/*!
 * jQuery JavaScript Library v2.1.3
 * http://jquery.com/
 *
 * Includes Sizzle.js
 * http://sizzlejs.com/
 *
 * Copyright 2005, 2014 jQuery Foundation, Inc. and other contributors
 * Released under the MIT license
 * http://jquery.org/license
 *
 * Date: 2014-12-18T15:11Z
 */
(function(b,a){if(typeof module==="object"&&typeof module.exports==="object"){module.exports=b.document?a(b,true):function(c){if(!c.document){throw new Error("jQuery requires a window with a document")}return a(c)}}else{a(b)}}(typeof window!=="undefined"?window:this,function(window,noGlobal){var arr=[];var slice=arr.slice;var concat=arr.concat;var push=arr.push;var indexOf=arr.indexOf;var class2type={};var toString=class2type.toString;var hasOwn=class2type.hasOwnProperty;var support={};var document=window.document,version="2.1.3",jQuery=function(selector,context){return new jQuery.fn.init(selector,context)},rtrim=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,rmsPrefix=/^-ms-/,rdashAlpha=/-([\da-z])/gi,fcamelCase=function(all,letter){return letter.toUpperCase()};jQuery.fn=jQuery.prototype={jquery:version,constructor:jQuery,selector:"",length:0,toArray:function(){return slice.call(this)},get:function(num){return num!=null?(num<0?this[num+this.length]:this[num]):slice.call(this)},pushStack:function(elems){var ret=jQuery.merge(this.constructor(),elems);ret.prevObject=this;ret.context=this.context;return ret},each:function(callback,args){return jQuery.each(this,callback,args)},map:function(callback){return this.pushStack(jQuery.map(this,function(elem,i){return callback.call(elem,i,elem)}))},slice:function(){return this.pushStack(slice.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(i){var len=this.length,j=+i+(i<0?len:0);return this.pushStack(j>=0&&j<len?[this[j]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:push,sort:arr.sort,splice:arr.splice};jQuery.extend=jQuery.fn.extend=function(){var options,name,src,copy,copyIsArray,clone,target=arguments[0]||{},i=1,length=arguments.length,deep=false;if(typeof target==="boolean"){deep=target;target=arguments[i]||{};i++}if(typeof target!=="object"&&!jQuery.isFunction(target)){target={}}if(i===length){target=this;i--}for(;i<length;i++){if((options=arguments[i])!=null){for(name in options){src=target[name];copy=options[name];if(target===copy){continue}if(deep&&copy&&(jQuery.isPlainObject(copy)||(copyIsArray=jQuery.isArray(copy)))){if(copyIsArray){copyIsArray=false;clone=src&&jQuery.isArray(src)?src:[]}else{clone=src&&jQuery.isPlainObject(src)?src:{}}target[name]=jQuery.extend(deep,clone,copy)}else{if(copy!==undefined){target[name]=copy}}}}}return target};jQuery.extend({expando:"jQuery"+(version+Math.random()).replace(/\D/g,""),isReady:true,error:function(msg){throw new Error(msg)},noop:function(){},isFunction:function(obj){return jQuery.type(obj)==="function"},isArray:Array.isArray,isWindow:function(obj){return obj!=null&&obj===obj.window},isNumeric:function(obj){return !jQuery.isArray(obj)&&(obj-parseFloat(obj)+1)>=0},isPlainObject:function(obj){if(jQuery.type(obj)!=="object"||obj.nodeType||jQuery.isWindow(obj)){return false}if(obj.constructor&&!hasOwn.call(obj.constructor.prototype,"isPrototypeOf")){return false}return true},isEmptyObject:function(obj){var name;for(name in obj){return false}return true},type:function(obj){if(obj==null){return obj+""}return typeof obj==="object"||typeof obj==="function"?class2type[toString.call(obj)]||"object":typeof obj},globalEval:function(code){var script,indirect=eval;code=jQuery.trim(code);if(code){if(code.indexOf("use strict")===1){script=document.createElement("script");script.text=code;document.head.appendChild(script).parentNode.removeChild(script)}else{indirect(code)}}},camelCase:function(string){return string.replace(rmsPrefix,"ms-").replace(rdashAlpha,fcamelCase)},nodeName:function(elem,name){return elem.nodeName&&elem.nodeName.toLowerCase()===name.toLowerCase()},each:function(obj,callback,args){var value,i=0,length=obj.length,isArray=isArraylike(obj);if(args){if(isArray){for(;i<length;i++){value=callback.apply(obj[i],args);if(value===false){break}}}else{for(i in obj){value=callback.apply(obj[i],args);if(value===false){break}}}}else{if(isArray){for(;i<length;i++){value=callback.call(obj[i],i,obj[i]);if(value===false){break}}}else{for(i in obj){value=callback.call(obj[i],i,obj[i]);if(value===false){break}}}}return obj},trim:function(text){return text==null?"":(text+"").replace(rtrim,"")},makeArray:function(arr,results){var ret=results||[];if(arr!=null){if(isArraylike(Object(arr))){jQuery.merge(ret,typeof arr==="string"?[arr]:arr)}else{push.call(ret,arr)}}return ret},inArray:function(elem,arr,i){return arr==null?-1:indexOf.call(arr,elem,i)},merge:function(first,second){var len=+second.length,j=0,i=first.length;for(;j<len;j++){first[i++]=second[j]}first.length=i;return first},grep:function(elems,callback,invert){var callbackInverse,matches=[],i=0,length=elems.length,callbackExpect=!invert;for(;i<length;i++){callbackInverse=!callback(elems[i],i);if(callbackInverse!==callbackExpect){matches.push(elems[i])}}return matches},map:function(elems,callback,arg){var value,i=0,length=elems.length,isArray=isArraylike(elems),ret=[];if(isArray){for(;i<length;i++){value=callback(elems[i],i,arg);if(value!=null){ret.push(value)}}}else{for(i in elems){value=callback(elems[i],i,arg);if(value!=null){ret.push(value)}}}return concat.apply([],ret)},guid:1,proxy:function(fn,context){var tmp,args,proxy;if(typeof context==="string"){tmp=fn[context];context=fn;fn=tmp}if(!jQuery.isFunction(fn)){return undefined}args=slice.call(arguments,2);proxy=function(){return fn.apply(context||this,args.concat(slice.call(arguments)))};proxy.guid=fn.guid=fn.guid||jQuery.guid++;return proxy},now:Date.now,support:support});jQuery.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(i,name){class2type["[object "+name+"]"]=name.toLowerCase()});function isArraylike(obj){var length=obj.length,type=jQuery.type(obj);if(type==="function"||jQuery.isWindow(obj)){return false}if(obj.nodeType===1&&length){return true}return type==="array"||length===0||typeof length==="number"&&length>0&&(length-1) in obj}var Sizzle=
/*!
 * Sizzle CSS Selector Engine v2.2.0-pre
 * http://sizzlejs.com/
 *
 * Copyright 2008, 2014 jQuery Foundation, Inc. and other contributors
 * Released under the MIT license
 * http://jquery.org/license
 *
 * Date: 2014-12-16
 */
(function(window){var i,support,Expr,getText,isXML,tokenize,compile,select,outermostContext,sortInput,hasDuplicate,setDocument,document,docElem,documentIsHTML,rbuggyQSA,rbuggyMatches,matches,contains,expando="sizzle"+1*new Date(),preferredDoc=window.document,dirruns=0,done=0,classCache=createCache(),tokenCache=createCache(),compilerCache=createCache(),sortOrder=function(a,b){if(a===b){hasDuplicate=true}return 0},MAX_NEGATIVE=1<<31,hasOwn=({}).hasOwnProperty,arr=[],pop=arr.pop,push_native=arr.push,push=arr.push,slice=arr.slice,indexOf=function(list,elem){var i=0,len=list.length;for(;i<len;i++){if(list[i]===elem){return i}}return -1},booleans="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",whitespace="[\\x20\\t\\r\\n\\f]",characterEncoding="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",identifier=characterEncoding.replace("w","w#"),attributes="\\["+whitespace+"*("+characterEncoding+")(?:"+whitespace+"*([*^$|!~]?=)"+whitespace+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+identifier+"))|)"+whitespace+"*\\]",pseudos=":("+characterEncoding+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+attributes+")*)|.*)\\)|)",rwhitespace=new RegExp(whitespace+"+","g"),rtrim=new RegExp("^"+whitespace+"+|((?:^|[^\\\\])(?:\\\\.)*)"+whitespace+"+$","g"),rcomma=new RegExp("^"+whitespace+"*,"+whitespace+"*"),rcombinators=new RegExp("^"+whitespace+"*([>+~]|"+whitespace+")"+whitespace+"*"),rattributeQuotes=new RegExp("="+whitespace+"*([^\\]'\"]*?)"+whitespace+"*\\]","g"),rpseudo=new RegExp(pseudos),ridentifier=new RegExp("^"+identifier+"$"),matchExpr={ID:new RegExp("^#("+characterEncoding+")"),CLASS:new RegExp("^\\.("+characterEncoding+")"),TAG:new RegExp("^("+characterEncoding.replace("w","w*")+")"),ATTR:new RegExp("^"+attributes),PSEUDO:new RegExp("^"+pseudos),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+whitespace+"*(even|odd|(([+-]|)(\\d*)n|)"+whitespace+"*(?:([+-]|)"+whitespace+"*(\\d+)|))"+whitespace+"*\\)|)","i"),bool:new RegExp("^(?:"+booleans+")$","i"),needsContext:new RegExp("^"+whitespace+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+whitespace+"*((?:-\\d)?\\d*)"+whitespace+"*\\)|)(?=[^-]|$)","i")},rinputs=/^(?:input|select|textarea|button)$/i,rheader=/^h\d$/i,rnative=/^[^{]+\{\s*\[native \w/,rquickExpr=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,rsibling=/[+~]/,rescape=/'|\\/g,runescape=new RegExp("\\\\([\\da-f]{1,6}"+whitespace+"?|("+whitespace+")|.)","ig"),funescape=function(_,escaped,escapedWhitespace){var high="0x"+escaped-65536;return high!==high||escapedWhitespace?escaped:high<0?String.fromCharCode(high+65536):String.fromCharCode(high>>10|55296,high&1023|56320)},unloadHandler=function(){setDocument()};try{push.apply((arr=slice.call(preferredDoc.childNodes)),preferredDoc.childNodes);arr[preferredDoc.childNodes.length].nodeType}catch(e){push={apply:arr.length?function(target,els){push_native.apply(target,slice.call(els))}:function(target,els){var j=target.length,i=0;while((target[j++]=els[i++])){}target.length=j-1}}}function Sizzle(selector,context,results,seed){var match,elem,m,nodeType,i,groups,old,nid,newContext,newSelector;if((context?context.ownerDocument||context:preferredDoc)!==document){setDocument(context)}context=context||document;results=results||[];nodeType=context.nodeType;if(typeof selector!=="string"||!selector||nodeType!==1&&nodeType!==9&&nodeType!==11){return results}if(!seed&&documentIsHTML){if(nodeType!==11&&(match=rquickExpr.exec(selector))){if((m=match[1])){if(nodeType===9){elem=context.getElementById(m);if(elem&&elem.parentNode){if(elem.id===m){results.push(elem);return results}}else{return results}}else{if(context.ownerDocument&&(elem=context.ownerDocument.getElementById(m))&&contains(context,elem)&&elem.id===m){results.push(elem);return results}}}else{if(match[2]){push.apply(results,context.getElementsByTagName(selector));return results}else{if((m=match[3])&&support.getElementsByClassName){push.apply(results,context.getElementsByClassName(m));return results}}}}if(support.qsa&&(!rbuggyQSA||!rbuggyQSA.test(selector))){nid=old=expando;newContext=context;newSelector=nodeType!==1&&selector;if(nodeType===1&&context.nodeName.toLowerCase()!=="object"){groups=tokenize(selector);if((old=context.getAttribute("id"))){nid=old.replace(rescape,"\\$&")}else{context.setAttribute("id",nid)}nid="[id='"+nid+"'] ";i=groups.length;while(i--){groups[i]=nid+toSelector(groups[i])}newContext=rsibling.test(selector)&&testContext(context.parentNode)||context;newSelector=groups.join(",")}if(newSelector){try{push.apply(results,newContext.querySelectorAll(newSelector));return results}catch(qsaError){}finally{if(!old){context.removeAttribute("id")}}}}}return select(selector.replace(rtrim,"$1"),context,results,seed)}function createCache(){var keys=[];function cache(key,value){if(keys.push(key+" ")>Expr.cacheLength){delete cache[keys.shift()]}return(cache[key+" "]=value)}return cache}function markFunction(fn){fn[expando]=true;return fn}function assert(fn){var div=document.createElement("div");try{return !!fn(div)}catch(e){return false}finally{if(div.parentNode){div.parentNode.removeChild(div)}div=null}}function addHandle(attrs,handler){var arr=attrs.split("|"),i=attrs.length;while(i--){Expr.attrHandle[arr[i]]=handler}}function siblingCheck(a,b){var cur=b&&a,diff=cur&&a.nodeType===1&&b.nodeType===1&&(~b.sourceIndex||MAX_NEGATIVE)-(~a.sourceIndex||MAX_NEGATIVE);if(diff){return diff}if(cur){while((cur=cur.nextSibling)){if(cur===b){return -1}}}return a?1:-1}function createInputPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return name==="input"&&elem.type===type}}function createButtonPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return(name==="input"||name==="button")&&elem.type===type}}function createPositionalPseudo(fn){return markFunction(function(argument){argument=+argument;return markFunction(function(seed,matches){var j,matchIndexes=fn([],seed.length,argument),i=matchIndexes.length;while(i--){if(seed[(j=matchIndexes[i])]){seed[j]=!(matches[j]=seed[j])}}})})}function testContext(context){return context&&typeof context.getElementsByTagName!=="undefined"&&context}support=Sizzle.support={};isXML=Sizzle.isXML=function(elem){var documentElement=elem&&(elem.ownerDocument||elem).documentElement;return documentElement?documentElement.nodeName!=="HTML":false};setDocument=Sizzle.setDocument=function(node){var hasCompare,parent,doc=node?node.ownerDocument||node:preferredDoc;if(doc===document||doc.nodeType!==9||!doc.documentElement){return document}document=doc;docElem=doc.documentElement;parent=doc.defaultView;if(parent&&parent!==parent.top){if(parent.addEventListener){parent.addEventListener("unload",unloadHandler,false)}else{if(parent.attachEvent){parent.attachEvent("onunload",unloadHandler)}}}documentIsHTML=!isXML(doc);support.attributes=assert(function(div){div.className="i";return !div.getAttribute("className")});support.getElementsByTagName=assert(function(div){div.appendChild(doc.createComment(""));return !div.getElementsByTagName("*").length});support.getElementsByClassName=rnative.test(doc.getElementsByClassName);support.getById=assert(function(div){docElem.appendChild(div).id=expando;return !doc.getElementsByName||!doc.getElementsByName(expando).length});if(support.getById){Expr.find.ID=function(id,context){if(typeof context.getElementById!=="undefined"&&documentIsHTML){var m=context.getElementById(id);return m&&m.parentNode?[m]:[]}};Expr.filter.ID=function(id){var attrId=id.replace(runescape,funescape);return function(elem){return elem.getAttribute("id")===attrId}}}else{delete Expr.find.ID;Expr.filter.ID=function(id){var attrId=id.replace(runescape,funescape);return function(elem){var node=typeof elem.getAttributeNode!=="undefined"&&elem.getAttributeNode("id");return node&&node.value===attrId}}}Expr.find.TAG=support.getElementsByTagName?function(tag,context){if(typeof context.getElementsByTagName!=="undefined"){return context.getElementsByTagName(tag)}else{if(support.qsa){return context.querySelectorAll(tag)}}}:function(tag,context){var elem,tmp=[],i=0,results=context.getElementsByTagName(tag);if(tag==="*"){while((elem=results[i++])){if(elem.nodeType===1){tmp.push(elem)}}return tmp}return results};Expr.find.CLASS=support.getElementsByClassName&&function(className,context){if(documentIsHTML){return context.getElementsByClassName(className)}};rbuggyMatches=[];rbuggyQSA=[];if((support.qsa=rnative.test(doc.querySelectorAll))){assert(function(div){docElem.appendChild(div).innerHTML="<a id='"+expando+"'></a><select id='"+expando+"-\f]' msallowcapture=''><option selected=''></option></select>";if(div.querySelectorAll("[msallowcapture^='']").length){rbuggyQSA.push("[*^$]="+whitespace+"*(?:''|\"\")")}if(!div.querySelectorAll("[selected]").length){rbuggyQSA.push("\\["+whitespace+"*(?:value|"+booleans+")")}if(!div.querySelectorAll("[id~="+expando+"-]").length){rbuggyQSA.push("~=")}if(!div.querySelectorAll(":checked").length){rbuggyQSA.push(":checked")}if(!div.querySelectorAll("a#"+expando+"+*").length){rbuggyQSA.push(".#.+[+~]")}});assert(function(div){var input=doc.createElement("input");input.setAttribute("type","hidden");div.appendChild(input).setAttribute("name","D");if(div.querySelectorAll("[name=d]").length){rbuggyQSA.push("name"+whitespace+"*[*^$|!~]?=")}if(!div.querySelectorAll(":enabled").length){rbuggyQSA.push(":enabled",":disabled")}div.querySelectorAll("*,:x");rbuggyQSA.push(",.*:")})}if((support.matchesSelector=rnative.test((matches=docElem.matches||docElem.webkitMatchesSelector||docElem.mozMatchesSelector||docElem.oMatchesSelector||docElem.msMatchesSelector)))){assert(function(div){support.disconnectedMatch=matches.call(div,"div");matches.call(div,"[s!='']:x");rbuggyMatches.push("!=",pseudos)})}rbuggyQSA=rbuggyQSA.length&&new RegExp(rbuggyQSA.join("|"));rbuggyMatches=rbuggyMatches.length&&new RegExp(rbuggyMatches.join("|"));hasCompare=rnative.test(docElem.compareDocumentPosition);contains=hasCompare||rnative.test(docElem.contains)?function(a,b){var adown=a.nodeType===9?a.documentElement:a,bup=b&&b.parentNode;return a===bup||!!(bup&&bup.nodeType===1&&(adown.contains?adown.contains(bup):a.compareDocumentPosition&&a.compareDocumentPosition(bup)&16))}:function(a,b){if(b){while((b=b.parentNode)){if(b===a){return true}}}return false};sortOrder=hasCompare?function(a,b){if(a===b){hasDuplicate=true;return 0}var compare=!a.compareDocumentPosition-!b.compareDocumentPosition;if(compare){return compare}compare=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1;if(compare&1||(!support.sortDetached&&b.compareDocumentPosition(a)===compare)){if(a===doc||a.ownerDocument===preferredDoc&&contains(preferredDoc,a)){return -1}if(b===doc||b.ownerDocument===preferredDoc&&contains(preferredDoc,b)){return 1}return sortInput?(indexOf(sortInput,a)-indexOf(sortInput,b)):0}return compare&4?-1:1}:function(a,b){if(a===b){hasDuplicate=true;return 0}var cur,i=0,aup=a.parentNode,bup=b.parentNode,ap=[a],bp=[b];if(!aup||!bup){return a===doc?-1:b===doc?1:aup?-1:bup?1:sortInput?(indexOf(sortInput,a)-indexOf(sortInput,b)):0}else{if(aup===bup){return siblingCheck(a,b)}}cur=a;while((cur=cur.parentNode)){ap.unshift(cur)}cur=b;while((cur=cur.parentNode)){bp.unshift(cur)}while(ap[i]===bp[i]){i++}return i?siblingCheck(ap[i],bp[i]):ap[i]===preferredDoc?-1:bp[i]===preferredDoc?1:0};return doc};Sizzle.matches=function(expr,elements){return Sizzle(expr,null,null,elements)};Sizzle.matchesSelector=function(elem,expr){if((elem.ownerDocument||elem)!==document){setDocument(elem)}expr=expr.replace(rattributeQuotes,"='$1']");if(support.matchesSelector&&documentIsHTML&&(!rbuggyMatches||!rbuggyMatches.test(expr))&&(!rbuggyQSA||!rbuggyQSA.test(expr))){try{var ret=matches.call(elem,expr);if(ret||support.disconnectedMatch||elem.document&&elem.document.nodeType!==11){return ret}}catch(e){}}return Sizzle(expr,document,null,[elem]).length>0};Sizzle.contains=function(context,elem){if((context.ownerDocument||context)!==document){setDocument(context)}return contains(context,elem)};Sizzle.attr=function(elem,name){if((elem.ownerDocument||elem)!==document){setDocument(elem)}var fn=Expr.attrHandle[name.toLowerCase()],val=fn&&hasOwn.call(Expr.attrHandle,name.toLowerCase())?fn(elem,name,!documentIsHTML):undefined;return val!==undefined?val:support.attributes||!documentIsHTML?elem.getAttribute(name):(val=elem.getAttributeNode(name))&&val.specified?val.value:null};Sizzle.error=function(msg){throw new Error("Syntax error, unrecognized expression: "+msg)};Sizzle.uniqueSort=function(results){var elem,duplicates=[],j=0,i=0;hasDuplicate=!support.detectDuplicates;sortInput=!support.sortStable&&results.slice(0);results.sort(sortOrder);if(hasDuplicate){while((elem=results[i++])){if(elem===results[i]){j=duplicates.push(i)}}while(j--){results.splice(duplicates[j],1)}}sortInput=null;return results};getText=Sizzle.getText=function(elem){var node,ret="",i=0,nodeType=elem.nodeType;if(!nodeType){while((node=elem[i++])){ret+=getText(node)}}else{if(nodeType===1||nodeType===9||nodeType===11){if(typeof elem.textContent==="string"){return elem.textContent}else{for(elem=elem.firstChild;elem;elem=elem.nextSibling){ret+=getText(elem)}}}else{if(nodeType===3||nodeType===4){return elem.nodeValue}}}return ret};Expr=Sizzle.selectors={cacheLength:50,createPseudo:markFunction,match:matchExpr,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:true}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:true},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(match){match[1]=match[1].replace(runescape,funescape);match[3]=(match[3]||match[4]||match[5]||"").replace(runescape,funescape);if(match[2]==="~="){match[3]=" "+match[3]+" "}return match.slice(0,4)},CHILD:function(match){match[1]=match[1].toLowerCase();if(match[1].slice(0,3)==="nth"){if(!match[3]){Sizzle.error(match[0])}match[4]=+(match[4]?match[5]+(match[6]||1):2*(match[3]==="even"||match[3]==="odd"));match[5]=+((match[7]+match[8])||match[3]==="odd")}else{if(match[3]){Sizzle.error(match[0])}}return match},PSEUDO:function(match){var excess,unquoted=!match[6]&&match[2];if(matchExpr.CHILD.test(match[0])){return null}if(match[3]){match[2]=match[4]||match[5]||""}else{if(unquoted&&rpseudo.test(unquoted)&&(excess=tokenize(unquoted,true))&&(excess=unquoted.indexOf(")",unquoted.length-excess)-unquoted.length)){match[0]=match[0].slice(0,excess);match[2]=unquoted.slice(0,excess)}}return match.slice(0,3)}},filter:{TAG:function(nodeNameSelector){var nodeName=nodeNameSelector.replace(runescape,funescape).toLowerCase();return nodeNameSelector==="*"?function(){return true}:function(elem){return elem.nodeName&&elem.nodeName.toLowerCase()===nodeName}},CLASS:function(className){var pattern=classCache[className+" "];return pattern||(pattern=new RegExp("(^|"+whitespace+")"+className+"("+whitespace+"|$)"))&&classCache(className,function(elem){return pattern.test(typeof elem.className==="string"&&elem.className||typeof elem.getAttribute!=="undefined"&&elem.getAttribute("class")||"")})},ATTR:function(name,operator,check){return function(elem){var result=Sizzle.attr(elem,name);if(result==null){return operator==="!="}if(!operator){return true}result+="";return operator==="="?result===check:operator==="!="?result!==check:operator==="^="?check&&result.indexOf(check)===0:operator==="*="?check&&result.indexOf(check)>-1:operator==="$="?check&&result.slice(-check.length)===check:operator==="~="?(" "+result.replace(rwhitespace," ")+" ").indexOf(check)>-1:operator==="|="?result===check||result.slice(0,check.length+1)===check+"-":false}},CHILD:function(type,what,argument,first,last){var simple=type.slice(0,3)!=="nth",forward=type.slice(-4)!=="last",ofType=what==="of-type";return first===1&&last===0?function(elem){return !!elem.parentNode}:function(elem,context,xml){var cache,outerCache,node,diff,nodeIndex,start,dir=simple!==forward?"nextSibling":"previousSibling",parent=elem.parentNode,name=ofType&&elem.nodeName.toLowerCase(),useCache=!xml&&!ofType;if(parent){if(simple){while(dir){node=elem;while((node=node[dir])){if(ofType?node.nodeName.toLowerCase()===name:node.nodeType===1){return false}}start=dir=type==="only"&&!start&&"nextSibling"}return true}start=[forward?parent.firstChild:parent.lastChild];if(forward&&useCache){outerCache=parent[expando]||(parent[expando]={});cache=outerCache[type]||[];nodeIndex=cache[0]===dirruns&&cache[1];diff=cache[0]===dirruns&&cache[2];node=nodeIndex&&parent.childNodes[nodeIndex];while((node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop())){if(node.nodeType===1&&++diff&&node===elem){outerCache[type]=[dirruns,nodeIndex,diff];break}}}else{if(useCache&&(cache=(elem[expando]||(elem[expando]={}))[type])&&cache[0]===dirruns){diff=cache[1]}else{while((node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop())){if((ofType?node.nodeName.toLowerCase()===name:node.nodeType===1)&&++diff){if(useCache){(node[expando]||(node[expando]={}))[type]=[dirruns,diff]}if(node===elem){break}}}}}diff-=last;return diff===first||(diff%first===0&&diff/first>=0)}}},PSEUDO:function(pseudo,argument){var args,fn=Expr.pseudos[pseudo]||Expr.setFilters[pseudo.toLowerCase()]||Sizzle.error("unsupported pseudo: "+pseudo);if(fn[expando]){return fn(argument)}if(fn.length>1){args=[pseudo,pseudo,"",argument];return Expr.setFilters.hasOwnProperty(pseudo.toLowerCase())?markFunction(function(seed,matches){var idx,matched=fn(seed,argument),i=matched.length;while(i--){idx=indexOf(seed,matched[i]);seed[idx]=!(matches[idx]=matched[i])}}):function(elem){return fn(elem,0,args)}}return fn}},pseudos:{not:markFunction(function(selector){var input=[],results=[],matcher=compile(selector.replace(rtrim,"$1"));return matcher[expando]?markFunction(function(seed,matches,context,xml){var elem,unmatched=matcher(seed,null,xml,[]),i=seed.length;while(i--){if((elem=unmatched[i])){seed[i]=!(matches[i]=elem)}}}):function(elem,context,xml){input[0]=elem;matcher(input,null,xml,results);input[0]=null;return !results.pop()}}),has:markFunction(function(selector){return function(elem){return Sizzle(selector,elem).length>0}}),contains:markFunction(function(text){text=text.replace(runescape,funescape);return function(elem){return(elem.textContent||elem.innerText||getText(elem)).indexOf(text)>-1}}),lang:markFunction(function(lang){if(!ridentifier.test(lang||"")){Sizzle.error("unsupported lang: "+lang)}lang=lang.replace(runescape,funescape).toLowerCase();return function(elem){var elemLang;do{if((elemLang=documentIsHTML?elem.lang:elem.getAttribute("xml:lang")||elem.getAttribute("lang"))){elemLang=elemLang.toLowerCase();return elemLang===lang||elemLang.indexOf(lang+"-")===0}}while((elem=elem.parentNode)&&elem.nodeType===1);return false}}),target:function(elem){var hash=window.location&&window.location.hash;return hash&&hash.slice(1)===elem.id},root:function(elem){return elem===docElem},focus:function(elem){return elem===document.activeElement&&(!document.hasFocus||document.hasFocus())&&!!(elem.type||elem.href||~elem.tabIndex)},enabled:function(elem){return elem.disabled===false},disabled:function(elem){return elem.disabled===true},checked:function(elem){var nodeName=elem.nodeName.toLowerCase();return(nodeName==="input"&&!!elem.checked)||(nodeName==="option"&&!!elem.selected)},selected:function(elem){if(elem.parentNode){elem.parentNode.selectedIndex}return elem.selected===true},empty:function(elem){for(elem=elem.firstChild;elem;elem=elem.nextSibling){if(elem.nodeType<6){return false}}return true},parent:function(elem){return !Expr.pseudos.empty(elem)},header:function(elem){return rheader.test(elem.nodeName)},input:function(elem){return rinputs.test(elem.nodeName)},button:function(elem){var name=elem.nodeName.toLowerCase();return name==="input"&&elem.type==="button"||name==="button"},text:function(elem){var attr;return elem.nodeName.toLowerCase()==="input"&&elem.type==="text"&&((attr=elem.getAttribute("type"))==null||attr.toLowerCase()==="text")},first:createPositionalPseudo(function(){return[0]}),last:createPositionalPseudo(function(matchIndexes,length){return[length-1]}),eq:createPositionalPseudo(function(matchIndexes,length,argument){return[argument<0?argument+length:argument]}),even:createPositionalPseudo(function(matchIndexes,length){var i=0;for(;i<length;i+=2){matchIndexes.push(i)}return matchIndexes}),odd:createPositionalPseudo(function(matchIndexes,length){var i=1;for(;i<length;i+=2){matchIndexes.push(i)}return matchIndexes}),lt:createPositionalPseudo(function(matchIndexes,length,argument){var i=argument<0?argument+length:argument;for(;--i>=0;){matchIndexes.push(i)}return matchIndexes}),gt:createPositionalPseudo(function(matchIndexes,length,argument){var i=argument<0?argument+length:argument;for(;++i<length;){matchIndexes.push(i)}return matchIndexes})}};Expr.pseudos.nth=Expr.pseudos.eq;for(i in {radio:true,checkbox:true,file:true,password:true,image:true}){Expr.pseudos[i]=createInputPseudo(i)}for(i in {submit:true,reset:true}){Expr.pseudos[i]=createButtonPseudo(i)}function setFilters(){}setFilters.prototype=Expr.filters=Expr.pseudos;Expr.setFilters=new setFilters();tokenize=Sizzle.tokenize=function(selector,parseOnly){var matched,match,tokens,type,soFar,groups,preFilters,cached=tokenCache[selector+" "];if(cached){return parseOnly?0:cached.slice(0)}soFar=selector;groups=[];preFilters=Expr.preFilter;while(soFar){if(!matched||(match=rcomma.exec(soFar))){if(match){soFar=soFar.slice(match[0].length)||soFar}groups.push((tokens=[]))}matched=false;if((match=rcombinators.exec(soFar))){matched=match.shift();tokens.push({value:matched,type:match[0].replace(rtrim," ")});soFar=soFar.slice(matched.length)}for(type in Expr.filter){if((match=matchExpr[type].exec(soFar))&&(!preFilters[type]||(match=preFilters[type](match)))){matched=match.shift();tokens.push({value:matched,type:type,matches:match});soFar=soFar.slice(matched.length)}}if(!matched){break}}return parseOnly?soFar.length:soFar?Sizzle.error(selector):tokenCache(selector,groups).slice(0)};function toSelector(tokens){var i=0,len=tokens.length,selector="";for(;i<len;i++){selector+=tokens[i].value}return selector}function addCombinator(matcher,combinator,base){var dir=combinator.dir,checkNonElements=base&&dir==="parentNode",doneName=done++;return combinator.first?function(elem,context,xml){while((elem=elem[dir])){if(elem.nodeType===1||checkNonElements){return matcher(elem,context,xml)}}}:function(elem,context,xml){var oldCache,outerCache,newCache=[dirruns,doneName];if(xml){while((elem=elem[dir])){if(elem.nodeType===1||checkNonElements){if(matcher(elem,context,xml)){return true}}}}else{while((elem=elem[dir])){if(elem.nodeType===1||checkNonElements){outerCache=elem[expando]||(elem[expando]={});if((oldCache=outerCache[dir])&&oldCache[0]===dirruns&&oldCache[1]===doneName){return(newCache[2]=oldCache[2])}else{outerCache[dir]=newCache;if((newCache[2]=matcher(elem,context,xml))){return true}}}}}}}function elementMatcher(matchers){return matchers.length>1?function(elem,context,xml){var i=matchers.length;while(i--){if(!matchers[i](elem,context,xml)){return false}}return true}:matchers[0]}function multipleContexts(selector,contexts,results){var i=0,len=contexts.length;for(;i<len;i++){Sizzle(selector,contexts[i],results)}return results}function condense(unmatched,map,filter,context,xml){var elem,newUnmatched=[],i=0,len=unmatched.length,mapped=map!=null;for(;i<len;i++){if((elem=unmatched[i])){if(!filter||filter(elem,context,xml)){newUnmatched.push(elem);if(mapped){map.push(i)}}}}return newUnmatched}function setMatcher(preFilter,selector,matcher,postFilter,postFinder,postSelector){if(postFilter&&!postFilter[expando]){postFilter=setMatcher(postFilter)}if(postFinder&&!postFinder[expando]){postFinder=setMatcher(postFinder,postSelector)}return markFunction(function(seed,results,context,xml){var temp,i,elem,preMap=[],postMap=[],preexisting=results.length,elems=seed||multipleContexts(selector||"*",context.nodeType?[context]:context,[]),matcherIn=preFilter&&(seed||!selector)?condense(elems,preMap,preFilter,context,xml):elems,matcherOut=matcher?postFinder||(seed?preFilter:preexisting||postFilter)?[]:results:matcherIn;if(matcher){matcher(matcherIn,matcherOut,context,xml)}if(postFilter){temp=condense(matcherOut,postMap);postFilter(temp,[],context,xml);i=temp.length;while(i--){if((elem=temp[i])){matcherOut[postMap[i]]=!(matcherIn[postMap[i]]=elem)}}}if(seed){if(postFinder||preFilter){if(postFinder){temp=[];i=matcherOut.length;while(i--){if((elem=matcherOut[i])){temp.push((matcherIn[i]=elem))}}postFinder(null,(matcherOut=[]),temp,xml)}i=matcherOut.length;while(i--){if((elem=matcherOut[i])&&(temp=postFinder?indexOf(seed,elem):preMap[i])>-1){seed[temp]=!(results[temp]=elem)}}}}else{matcherOut=condense(matcherOut===results?matcherOut.splice(preexisting,matcherOut.length):matcherOut);if(postFinder){postFinder(null,results,matcherOut,xml)}else{push.apply(results,matcherOut)}}})}function matcherFromTokens(tokens){var checkContext,matcher,j,len=tokens.length,leadingRelative=Expr.relative[tokens[0].type],implicitRelative=leadingRelative||Expr.relative[" "],i=leadingRelative?1:0,matchContext=addCombinator(function(elem){return elem===checkContext},implicitRelative,true),matchAnyContext=addCombinator(function(elem){return indexOf(checkContext,elem)>-1},implicitRelative,true),matchers=[function(elem,context,xml){var ret=(!leadingRelative&&(xml||context!==outermostContext))||((checkContext=context).nodeType?matchContext(elem,context,xml):matchAnyContext(elem,context,xml));checkContext=null;return ret}];for(;i<len;i++){if((matcher=Expr.relative[tokens[i].type])){matchers=[addCombinator(elementMatcher(matchers),matcher)]}else{matcher=Expr.filter[tokens[i].type].apply(null,tokens[i].matches);if(matcher[expando]){j=++i;for(;j<len;j++){if(Expr.relative[tokens[j].type]){break}}return setMatcher(i>1&&elementMatcher(matchers),i>1&&toSelector(tokens.slice(0,i-1).concat({value:tokens[i-2].type===" "?"*":""})).replace(rtrim,"$1"),matcher,i<j&&matcherFromTokens(tokens.slice(i,j)),j<len&&matcherFromTokens((tokens=tokens.slice(j))),j<len&&toSelector(tokens))}matchers.push(matcher)}}return elementMatcher(matchers)}function matcherFromGroupMatchers(elementMatchers,setMatchers){var bySet=setMatchers.length>0,byElement=elementMatchers.length>0,superMatcher=function(seed,context,xml,results,outermost){var elem,j,matcher,matchedCount=0,i="0",unmatched=seed&&[],setMatched=[],contextBackup=outermostContext,elems=seed||byElement&&Expr.find.TAG("*",outermost),dirrunsUnique=(dirruns+=contextBackup==null?1:Math.random()||0.1),len=elems.length;if(outermost){outermostContext=context!==document&&context}for(;i!==len&&(elem=elems[i])!=null;i++){if(byElement&&elem){j=0;while((matcher=elementMatchers[j++])){if(matcher(elem,context,xml)){results.push(elem);break}}if(outermost){dirruns=dirrunsUnique}}if(bySet){if((elem=!matcher&&elem)){matchedCount--}if(seed){unmatched.push(elem)}}}matchedCount+=i;if(bySet&&i!==matchedCount){j=0;while((matcher=setMatchers[j++])){matcher(unmatched,setMatched,context,xml)}if(seed){if(matchedCount>0){while(i--){if(!(unmatched[i]||setMatched[i])){setMatched[i]=pop.call(results)}}}setMatched=condense(setMatched)}push.apply(results,setMatched);if(outermost&&!seed&&setMatched.length>0&&(matchedCount+setMatchers.length)>1){Sizzle.uniqueSort(results)}}if(outermost){dirruns=dirrunsUnique;outermostContext=contextBackup}return unmatched};return bySet?markFunction(superMatcher):superMatcher}compile=Sizzle.compile=function(selector,match){var i,setMatchers=[],elementMatchers=[],cached=compilerCache[selector+" "];if(!cached){if(!match){match=tokenize(selector)}i=match.length;while(i--){cached=matcherFromTokens(match[i]);if(cached[expando]){setMatchers.push(cached)}else{elementMatchers.push(cached)}}cached=compilerCache(selector,matcherFromGroupMatchers(elementMatchers,setMatchers));cached.selector=selector}return cached};select=Sizzle.select=function(selector,context,results,seed){var i,tokens,token,type,find,compiled=typeof selector==="function"&&selector,match=!seed&&tokenize((selector=compiled.selector||selector));results=results||[];if(match.length===1){tokens=match[0]=match[0].slice(0);if(tokens.length>2&&(token=tokens[0]).type==="ID"&&support.getById&&context.nodeType===9&&documentIsHTML&&Expr.relative[tokens[1].type]){context=(Expr.find.ID(token.matches[0].replace(runescape,funescape),context)||[])[0];if(!context){return results}else{if(compiled){context=context.parentNode}}selector=selector.slice(tokens.shift().value.length)}i=matchExpr.needsContext.test(selector)?0:tokens.length;while(i--){token=tokens[i];if(Expr.relative[(type=token.type)]){break}if((find=Expr.find[type])){if((seed=find(token.matches[0].replace(runescape,funescape),rsibling.test(tokens[0].type)&&testContext(context.parentNode)||context))){tokens.splice(i,1);selector=seed.length&&toSelector(tokens);if(!selector){push.apply(results,seed);return results}break}}}}(compiled||compile(selector,match))(seed,context,!documentIsHTML,results,rsibling.test(selector)&&testContext(context.parentNode)||context);return results};support.sortStable=expando.split("").sort(sortOrder).join("")===expando;support.detectDuplicates=!!hasDuplicate;setDocument();support.sortDetached=assert(function(div1){return div1.compareDocumentPosition(document.createElement("div"))&1});if(!assert(function(div){div.innerHTML="<a href='#'></a>";return div.firstChild.getAttribute("href")==="#"})){addHandle("type|href|height|width",function(elem,name,isXML){if(!isXML){return elem.getAttribute(name,name.toLowerCase()==="type"?1:2)}})}if(!support.attributes||!assert(function(div){div.innerHTML="<input/>";div.firstChild.setAttribute("value","");return div.firstChild.getAttribute("value")===""})){addHandle("value",function(elem,name,isXML){if(!isXML&&elem.nodeName.toLowerCase()==="input"){return elem.defaultValue}})}if(!assert(function(div){return div.getAttribute("disabled")==null})){addHandle(booleans,function(elem,name,isXML){var val;if(!isXML){return elem[name]===true?name.toLowerCase():(val=elem.getAttributeNode(name))&&val.specified?val.value:null}})}return Sizzle})(window);jQuery.find=Sizzle;jQuery.expr=Sizzle.selectors;jQuery.expr[":"]=jQuery.expr.pseudos;jQuery.unique=Sizzle.uniqueSort;jQuery.text=Sizzle.getText;jQuery.isXMLDoc=Sizzle.isXML;jQuery.contains=Sizzle.contains;var rneedsContext=jQuery.expr.match.needsContext;var rsingleTag=(/^<(\w+)\s*\/?>(?:<\/\1>|)$/);var risSimple=/^.[^:#\[\.,]*$/;function winnow(elements,qualifier,not){if(jQuery.isFunction(qualifier)){return jQuery.grep(elements,function(elem,i){return !!qualifier.call(elem,i,elem)!==not})}if(qualifier.nodeType){return jQuery.grep(elements,function(elem){return(elem===qualifier)!==not})}if(typeof qualifier==="string"){if(risSimple.test(qualifier)){return jQuery.filter(qualifier,elements,not)}qualifier=jQuery.filter(qualifier,elements)}return jQuery.grep(elements,function(elem){return(indexOf.call(qualifier,elem)>=0)!==not})}jQuery.filter=function(expr,elems,not){var elem=elems[0];if(not){expr=":not("+expr+")"}return elems.length===1&&elem.nodeType===1?jQuery.find.matchesSelector(elem,expr)?[elem]:[]:jQuery.find.matches(expr,jQuery.grep(elems,function(elem){return elem.nodeType===1}))};jQuery.fn.extend({find:function(selector){var i,len=this.length,ret=[],self=this;if(typeof selector!=="string"){return this.pushStack(jQuery(selector).filter(function(){for(i=0;i<len;i++){if(jQuery.contains(self[i],this)){return true}}}))}for(i=0;i<len;i++){jQuery.find(selector,self[i],ret)}ret=this.pushStack(len>1?jQuery.unique(ret):ret);ret.selector=this.selector?this.selector+" "+selector:selector;return ret},filter:function(selector){return this.pushStack(winnow(this,selector||[],false))},not:function(selector){return this.pushStack(winnow(this,selector||[],true))},is:function(selector){return !!winnow(this,typeof selector==="string"&&rneedsContext.test(selector)?jQuery(selector):selector||[],false).length}});var rootjQuery,rquickExpr=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,init=jQuery.fn.init=function(selector,context){var match,elem;if(!selector){return this}if(typeof selector==="string"){if(selector[0]==="<"&&selector[selector.length-1]===">"&&selector.length>=3){match=[null,selector,null]}else{match=rquickExpr.exec(selector)}if(match&&(match[1]||!context)){if(match[1]){context=context instanceof jQuery?context[0]:context;jQuery.merge(this,jQuery.parseHTML(match[1],context&&context.nodeType?context.ownerDocument||context:document,true));if(rsingleTag.test(match[1])&&jQuery.isPlainObject(context)){for(match in context){if(jQuery.isFunction(this[match])){this[match](context[match])}else{this.attr(match,context[match])}}}return this}else{elem=document.getElementById(match[2]);if(elem&&elem.parentNode){this.length=1;this[0]=elem}this.context=document;this.selector=selector;return this}}else{if(!context||context.jquery){return(context||rootjQuery).find(selector)}else{return this.constructor(context).find(selector)}}}else{if(selector.nodeType){this.context=this[0]=selector;this.length=1;return this}else{if(jQuery.isFunction(selector)){return typeof rootjQuery.ready!=="undefined"?rootjQuery.ready(selector):selector(jQuery)}}}if(selector.selector!==undefined){this.selector=selector.selector;this.context=selector.context}return jQuery.makeArray(selector,this)};init.prototype=jQuery.fn;rootjQuery=jQuery(document);var rparentsprev=/^(?:parents|prev(?:Until|All))/,guaranteedUnique={children:true,contents:true,next:true,prev:true};jQuery.extend({dir:function(elem,dir,until){var matched=[],truncate=until!==undefined;while((elem=elem[dir])&&elem.nodeType!==9){if(elem.nodeType===1){if(truncate&&jQuery(elem).is(until)){break}matched.push(elem)}}return matched},sibling:function(n,elem){var matched=[];for(;n;n=n.nextSibling){if(n.nodeType===1&&n!==elem){matched.push(n)}}return matched}});jQuery.fn.extend({has:function(target){var targets=jQuery(target,this),l=targets.length;return this.filter(function(){var i=0;for(;i<l;i++){if(jQuery.contains(this,targets[i])){return true}}})},closest:function(selectors,context){var cur,i=0,l=this.length,matched=[],pos=rneedsContext.test(selectors)||typeof selectors!=="string"?jQuery(selectors,context||this.context):0;for(;i<l;i++){for(cur=this[i];cur&&cur!==context;cur=cur.parentNode){if(cur.nodeType<11&&(pos?pos.index(cur)>-1:cur.nodeType===1&&jQuery.find.matchesSelector(cur,selectors))){matched.push(cur);break}}}return this.pushStack(matched.length>1?jQuery.unique(matched):matched)},index:function(elem){if(!elem){return(this[0]&&this[0].parentNode)?this.first().prevAll().length:-1}if(typeof elem==="string"){return indexOf.call(jQuery(elem),this[0])}return indexOf.call(this,elem.jquery?elem[0]:elem)},add:function(selector,context){return this.pushStack(jQuery.unique(jQuery.merge(this.get(),jQuery(selector,context))))},addBack:function(selector){return this.add(selector==null?this.prevObject:this.prevObject.filter(selector))}});function sibling(cur,dir){while((cur=cur[dir])&&cur.nodeType!==1){}return cur}jQuery.each({parent:function(elem){var parent=elem.parentNode;return parent&&parent.nodeType!==11?parent:null},parents:function(elem){return jQuery.dir(elem,"parentNode")},parentsUntil:function(elem,i,until){return jQuery.dir(elem,"parentNode",until)},next:function(elem){return sibling(elem,"nextSibling")},prev:function(elem){return sibling(elem,"previousSibling")},nextAll:function(elem){return jQuery.dir(elem,"nextSibling")},prevAll:function(elem){return jQuery.dir(elem,"previousSibling")},nextUntil:function(elem,i,until){return jQuery.dir(elem,"nextSibling",until)},prevUntil:function(elem,i,until){return jQuery.dir(elem,"previousSibling",until)},siblings:function(elem){return jQuery.sibling((elem.parentNode||{}).firstChild,elem)},children:function(elem){return jQuery.sibling(elem.firstChild)},contents:function(elem){return elem.contentDocument||jQuery.merge([],elem.childNodes)}},function(name,fn){jQuery.fn[name]=function(until,selector){var matched=jQuery.map(this,fn,until);if(name.slice(-5)!=="Until"){selector=until}if(selector&&typeof selector==="string"){matched=jQuery.filter(selector,matched)}if(this.length>1){if(!guaranteedUnique[name]){jQuery.unique(matched)}if(rparentsprev.test(name)){matched.reverse()}}return this.pushStack(matched)}});var rnotwhite=(/\S+/g);var optionsCache={};function createOptions(options){var object=optionsCache[options]={};jQuery.each(options.match(rnotwhite)||[],function(_,flag){object[flag]=true});return object}jQuery.Callbacks=function(options){options=typeof options==="string"?(optionsCache[options]||createOptions(options)):jQuery.extend({},options);var memory,fired,firing,firingStart,firingLength,firingIndex,list=[],stack=!options.once&&[],fire=function(data){memory=options.memory&&data;fired=true;firingIndex=firingStart||0;firingStart=0;firingLength=list.length;firing=true;for(;list&&firingIndex<firingLength;firingIndex++){if(list[firingIndex].apply(data[0],data[1])===false&&options.stopOnFalse){memory=false;break}}firing=false;if(list){if(stack){if(stack.length){fire(stack.shift())}}else{if(memory){list=[]}else{self.disable()}}}},self={add:function(){if(list){var start=list.length;(function add(args){jQuery.each(args,function(_,arg){var type=jQuery.type(arg);if(type==="function"){if(!options.unique||!self.has(arg)){list.push(arg)}}else{if(arg&&arg.length&&type!=="string"){add(arg)}}})})(arguments);if(firing){firingLength=list.length}else{if(memory){firingStart=start;fire(memory)}}}return this},remove:function(){if(list){jQuery.each(arguments,function(_,arg){var index;while((index=jQuery.inArray(arg,list,index))>-1){list.splice(index,1);if(firing){if(index<=firingLength){firingLength--}if(index<=firingIndex){firingIndex--}}}})}return this},has:function(fn){return fn?jQuery.inArray(fn,list)>-1:!!(list&&list.length)},empty:function(){list=[];firingLength=0;return this},disable:function(){list=stack=memory=undefined;return this},disabled:function(){return !list},lock:function(){stack=undefined;if(!memory){self.disable()}return this},locked:function(){return !stack},fireWith:function(context,args){if(list&&(!fired||stack)){args=args||[];args=[context,args.slice?args.slice():args];if(firing){stack.push(args)}else{fire(args)}}return this},fire:function(){self.fireWith(this,arguments);return this},fired:function(){return !!fired}};return self};jQuery.extend({Deferred:function(func){var tuples=[["resolve","done",jQuery.Callbacks("once memory"),"resolved"],["reject","fail",jQuery.Callbacks("once memory"),"rejected"],["notify","progress",jQuery.Callbacks("memory")]],state="pending",promise={state:function(){return state},always:function(){deferred.done(arguments).fail(arguments);return this},then:function(){var fns=arguments;return jQuery.Deferred(function(newDefer){jQuery.each(tuples,function(i,tuple){var fn=jQuery.isFunction(fns[i])&&fns[i];deferred[tuple[1]](function(){var returned=fn&&fn.apply(this,arguments);if(returned&&jQuery.isFunction(returned.promise)){returned.promise().done(newDefer.resolve).fail(newDefer.reject).progress(newDefer.notify)}else{newDefer[tuple[0]+"With"](this===promise?newDefer.promise():this,fn?[returned]:arguments)}})});fns=null}).promise()},promise:function(obj){return obj!=null?jQuery.extend(obj,promise):promise}},deferred={};promise.pipe=promise.then;jQuery.each(tuples,function(i,tuple){var list=tuple[2],stateString=tuple[3];promise[tuple[1]]=list.add;if(stateString){list.add(function(){state=stateString},tuples[i^1][2].disable,tuples[2][2].lock)}deferred[tuple[0]]=function(){deferred[tuple[0]+"With"](this===deferred?promise:this,arguments);return this};deferred[tuple[0]+"With"]=list.fireWith});promise.promise(deferred);if(func){func.call(deferred,deferred)}return deferred},when:function(subordinate){var i=0,resolveValues=slice.call(arguments),length=resolveValues.length,remaining=length!==1||(subordinate&&jQuery.isFunction(subordinate.promise))?length:0,deferred=remaining===1?subordinate:jQuery.Deferred(),updateFunc=function(i,contexts,values){return function(value){contexts[i]=this;values[i]=arguments.length>1?slice.call(arguments):value;if(values===progressValues){deferred.notifyWith(contexts,values)}else{if(!(--remaining)){deferred.resolveWith(contexts,values)}}}},progressValues,progressContexts,resolveContexts;if(length>1){progressValues=new Array(length);progressContexts=new Array(length);resolveContexts=new Array(length);for(;i<length;i++){if(resolveValues[i]&&jQuery.isFunction(resolveValues[i].promise)){resolveValues[i].promise().done(updateFunc(i,resolveContexts,resolveValues)).fail(deferred.reject).progress(updateFunc(i,progressContexts,progressValues))}else{--remaining}}}if(!remaining){deferred.resolveWith(resolveContexts,resolveValues)}return deferred.promise()}});var readyList;jQuery.fn.ready=function(fn){jQuery.ready.promise().done(fn);return this};jQuery.extend({isReady:false,readyWait:1,holdReady:function(hold){if(hold){jQuery.readyWait++}else{jQuery.ready(true)}},ready:function(wait){if(wait===true?--jQuery.readyWait:jQuery.isReady){return}jQuery.isReady=true;if(wait!==true&&--jQuery.readyWait>0){return}readyList.resolveWith(document,[jQuery]);if(jQuery.fn.triggerHandler){jQuery(document).triggerHandler("ready");jQuery(document).off("ready")}}});function completed(){document.removeEventListener("DOMContentLoaded",completed,false);window.removeEventListener("load",completed,false);jQuery.ready()}jQuery.ready.promise=function(obj){if(!readyList){readyList=jQuery.Deferred();if(document.readyState==="complete"){setTimeout(jQuery.ready)}else{document.addEventListener("DOMContentLoaded",completed,false);window.addEventListener("load",completed,false)}}return readyList.promise(obj)};jQuery.ready.promise();var access=jQuery.access=function(elems,fn,key,value,chainable,emptyGet,raw){var i=0,len=elems.length,bulk=key==null;if(jQuery.type(key)==="object"){chainable=true;for(i in key){jQuery.access(elems,fn,i,key[i],true,emptyGet,raw)}}else{if(value!==undefined){chainable=true;if(!jQuery.isFunction(value)){raw=true}if(bulk){if(raw){fn.call(elems,value);fn=null}else{bulk=fn;fn=function(elem,key,value){return bulk.call(jQuery(elem),value)}}}if(fn){for(;i<len;i++){fn(elems[i],key,raw?value:value.call(elems[i],i,fn(elems[i],key)))}}}}return chainable?elems:bulk?fn.call(elems):len?fn(elems[0],key):emptyGet};jQuery.acceptData=function(owner){return owner.nodeType===1||owner.nodeType===9||!(+owner.nodeType)};function Data(){Object.defineProperty(this.cache={},0,{get:function(){return{}}});this.expando=jQuery.expando+Data.uid++}Data.uid=1;Data.accepts=jQuery.acceptData;Data.prototype={key:function(owner){if(!Data.accepts(owner)){return 0}var descriptor={},unlock=owner[this.expando];if(!unlock){unlock=Data.uid++;try{descriptor[this.expando]={value:unlock};Object.defineProperties(owner,descriptor)}catch(e){descriptor[this.expando]=unlock;jQuery.extend(owner,descriptor)}}if(!this.cache[unlock]){this.cache[unlock]={}}return unlock},set:function(owner,data,value){var prop,unlock=this.key(owner),cache=this.cache[unlock];if(typeof data==="string"){cache[data]=value}else{if(jQuery.isEmptyObject(cache)){jQuery.extend(this.cache[unlock],data)}else{for(prop in data){cache[prop]=data[prop]}}}return cache},get:function(owner,key){var cache=this.cache[this.key(owner)];return key===undefined?cache:cache[key]},access:function(owner,key,value){var stored;if(key===undefined||((key&&typeof key==="string")&&value===undefined)){stored=this.get(owner,key);return stored!==undefined?stored:this.get(owner,jQuery.camelCase(key))}this.set(owner,key,value);return value!==undefined?value:key},remove:function(owner,key){var i,name,camel,unlock=this.key(owner),cache=this.cache[unlock];if(key===undefined){this.cache[unlock]={}}else{if(jQuery.isArray(key)){name=key.concat(key.map(jQuery.camelCase))}else{camel=jQuery.camelCase(key);if(key in cache){name=[key,camel]}else{name=camel;name=name in cache?[name]:(name.match(rnotwhite)||[])}}i=name.length;while(i--){delete cache[name[i]]}}},hasData:function(owner){return !jQuery.isEmptyObject(this.cache[owner[this.expando]]||{})},discard:function(owner){if(owner[this.expando]){delete this.cache[owner[this.expando]]}}};var data_priv=new Data();var data_user=new Data();var rbrace=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,rmultiDash=/([A-Z])/g;function dataAttr(elem,key,data){var name;if(data===undefined&&elem.nodeType===1){name="data-"+key.replace(rmultiDash,"-$1").toLowerCase();data=elem.getAttribute(name);if(typeof data==="string"){try{data=data==="true"?true:data==="false"?false:data==="null"?null:+data+""===data?+data:rbrace.test(data)?jQuery.parseJSON(data):data}catch(e){}data_user.set(elem,key,data)}else{data=undefined}}return data}jQuery.extend({hasData:function(elem){return data_user.hasData(elem)||data_priv.hasData(elem)},data:function(elem,name,data){return data_user.access(elem,name,data)},removeData:function(elem,name){data_user.remove(elem,name)},_data:function(elem,name,data){return data_priv.access(elem,name,data)},_removeData:function(elem,name){data_priv.remove(elem,name)}});jQuery.fn.extend({data:function(key,value){var i,name,data,elem=this[0],attrs=elem&&elem.attributes;if(key===undefined){if(this.length){data=data_user.get(elem);if(elem.nodeType===1&&!data_priv.get(elem,"hasDataAttrs")){i=attrs.length;while(i--){if(attrs[i]){name=attrs[i].name;if(name.indexOf("data-")===0){name=jQuery.camelCase(name.slice(5));dataAttr(elem,name,data[name])}}}data_priv.set(elem,"hasDataAttrs",true)}}return data}if(typeof key==="object"){return this.each(function(){data_user.set(this,key)})}return access(this,function(value){var data,camelKey=jQuery.camelCase(key);if(elem&&value===undefined){data=data_user.get(elem,key);if(data!==undefined){return data}data=data_user.get(elem,camelKey);if(data!==undefined){return data}data=dataAttr(elem,camelKey,undefined);if(data!==undefined){return data}return}this.each(function(){var data=data_user.get(this,camelKey);data_user.set(this,camelKey,value);if(key.indexOf("-")!==-1&&data!==undefined){data_user.set(this,key,value)}})},null,value,arguments.length>1,null,true)},removeData:function(key){return this.each(function(){data_user.remove(this,key)})}});jQuery.extend({queue:function(elem,type,data){var queue;if(elem){type=(type||"fx")+"queue";queue=data_priv.get(elem,type);if(data){if(!queue||jQuery.isArray(data)){queue=data_priv.access(elem,type,jQuery.makeArray(data))}else{queue.push(data)}}return queue||[]}},dequeue:function(elem,type){type=type||"fx";var queue=jQuery.queue(elem,type),startLength=queue.length,fn=queue.shift(),hooks=jQuery._queueHooks(elem,type),next=function(){jQuery.dequeue(elem,type)};if(fn==="inprogress"){fn=queue.shift();startLength--}if(fn){if(type==="fx"){queue.unshift("inprogress")}delete hooks.stop;fn.call(elem,next,hooks)}if(!startLength&&hooks){hooks.empty.fire()}},_queueHooks:function(elem,type){var key=type+"queueHooks";return data_priv.get(elem,key)||data_priv.access(elem,key,{empty:jQuery.Callbacks("once memory").add(function(){data_priv.remove(elem,[type+"queue",key])})})}});jQuery.fn.extend({queue:function(type,data){var setter=2;if(typeof type!=="string"){data=type;type="fx";setter--}if(arguments.length<setter){return jQuery.queue(this[0],type)}return data===undefined?this:this.each(function(){var queue=jQuery.queue(this,type,data);jQuery._queueHooks(this,type);if(type==="fx"&&queue[0]!=="inprogress"){jQuery.dequeue(this,type)}})},dequeue:function(type){return this.each(function(){jQuery.dequeue(this,type)})},clearQueue:function(type){return this.queue(type||"fx",[])},promise:function(type,obj){var tmp,count=1,defer=jQuery.Deferred(),elements=this,i=this.length,resolve=function(){if(!(--count)){defer.resolveWith(elements,[elements])}};if(typeof type!=="string"){obj=type;type=undefined}type=type||"fx";while(i--){tmp=data_priv.get(elements[i],type+"queueHooks");if(tmp&&tmp.empty){count++;tmp.empty.add(resolve)}}resolve();return defer.promise(obj)}});var pnum=(/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/).source;var cssExpand=["Top","Right","Bottom","Left"];var isHidden=function(elem,el){elem=el||elem;return jQuery.css(elem,"display")==="none"||!jQuery.contains(elem.ownerDocument,elem)};var rcheckableType=(/^(?:checkbox|radio)$/i);(function(){var fragment=document.createDocumentFragment(),div=fragment.appendChild(document.createElement("div")),input=document.createElement("input");input.setAttribute("type","radio");input.setAttribute("checked","checked");input.setAttribute("name","t");div.appendChild(input);support.checkClone=div.cloneNode(true).cloneNode(true).lastChild.checked;div.innerHTML="<textarea>x</textarea>";support.noCloneChecked=!!div.cloneNode(true).lastChild.defaultValue})();var strundefined=typeof undefined;support.focusinBubbles="onfocusin" in window;var rkeyEvent=/^key/,rmouseEvent=/^(?:mouse|pointer|contextmenu)|click/,rfocusMorph=/^(?:focusinfocus|focusoutblur)$/,rtypenamespace=/^([^.]*)(?:\.(.+)|)$/;function returnTrue(){return true}function returnFalse(){return false}function safeActiveElement(){try{return document.activeElement}catch(err){}}jQuery.event={global:{},add:function(elem,types,handler,data,selector){var handleObjIn,eventHandle,tmp,events,t,handleObj,special,handlers,type,namespaces,origType,elemData=data_priv.get(elem);if(!elemData){return}if(handler.handler){handleObjIn=handler;handler=handleObjIn.handler;selector=handleObjIn.selector}if(!handler.guid){handler.guid=jQuery.guid++}if(!(events=elemData.events)){events=elemData.events={}}if(!(eventHandle=elemData.handle)){eventHandle=elemData.handle=function(e){return typeof jQuery!==strundefined&&jQuery.event.triggered!==e.type?jQuery.event.dispatch.apply(elem,arguments):undefined}}types=(types||"").match(rnotwhite)||[""];t=types.length;while(t--){tmp=rtypenamespace.exec(types[t])||[];type=origType=tmp[1];namespaces=(tmp[2]||"").split(".").sort();if(!type){continue}special=jQuery.event.special[type]||{};type=(selector?special.delegateType:special.bindType)||type;special=jQuery.event.special[type]||{};handleObj=jQuery.extend({type:type,origType:origType,data:data,handler:handler,guid:handler.guid,selector:selector,needsContext:selector&&jQuery.expr.match.needsContext.test(selector),namespace:namespaces.join(".")},handleObjIn);if(!(handlers=events[type])){handlers=events[type]=[];handlers.delegateCount=0;if(!special.setup||special.setup.call(elem,data,namespaces,eventHandle)===false){if(elem.addEventListener){elem.addEventListener(type,eventHandle,false)}}}if(special.add){special.add.call(elem,handleObj);if(!handleObj.handler.guid){handleObj.handler.guid=handler.guid}}if(selector){handlers.splice(handlers.delegateCount++,0,handleObj)}else{handlers.push(handleObj)}jQuery.event.global[type]=true}},remove:function(elem,types,handler,selector,mappedTypes){var j,origCount,tmp,events,t,handleObj,special,handlers,type,namespaces,origType,elemData=data_priv.hasData(elem)&&data_priv.get(elem);if(!elemData||!(events=elemData.events)){return}types=(types||"").match(rnotwhite)||[""];t=types.length;while(t--){tmp=rtypenamespace.exec(types[t])||[];type=origType=tmp[1];namespaces=(tmp[2]||"").split(".").sort();if(!type){for(type in events){jQuery.event.remove(elem,type+types[t],handler,selector,true)}continue}special=jQuery.event.special[type]||{};type=(selector?special.delegateType:special.bindType)||type;handlers=events[type]||[];tmp=tmp[2]&&new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)");origCount=j=handlers.length;while(j--){handleObj=handlers[j];if((mappedTypes||origType===handleObj.origType)&&(!handler||handler.guid===handleObj.guid)&&(!tmp||tmp.test(handleObj.namespace))&&(!selector||selector===handleObj.selector||selector==="**"&&handleObj.selector)){handlers.splice(j,1);if(handleObj.selector){handlers.delegateCount--}if(special.remove){special.remove.call(elem,handleObj)}}}if(origCount&&!handlers.length){if(!special.teardown||special.teardown.call(elem,namespaces,elemData.handle)===false){jQuery.removeEvent(elem,type,elemData.handle)}delete events[type]}}if(jQuery.isEmptyObject(events)){delete elemData.handle;data_priv.remove(elem,"events")}},trigger:function(event,data,elem,onlyHandlers){var i,cur,tmp,bubbleType,ontype,handle,special,eventPath=[elem||document],type=hasOwn.call(event,"type")?event.type:event,namespaces=hasOwn.call(event,"namespace")?event.namespace.split("."):[];cur=tmp=elem=elem||document;if(elem.nodeType===3||elem.nodeType===8){return}if(rfocusMorph.test(type+jQuery.event.triggered)){return}if(type.indexOf(".")>=0){namespaces=type.split(".");type=namespaces.shift();namespaces.sort()}ontype=type.indexOf(":")<0&&"on"+type;event=event[jQuery.expando]?event:new jQuery.Event(type,typeof event==="object"&&event);event.isTrigger=onlyHandlers?2:3;event.namespace=namespaces.join(".");event.namespace_re=event.namespace?new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)"):null;event.result=undefined;if(!event.target){event.target=elem}data=data==null?[event]:jQuery.makeArray(data,[event]);special=jQuery.event.special[type]||{};if(!onlyHandlers&&special.trigger&&special.trigger.apply(elem,data)===false){return}if(!onlyHandlers&&!special.noBubble&&!jQuery.isWindow(elem)){bubbleType=special.delegateType||type;if(!rfocusMorph.test(bubbleType+type)){cur=cur.parentNode}for(;cur;cur=cur.parentNode){eventPath.push(cur);tmp=cur}if(tmp===(elem.ownerDocument||document)){eventPath.push(tmp.defaultView||tmp.parentWindow||window)}}i=0;while((cur=eventPath[i++])&&!event.isPropagationStopped()){event.type=i>1?bubbleType:special.bindType||type;handle=(data_priv.get(cur,"events")||{})[event.type]&&data_priv.get(cur,"handle");if(handle){handle.apply(cur,data)}handle=ontype&&cur[ontype];if(handle&&handle.apply&&jQuery.acceptData(cur)){event.result=handle.apply(cur,data);if(event.result===false){event.preventDefault()}}}event.type=type;if(!onlyHandlers&&!event.isDefaultPrevented()){if((!special._default||special._default.apply(eventPath.pop(),data)===false)&&jQuery.acceptData(elem)){if(ontype&&jQuery.isFunction(elem[type])&&!jQuery.isWindow(elem)){tmp=elem[ontype];if(tmp){elem[ontype]=null}jQuery.event.triggered=type;elem[type]();jQuery.event.triggered=undefined;if(tmp){elem[ontype]=tmp}}}}return event.result},dispatch:function(event){event=jQuery.event.fix(event);var i,j,ret,matched,handleObj,handlerQueue=[],args=slice.call(arguments),handlers=(data_priv.get(this,"events")||{})[event.type]||[],special=jQuery.event.special[event.type]||{};args[0]=event;event.delegateTarget=this;if(special.preDispatch&&special.preDispatch.call(this,event)===false){return}handlerQueue=jQuery.event.handlers.call(this,event,handlers);i=0;while((matched=handlerQueue[i++])&&!event.isPropagationStopped()){event.currentTarget=matched.elem;j=0;while((handleObj=matched.handlers[j++])&&!event.isImmediatePropagationStopped()){if(!event.namespace_re||event.namespace_re.test(handleObj.namespace)){event.handleObj=handleObj;event.data=handleObj.data;ret=((jQuery.event.special[handleObj.origType]||{}).handle||handleObj.handler).apply(matched.elem,args);if(ret!==undefined){if((event.result=ret)===false){event.preventDefault();event.stopPropagation()}}}}}if(special.postDispatch){special.postDispatch.call(this,event)}return event.result},handlers:function(event,handlers){var i,matches,sel,handleObj,handlerQueue=[],delegateCount=handlers.delegateCount,cur=event.target;if(delegateCount&&cur.nodeType&&(!event.button||event.type!=="click")){for(;cur!==this;cur=cur.parentNode||this){if(cur.disabled!==true||event.type!=="click"){matches=[];for(i=0;i<delegateCount;i++){handleObj=handlers[i];sel=handleObj.selector+" ";if(matches[sel]===undefined){matches[sel]=handleObj.needsContext?jQuery(sel,this).index(cur)>=0:jQuery.find(sel,this,null,[cur]).length}if(matches[sel]){matches.push(handleObj)}}if(matches.length){handlerQueue.push({elem:cur,handlers:matches})}}}}if(delegateCount<handlers.length){handlerQueue.push({elem:this,handlers:handlers.slice(delegateCount)})}return handlerQueue},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(event,original){if(event.which==null){event.which=original.charCode!=null?original.charCode:original.keyCode}return event}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(event,original){var eventDoc,doc,body,button=original.button;if(event.pageX==null&&original.clientX!=null){eventDoc=event.target.ownerDocument||document;doc=eventDoc.documentElement;body=eventDoc.body;event.pageX=original.clientX+(doc&&doc.scrollLeft||body&&body.scrollLeft||0)-(doc&&doc.clientLeft||body&&body.clientLeft||0);event.pageY=original.clientY+(doc&&doc.scrollTop||body&&body.scrollTop||0)-(doc&&doc.clientTop||body&&body.clientTop||0)}if(!event.which&&button!==undefined){event.which=(button&1?1:(button&2?3:(button&4?2:0)))}return event}},fix:function(event){if(event[jQuery.expando]){return event}var i,prop,copy,type=event.type,originalEvent=event,fixHook=this.fixHooks[type];if(!fixHook){this.fixHooks[type]=fixHook=rmouseEvent.test(type)?this.mouseHooks:rkeyEvent.test(type)?this.keyHooks:{}}copy=fixHook.props?this.props.concat(fixHook.props):this.props;event=new jQuery.Event(originalEvent);i=copy.length;while(i--){prop=copy[i];event[prop]=originalEvent[prop]}if(!event.target){event.target=document}if(event.target.nodeType===3){event.target=event.target.parentNode}return fixHook.filter?fixHook.filter(event,originalEvent):event},special:{load:{noBubble:true},focus:{trigger:function(){if(this!==safeActiveElement()&&this.focus){this.focus();return false}},delegateType:"focusin"},blur:{trigger:function(){if(this===safeActiveElement()&&this.blur){this.blur();return false}},delegateType:"focusout"},click:{trigger:function(){if(this.type==="checkbox"&&this.click&&jQuery.nodeName(this,"input")){this.click();return false}},_default:function(event){return jQuery.nodeName(event.target,"a")}},beforeunload:{postDispatch:function(event){if(event.result!==undefined&&event.originalEvent){event.originalEvent.returnValue=event.result}}}},simulate:function(type,elem,event,bubble){var e=jQuery.extend(new jQuery.Event(),event,{type:type,isSimulated:true,originalEvent:{}});if(bubble){jQuery.event.trigger(e,null,elem)}else{jQuery.event.dispatch.call(elem,e)}if(e.isDefaultPrevented()){event.preventDefault()}}};jQuery.removeEvent=function(elem,type,handle){if(elem.removeEventListener){elem.removeEventListener(type,handle,false)}};jQuery.Event=function(src,props){if(!(this instanceof jQuery.Event)){return new jQuery.Event(src,props)}if(src&&src.type){this.originalEvent=src;this.type=src.type;this.isDefaultPrevented=src.defaultPrevented||src.defaultPrevented===undefined&&src.returnValue===false?returnTrue:returnFalse}else{this.type=src}if(props){jQuery.extend(this,props)}this.timeStamp=src&&src.timeStamp||jQuery.now();this[jQuery.expando]=true};jQuery.Event.prototype={isDefaultPrevented:returnFalse,isPropagationStopped:returnFalse,isImmediatePropagationStopped:returnFalse,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=returnTrue;if(e&&e.preventDefault){e.preventDefault()}},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=returnTrue;if(e&&e.stopPropagation){e.stopPropagation()}},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=returnTrue;if(e&&e.stopImmediatePropagation){e.stopImmediatePropagation()}this.stopPropagation()}};jQuery.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(orig,fix){jQuery.event.special[orig]={delegateType:fix,bindType:fix,handle:function(event){var ret,target=this,related=event.relatedTarget,handleObj=event.handleObj;if(!related||(related!==target&&!jQuery.contains(target,related))){event.type=handleObj.origType;ret=handleObj.handler.apply(this,arguments);event.type=fix}return ret}}});if(!support.focusinBubbles){jQuery.each({focus:"focusin",blur:"focusout"},function(orig,fix){var handler=function(event){jQuery.event.simulate(fix,event.target,jQuery.event.fix(event),true)};jQuery.event.special[fix]={setup:function(){var doc=this.ownerDocument||this,attaches=data_priv.access(doc,fix);if(!attaches){doc.addEventListener(orig,handler,true)}data_priv.access(doc,fix,(attaches||0)+1)},teardown:function(){var doc=this.ownerDocument||this,attaches=data_priv.access(doc,fix)-1;if(!attaches){doc.removeEventListener(orig,handler,true);data_priv.remove(doc,fix)}else{data_priv.access(doc,fix,attaches)}}}})}jQuery.fn.extend({on:function(types,selector,data,fn,one){var origFn,type;if(typeof types==="object"){if(typeof selector!=="string"){data=data||selector;selector=undefined}for(type in types){this.on(type,selector,data,types[type],one)}return this}if(data==null&&fn==null){fn=selector;data=selector=undefined}else{if(fn==null){if(typeof selector==="string"){fn=data;data=undefined}else{fn=data;data=selector;selector=undefined}}}if(fn===false){fn=returnFalse}else{if(!fn){return this}}if(one===1){origFn=fn;fn=function(event){jQuery().off(event);return origFn.apply(this,arguments)};fn.guid=origFn.guid||(origFn.guid=jQuery.guid++)}return this.each(function(){jQuery.event.add(this,types,fn,data,selector)})},one:function(types,selector,data,fn){return this.on(types,selector,data,fn,1)},off:function(types,selector,fn){var handleObj,type;if(types&&types.preventDefault&&types.handleObj){handleObj=types.handleObj;jQuery(types.delegateTarget).off(handleObj.namespace?handleObj.origType+"."+handleObj.namespace:handleObj.origType,handleObj.selector,handleObj.handler);return this}if(typeof types==="object"){for(type in types){this.off(type,selector,types[type])}return this}if(selector===false||typeof selector==="function"){fn=selector;selector=undefined}if(fn===false){fn=returnFalse}return this.each(function(){jQuery.event.remove(this,types,fn,selector)})},trigger:function(type,data){return this.each(function(){jQuery.event.trigger(type,data,this)})},triggerHandler:function(type,data){var elem=this[0];if(elem){return jQuery.event.trigger(type,data,elem,true)}}});var rxhtmlTag=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,rtagName=/<([\w:]+)/,rhtml=/<|&#?\w+;/,rnoInnerhtml=/<(?:script|style|link)/i,rchecked=/checked\s*(?:[^=]|=\s*.checked.)/i,rscriptType=/^$|\/(?:java|ecma)script/i,rscriptTypeMasked=/^true\/(.*)/,rcleanScript=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,wrapMap={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};wrapMap.optgroup=wrapMap.option;wrapMap.tbody=wrapMap.tfoot=wrapMap.colgroup=wrapMap.caption=wrapMap.thead;wrapMap.th=wrapMap.td;function manipulationTarget(elem,content){return jQuery.nodeName(elem,"table")&&jQuery.nodeName(content.nodeType!==11?content:content.firstChild,"tr")?elem.getElementsByTagName("tbody")[0]||elem.appendChild(elem.ownerDocument.createElement("tbody")):elem}function disableScript(elem){elem.type=(elem.getAttribute("type")!==null)+"/"+elem.type;return elem}function restoreScript(elem){var match=rscriptTypeMasked.exec(elem.type);if(match){elem.type=match[1]}else{elem.removeAttribute("type")}return elem}function setGlobalEval(elems,refElements){var i=0,l=elems.length;for(;i<l;i++){data_priv.set(elems[i],"globalEval",!refElements||data_priv.get(refElements[i],"globalEval"))}}function cloneCopyEvent(src,dest){var i,l,type,pdataOld,pdataCur,udataOld,udataCur,events;if(dest.nodeType!==1){return}if(data_priv.hasData(src)){pdataOld=data_priv.access(src);pdataCur=data_priv.set(dest,pdataOld);events=pdataOld.events;if(events){delete pdataCur.handle;pdataCur.events={};for(type in events){for(i=0,l=events[type].length;i<l;i++){jQuery.event.add(dest,type,events[type][i])}}}}if(data_user.hasData(src)){udataOld=data_user.access(src);udataCur=jQuery.extend({},udataOld);data_user.set(dest,udataCur)}}function getAll(context,tag){var ret=context.getElementsByTagName?context.getElementsByTagName(tag||"*"):context.querySelectorAll?context.querySelectorAll(tag||"*"):[];return tag===undefined||tag&&jQuery.nodeName(context,tag)?jQuery.merge([context],ret):ret}function fixInput(src,dest){var nodeName=dest.nodeName.toLowerCase();if(nodeName==="input"&&rcheckableType.test(src.type)){dest.checked=src.checked}else{if(nodeName==="input"||nodeName==="textarea"){dest.defaultValue=src.defaultValue}}}jQuery.extend({clone:function(elem,dataAndEvents,deepDataAndEvents){var i,l,srcElements,destElements,clone=elem.cloneNode(true),inPage=jQuery.contains(elem.ownerDocument,elem);if(!support.noCloneChecked&&(elem.nodeType===1||elem.nodeType===11)&&!jQuery.isXMLDoc(elem)){destElements=getAll(clone);srcElements=getAll(elem);for(i=0,l=srcElements.length;i<l;i++){fixInput(srcElements[i],destElements[i])}}if(dataAndEvents){if(deepDataAndEvents){srcElements=srcElements||getAll(elem);destElements=destElements||getAll(clone);for(i=0,l=srcElements.length;i<l;i++){cloneCopyEvent(srcElements[i],destElements[i])}}else{cloneCopyEvent(elem,clone)}}destElements=getAll(clone,"script");if(destElements.length>0){setGlobalEval(destElements,!inPage&&getAll(elem,"script"))}return clone},buildFragment:function(elems,context,scripts,selection){var elem,tmp,tag,wrap,contains,j,fragment=context.createDocumentFragment(),nodes=[],i=0,l=elems.length;for(;i<l;i++){elem=elems[i];if(elem||elem===0){if(jQuery.type(elem)==="object"){jQuery.merge(nodes,elem.nodeType?[elem]:elem)}else{if(!rhtml.test(elem)){nodes.push(context.createTextNode(elem))}else{tmp=tmp||fragment.appendChild(context.createElement("div"));tag=(rtagName.exec(elem)||["",""])[1].toLowerCase();wrap=wrapMap[tag]||wrapMap._default;tmp.innerHTML=wrap[1]+elem.replace(rxhtmlTag,"<$1></$2>")+wrap[2];j=wrap[0];while(j--){tmp=tmp.lastChild}jQuery.merge(nodes,tmp.childNodes);tmp=fragment.firstChild;tmp.textContent=""}}}}fragment.textContent="";i=0;while((elem=nodes[i++])){if(selection&&jQuery.inArray(elem,selection)!==-1){continue}contains=jQuery.contains(elem.ownerDocument,elem);tmp=getAll(fragment.appendChild(elem),"script");if(contains){setGlobalEval(tmp)}if(scripts){j=0;while((elem=tmp[j++])){if(rscriptType.test(elem.type||"")){scripts.push(elem)}}}}return fragment},cleanData:function(elems){var data,elem,type,key,special=jQuery.event.special,i=0;for(;(elem=elems[i])!==undefined;i++){if(jQuery.acceptData(elem)){key=elem[data_priv.expando];if(key&&(data=data_priv.cache[key])){if(data.events){for(type in data.events){if(special[type]){jQuery.event.remove(elem,type)}else{jQuery.removeEvent(elem,type,data.handle)}}}if(data_priv.cache[key]){delete data_priv.cache[key]}}}delete data_user.cache[elem[data_user.expando]]}}});jQuery.fn.extend({text:function(value){return access(this,function(value){return value===undefined?jQuery.text(this):this.empty().each(function(){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){this.textContent=value}})},null,value,arguments.length)},append:function(){return this.domManip(arguments,function(elem){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var target=manipulationTarget(this,elem);target.appendChild(elem)}})},prepend:function(){return this.domManip(arguments,function(elem){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var target=manipulationTarget(this,elem);target.insertBefore(elem,target.firstChild)}})},before:function(){return this.domManip(arguments,function(elem){if(this.parentNode){this.parentNode.insertBefore(elem,this)}})},after:function(){return this.domManip(arguments,function(elem){if(this.parentNode){this.parentNode.insertBefore(elem,this.nextSibling)}})},remove:function(selector,keepData){var elem,elems=selector?jQuery.filter(selector,this):this,i=0;for(;(elem=elems[i])!=null;i++){if(!keepData&&elem.nodeType===1){jQuery.cleanData(getAll(elem))}if(elem.parentNode){if(keepData&&jQuery.contains(elem.ownerDocument,elem)){setGlobalEval(getAll(elem,"script"))}elem.parentNode.removeChild(elem)}}return this},empty:function(){var elem,i=0;for(;(elem=this[i])!=null;i++){if(elem.nodeType===1){jQuery.cleanData(getAll(elem,false));elem.textContent=""}}return this},clone:function(dataAndEvents,deepDataAndEvents){dataAndEvents=dataAndEvents==null?false:dataAndEvents;deepDataAndEvents=deepDataAndEvents==null?dataAndEvents:deepDataAndEvents;return this.map(function(){return jQuery.clone(this,dataAndEvents,deepDataAndEvents)})},html:function(value){return access(this,function(value){var elem=this[0]||{},i=0,l=this.length;if(value===undefined&&elem.nodeType===1){return elem.innerHTML}if(typeof value==="string"&&!rnoInnerhtml.test(value)&&!wrapMap[(rtagName.exec(value)||["",""])[1].toLowerCase()]){value=value.replace(rxhtmlTag,"<$1></$2>");try{for(;i<l;i++){elem=this[i]||{};if(elem.nodeType===1){jQuery.cleanData(getAll(elem,false));elem.innerHTML=value}}elem=0}catch(e){}}if(elem){this.empty().append(value)}},null,value,arguments.length)},replaceWith:function(){var arg=arguments[0];this.domManip(arguments,function(elem){arg=this.parentNode;jQuery.cleanData(getAll(this));if(arg){arg.replaceChild(elem,this)}});return arg&&(arg.length||arg.nodeType)?this:this.remove()},detach:function(selector){return this.remove(selector,true)},domManip:function(args,callback){args=concat.apply([],args);var fragment,first,scripts,hasScripts,node,doc,i=0,l=this.length,set=this,iNoClone=l-1,value=args[0],isFunction=jQuery.isFunction(value);if(isFunction||(l>1&&typeof value==="string"&&!support.checkClone&&rchecked.test(value))){return this.each(function(index){var self=set.eq(index);if(isFunction){args[0]=value.call(this,index,self.html())}self.domManip(args,callback)})}if(l){fragment=jQuery.buildFragment(args,this[0].ownerDocument,false,this);first=fragment.firstChild;if(fragment.childNodes.length===1){fragment=first}if(first){scripts=jQuery.map(getAll(fragment,"script"),disableScript);hasScripts=scripts.length;for(;i<l;i++){node=fragment;if(i!==iNoClone){node=jQuery.clone(node,true,true);if(hasScripts){jQuery.merge(scripts,getAll(node,"script"))}}callback.call(this[i],node,i)}if(hasScripts){doc=scripts[scripts.length-1].ownerDocument;jQuery.map(scripts,restoreScript);for(i=0;i<hasScripts;i++){node=scripts[i];if(rscriptType.test(node.type||"")&&!data_priv.access(node,"globalEval")&&jQuery.contains(doc,node)){if(node.src){if(jQuery._evalUrl){jQuery._evalUrl(node.src)}}else{jQuery.globalEval(node.textContent.replace(rcleanScript,""))}}}}}}return this}});jQuery.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(name,original){jQuery.fn[name]=function(selector){var elems,ret=[],insert=jQuery(selector),last=insert.length-1,i=0;for(;i<=last;i++){elems=i===last?this:this.clone(true);jQuery(insert[i])[original](elems);push.apply(ret,elems.get())}return this.pushStack(ret)}});var iframe,elemdisplay={};function actualDisplay(name,doc){var style,elem=jQuery(doc.createElement(name)).appendTo(doc.body),display=window.getDefaultComputedStyle&&(style=window.getDefaultComputedStyle(elem[0]))?style.display:jQuery.css(elem[0],"display");elem.detach();return display}function defaultDisplay(nodeName){var doc=document,display=elemdisplay[nodeName];if(!display){display=actualDisplay(nodeName,doc);if(display==="none"||!display){iframe=(iframe||jQuery("<iframe frameborder='0' width='0' height='0'/>")).appendTo(doc.documentElement);doc=iframe[0].contentDocument;doc.write();doc.close();display=actualDisplay(nodeName,doc);iframe.detach()}elemdisplay[nodeName]=display}return display}var rmargin=(/^margin/);var rnumnonpx=new RegExp("^("+pnum+")(?!px)[a-z%]+$","i");var getStyles=function(elem){if(elem.ownerDocument.defaultView.opener){return elem.ownerDocument.defaultView.getComputedStyle(elem,null)}return window.getComputedStyle(elem,null)};function curCSS(elem,name,computed){var width,minWidth,maxWidth,ret,style=elem.style;computed=computed||getStyles(elem);if(computed){ret=computed.getPropertyValue(name)||computed[name]}if(computed){if(ret===""&&!jQuery.contains(elem.ownerDocument,elem)){ret=jQuery.style(elem,name)}if(rnumnonpx.test(ret)&&rmargin.test(name)){width=style.width;minWidth=style.minWidth;maxWidth=style.maxWidth;style.minWidth=style.maxWidth=style.width=ret;ret=computed.width;style.width=width;style.minWidth=minWidth;style.maxWidth=maxWidth}}return ret!==undefined?ret+"":ret}function addGetHookIf(conditionFn,hookFn){return{get:function(){if(conditionFn()){delete this.get;return}return(this.get=hookFn).apply(this,arguments)}}}(function(){var pixelPositionVal,boxSizingReliableVal,docElem=document.documentElement,container=document.createElement("div"),div=document.createElement("div");if(!div.style){return}div.style.backgroundClip="content-box";div.cloneNode(true).style.backgroundClip="";support.clearCloneStyle=div.style.backgroundClip==="content-box";container.style.cssText="border:0;width:0;height:0;top:0;left:-9999px;margin-top:1px;position:absolute";container.appendChild(div);function computePixelPositionAndBoxSizingReliable(){div.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute";div.innerHTML="";docElem.appendChild(container);var divStyle=window.getComputedStyle(div,null);pixelPositionVal=divStyle.top!=="1%";boxSizingReliableVal=divStyle.width==="4px";docElem.removeChild(container)}if(window.getComputedStyle){jQuery.extend(support,{pixelPosition:function(){computePixelPositionAndBoxSizingReliable();return pixelPositionVal},boxSizingReliable:function(){if(boxSizingReliableVal==null){computePixelPositionAndBoxSizingReliable()}return boxSizingReliableVal},reliableMarginRight:function(){var ret,marginDiv=div.appendChild(document.createElement("div"));marginDiv.style.cssText=div.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0";marginDiv.style.marginRight=marginDiv.style.width="0";div.style.width="1px";docElem.appendChild(container);ret=!parseFloat(window.getComputedStyle(marginDiv,null).marginRight);docElem.removeChild(container);div.removeChild(marginDiv);return ret}})}})();jQuery.swap=function(elem,options,callback,args){var ret,name,old={};for(name in options){old[name]=elem.style[name];elem.style[name]=options[name]}ret=callback.apply(elem,args||[]);for(name in options){elem.style[name]=old[name]}return ret};var rdisplayswap=/^(none|table(?!-c[ea]).+)/,rnumsplit=new RegExp("^("+pnum+")(.*)$","i"),rrelNum=new RegExp("^([+-])=("+pnum+")","i"),cssShow={position:"absolute",visibility:"hidden",display:"block"},cssNormalTransform={letterSpacing:"0",fontWeight:"400"},cssPrefixes=["Webkit","O","Moz","ms"];function vendorPropName(style,name){if(name in style){return name}var capName=name[0].toUpperCase()+name.slice(1),origName=name,i=cssPrefixes.length;while(i--){name=cssPrefixes[i]+capName;if(name in style){return name}}return origName}function setPositiveNumber(elem,value,subtract){var matches=rnumsplit.exec(value);return matches?Math.max(0,matches[1]-(subtract||0))+(matches[2]||"px"):value}function augmentWidthOrHeight(elem,name,extra,isBorderBox,styles){var i=extra===(isBorderBox?"border":"content")?4:name==="width"?1:0,val=0;for(;i<4;i+=2){if(extra==="margin"){val+=jQuery.css(elem,extra+cssExpand[i],true,styles)}if(isBorderBox){if(extra==="content"){val-=jQuery.css(elem,"padding"+cssExpand[i],true,styles)}if(extra!=="margin"){val-=jQuery.css(elem,"border"+cssExpand[i]+"Width",true,styles)}}else{val+=jQuery.css(elem,"padding"+cssExpand[i],true,styles);if(extra!=="padding"){val+=jQuery.css(elem,"border"+cssExpand[i]+"Width",true,styles)}}}return val}function getWidthOrHeight(elem,name,extra){var valueIsBorderBox=true,val=name==="width"?elem.offsetWidth:elem.offsetHeight,styles=getStyles(elem),isBorderBox=jQuery.css(elem,"boxSizing",false,styles)==="border-box";if(val<=0||val==null){val=curCSS(elem,name,styles);if(val<0||val==null){val=elem.style[name]}if(rnumnonpx.test(val)){return val}valueIsBorderBox=isBorderBox&&(support.boxSizingReliable()||val===elem.style[name]);val=parseFloat(val)||0}return(val+augmentWidthOrHeight(elem,name,extra||(isBorderBox?"border":"content"),valueIsBorderBox,styles))+"px"}function showHide(elements,show){var display,elem,hidden,values=[],index=0,length=elements.length;for(;index<length;index++){elem=elements[index];if(!elem.style){continue}values[index]=data_priv.get(elem,"olddisplay");display=elem.style.display;if(show){if(!values[index]&&display==="none"){elem.style.display=""}if(elem.style.display===""&&isHidden(elem)){values[index]=data_priv.access(elem,"olddisplay",defaultDisplay(elem.nodeName))}}else{hidden=isHidden(elem);if(display!=="none"||!hidden){data_priv.set(elem,"olddisplay",hidden?display:jQuery.css(elem,"display"))}}}for(index=0;index<length;index++){elem=elements[index];if(!elem.style){continue}if(!show||elem.style.display==="none"||elem.style.display===""){elem.style.display=show?values[index]||"":"none"}}return elements}jQuery.extend({cssHooks:{opacity:{get:function(elem,computed){if(computed){var ret=curCSS(elem,"opacity");return ret===""?"1":ret}}}},cssNumber:{columnCount:true,fillOpacity:true,flexGrow:true,flexShrink:true,fontWeight:true,lineHeight:true,opacity:true,order:true,orphans:true,widows:true,zIndex:true,zoom:true},cssProps:{"float":"cssFloat"},style:function(elem,name,value,extra){if(!elem||elem.nodeType===3||elem.nodeType===8||!elem.style){return}var ret,type,hooks,origName=jQuery.camelCase(name),style=elem.style;name=jQuery.cssProps[origName]||(jQuery.cssProps[origName]=vendorPropName(style,origName));hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName];if(value!==undefined){type=typeof value;if(type==="string"&&(ret=rrelNum.exec(value))){value=(ret[1]+1)*ret[2]+parseFloat(jQuery.css(elem,name));type="number"}if(value==null||value!==value){return}if(type==="number"&&!jQuery.cssNumber[origName]){value+="px"}if(!support.clearCloneStyle&&value===""&&name.indexOf("background")===0){style[name]="inherit"}if(!hooks||!("set" in hooks)||(value=hooks.set(elem,value,extra))!==undefined){style[name]=value}}else{if(hooks&&"get" in hooks&&(ret=hooks.get(elem,false,extra))!==undefined){return ret}return style[name]}},css:function(elem,name,extra,styles){var val,num,hooks,origName=jQuery.camelCase(name);name=jQuery.cssProps[origName]||(jQuery.cssProps[origName]=vendorPropName(elem.style,origName));hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName];if(hooks&&"get" in hooks){val=hooks.get(elem,true,extra)}if(val===undefined){val=curCSS(elem,name,styles)}if(val==="normal"&&name in cssNormalTransform){val=cssNormalTransform[name]}if(extra===""||extra){num=parseFloat(val);return extra===true||jQuery.isNumeric(num)?num||0:val}return val}});jQuery.each(["height","width"],function(i,name){jQuery.cssHooks[name]={get:function(elem,computed,extra){if(computed){return rdisplayswap.test(jQuery.css(elem,"display"))&&elem.offsetWidth===0?jQuery.swap(elem,cssShow,function(){return getWidthOrHeight(elem,name,extra)}):getWidthOrHeight(elem,name,extra)}},set:function(elem,value,extra){var styles=extra&&getStyles(elem);return setPositiveNumber(elem,value,extra?augmentWidthOrHeight(elem,name,extra,jQuery.css(elem,"boxSizing",false,styles)==="border-box",styles):0)}}});jQuery.cssHooks.marginRight=addGetHookIf(support.reliableMarginRight,function(elem,computed){if(computed){return jQuery.swap(elem,{display:"inline-block"},curCSS,[elem,"marginRight"])}});jQuery.each({margin:"",padding:"",border:"Width"},function(prefix,suffix){jQuery.cssHooks[prefix+suffix]={expand:function(value){var i=0,expanded={},parts=typeof value==="string"?value.split(" "):[value];for(;i<4;i++){expanded[prefix+cssExpand[i]+suffix]=parts[i]||parts[i-2]||parts[0]}return expanded}};if(!rmargin.test(prefix)){jQuery.cssHooks[prefix+suffix].set=setPositiveNumber}});jQuery.fn.extend({css:function(name,value){return access(this,function(elem,name,value){var styles,len,map={},i=0;if(jQuery.isArray(name)){styles=getStyles(elem);len=name.length;for(;i<len;i++){map[name[i]]=jQuery.css(elem,name[i],false,styles)}return map}return value!==undefined?jQuery.style(elem,name,value):jQuery.css(elem,name)},name,value,arguments.length>1)},show:function(){return showHide(this,true)},hide:function(){return showHide(this)},toggle:function(state){if(typeof state==="boolean"){return state?this.show():this.hide()}return this.each(function(){if(isHidden(this)){jQuery(this).show()}else{jQuery(this).hide()}})}});function Tween(elem,options,prop,end,easing){return new Tween.prototype.init(elem,options,prop,end,easing)}jQuery.Tween=Tween;Tween.prototype={constructor:Tween,init:function(elem,options,prop,end,easing,unit){this.elem=elem;this.prop=prop;this.easing=easing||"swing";this.options=options;this.start=this.now=this.cur();this.end=end;this.unit=unit||(jQuery.cssNumber[prop]?"":"px")},cur:function(){var hooks=Tween.propHooks[this.prop];return hooks&&hooks.get?hooks.get(this):Tween.propHooks._default.get(this)},run:function(percent){var eased,hooks=Tween.propHooks[this.prop];if(this.options.duration){this.pos=eased=jQuery.easing[this.easing](percent,this.options.duration*percent,0,1,this.options.duration)}else{this.pos=eased=percent}this.now=(this.end-this.start)*eased+this.start;if(this.options.step){this.options.step.call(this.elem,this.now,this)}if(hooks&&hooks.set){hooks.set(this)}else{Tween.propHooks._default.set(this)}return this}};Tween.prototype.init.prototype=Tween.prototype;Tween.propHooks={_default:{get:function(tween){var result;if(tween.elem[tween.prop]!=null&&(!tween.elem.style||tween.elem.style[tween.prop]==null)){return tween.elem[tween.prop]}result=jQuery.css(tween.elem,tween.prop,"");return !result||result==="auto"?0:result},set:function(tween){if(jQuery.fx.step[tween.prop]){jQuery.fx.step[tween.prop](tween)}else{if(tween.elem.style&&(tween.elem.style[jQuery.cssProps[tween.prop]]!=null||jQuery.cssHooks[tween.prop])){jQuery.style(tween.elem,tween.prop,tween.now+tween.unit)}else{tween.elem[tween.prop]=tween.now}}}}};Tween.propHooks.scrollTop=Tween.propHooks.scrollLeft={set:function(tween){if(tween.elem.nodeType&&tween.elem.parentNode){tween.elem[tween.prop]=tween.now}}};jQuery.easing={linear:function(p){return p},swing:function(p){return 0.5-Math.cos(p*Math.PI)/2}};jQuery.fx=Tween.prototype.init;jQuery.fx.step={};var fxNow,timerId,rfxtypes=/^(?:toggle|show|hide)$/,rfxnum=new RegExp("^(?:([+-])=|)("+pnum+")([a-z%]*)$","i"),rrun=/queueHooks$/,animationPrefilters=[defaultPrefilter],tweeners={"*":[function(prop,value){var tween=this.createTween(prop,value),target=tween.cur(),parts=rfxnum.exec(value),unit=parts&&parts[3]||(jQuery.cssNumber[prop]?"":"px"),start=(jQuery.cssNumber[prop]||unit!=="px"&&+target)&&rfxnum.exec(jQuery.css(tween.elem,prop)),scale=1,maxIterations=20;if(start&&start[3]!==unit){unit=unit||start[3];parts=parts||[];start=+target||1;do{scale=scale||".5";start=start/scale;jQuery.style(tween.elem,prop,start+unit)}while(scale!==(scale=tween.cur()/target)&&scale!==1&&--maxIterations)}if(parts){start=tween.start=+start||+target||0;tween.unit=unit;tween.end=parts[1]?start+(parts[1]+1)*parts[2]:+parts[2]}return tween}]};function createFxNow(){setTimeout(function(){fxNow=undefined});return(fxNow=jQuery.now())}function genFx(type,includeWidth){var which,i=0,attrs={height:type};includeWidth=includeWidth?1:0;for(;i<4;i+=2-includeWidth){which=cssExpand[i];attrs["margin"+which]=attrs["padding"+which]=type}if(includeWidth){attrs.opacity=attrs.width=type}return attrs}function createTween(value,prop,animation){var tween,collection=(tweeners[prop]||[]).concat(tweeners["*"]),index=0,length=collection.length;for(;index<length;index++){if((tween=collection[index].call(animation,prop,value))){return tween}}}function defaultPrefilter(elem,props,opts){var prop,value,toggle,tween,hooks,oldfire,display,checkDisplay,anim=this,orig={},style=elem.style,hidden=elem.nodeType&&isHidden(elem),dataShow=data_priv.get(elem,"fxshow");if(!opts.queue){hooks=jQuery._queueHooks(elem,"fx");if(hooks.unqueued==null){hooks.unqueued=0;oldfire=hooks.empty.fire;hooks.empty.fire=function(){if(!hooks.unqueued){oldfire()}}}hooks.unqueued++;anim.always(function(){anim.always(function(){hooks.unqueued--;if(!jQuery.queue(elem,"fx").length){hooks.empty.fire()}})})}if(elem.nodeType===1&&("height" in props||"width" in props)){opts.overflow=[style.overflow,style.overflowX,style.overflowY];display=jQuery.css(elem,"display");checkDisplay=display==="none"?data_priv.get(elem,"olddisplay")||defaultDisplay(elem.nodeName):display;if(checkDisplay==="inline"&&jQuery.css(elem,"float")==="none"){style.display="inline-block"}}if(opts.overflow){style.overflow="hidden";anim.always(function(){style.overflow=opts.overflow[0];style.overflowX=opts.overflow[1];style.overflowY=opts.overflow[2]})}for(prop in props){value=props[prop];if(rfxtypes.exec(value)){delete props[prop];toggle=toggle||value==="toggle";if(value===(hidden?"hide":"show")){if(value==="show"&&dataShow&&dataShow[prop]!==undefined){hidden=true}else{continue}}orig[prop]=dataShow&&dataShow[prop]||jQuery.style(elem,prop)}else{display=undefined}}if(!jQuery.isEmptyObject(orig)){if(dataShow){if("hidden" in dataShow){hidden=dataShow.hidden}}else{dataShow=data_priv.access(elem,"fxshow",{})}if(toggle){dataShow.hidden=!hidden}if(hidden){jQuery(elem).show()}else{anim.done(function(){jQuery(elem).hide()})}anim.done(function(){var prop;data_priv.remove(elem,"fxshow");for(prop in orig){jQuery.style(elem,prop,orig[prop])}});for(prop in orig){tween=createTween(hidden?dataShow[prop]:0,prop,anim);if(!(prop in dataShow)){dataShow[prop]=tween.start;if(hidden){tween.end=tween.start;tween.start=prop==="width"||prop==="height"?1:0}}}}else{if((display==="none"?defaultDisplay(elem.nodeName):display)==="inline"){style.display=display}}}function propFilter(props,specialEasing){var index,name,easing,value,hooks;for(index in props){name=jQuery.camelCase(index);easing=specialEasing[name];value=props[index];if(jQuery.isArray(value)){easing=value[1];value=props[index]=value[0]}if(index!==name){props[name]=value;delete props[index]}hooks=jQuery.cssHooks[name];if(hooks&&"expand" in hooks){value=hooks.expand(value);delete props[name];for(index in value){if(!(index in props)){props[index]=value[index];specialEasing[index]=easing}}}else{specialEasing[name]=easing}}}function Animation(elem,properties,options){var result,stopped,index=0,length=animationPrefilters.length,deferred=jQuery.Deferred().always(function(){delete tick.elem}),tick=function(){if(stopped){return false}var currentTime=fxNow||createFxNow(),remaining=Math.max(0,animation.startTime+animation.duration-currentTime),temp=remaining/animation.duration||0,percent=1-temp,index=0,length=animation.tweens.length;for(;index<length;index++){animation.tweens[index].run(percent)}deferred.notifyWith(elem,[animation,percent,remaining]);if(percent<1&&length){return remaining}else{deferred.resolveWith(elem,[animation]);return false}},animation=deferred.promise({elem:elem,props:jQuery.extend({},properties),opts:jQuery.extend(true,{specialEasing:{}},options),originalProperties:properties,originalOptions:options,startTime:fxNow||createFxNow(),duration:options.duration,tweens:[],createTween:function(prop,end){var tween=jQuery.Tween(elem,animation.opts,prop,end,animation.opts.specialEasing[prop]||animation.opts.easing);animation.tweens.push(tween);return tween},stop:function(gotoEnd){var index=0,length=gotoEnd?animation.tweens.length:0;if(stopped){return this}stopped=true;for(;index<length;index++){animation.tweens[index].run(1)}if(gotoEnd){deferred.resolveWith(elem,[animation,gotoEnd])}else{deferred.rejectWith(elem,[animation,gotoEnd])}return this}}),props=animation.props;propFilter(props,animation.opts.specialEasing);for(;index<length;index++){result=animationPrefilters[index].call(animation,elem,props,animation.opts);if(result){return result}}jQuery.map(props,createTween,animation);if(jQuery.isFunction(animation.opts.start)){animation.opts.start.call(elem,animation)}jQuery.fx.timer(jQuery.extend(tick,{elem:elem,anim:animation,queue:animation.opts.queue}));return animation.progress(animation.opts.progress).done(animation.opts.done,animation.opts.complete).fail(animation.opts.fail).always(animation.opts.always)}jQuery.Animation=jQuery.extend(Animation,{tweener:function(props,callback){if(jQuery.isFunction(props)){callback=props;props=["*"]}else{props=props.split(" ")}var prop,index=0,length=props.length;for(;index<length;index++){prop=props[index];tweeners[prop]=tweeners[prop]||[];tweeners[prop].unshift(callback)}},prefilter:function(callback,prepend){if(prepend){animationPrefilters.unshift(callback)}else{animationPrefilters.push(callback)}}});jQuery.speed=function(speed,easing,fn){var opt=speed&&typeof speed==="object"?jQuery.extend({},speed):{complete:fn||!fn&&easing||jQuery.isFunction(speed)&&speed,duration:speed,easing:fn&&easing||easing&&!jQuery.isFunction(easing)&&easing};opt.duration=jQuery.fx.off?0:typeof opt.duration==="number"?opt.duration:opt.duration in jQuery.fx.speeds?jQuery.fx.speeds[opt.duration]:jQuery.fx.speeds._default;if(opt.queue==null||opt.queue===true){opt.queue="fx"}opt.old=opt.complete;opt.complete=function(){if(jQuery.isFunction(opt.old)){opt.old.call(this)}if(opt.queue){jQuery.dequeue(this,opt.queue)}};return opt};jQuery.fn.extend({fadeTo:function(speed,to,easing,callback){return this.filter(isHidden).css("opacity",0).show().end().animate({opacity:to},speed,easing,callback)},animate:function(prop,speed,easing,callback){var empty=jQuery.isEmptyObject(prop),optall=jQuery.speed(speed,easing,callback),doAnimation=function(){var anim=Animation(this,jQuery.extend({},prop),optall);if(empty||data_priv.get(this,"finish")){anim.stop(true)}};doAnimation.finish=doAnimation;return empty||optall.queue===false?this.each(doAnimation):this.queue(optall.queue,doAnimation)},stop:function(type,clearQueue,gotoEnd){var stopQueue=function(hooks){var stop=hooks.stop;delete hooks.stop;stop(gotoEnd)};if(typeof type!=="string"){gotoEnd=clearQueue;clearQueue=type;type=undefined}if(clearQueue&&type!==false){this.queue(type||"fx",[])}return this.each(function(){var dequeue=true,index=type!=null&&type+"queueHooks",timers=jQuery.timers,data=data_priv.get(this);if(index){if(data[index]&&data[index].stop){stopQueue(data[index])}}else{for(index in data){if(data[index]&&data[index].stop&&rrun.test(index)){stopQueue(data[index])}}}for(index=timers.length;index--;){if(timers[index].elem===this&&(type==null||timers[index].queue===type)){timers[index].anim.stop(gotoEnd);dequeue=false;timers.splice(index,1)}}if(dequeue||!gotoEnd){jQuery.dequeue(this,type)}})},finish:function(type){if(type!==false){type=type||"fx"}return this.each(function(){var index,data=data_priv.get(this),queue=data[type+"queue"],hooks=data[type+"queueHooks"],timers=jQuery.timers,length=queue?queue.length:0;data.finish=true;jQuery.queue(this,type,[]);if(hooks&&hooks.stop){hooks.stop.call(this,true)}for(index=timers.length;index--;){if(timers[index].elem===this&&timers[index].queue===type){timers[index].anim.stop(true);timers.splice(index,1)}}for(index=0;index<length;index++){if(queue[index]&&queue[index].finish){queue[index].finish.call(this)}}delete data.finish})}});jQuery.each(["toggle","show","hide"],function(i,name){var cssFn=jQuery.fn[name];jQuery.fn[name]=function(speed,easing,callback){return speed==null||typeof speed==="boolean"?cssFn.apply(this,arguments):this.animate(genFx(name,true),speed,easing,callback)}});jQuery.each({slideDown:genFx("show"),slideUp:genFx("hide"),slideToggle:genFx("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(name,props){jQuery.fn[name]=function(speed,easing,callback){return this.animate(props,speed,easing,callback)}});jQuery.timers=[];jQuery.fx.tick=function(){var timer,i=0,timers=jQuery.timers;fxNow=jQuery.now();for(;i<timers.length;i++){timer=timers[i];if(!timer()&&timers[i]===timer){timers.splice(i--,1)}}if(!timers.length){jQuery.fx.stop()}fxNow=undefined};jQuery.fx.timer=function(timer){jQuery.timers.push(timer);if(timer()){jQuery.fx.start()}else{jQuery.timers.pop()}};jQuery.fx.interval=13;jQuery.fx.start=function(){if(!timerId){timerId=setInterval(jQuery.fx.tick,jQuery.fx.interval)}};jQuery.fx.stop=function(){clearInterval(timerId);timerId=null};jQuery.fx.speeds={slow:600,fast:200,_default:400};jQuery.fn.delay=function(time,type){time=jQuery.fx?jQuery.fx.speeds[time]||time:time;type=type||"fx";return this.queue(type,function(next,hooks){var timeout=setTimeout(next,time);hooks.stop=function(){clearTimeout(timeout)}})};(function(){var input=document.createElement("input"),select=document.createElement("select"),opt=select.appendChild(document.createElement("option"));input.type="checkbox";support.checkOn=input.value!=="";support.optSelected=opt.selected;select.disabled=true;support.optDisabled=!opt.disabled;input=document.createElement("input");input.value="t";input.type="radio";support.radioValue=input.value==="t"})();var nodeHook,boolHook,attrHandle=jQuery.expr.attrHandle;jQuery.fn.extend({attr:function(name,value){return access(this,jQuery.attr,name,value,arguments.length>1)},removeAttr:function(name){return this.each(function(){jQuery.removeAttr(this,name)})}});jQuery.extend({attr:function(elem,name,value){var hooks,ret,nType=elem.nodeType;if(!elem||nType===3||nType===8||nType===2){return}if(typeof elem.getAttribute===strundefined){return jQuery.prop(elem,name,value)}if(nType!==1||!jQuery.isXMLDoc(elem)){name=name.toLowerCase();hooks=jQuery.attrHooks[name]||(jQuery.expr.match.bool.test(name)?boolHook:nodeHook)}if(value!==undefined){if(value===null){jQuery.removeAttr(elem,name)}else{if(hooks&&"set" in hooks&&(ret=hooks.set(elem,value,name))!==undefined){return ret}else{elem.setAttribute(name,value+"");return value}}}else{if(hooks&&"get" in hooks&&(ret=hooks.get(elem,name))!==null){return ret}else{ret=jQuery.find.attr(elem,name);return ret==null?undefined:ret}}},removeAttr:function(elem,value){var name,propName,i=0,attrNames=value&&value.match(rnotwhite);if(attrNames&&elem.nodeType===1){while((name=attrNames[i++])){propName=jQuery.propFix[name]||name;if(jQuery.expr.match.bool.test(name)){elem[propName]=false}elem.removeAttribute(name)}}},attrHooks:{type:{set:function(elem,value){if(!support.radioValue&&value==="radio"&&jQuery.nodeName(elem,"input")){var val=elem.value;elem.setAttribute("type",value);if(val){elem.value=val}return value}}}}});boolHook={set:function(elem,value,name){if(value===false){jQuery.removeAttr(elem,name)}else{elem.setAttribute(name,name)}return name}};jQuery.each(jQuery.expr.match.bool.source.match(/\w+/g),function(i,name){var getter=attrHandle[name]||jQuery.find.attr;attrHandle[name]=function(elem,name,isXML){var ret,handle;if(!isXML){handle=attrHandle[name];attrHandle[name]=ret;ret=getter(elem,name,isXML)!=null?name.toLowerCase():null;attrHandle[name]=handle}return ret}});var rfocusable=/^(?:input|select|textarea|button)$/i;jQuery.fn.extend({prop:function(name,value){return access(this,jQuery.prop,name,value,arguments.length>1)},removeProp:function(name){return this.each(function(){delete this[jQuery.propFix[name]||name]})}});jQuery.extend({propFix:{"for":"htmlFor","class":"className"},prop:function(elem,name,value){var ret,hooks,notxml,nType=elem.nodeType;if(!elem||nType===3||nType===8||nType===2){return}notxml=nType!==1||!jQuery.isXMLDoc(elem);if(notxml){name=jQuery.propFix[name]||name;hooks=jQuery.propHooks[name]}if(value!==undefined){return hooks&&"set" in hooks&&(ret=hooks.set(elem,value,name))!==undefined?ret:(elem[name]=value)}else{return hooks&&"get" in hooks&&(ret=hooks.get(elem,name))!==null?ret:elem[name]}},propHooks:{tabIndex:{get:function(elem){return elem.hasAttribute("tabindex")||rfocusable.test(elem.nodeName)||elem.href?elem.tabIndex:-1}}}});if(!support.optSelected){jQuery.propHooks.selected={get:function(elem){var parent=elem.parentNode;if(parent&&parent.parentNode){parent.parentNode.selectedIndex}return null}}}jQuery.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){jQuery.propFix[this.toLowerCase()]=this});var rclass=/[\t\r\n\f]/g;jQuery.fn.extend({addClass:function(value){var classes,elem,cur,clazz,j,finalValue,proceed=typeof value==="string"&&value,i=0,len=this.length;if(jQuery.isFunction(value)){return this.each(function(j){jQuery(this).addClass(value.call(this,j,this.className))})}if(proceed){classes=(value||"").match(rnotwhite)||[];for(;i<len;i++){elem=this[i];cur=elem.nodeType===1&&(elem.className?(" "+elem.className+" ").replace(rclass," "):" ");if(cur){j=0;while((clazz=classes[j++])){if(cur.indexOf(" "+clazz+" ")<0){cur+=clazz+" "}}finalValue=jQuery.trim(cur);if(elem.className!==finalValue){elem.className=finalValue}}}}return this},removeClass:function(value){var classes,elem,cur,clazz,j,finalValue,proceed=arguments.length===0||typeof value==="string"&&value,i=0,len=this.length;if(jQuery.isFunction(value)){return this.each(function(j){jQuery(this).removeClass(value.call(this,j,this.className))})}if(proceed){classes=(value||"").match(rnotwhite)||[];for(;i<len;i++){elem=this[i];cur=elem.nodeType===1&&(elem.className?(" "+elem.className+" ").replace(rclass," "):"");if(cur){j=0;while((clazz=classes[j++])){while(cur.indexOf(" "+clazz+" ")>=0){cur=cur.replace(" "+clazz+" "," ")}}finalValue=value?jQuery.trim(cur):"";if(elem.className!==finalValue){elem.className=finalValue}}}}return this},toggleClass:function(value,stateVal){var type=typeof value;if(typeof stateVal==="boolean"&&type==="string"){return stateVal?this.addClass(value):this.removeClass(value)}if(jQuery.isFunction(value)){return this.each(function(i){jQuery(this).toggleClass(value.call(this,i,this.className,stateVal),stateVal)})}return this.each(function(){if(type==="string"){var className,i=0,self=jQuery(this),classNames=value.match(rnotwhite)||[];while((className=classNames[i++])){if(self.hasClass(className)){self.removeClass(className)}else{self.addClass(className)}}}else{if(type===strundefined||type==="boolean"){if(this.className){data_priv.set(this,"__className__",this.className)}this.className=this.className||value===false?"":data_priv.get(this,"__className__")||""}}})},hasClass:function(selector){var className=" "+selector+" ",i=0,l=this.length;for(;i<l;i++){if(this[i].nodeType===1&&(" "+this[i].className+" ").replace(rclass," ").indexOf(className)>=0){return true}}return false}});var rreturn=/\r/g;jQuery.fn.extend({val:function(value){var hooks,ret,isFunction,elem=this[0];if(!arguments.length){if(elem){hooks=jQuery.valHooks[elem.type]||jQuery.valHooks[elem.nodeName.toLowerCase()];if(hooks&&"get" in hooks&&(ret=hooks.get(elem,"value"))!==undefined){return ret}ret=elem.value;return typeof ret==="string"?ret.replace(rreturn,""):ret==null?"":ret}return}isFunction=jQuery.isFunction(value);return this.each(function(i){var val;if(this.nodeType!==1){return}if(isFunction){val=value.call(this,i,jQuery(this).val())}else{val=value}if(val==null){val=""}else{if(typeof val==="number"){val+=""}else{if(jQuery.isArray(val)){val=jQuery.map(val,function(value){return value==null?"":value+""})}}}hooks=jQuery.valHooks[this.type]||jQuery.valHooks[this.nodeName.toLowerCase()];if(!hooks||!("set" in hooks)||hooks.set(this,val,"value")===undefined){this.value=val}})}});jQuery.extend({valHooks:{option:{get:function(elem){var val=jQuery.find.attr(elem,"value");return val!=null?val:jQuery.trim(jQuery.text(elem))}},select:{get:function(elem){var value,option,options=elem.options,index=elem.selectedIndex,one=elem.type==="select-one"||index<0,values=one?null:[],max=one?index+1:options.length,i=index<0?max:one?index:0;for(;i<max;i++){option=options[i];if((option.selected||i===index)&&(support.optDisabled?!option.disabled:option.getAttribute("disabled")===null)&&(!option.parentNode.disabled||!jQuery.nodeName(option.parentNode,"optgroup"))){value=jQuery(option).val();if(one){return value}values.push(value)}}return values},set:function(elem,value){var optionSet,option,options=elem.options,values=jQuery.makeArray(value),i=options.length;while(i--){option=options[i];if((option.selected=jQuery.inArray(option.value,values)>=0)){optionSet=true}}if(!optionSet){elem.selectedIndex=-1}return values}}}});jQuery.each(["radio","checkbox"],function(){jQuery.valHooks[this]={set:function(elem,value){if(jQuery.isArray(value)){return(elem.checked=jQuery.inArray(jQuery(elem).val(),value)>=0)}}};if(!support.checkOn){jQuery.valHooks[this].get=function(elem){return elem.getAttribute("value")===null?"on":elem.value}}});jQuery.each(("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu").split(" "),function(i,name){jQuery.fn[name]=function(data,fn){return arguments.length>0?this.on(name,null,data,fn):this.trigger(name)}});jQuery.fn.extend({hover:function(fnOver,fnOut){return this.mouseenter(fnOver).mouseleave(fnOut||fnOver)},bind:function(types,data,fn){return this.on(types,null,data,fn)},unbind:function(types,fn){return this.off(types,null,fn)},delegate:function(selector,types,data,fn){return this.on(types,selector,data,fn)},undelegate:function(selector,types,fn){return arguments.length===1?this.off(selector,"**"):this.off(types,selector||"**",fn)}});var nonce=jQuery.now();var rquery=(/\?/);jQuery.parseJSON=function(data){return JSON.parse(data+"")};jQuery.parseXML=function(data){var xml,tmp;if(!data||typeof data!=="string"){return null}try{tmp=new DOMParser();xml=tmp.parseFromString(data,"text/xml")}catch(e){xml=undefined}if(!xml||xml.getElementsByTagName("parsererror").length){jQuery.error("Invalid XML: "+data)}return xml};var rhash=/#.*$/,rts=/([?&])_=[^&]*/,rheaders=/^(.*?):[ \t]*([^\r\n]*)$/mg,rlocalProtocol=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,rnoContent=/^(?:GET|HEAD)$/,rprotocol=/^\/\//,rurl=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,prefilters={},transports={},allTypes="*/".concat("*"),ajaxLocation=window.location.href,ajaxLocParts=rurl.exec(ajaxLocation.toLowerCase())||[];function addToPrefiltersOrTransports(structure){return function(dataTypeExpression,func){if(typeof dataTypeExpression!=="string"){func=dataTypeExpression;dataTypeExpression="*"}var dataType,i=0,dataTypes=dataTypeExpression.toLowerCase().match(rnotwhite)||[];if(jQuery.isFunction(func)){while((dataType=dataTypes[i++])){if(dataType[0]==="+"){dataType=dataType.slice(1)||"*";(structure[dataType]=structure[dataType]||[]).unshift(func)}else{(structure[dataType]=structure[dataType]||[]).push(func)}}}}}function inspectPrefiltersOrTransports(structure,options,originalOptions,jqXHR){var inspected={},seekingTransport=(structure===transports);function inspect(dataType){var selected;inspected[dataType]=true;jQuery.each(structure[dataType]||[],function(_,prefilterOrFactory){var dataTypeOrTransport=prefilterOrFactory(options,originalOptions,jqXHR);if(typeof dataTypeOrTransport==="string"&&!seekingTransport&&!inspected[dataTypeOrTransport]){options.dataTypes.unshift(dataTypeOrTransport);inspect(dataTypeOrTransport);return false}else{if(seekingTransport){return !(selected=dataTypeOrTransport)}}});return selected}return inspect(options.dataTypes[0])||!inspected["*"]&&inspect("*")}function ajaxExtend(target,src){var key,deep,flatOptions=jQuery.ajaxSettings.flatOptions||{};for(key in src){if(src[key]!==undefined){(flatOptions[key]?target:(deep||(deep={})))[key]=src[key]}}if(deep){jQuery.extend(true,target,deep)}return target}function ajaxHandleResponses(s,jqXHR,responses){var ct,type,finalDataType,firstDataType,contents=s.contents,dataTypes=s.dataTypes;while(dataTypes[0]==="*"){dataTypes.shift();if(ct===undefined){ct=s.mimeType||jqXHR.getResponseHeader("Content-Type")}}if(ct){for(type in contents){if(contents[type]&&contents[type].test(ct)){dataTypes.unshift(type);break}}}if(dataTypes[0] in responses){finalDataType=dataTypes[0]}else{for(type in responses){if(!dataTypes[0]||s.converters[type+" "+dataTypes[0]]){finalDataType=type;break}if(!firstDataType){firstDataType=type}}finalDataType=finalDataType||firstDataType}if(finalDataType){if(finalDataType!==dataTypes[0]){dataTypes.unshift(finalDataType)}return responses[finalDataType]}}function ajaxConvert(s,response,jqXHR,isSuccess){var conv2,current,conv,tmp,prev,converters={},dataTypes=s.dataTypes.slice();if(dataTypes[1]){for(conv in s.converters){converters[conv.toLowerCase()]=s.converters[conv]}}current=dataTypes.shift();while(current){if(s.responseFields[current]){jqXHR[s.responseFields[current]]=response}if(!prev&&isSuccess&&s.dataFilter){response=s.dataFilter(response,s.dataType)}prev=current;current=dataTypes.shift();if(current){if(current==="*"){current=prev}else{if(prev!=="*"&&prev!==current){conv=converters[prev+" "+current]||converters["* "+current];if(!conv){for(conv2 in converters){tmp=conv2.split(" ");if(tmp[1]===current){conv=converters[prev+" "+tmp[0]]||converters["* "+tmp[0]];if(conv){if(conv===true){conv=converters[conv2]}else{if(converters[conv2]!==true){current=tmp[0];dataTypes.unshift(tmp[1])}}break}}}}if(conv!==true){if(conv&&s["throws"]){response=conv(response)}else{try{response=conv(response)}catch(e){return{state:"parsererror",error:conv?e:"No conversion from "+prev+" to "+current}}}}}}}}return{state:"success",data:response}}jQuery.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:ajaxLocation,type:"GET",isLocal:rlocalProtocol.test(ajaxLocParts[1]),global:true,processData:true,async:true,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":allTypes,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":true,"text json":jQuery.parseJSON,"text xml":jQuery.parseXML},flatOptions:{url:true,context:true}},ajaxSetup:function(target,settings){return settings?ajaxExtend(ajaxExtend(target,jQuery.ajaxSettings),settings):ajaxExtend(jQuery.ajaxSettings,target)},ajaxPrefilter:addToPrefiltersOrTransports(prefilters),ajaxTransport:addToPrefiltersOrTransports(transports),ajax:function(url,options){if(typeof url==="object"){options=url;url=undefined}options=options||{};var transport,cacheURL,responseHeadersString,responseHeaders,timeoutTimer,parts,fireGlobals,i,s=jQuery.ajaxSetup({},options),callbackContext=s.context||s,globalEventContext=s.context&&(callbackContext.nodeType||callbackContext.jquery)?jQuery(callbackContext):jQuery.event,deferred=jQuery.Deferred(),completeDeferred=jQuery.Callbacks("once memory"),statusCode=s.statusCode||{},requestHeaders={},requestHeadersNames={},state=0,strAbort="canceled",jqXHR={readyState:0,getResponseHeader:function(key){var match;if(state===2){if(!responseHeaders){responseHeaders={};while((match=rheaders.exec(responseHeadersString))){responseHeaders[match[1].toLowerCase()]=match[2]}}match=responseHeaders[key.toLowerCase()]}return match==null?null:match},getAllResponseHeaders:function(){return state===2?responseHeadersString:null},setRequestHeader:function(name,value){var lname=name.toLowerCase();if(!state){name=requestHeadersNames[lname]=requestHeadersNames[lname]||name;requestHeaders[name]=value}return this},overrideMimeType:function(type){if(!state){s.mimeType=type}return this},statusCode:function(map){var code;if(map){if(state<2){for(code in map){statusCode[code]=[statusCode[code],map[code]]}}else{jqXHR.always(map[jqXHR.status])}}return this},abort:function(statusText){var finalText=statusText||strAbort;if(transport){transport.abort(finalText)}done(0,finalText);return this}};deferred.promise(jqXHR).complete=completeDeferred.add;jqXHR.success=jqXHR.done;jqXHR.error=jqXHR.fail;s.url=((url||s.url||ajaxLocation)+"").replace(rhash,"").replace(rprotocol,ajaxLocParts[1]+"//");s.type=options.method||options.type||s.method||s.type;s.dataTypes=jQuery.trim(s.dataType||"*").toLowerCase().match(rnotwhite)||[""];if(s.crossDomain==null){parts=rurl.exec(s.url.toLowerCase());s.crossDomain=!!(parts&&(parts[1]!==ajaxLocParts[1]||parts[2]!==ajaxLocParts[2]||(parts[3]||(parts[1]==="http:"?"80":"443"))!==(ajaxLocParts[3]||(ajaxLocParts[1]==="http:"?"80":"443"))))}if(s.data&&s.processData&&typeof s.data!=="string"){s.data=jQuery.param(s.data,s.traditional)}inspectPrefiltersOrTransports(prefilters,s,options,jqXHR);if(state===2){return jqXHR}fireGlobals=jQuery.event&&s.global;if(fireGlobals&&jQuery.active++===0){jQuery.event.trigger("ajaxStart")}s.type=s.type.toUpperCase();s.hasContent=!rnoContent.test(s.type);cacheURL=s.url;if(!s.hasContent){if(s.data){cacheURL=(s.url+=(rquery.test(cacheURL)?"&":"?")+s.data);delete s.data}if(s.cache===false){s.url=rts.test(cacheURL)?cacheURL.replace(rts,"$1_="+nonce++):cacheURL+(rquery.test(cacheURL)?"&":"?")+"_="+nonce++}}if(s.ifModified){if(jQuery.lastModified[cacheURL]){jqXHR.setRequestHeader("If-Modified-Since",jQuery.lastModified[cacheURL])}if(jQuery.etag[cacheURL]){jqXHR.setRequestHeader("If-None-Match",jQuery.etag[cacheURL])}}if(s.data&&s.hasContent&&s.contentType!==false||options.contentType){jqXHR.setRequestHeader("Content-Type",s.contentType)}jqXHR.setRequestHeader("Accept",s.dataTypes[0]&&s.accepts[s.dataTypes[0]]?s.accepts[s.dataTypes[0]]+(s.dataTypes[0]!=="*"?", "+allTypes+"; q=0.01":""):s.accepts["*"]);for(i in s.headers){jqXHR.setRequestHeader(i,s.headers[i])}if(s.beforeSend&&(s.beforeSend.call(callbackContext,jqXHR,s)===false||state===2)){return jqXHR.abort()}strAbort="abort";for(i in {success:1,error:1,complete:1}){jqXHR[i](s[i])}transport=inspectPrefiltersOrTransports(transports,s,options,jqXHR);if(!transport){done(-1,"No Transport")}else{jqXHR.readyState=1;if(fireGlobals){globalEventContext.trigger("ajaxSend",[jqXHR,s])}if(s.async&&s.timeout>0){timeoutTimer=setTimeout(function(){jqXHR.abort("timeout")},s.timeout)}try{state=1;transport.send(requestHeaders,done)}catch(e){if(state<2){done(-1,e)}else{throw e}}}function done(status,nativeStatusText,responses,headers){var isSuccess,success,error,response,modified,statusText=nativeStatusText;if(state===2){return}state=2;if(timeoutTimer){clearTimeout(timeoutTimer)}transport=undefined;responseHeadersString=headers||"";jqXHR.readyState=status>0?4:0;isSuccess=status>=200&&status<300||status===304;if(responses){response=ajaxHandleResponses(s,jqXHR,responses)}response=ajaxConvert(s,response,jqXHR,isSuccess);if(isSuccess){if(s.ifModified){modified=jqXHR.getResponseHeader("Last-Modified");if(modified){jQuery.lastModified[cacheURL]=modified}modified=jqXHR.getResponseHeader("etag");if(modified){jQuery.etag[cacheURL]=modified}}if(status===204||s.type==="HEAD"){statusText="nocontent"}else{if(status===304){statusText="notmodified"}else{statusText=response.state;success=response.data;error=response.error;isSuccess=!error}}}else{error=statusText;if(status||!statusText){statusText="error";if(status<0){status=0}}}jqXHR.status=status;jqXHR.statusText=(nativeStatusText||statusText)+"";if(isSuccess){deferred.resolveWith(callbackContext,[success,statusText,jqXHR])}else{deferred.rejectWith(callbackContext,[jqXHR,statusText,error])}jqXHR.statusCode(statusCode);statusCode=undefined;if(fireGlobals){globalEventContext.trigger(isSuccess?"ajaxSuccess":"ajaxError",[jqXHR,s,isSuccess?success:error])}completeDeferred.fireWith(callbackContext,[jqXHR,statusText]);if(fireGlobals){globalEventContext.trigger("ajaxComplete",[jqXHR,s]);if(!(--jQuery.active)){jQuery.event.trigger("ajaxStop")}}}return jqXHR},getJSON:function(url,data,callback){return jQuery.get(url,data,callback,"json")},getScript:function(url,callback){return jQuery.get(url,undefined,callback,"script")}});jQuery.each(["get","post"],function(i,method){jQuery[method]=function(url,data,callback,type){if(jQuery.isFunction(data)){type=type||callback;callback=data;data=undefined}return jQuery.ajax({url:url,type:method,dataType:type,data:data,success:callback})}});jQuery._evalUrl=function(url){return jQuery.ajax({url:url,type:"GET",dataType:"script",async:false,global:false,"throws":true})};jQuery.fn.extend({wrapAll:function(html){var wrap;if(jQuery.isFunction(html)){return this.each(function(i){jQuery(this).wrapAll(html.call(this,i))})}if(this[0]){wrap=jQuery(html,this[0].ownerDocument).eq(0).clone(true);if(this[0].parentNode){wrap.insertBefore(this[0])}wrap.map(function(){var elem=this;while(elem.firstElementChild){elem=elem.firstElementChild}return elem}).append(this)}return this},wrapInner:function(html){if(jQuery.isFunction(html)){return this.each(function(i){jQuery(this).wrapInner(html.call(this,i))})}return this.each(function(){var self=jQuery(this),contents=self.contents();if(contents.length){contents.wrapAll(html)}else{self.append(html)}})},wrap:function(html){var isFunction=jQuery.isFunction(html);return this.each(function(i){jQuery(this).wrapAll(isFunction?html.call(this,i):html)})},unwrap:function(){return this.parent().each(function(){if(!jQuery.nodeName(this,"body")){jQuery(this).replaceWith(this.childNodes)}}).end()}});jQuery.expr.filters.hidden=function(elem){return elem.offsetWidth<=0&&elem.offsetHeight<=0};jQuery.expr.filters.visible=function(elem){return !jQuery.expr.filters.hidden(elem)};var r20=/%20/g,rbracket=/\[\]$/,rCRLF=/\r?\n/g,rsubmitterTypes=/^(?:submit|button|image|reset|file)$/i,rsubmittable=/^(?:input|select|textarea|keygen)/i;function buildParams(prefix,obj,traditional,add){var name;if(jQuery.isArray(obj)){jQuery.each(obj,function(i,v){if(traditional||rbracket.test(prefix)){add(prefix,v)}else{buildParams(prefix+"["+(typeof v==="object"?i:"")+"]",v,traditional,add)}})}else{if(!traditional&&jQuery.type(obj)==="object"){for(name in obj){buildParams(prefix+"["+name+"]",obj[name],traditional,add)}}else{add(prefix,obj)}}}jQuery.param=function(a,traditional){var prefix,s=[],add=function(key,value){value=jQuery.isFunction(value)?value():(value==null?"":value);s[s.length]=encodeURIComponent(key)+"="+encodeURIComponent(value)};if(traditional===undefined){traditional=jQuery.ajaxSettings&&jQuery.ajaxSettings.traditional}if(jQuery.isArray(a)||(a.jquery&&!jQuery.isPlainObject(a))){jQuery.each(a,function(){add(this.name,this.value)})}else{for(prefix in a){buildParams(prefix,a[prefix],traditional,add)}}return s.join("&").replace(r20,"+")};jQuery.fn.extend({serialize:function(){return jQuery.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var elements=jQuery.prop(this,"elements");return elements?jQuery.makeArray(elements):this}).filter(function(){var type=this.type;return this.name&&!jQuery(this).is(":disabled")&&rsubmittable.test(this.nodeName)&&!rsubmitterTypes.test(type)&&(this.checked||!rcheckableType.test(type))}).map(function(i,elem){var val=jQuery(this).val();return val==null?null:jQuery.isArray(val)?jQuery.map(val,function(val){return{name:elem.name,value:val.replace(rCRLF,"\r\n")}}):{name:elem.name,value:val.replace(rCRLF,"\r\n")}}).get()}});jQuery.ajaxSettings.xhr=function(){try{return new XMLHttpRequest()}catch(e){}};var xhrId=0,xhrCallbacks={},xhrSuccessStatus={0:200,1223:204},xhrSupported=jQuery.ajaxSettings.xhr();if(window.attachEvent){window.attachEvent("onunload",function(){for(var key in xhrCallbacks){xhrCallbacks[key]()}})}support.cors=!!xhrSupported&&("withCredentials" in xhrSupported);support.ajax=xhrSupported=!!xhrSupported;jQuery.ajaxTransport(function(options){var callback;if(support.cors||xhrSupported&&!options.crossDomain){return{send:function(headers,complete){var i,xhr=options.xhr(),id=++xhrId;xhr.open(options.type,options.url,options.async,options.username,options.password);if(options.xhrFields){for(i in options.xhrFields){xhr[i]=options.xhrFields[i]}}if(options.mimeType&&xhr.overrideMimeType){xhr.overrideMimeType(options.mimeType)}if(!options.crossDomain&&!headers["X-Requested-With"]){headers["X-Requested-With"]="XMLHttpRequest"}for(i in headers){xhr.setRequestHeader(i,headers[i])}callback=function(type){return function(){if(callback){delete xhrCallbacks[id];callback=xhr.onload=xhr.onerror=null;if(type==="abort"){xhr.abort()}else{if(type==="error"){complete(xhr.status,xhr.statusText)}else{complete(xhrSuccessStatus[xhr.status]||xhr.status,xhr.statusText,typeof xhr.responseText==="string"?{text:xhr.responseText}:undefined,xhr.getAllResponseHeaders())}}}}};xhr.onload=callback();xhr.onerror=callback("error");callback=xhrCallbacks[id]=callback("abort");try{xhr.send(options.hasContent&&options.data||null)}catch(e){if(callback){throw e}}},abort:function(){if(callback){callback()}}}}});jQuery.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(text){jQuery.globalEval(text);return text}}});jQuery.ajaxPrefilter("script",function(s){if(s.cache===undefined){s.cache=false}if(s.crossDomain){s.type="GET"}});jQuery.ajaxTransport("script",function(s){if(s.crossDomain){var script,callback;return{send:function(_,complete){script=jQuery("<script>").prop({async:true,charset:s.scriptCharset,src:s.url}).on("load error",callback=function(evt){script.remove();callback=null;if(evt){complete(evt.type==="error"?404:200,evt.type)}});document.head.appendChild(script[0])},abort:function(){if(callback){callback()}}}}});var oldCallbacks=[],rjsonp=/(=)\?(?=&|$)|\?\?/;jQuery.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var callback=oldCallbacks.pop()||(jQuery.expando+"_"+(nonce++));this[callback]=true;return callback}});jQuery.ajaxPrefilter("json jsonp",function(s,originalSettings,jqXHR){var callbackName,overwritten,responseContainer,jsonProp=s.jsonp!==false&&(rjsonp.test(s.url)?"url":typeof s.data==="string"&&!(s.contentType||"").indexOf("application/x-www-form-urlencoded")&&rjsonp.test(s.data)&&"data");if(jsonProp||s.dataTypes[0]==="jsonp"){callbackName=s.jsonpCallback=jQuery.isFunction(s.jsonpCallback)?s.jsonpCallback():s.jsonpCallback;if(jsonProp){s[jsonProp]=s[jsonProp].replace(rjsonp,"$1"+callbackName)}else{if(s.jsonp!==false){s.url+=(rquery.test(s.url)?"&":"?")+s.jsonp+"="+callbackName}}s.converters["script json"]=function(){if(!responseContainer){jQuery.error(callbackName+" was not called")}return responseContainer[0]};s.dataTypes[0]="json";overwritten=window[callbackName];window[callbackName]=function(){responseContainer=arguments};jqXHR.always(function(){window[callbackName]=overwritten;if(s[callbackName]){s.jsonpCallback=originalSettings.jsonpCallback;oldCallbacks.push(callbackName)}if(responseContainer&&jQuery.isFunction(overwritten)){overwritten(responseContainer[0])}responseContainer=overwritten=undefined});return"script"}});jQuery.parseHTML=function(data,context,keepScripts){if(!data||typeof data!=="string"){return null}if(typeof context==="boolean"){keepScripts=context;context=false}context=context||document;var parsed=rsingleTag.exec(data),scripts=!keepScripts&&[];if(parsed){return[context.createElement(parsed[1])]}parsed=jQuery.buildFragment([data],context,scripts);if(scripts&&scripts.length){jQuery(scripts).remove()}return jQuery.merge([],parsed.childNodes)};var _load=jQuery.fn.load;jQuery.fn.load=function(url,params,callback){if(typeof url!=="string"&&_load){return _load.apply(this,arguments)}var selector,type,response,self=this,off=url.indexOf(" ");if(off>=0){selector=jQuery.trim(url.slice(off));url=url.slice(0,off)}if(jQuery.isFunction(params)){callback=params;params=undefined}else{if(params&&typeof params==="object"){type="POST"}}if(self.length>0){jQuery.ajax({url:url,type:type,dataType:"html",data:params}).done(function(responseText){response=arguments;self.html(selector?jQuery("<div>").append(jQuery.parseHTML(responseText)).find(selector):responseText)}).complete(callback&&function(jqXHR,status){self.each(callback,response||[jqXHR.responseText,status,jqXHR])})}return this};jQuery.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(i,type){jQuery.fn[type]=function(fn){return this.on(type,fn)}});jQuery.expr.filters.animated=function(elem){return jQuery.grep(jQuery.timers,function(fn){return elem===fn.elem}).length};var docElem=window.document.documentElement;function getWindow(elem){return jQuery.isWindow(elem)?elem:elem.nodeType===9&&elem.defaultView}jQuery.offset={setOffset:function(elem,options,i){var curPosition,curLeft,curCSSTop,curTop,curOffset,curCSSLeft,calculatePosition,position=jQuery.css(elem,"position"),curElem=jQuery(elem),props={};if(position==="static"){elem.style.position="relative"}curOffset=curElem.offset();curCSSTop=jQuery.css(elem,"top");curCSSLeft=jQuery.css(elem,"left");calculatePosition=(position==="absolute"||position==="fixed")&&(curCSSTop+curCSSLeft).indexOf("auto")>-1;if(calculatePosition){curPosition=curElem.position();curTop=curPosition.top;curLeft=curPosition.left}else{curTop=parseFloat(curCSSTop)||0;curLeft=parseFloat(curCSSLeft)||0}if(jQuery.isFunction(options)){options=options.call(elem,i,curOffset)}if(options.top!=null){props.top=(options.top-curOffset.top)+curTop}if(options.left!=null){props.left=(options.left-curOffset.left)+curLeft}if("using" in options){options.using.call(elem,props)}else{curElem.css(props)}}};jQuery.fn.extend({offset:function(options){if(arguments.length){return options===undefined?this:this.each(function(i){jQuery.offset.setOffset(this,options,i)})}var docElem,win,elem=this[0],box={top:0,left:0},doc=elem&&elem.ownerDocument;if(!doc){return}docElem=doc.documentElement;if(!jQuery.contains(docElem,elem)){return box}if(typeof elem.getBoundingClientRect!==strundefined){box=elem.getBoundingClientRect()}win=getWindow(doc);return{top:box.top+win.pageYOffset-docElem.clientTop,left:box.left+win.pageXOffset-docElem.clientLeft}},position:function(){if(!this[0]){return}var offsetParent,offset,elem=this[0],parentOffset={top:0,left:0};if(jQuery.css(elem,"position")==="fixed"){offset=elem.getBoundingClientRect()}else{offsetParent=this.offsetParent();offset=this.offset();if(!jQuery.nodeName(offsetParent[0],"html")){parentOffset=offsetParent.offset()}parentOffset.top+=jQuery.css(offsetParent[0],"borderTopWidth",true);parentOffset.left+=jQuery.css(offsetParent[0],"borderLeftWidth",true)}return{top:offset.top-parentOffset.top-jQuery.css(elem,"marginTop",true),left:offset.left-parentOffset.left-jQuery.css(elem,"marginLeft",true)}},offsetParent:function(){return this.map(function(){var offsetParent=this.offsetParent||docElem;while(offsetParent&&(!jQuery.nodeName(offsetParent,"html")&&jQuery.css(offsetParent,"position")==="static")){offsetParent=offsetParent.offsetParent}return offsetParent||docElem})}});jQuery.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(method,prop){var top="pageYOffset"===prop;jQuery.fn[method]=function(val){return access(this,function(elem,method,val){var win=getWindow(elem);if(val===undefined){return win?win[prop]:elem[method]}if(win){win.scrollTo(!top?val:window.pageXOffset,top?val:window.pageYOffset)}else{elem[method]=val}},method,val,arguments.length,null)}});jQuery.each(["top","left"],function(i,prop){jQuery.cssHooks[prop]=addGetHookIf(support.pixelPosition,function(elem,computed){if(computed){computed=curCSS(elem,prop);return rnumnonpx.test(computed)?jQuery(elem).position()[prop]+"px":computed}})});jQuery.each({Height:"height",Width:"width"},function(name,type){jQuery.each({padding:"inner"+name,content:type,"":"outer"+name},function(defaultExtra,funcName){jQuery.fn[funcName]=function(margin,value){var chainable=arguments.length&&(defaultExtra||typeof margin!=="boolean"),extra=defaultExtra||(margin===true||value===true?"margin":"border");return access(this,function(elem,type,value){var doc;if(jQuery.isWindow(elem)){return elem.document.documentElement["client"+name]}if(elem.nodeType===9){doc=elem.documentElement;return Math.max(elem.body["scroll"+name],doc["scroll"+name],elem.body["offset"+name],doc["offset"+name],doc["client"+name])}return value===undefined?jQuery.css(elem,type,extra):jQuery.style(elem,type,value,extra)},type,chainable?margin:undefined,chainable,null)}})});jQuery.fn.size=function(){return this.length};jQuery.fn.andSelf=jQuery.fn.addBack;if(typeof define==="function"&&define.amd){define("jquery",[],function(){return jQuery})}var _jQuery=window.jQuery,_$=window.$;jQuery.noConflict=function(deep){if(window.$===jQuery){window.$=_$}if(deep&&window.jQuery===jQuery){window.jQuery=_jQuery}return jQuery};if(typeof noGlobal===strundefined){window.jQuery=window.$=jQuery}return jQuery}));
/*! jQuery UI - v1.11.3 - 2015-02-23
* http://jqueryui.com
* Includes: core.js, widget.js, mouse.js, position.js, draggable.js, droppable.js, resizable.js, selectable.js, sortable.js, accordion.js, autocomplete.js, button.js, datepicker.js, dialog.js, menu.js, progressbar.js, slider.js, tabs.js, effect.js, effect-blind.js, effect-bounce.js, effect-clip.js, effect-drop.js, effect-explode.js, effect-fade.js, effect-fold.js, effect-highlight.js, effect-puff.js, effect-pulsate.js, effect-scale.js, effect-shake.js, effect-size.js, effect-slide.js, effect-transfer.js
* Copyright 2015 jQuery Foundation and other contributors; Licensed MIT */
(function(a){if(typeof define==="function"&&define.amd){define(["jquery"],a)}else{a(jQuery)}}(function(I){
/*!
 * jQuery UI Core 1.11.3
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/category/ui-core/
 */
I.ui=I.ui||{};I.extend(I.ui,{version:"1.11.3",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}});I.fn.extend({scrollParent:function(ad){var ac=this.css("position"),ab=ac==="absolute",ae=ad?/(auto|scroll|hidden)/:/(auto|scroll)/,af=this.parents().filter(function(){var ag=I(this);if(ab&&ag.css("position")==="static"){return false}return ae.test(ag.css("overflow")+ag.css("overflow-y")+ag.css("overflow-x"))}).eq(0);return ac==="fixed"||!af.length?I(this[0].ownerDocument||document):af},uniqueId:(function(){var ab=0;return function(){return this.each(function(){if(!this.id){this.id="ui-id-"+(++ab)}})}})(),removeUniqueId:function(){return this.each(function(){if(/^ui-id-\d+$/.test(this.id)){I(this).removeAttr("id")}})}});function v(ad,ab){var af,ae,ac,ag=ad.nodeName.toLowerCase();if("area"===ag){af=ad.parentNode;ae=af.name;if(!ad.href||!ae||af.nodeName.toLowerCase()!=="map"){return false}ac=I("img[usemap='#"+ae+"']")[0];return !!ac&&w(ac)}return(/^(input|select|textarea|button|object)$/.test(ag)?!ad.disabled:"a"===ag?ad.href||ab:ab)&&w(ad)}function w(ab){return I.expr.filters.visible(ab)&&!I(ab).parents().addBack().filter(function(){return I.css(this,"visibility")==="hidden"}).length}I.extend(I.expr[":"],{data:I.expr.createPseudo?I.expr.createPseudo(function(ab){return function(ac){return !!I.data(ac,ab)}}):function(ad,ac,ab){return !!I.data(ad,ab[3])},focusable:function(ab){return v(ab,!isNaN(I.attr(ab,"tabindex")))},tabbable:function(ad){var ab=I.attr(ad,"tabindex"),ac=isNaN(ab);return(ac||ab>=0)&&v(ad,!ac)}});if(!I("<a>").outerWidth(1).jquery){I.each(["Width","Height"],function(ad,ab){var ac=ab==="Width"?["Left","Right"]:["Top","Bottom"],ae=ab.toLowerCase(),ag={innerWidth:I.fn.innerWidth,innerHeight:I.fn.innerHeight,outerWidth:I.fn.outerWidth,outerHeight:I.fn.outerHeight};function af(aj,ai,ah,ak){I.each(ac,function(){ai-=parseFloat(I.css(aj,"padding"+this))||0;if(ah){ai-=parseFloat(I.css(aj,"border"+this+"Width"))||0}if(ak){ai-=parseFloat(I.css(aj,"margin"+this))||0}});return ai}I.fn["inner"+ab]=function(ah){if(ah===undefined){return ag["inner"+ab].call(this)}return this.each(function(){I(this).css(ae,af(this,ah)+"px")})};I.fn["outer"+ab]=function(ah,ai){if(typeof ah!=="number"){return ag["outer"+ab].call(this,ah)}return this.each(function(){I(this).css(ae,af(this,ah,true,ai)+"px")})}})}if(!I.fn.addBack){I.fn.addBack=function(ab){return this.add(ab==null?this.prevObject:this.prevObject.filter(ab))}}if(I("<a>").data("a-b","a").removeData("a-b").data("a-b")){I.fn.removeData=(function(ab){return function(ac){if(arguments.length){return ab.call(this,I.camelCase(ac))}else{return ab.call(this)}}})(I.fn.removeData)}I.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase());I.fn.extend({focus:(function(ab){return function(ac,ad){return typeof ac==="number"?this.each(function(){var ae=this;setTimeout(function(){I(ae).focus();if(ad){ad.call(ae)}},ac)}):ab.apply(this,arguments)}})(I.fn.focus),disableSelection:(function(){var ab="onselectstart" in document.createElement("div")?"selectstart":"mousedown";return function(){return this.bind(ab+".ui-disableSelection",function(ac){ac.preventDefault()})}})(),enableSelection:function(){return this.unbind(".ui-disableSelection")},zIndex:function(ae){if(ae!==undefined){return this.css("zIndex",ae)}if(this.length){var ac=I(this[0]),ab,ad;while(ac.length&&ac[0]!==document){ab=ac.css("position");if(ab==="absolute"||ab==="relative"||ab==="fixed"){ad=parseInt(ac.css("zIndex"),10);if(!isNaN(ad)&&ad!==0){return ad}}ac=ac.parent()}}return 0}});I.ui.plugin={add:function(ac,ad,af){var ab,ae=I.ui[ac].prototype;for(ab in af){ae.plugins[ab]=ae.plugins[ab]||[];ae.plugins[ab].push([ad,af[ab]])}},call:function(ab,ae,ad,ac){var af,ag=ab.plugins[ae];if(!ag){return}if(!ac&&(!ab.element[0].parentNode||ab.element[0].parentNode.nodeType===11)){return}for(af=0;af<ag.length;af++){if(ab.options[ag[af][0]]){ag[af][1].apply(ab.element,ad)}}}};
/*!
 * jQuery UI Widget 1.11.3
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/jQuery.widget/
 */
var M=0,j=Array.prototype.slice;I.cleanData=(function(ab){return function(ac){var ae,af,ad;for(ad=0;(af=ac[ad])!=null;ad++){try{ae=I._data(af,"events");if(ae&&ae.remove){I(af).triggerHandler("remove")}}catch(ag){}}ab(ac)}})(I.cleanData);I.widget=function(ab,ac,aj){var ag,ah,ae,ai,ad={},af=ab.split(".")[0];ab=ab.split(".")[1];ag=af+"-"+ab;if(!aj){aj=ac;ac=I.Widget}I.expr[":"][ag.toLowerCase()]=function(ak){return !!I.data(ak,ag)};I[af]=I[af]||{};ah=I[af][ab];ae=I[af][ab]=function(ak,al){if(!this._createWidget){return new ae(ak,al)}if(arguments.length){this._createWidget(ak,al)}};I.extend(ae,ah,{version:aj.version,_proto:I.extend({},aj),_childConstructors:[]});ai=new ac();ai.options=I.widget.extend({},ai.options);I.each(aj,function(al,ak){if(!I.isFunction(ak)){ad[al]=ak;return}ad[al]=(function(){var am=function(){return ac.prototype[al].apply(this,arguments)},an=function(ao){return ac.prototype[al].apply(this,ao)};return function(){var aq=this._super,ao=this._superApply,ap;this._super=am;this._superApply=an;ap=ak.apply(this,arguments);this._super=aq;this._superApply=ao;return ap}})()});ae.prototype=I.widget.extend(ai,{widgetEventPrefix:ah?(ai.widgetEventPrefix||ab):ab},ad,{constructor:ae,namespace:af,widgetName:ab,widgetFullName:ag});if(ah){I.each(ah._childConstructors,function(al,am){var ak=am.prototype;I.widget(ak.namespace+"."+ak.widgetName,ae,am._proto)});delete ah._childConstructors}else{ac._childConstructors.push(ae)}I.widget.bridge(ab,ae);return ae};I.widget.extend=function(ag){var ac=j.call(arguments,1),af=0,ab=ac.length,ad,ae;for(;af<ab;af++){for(ad in ac[af]){ae=ac[af][ad];if(ac[af].hasOwnProperty(ad)&&ae!==undefined){if(I.isPlainObject(ae)){ag[ad]=I.isPlainObject(ag[ad])?I.widget.extend({},ag[ad],ae):I.widget.extend({},ae)}else{ag[ad]=ae}}}}return ag};I.widget.bridge=function(ac,ab){var ad=ab.prototype.widgetFullName||ac;I.fn[ac]=function(ag){var ae=typeof ag==="string",af=j.call(arguments,1),ah=this;if(ae){this.each(function(){var aj,ai=I.data(this,ad);if(ag==="instance"){ah=ai;return false}if(!ai){return I.error("cannot call methods on "+ac+" prior to initialization; attempted to call method '"+ag+"'")}if(!I.isFunction(ai[ag])||ag.charAt(0)==="_"){return I.error("no such method '"+ag+"' for "+ac+" widget instance")}aj=ai[ag].apply(ai,af);if(aj!==ai&&aj!==undefined){ah=aj&&aj.jquery?ah.pushStack(aj.get()):aj;return false}})}else{if(af.length){ag=I.widget.extend.apply(null,[ag].concat(af))}this.each(function(){var ai=I.data(this,ad);if(ai){ai.option(ag||{});if(ai._init){ai._init()}}else{I.data(this,ad,new ab(ag,this))}})}return ah}};I.Widget=function(){};I.Widget._childConstructors=[];I.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:false,create:null},_createWidget:function(ab,ac){ac=I(ac||this.defaultElement||this)[0];this.element=I(ac);this.uuid=M++;this.eventNamespace="."+this.widgetName+this.uuid;this.bindings=I();this.hoverable=I();this.focusable=I();if(ac!==this){I.data(ac,this.widgetFullName,this);this._on(true,this.element,{remove:function(ad){if(ad.target===ac){this.destroy()}}});this.document=I(ac.style?ac.ownerDocument:ac.document||ac);this.window=I(this.document[0].defaultView||this.document[0].parentWindow)}this.options=I.widget.extend({},this.options,this._getCreateOptions(),ab);this._create();this._trigger("create",null,this._getCreateEventData());this._init()},_getCreateOptions:I.noop,_getCreateEventData:I.noop,_create:I.noop,_init:I.noop,destroy:function(){this._destroy();this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData(I.camelCase(this.widgetFullName));this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled");this.bindings.unbind(this.eventNamespace);this.hoverable.removeClass("ui-state-hover");this.focusable.removeClass("ui-state-focus")},_destroy:I.noop,widget:function(){return this.element},option:function(ae,af){var ab=ae,ag,ad,ac;if(arguments.length===0){return I.widget.extend({},this.options)}if(typeof ae==="string"){ab={};ag=ae.split(".");ae=ag.shift();if(ag.length){ad=ab[ae]=I.widget.extend({},this.options[ae]);for(ac=0;ac<ag.length-1;ac++){ad[ag[ac]]=ad[ag[ac]]||{};ad=ad[ag[ac]]}ae=ag.pop();if(arguments.length===1){return ad[ae]===undefined?null:ad[ae]}ad[ae]=af}else{if(arguments.length===1){return this.options[ae]===undefined?null:this.options[ae]}ab[ae]=af}}this._setOptions(ab);return this},_setOptions:function(ab){var ac;for(ac in ab){this._setOption(ac,ab[ac])}return this},_setOption:function(ab,ac){this.options[ab]=ac;if(ab==="disabled"){this.widget().toggleClass(this.widgetFullName+"-disabled",!!ac);if(ac){this.hoverable.removeClass("ui-state-hover");this.focusable.removeClass("ui-state-focus")}}return this},enable:function(){return this._setOptions({disabled:false})},disable:function(){return this._setOptions({disabled:true})},_on:function(ae,ad,ac){var af,ab=this;if(typeof ae!=="boolean"){ac=ad;ad=ae;ae=false}if(!ac){ac=ad;ad=this.element;af=this.widget()}else{ad=af=I(ad);this.bindings=this.bindings.add(ad)}I.each(ac,function(al,ak){function ai(){if(!ae&&(ab.options.disabled===true||I(this).hasClass("ui-state-disabled"))){return}return(typeof ak==="string"?ab[ak]:ak).apply(ab,arguments)}if(typeof ak!=="string"){ai.guid=ak.guid=ak.guid||ai.guid||I.guid++}var aj=al.match(/^([\w:-]*)\s*(.*)$/),ah=aj[1]+ab.eventNamespace,ag=aj[2];if(ag){af.delegate(ag,ah,ai)}else{ad.bind(ah,ai)}})},_off:function(ac,ab){ab=(ab||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace;ac.unbind(ab).undelegate(ab);this.bindings=I(this.bindings.not(ac).get());this.focusable=I(this.focusable.not(ac).get());this.hoverable=I(this.hoverable.not(ac).get())},_delay:function(ae,ad){function ac(){return(typeof ae==="string"?ab[ae]:ae).apply(ab,arguments)}var ab=this;return setTimeout(ac,ad||0)},_hoverable:function(ab){this.hoverable=this.hoverable.add(ab);this._on(ab,{mouseenter:function(ac){I(ac.currentTarget).addClass("ui-state-hover")},mouseleave:function(ac){I(ac.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(ab){this.focusable=this.focusable.add(ab);this._on(ab,{focusin:function(ac){I(ac.currentTarget).addClass("ui-state-focus")},focusout:function(ac){I(ac.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(ab,ac,ad){var ag,af,ae=this.options[ab];ad=ad||{};ac=I.Event(ac);ac.type=(ab===this.widgetEventPrefix?ab:this.widgetEventPrefix+ab).toLowerCase();ac.target=this.element[0];af=ac.originalEvent;if(af){for(ag in af){if(!(ag in ac)){ac[ag]=af[ag]}}}this.element.trigger(ac,ad);return !(I.isFunction(ae)&&ae.apply(this.element[0],[ac].concat(ad))===false||ac.isDefaultPrevented())}};I.each({show:"fadeIn",hide:"fadeOut"},function(ac,ab){I.Widget.prototype["_"+ac]=function(af,ae,ah){if(typeof ae==="string"){ae={effect:ae}}var ag,ad=!ae?ac:ae===true||typeof ae==="number"?ab:ae.effect||ab;ae=ae||{};if(typeof ae==="number"){ae={duration:ae}}ag=!I.isEmptyObject(ae);ae.complete=ah;if(ae.delay){af.delay(ae.delay)}if(ag&&I.effects&&I.effects.effect[ad]){af[ac](ae)}else{if(ad!==ac&&af[ad]){af[ad](ae.duration,ae.easing,ah)}else{af.queue(function(ai){I(this)[ac]();if(ah){ah.call(af[0])}ai()})}}}});var J=I.widget;
/*!
 * jQuery UI Mouse 1.11.3
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/mouse/
 */
var b=false;I(document).mouseup(function(){b=false});var G=I.widget("ui.mouse",{version:"1.11.3",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var ab=this;this.element.bind("mousedown."+this.widgetName,function(ac){return ab._mouseDown(ac)}).bind("click."+this.widgetName,function(ac){if(true===I.data(ac.target,ab.widgetName+".preventClickEvent")){I.removeData(ac.target,ab.widgetName+".preventClickEvent");ac.stopImmediatePropagation();return false}});this.started=false},_mouseDestroy:function(){this.element.unbind("."+this.widgetName);if(this._mouseMoveDelegate){this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)}},_mouseDown:function(ad){if(b){return}this._mouseMoved=false;(this._mouseStarted&&this._mouseUp(ad));this._mouseDownEvent=ad;var ac=this,ae=(ad.which===1),ab=(typeof this.options.cancel==="string"&&ad.target.nodeName?I(ad.target).closest(this.options.cancel).length:false);if(!ae||ab||!this._mouseCapture(ad)){return true}this.mouseDelayMet=!this.options.delay;if(!this.mouseDelayMet){this._mouseDelayTimer=setTimeout(function(){ac.mouseDelayMet=true},this.options.delay)}if(this._mouseDistanceMet(ad)&&this._mouseDelayMet(ad)){this._mouseStarted=(this._mouseStart(ad)!==false);if(!this._mouseStarted){ad.preventDefault();return true}}if(true===I.data(ad.target,this.widgetName+".preventClickEvent")){I.removeData(ad.target,this.widgetName+".preventClickEvent")}this._mouseMoveDelegate=function(af){return ac._mouseMove(af)};this._mouseUpDelegate=function(af){return ac._mouseUp(af)};this.document.bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate);ad.preventDefault();b=true;return true},_mouseMove:function(ab){if(this._mouseMoved){if(I.ui.ie&&(!document.documentMode||document.documentMode<9)&&!ab.button){return this._mouseUp(ab)}else{if(!ab.which){return this._mouseUp(ab)}}}if(ab.which||ab.button){this._mouseMoved=true}if(this._mouseStarted){this._mouseDrag(ab);return ab.preventDefault()}if(this._mouseDistanceMet(ab)&&this._mouseDelayMet(ab)){this._mouseStarted=(this._mouseStart(this._mouseDownEvent,ab)!==false);(this._mouseStarted?this._mouseDrag(ab):this._mouseUp(ab))}return !this._mouseStarted},_mouseUp:function(ab){this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate);if(this._mouseStarted){this._mouseStarted=false;if(ab.target===this._mouseDownEvent.target){I.data(ab.target,this.widgetName+".preventClickEvent",true)}this._mouseStop(ab)}b=false;return false},_mouseDistanceMet:function(ab){return(Math.max(Math.abs(this._mouseDownEvent.pageX-ab.pageX),Math.abs(this._mouseDownEvent.pageY-ab.pageY))>=this.options.distance)},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return true}});
/*!
 * jQuery UI Position 1.11.3
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/position/
 */
(function(){I.ui=I.ui||{};var ai,al,aj=Math.max,ao=Math.abs,am=Math.round,ad=/left|center|right/,ag=/top|center|bottom/,ab=/[\+\-]\d+(\.[\d]+)?%?/,ak=/^\w+/,ac=/%$/,af=I.fn.position;function an(ar,aq,ap){return[parseFloat(ar[0])*(ac.test(ar[0])?aq/100:1),parseFloat(ar[1])*(ac.test(ar[1])?ap/100:1)]}function ah(ap,aq){return parseInt(I.css(ap,aq),10)||0}function ae(aq){var ap=aq[0];if(ap.nodeType===9){return{width:aq.width(),height:aq.height(),offset:{top:0,left:0}}}if(I.isWindow(ap)){return{width:aq.width(),height:aq.height(),offset:{top:aq.scrollTop(),left:aq.scrollLeft()}}}if(ap.preventDefault){return{width:0,height:0,offset:{top:ap.pageY,left:ap.pageX}}}return{width:aq.outerWidth(),height:aq.outerHeight(),offset:aq.offset()}}I.position={scrollbarWidth:function(){if(ai!==undefined){return ai}var aq,ap,at=I("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),ar=at.children()[0];I("body").append(at);aq=ar.offsetWidth;at.css("overflow","scroll");ap=ar.offsetWidth;if(aq===ap){ap=at[0].clientWidth}at.remove();return(ai=aq-ap)},getScrollInfo:function(au){var at=au.isWindow||au.isDocument?"":au.element.css("overflow-x"),ar=au.isWindow||au.isDocument?"":au.element.css("overflow-y"),aq=at==="scroll"||(at==="auto"&&au.width<au.element[0].scrollWidth),ap=ar==="scroll"||(ar==="auto"&&au.height<au.element[0].scrollHeight);return{width:ap?I.position.scrollbarWidth():0,height:aq?I.position.scrollbarWidth():0}},getWithinInfo:function(aq){var ar=I(aq||window),ap=I.isWindow(ar[0]),at=!!ar[0]&&ar[0].nodeType===9;return{element:ar,isWindow:ap,isDocument:at,offset:ar.offset()||{left:0,top:0},scrollLeft:ar.scrollLeft(),scrollTop:ar.scrollTop(),width:ap||at?ar.width():ar.outerWidth(),height:ap||at?ar.height():ar.outerHeight()}}};I.fn.position=function(aA){if(!aA||!aA.of){return af.apply(this,arguments)}aA=I.extend({},aA);var aB,ax,av,az,au,ap,aw=I(aA.of),at=I.position.getWithinInfo(aA.within),aq=I.position.getScrollInfo(at),ay=(aA.collision||"flip").split(" "),ar={};ap=ae(aw);if(aw[0].preventDefault){aA.at="left top"}ax=ap.width;av=ap.height;az=ap.offset;au=I.extend({},az);I.each(["my","at"],function(){var aE=(aA[this]||"").split(" "),aD,aC;if(aE.length===1){aE=ad.test(aE[0])?aE.concat(["center"]):ag.test(aE[0])?["center"].concat(aE):["center","center"]}aE[0]=ad.test(aE[0])?aE[0]:"center";aE[1]=ag.test(aE[1])?aE[1]:"center";aD=ab.exec(aE[0]);aC=ab.exec(aE[1]);ar[this]=[aD?aD[0]:0,aC?aC[0]:0];aA[this]=[ak.exec(aE[0])[0],ak.exec(aE[1])[0]]});if(ay.length===1){ay[1]=ay[0]}if(aA.at[0]==="right"){au.left+=ax}else{if(aA.at[0]==="center"){au.left+=ax/2}}if(aA.at[1]==="bottom"){au.top+=av}else{if(aA.at[1]==="center"){au.top+=av/2}}aB=an(ar.at,ax,av);au.left+=aB[0];au.top+=aB[1];return this.each(function(){var aD,aM,aF=I(this),aH=aF.outerWidth(),aE=aF.outerHeight(),aG=ah(this,"marginLeft"),aC=ah(this,"marginTop"),aL=aH+aG+ah(this,"marginRight")+aq.width,aK=aE+aC+ah(this,"marginBottom")+aq.height,aI=I.extend({},au),aJ=an(ar.my,aF.outerWidth(),aF.outerHeight());if(aA.my[0]==="right"){aI.left-=aH}else{if(aA.my[0]==="center"){aI.left-=aH/2}}if(aA.my[1]==="bottom"){aI.top-=aE}else{if(aA.my[1]==="center"){aI.top-=aE/2}}aI.left+=aJ[0];aI.top+=aJ[1];if(!al){aI.left=am(aI.left);aI.top=am(aI.top)}aD={marginLeft:aG,marginTop:aC};I.each(["left","top"],function(aO,aN){if(I.ui.position[ay[aO]]){I.ui.position[ay[aO]][aN](aI,{targetWidth:ax,targetHeight:av,elemWidth:aH,elemHeight:aE,collisionPosition:aD,collisionWidth:aL,collisionHeight:aK,offset:[aB[0]+aJ[0],aB[1]+aJ[1]],my:aA.my,at:aA.at,within:at,elem:aF})}});if(aA.using){aM=function(aQ){var aS=az.left-aI.left,aP=aS+ax-aH,aR=az.top-aI.top,aO=aR+av-aE,aN={target:{element:aw,left:az.left,top:az.top,width:ax,height:av},element:{element:aF,left:aI.left,top:aI.top,width:aH,height:aE},horizontal:aP<0?"left":aS>0?"right":"center",vertical:aO<0?"top":aR>0?"bottom":"middle"};if(ax<aH&&ao(aS+aP)<ax){aN.horizontal="center"}if(av<aE&&ao(aR+aO)<av){aN.vertical="middle"}if(aj(ao(aS),ao(aP))>aj(ao(aR),ao(aO))){aN.important="horizontal"}else{aN.important="vertical"}aA.using.call(this,aQ,aN)}}aF.offset(I.extend(aI,{using:aM}))})};I.ui.position={fit:{left:function(au,at){var ar=at.within,aw=ar.isWindow?ar.scrollLeft:ar.offset.left,ay=ar.width,av=au.left-at.collisionPosition.marginLeft,ax=aw-av,aq=av+at.collisionWidth-ay-aw,ap;if(at.collisionWidth>ay){if(ax>0&&aq<=0){ap=au.left+ax+at.collisionWidth-ay-aw;au.left+=ax-ap}else{if(aq>0&&ax<=0){au.left=aw}else{if(ax>aq){au.left=aw+ay-at.collisionWidth}else{au.left=aw}}}}else{if(ax>0){au.left+=ax}else{if(aq>0){au.left-=aq}else{au.left=aj(au.left-av,au.left)}}}},top:function(at,ar){var aq=ar.within,ax=aq.isWindow?aq.scrollTop:aq.offset.top,ay=ar.within.height,av=at.top-ar.collisionPosition.marginTop,aw=ax-av,au=av+ar.collisionHeight-ay-ax,ap;if(ar.collisionHeight>ay){if(aw>0&&au<=0){ap=at.top+aw+ar.collisionHeight-ay-ax;at.top+=aw-ap}else{if(au>0&&aw<=0){at.top=ax}else{if(aw>au){at.top=ax+ay-ar.collisionHeight}else{at.top=ax}}}}else{if(aw>0){at.top+=aw}else{if(au>0){at.top-=au}else{at.top=aj(at.top-av,at.top)}}}}},flip:{left:function(aw,av){var au=av.within,aA=au.offset.left+au.scrollLeft,aD=au.width,ar=au.isWindow?au.scrollLeft:au.offset.left,ax=aw.left-av.collisionPosition.marginLeft,aB=ax-ar,aq=ax+av.collisionWidth-aD-ar,az=av.my[0]==="left"?-av.elemWidth:av.my[0]==="right"?av.elemWidth:0,aC=av.at[0]==="left"?av.targetWidth:av.at[0]==="right"?-av.targetWidth:0,at=-2*av.offset[0],ap,ay;if(aB<0){ap=aw.left+az+aC+at+av.collisionWidth-aD-aA;if(ap<0||ap<ao(aB)){aw.left+=az+aC+at}}else{if(aq>0){ay=aw.left-av.collisionPosition.marginLeft+az+aC+at-ar;if(ay>0||ao(ay)<aq){aw.left+=az+aC+at}}}},top:function(av,au){var at=au.within,aC=at.offset.top+at.scrollTop,aD=at.height,ap=at.isWindow?at.scrollTop:at.offset.top,ax=av.top-au.collisionPosition.marginTop,az=ax-ap,aw=ax+au.collisionHeight-aD-ap,aA=au.my[1]==="top",ay=aA?-au.elemHeight:au.my[1]==="bottom"?au.elemHeight:0,aE=au.at[1]==="top"?au.targetHeight:au.at[1]==="bottom"?-au.targetHeight:0,ar=-2*au.offset[1],aB,aq;if(az<0){aq=av.top+ay+aE+ar+au.collisionHeight-aD-aC;if(aq<0||aq<ao(az)){av.top+=ay+aE+ar}}else{if(aw>0){aB=av.top-au.collisionPosition.marginTop+ay+aE+ar-ap;if(aB>0||ao(aB)<aw){av.top+=ay+aE+ar}}}}},flipfit:{left:function(){I.ui.position.flip.left.apply(this,arguments);I.ui.position.fit.left.apply(this,arguments)},top:function(){I.ui.position.flip.top.apply(this,arguments);I.ui.position.fit.top.apply(this,arguments)}}};(function(){var au,aw,aq,at,ar,ap=document.getElementsByTagName("body")[0],av=document.createElement("div");au=document.createElement(ap?"div":"body");aq={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"};if(ap){I.extend(aq,{position:"absolute",left:"-1000px",top:"-1000px"})}for(ar in aq){au.style[ar]=aq[ar]}au.appendChild(av);aw=ap||document.documentElement;aw.insertBefore(au,aw.firstChild);av.style.cssText="position: absolute; left: 10.7432222px;";at=I(av).offset().left;al=at>10&&at<11;au.innerHTML="";aw.removeChild(au)})()})();var N=I.ui.position;
/*!
 * jQuery UI Draggable 1.11.3
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/draggable/
 */
I.widget("ui.draggable",I.ui.mouse,{version:"1.11.3",widgetEventPrefix:"drag",options:{addClasses:true,appendTo:"parent",axis:false,connectToSortable:false,containment:false,cursor:"auto",cursorAt:false,grid:false,handle:false,helper:"original",iframeFix:false,opacity:false,refreshPositions:false,revert:false,revertDuration:500,scope:"default",scroll:true,scrollSensitivity:20,scrollSpeed:20,snap:false,snapMode:"both",snapTolerance:20,stack:false,zIndex:false,drag:null,start:null,stop:null},_create:function(){if(this.options.helper==="original"){this._setPositionRelative()}if(this.options.addClasses){this.element.addClass("ui-draggable")}if(this.options.disabled){this.element.addClass("ui-draggable-disabled")}this._setHandleClassName();this._mouseInit()},_setOption:function(ab,ac){this._super(ab,ac);if(ab==="handle"){this._removeHandleClassName();this._setHandleClassName()}},_destroy:function(){if((this.helper||this.element).is(".ui-draggable-dragging")){this.destroyOnClear=true;return}this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled");this._removeHandleClassName();this._mouseDestroy()},_mouseCapture:function(ab){var ac=this.options;this._blurActiveElement(ab);if(this.helper||ac.disabled||I(ab.target).closest(".ui-resizable-handle").length>0){return false}this.handle=this._getHandle(ab);if(!this.handle){return false}this._blockFrames(ac.iframeFix===true?"iframe":ac.iframeFix);return true},_blockFrames:function(ab){this.iframeBlocks=this.document.find(ab).map(function(){var ac=I(this);return I("<div>").css("position","absolute").appendTo(ac.parent()).outerWidth(ac.outerWidth()).outerHeight(ac.outerHeight()).offset(ac.offset())[0]})},_unblockFrames:function(){if(this.iframeBlocks){this.iframeBlocks.remove();delete this.iframeBlocks}},_blurActiveElement:function(ad){var ab=this.document[0];if(!this.handleElement.is(ad.target)){return}try{if(ab.activeElement&&ab.activeElement.nodeName.toLowerCase()!=="body"){I(ab.activeElement).blur()}}catch(ac){}},_mouseStart:function(ab){var ac=this.options;this.helper=this._createHelper(ab);this.helper.addClass("ui-draggable-dragging");this._cacheHelperProportions();if(I.ui.ddmanager){I.ui.ddmanager.current=this}this._cacheMargins();this.cssPosition=this.helper.css("position");this.scrollParent=this.helper.scrollParent(true);this.offsetParent=this.helper.offsetParent();this.hasFixedAncestor=this.helper.parents().filter(function(){return I(this).css("position")==="fixed"}).length>0;this.positionAbs=this.element.offset();this._refreshOffsets(ab);this.originalPosition=this.position=this._generatePosition(ab,false);this.originalPageX=ab.pageX;this.originalPageY=ab.pageY;(ac.cursorAt&&this._adjustOffsetFromHelper(ac.cursorAt));this._setContainment();if(this._trigger("start",ab)===false){this._clear();return false}this._cacheHelperProportions();if(I.ui.ddmanager&&!ac.dropBehaviour){I.ui.ddmanager.prepareOffsets(this,ab)}this._normalizeRightBottom();this._mouseDrag(ab,true);if(I.ui.ddmanager){I.ui.ddmanager.dragStart(this,ab)}return true},_refreshOffsets:function(ab){this.offset={top:this.positionAbs.top-this.margins.top,left:this.positionAbs.left-this.margins.left,scroll:false,parent:this._getParentOffset(),relative:this._getRelativeOffset()};this.offset.click={left:ab.pageX-this.offset.left,top:ab.pageY-this.offset.top}},_mouseDrag:function(ab,ad){if(this.hasFixedAncestor){this.offset.parent=this._getParentOffset()}this.position=this._generatePosition(ab,true);this.positionAbs=this._convertPositionTo("absolute");if(!ad){var ac=this._uiHash();if(this._trigger("drag",ab,ac)===false){this._mouseUp({});return false}this.position=ac.position}this.helper[0].style.left=this.position.left+"px";this.helper[0].style.top=this.position.top+"px";if(I.ui.ddmanager){I.ui.ddmanager.drag(this,ab)}return false},_mouseStop:function(ac){var ab=this,ad=false;if(I.ui.ddmanager&&!this.options.dropBehaviour){ad=I.ui.ddmanager.drop(this,ac)}if(this.dropped){ad=this.dropped;this.dropped=false}if((this.options.revert==="invalid"&&!ad)||(this.options.revert==="valid"&&ad)||this.options.revert===true||(I.isFunction(this.options.revert)&&this.options.revert.call(this.element,ad))){I(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){if(ab._trigger("stop",ac)!==false){ab._clear()}})}else{if(this._trigger("stop",ac)!==false){this._clear()}}return false},_mouseUp:function(ab){this._unblockFrames();if(I.ui.ddmanager){I.ui.ddmanager.dragStop(this,ab)}if(this.handleElement.is(ab.target)){this.element.focus()}return I.ui.mouse.prototype._mouseUp.call(this,ab)},cancel:function(){if(this.helper.is(".ui-draggable-dragging")){this._mouseUp({})}else{this._clear()}return this},_getHandle:function(ab){return this.options.handle?!!I(ab.target).closest(this.element.find(this.options.handle)).length:true},_setHandleClassName:function(){this.handleElement=this.options.handle?this.element.find(this.options.handle):this.element;this.handleElement.addClass("ui-draggable-handle")},_removeHandleClassName:function(){this.handleElement.removeClass("ui-draggable-handle")},_createHelper:function(ac){var ae=this.options,ad=I.isFunction(ae.helper),ab=ad?I(ae.helper.apply(this.element[0],[ac])):(ae.helper==="clone"?this.element.clone().removeAttr("id"):this.element);if(!ab.parents("body").length){ab.appendTo((ae.appendTo==="parent"?this.element[0].parentNode:ae.appendTo))}if(ad&&ab[0]===this.element[0]){this._setPositionRelative()}if(ab[0]!==this.element[0]&&!(/(fixed|absolute)/).test(ab.css("position"))){ab.css("position","absolute")}return ab},_setPositionRelative:function(){if(!(/^(?:r|a|f)/).test(this.element.css("position"))){this.element[0].style.position="relative"}},_adjustOffsetFromHelper:function(ab){if(typeof ab==="string"){ab=ab.split(" ")}if(I.isArray(ab)){ab={left:+ab[0],top:+ab[1]||0}}if("left" in ab){this.offset.click.left=ab.left+this.margins.left}if("right" in ab){this.offset.click.left=this.helperProportions.width-ab.right+this.margins.left}if("top" in ab){this.offset.click.top=ab.top+this.margins.top}if("bottom" in ab){this.offset.click.top=this.helperProportions.height-ab.bottom+this.margins.top}},_isRootNode:function(ab){return(/(html|body)/i).test(ab.tagName)||ab===this.document[0]},_getParentOffset:function(){var ac=this.offsetParent.offset(),ab=this.document[0];if(this.cssPosition==="absolute"&&this.scrollParent[0]!==ab&&I.contains(this.scrollParent[0],this.offsetParent[0])){ac.left+=this.scrollParent.scrollLeft();ac.top+=this.scrollParent.scrollTop()}if(this._isRootNode(this.offsetParent[0])){ac={top:0,left:0}}return{top:ac.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:ac.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition!=="relative"){return{top:0,left:0}}var ab=this.element.position(),ac=this._isRootNode(this.scrollParent[0]);return{top:ab.top-(parseInt(this.helper.css("top"),10)||0)+(!ac?this.scrollParent.scrollTop():0),left:ab.left-(parseInt(this.helper.css("left"),10)||0)+(!ac?this.scrollParent.scrollLeft():0)}},_cacheMargins:function(){this.margins={left:(parseInt(this.element.css("marginLeft"),10)||0),top:(parseInt(this.element.css("marginTop"),10)||0),right:(parseInt(this.element.css("marginRight"),10)||0),bottom:(parseInt(this.element.css("marginBottom"),10)||0)}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var ac,af,ad,ae=this.options,ab=this.document[0];this.relativeContainer=null;if(!ae.containment){this.containment=null;return}if(ae.containment==="window"){this.containment=[I(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,I(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,I(window).scrollLeft()+I(window).width()-this.helperProportions.width-this.margins.left,I(window).scrollTop()+(I(window).height()||ab.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];return}if(ae.containment==="document"){this.containment=[0,0,I(ab).width()-this.helperProportions.width-this.margins.left,(I(ab).height()||ab.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];return}if(ae.containment.constructor===Array){this.containment=ae.containment;return}if(ae.containment==="parent"){ae.containment=this.helper[0].parentNode}af=I(ae.containment);ad=af[0];if(!ad){return}ac=/(scroll|auto)/.test(af.css("overflow"));this.containment=[(parseInt(af.css("borderLeftWidth"),10)||0)+(parseInt(af.css("paddingLeft"),10)||0),(parseInt(af.css("borderTopWidth"),10)||0)+(parseInt(af.css("paddingTop"),10)||0),(ac?Math.max(ad.scrollWidth,ad.offsetWidth):ad.offsetWidth)-(parseInt(af.css("borderRightWidth"),10)||0)-(parseInt(af.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(ac?Math.max(ad.scrollHeight,ad.offsetHeight):ad.offsetHeight)-(parseInt(af.css("borderBottomWidth"),10)||0)-(parseInt(af.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom];this.relativeContainer=af},_convertPositionTo:function(ac,ae){if(!ae){ae=this.position}var ab=ac==="absolute"?1:-1,ad=this._isRootNode(this.scrollParent[0]);return{top:(ae.top+this.offset.relative.top*ab+this.offset.parent.top*ab-((this.cssPosition==="fixed"?-this.offset.scroll.top:(ad?0:this.offset.scroll.top))*ab)),left:(ae.left+this.offset.relative.left*ab+this.offset.parent.left*ab-((this.cssPosition==="fixed"?-this.offset.scroll.left:(ad?0:this.offset.scroll.left))*ab))}},_generatePosition:function(ac,ai){var ab,aj,ak,ae,ad=this.options,ah=this._isRootNode(this.scrollParent[0]),ag=ac.pageX,af=ac.pageY;if(!ah||!this.offset.scroll){this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()}}if(ai){if(this.containment){if(this.relativeContainer){aj=this.relativeContainer.offset();ab=[this.containment[0]+aj.left,this.containment[1]+aj.top,this.containment[2]+aj.left,this.containment[3]+aj.top]}else{ab=this.containment}if(ac.pageX-this.offset.click.left<ab[0]){ag=ab[0]+this.offset.click.left}if(ac.pageY-this.offset.click.top<ab[1]){af=ab[1]+this.offset.click.top}if(ac.pageX-this.offset.click.left>ab[2]){ag=ab[2]+this.offset.click.left}if(ac.pageY-this.offset.click.top>ab[3]){af=ab[3]+this.offset.click.top}}if(ad.grid){ak=ad.grid[1]?this.originalPageY+Math.round((af-this.originalPageY)/ad.grid[1])*ad.grid[1]:this.originalPageY;af=ab?((ak-this.offset.click.top>=ab[1]||ak-this.offset.click.top>ab[3])?ak:((ak-this.offset.click.top>=ab[1])?ak-ad.grid[1]:ak+ad.grid[1])):ak;ae=ad.grid[0]?this.originalPageX+Math.round((ag-this.originalPageX)/ad.grid[0])*ad.grid[0]:this.originalPageX;ag=ab?((ae-this.offset.click.left>=ab[0]||ae-this.offset.click.left>ab[2])?ae:((ae-this.offset.click.left>=ab[0])?ae-ad.grid[0]:ae+ad.grid[0])):ae}if(ad.axis==="y"){ag=this.originalPageX}if(ad.axis==="x"){af=this.originalPageY}}return{top:(af-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(this.cssPosition==="fixed"?-this.offset.scroll.top:(ah?0:this.offset.scroll.top))),left:(ag-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(this.cssPosition==="fixed"?-this.offset.scroll.left:(ah?0:this.offset.scroll.left)))}},_clear:function(){this.helper.removeClass("ui-draggable-dragging");if(this.helper[0]!==this.element[0]&&!this.cancelHelperRemoval){this.helper.remove()}this.helper=null;this.cancelHelperRemoval=false;if(this.destroyOnClear){this.destroy()}},_normalizeRightBottom:function(){if(this.options.axis!=="y"&&this.helper.css("right")!=="auto"){this.helper.width(this.helper.width());this.helper.css("right","auto")}if(this.options.axis!=="x"&&this.helper.css("bottom")!=="auto"){this.helper.height(this.helper.height());this.helper.css("bottom","auto")}},_trigger:function(ab,ac,ad){ad=ad||this._uiHash();I.ui.plugin.call(this,ab,[ac,ad,this],true);if(/^(drag|start|stop)/.test(ab)){this.positionAbs=this._convertPositionTo("absolute");ad.offset=this.positionAbs}return I.Widget.prototype._trigger.call(this,ab,ac,ad)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}});I.ui.plugin.add("draggable","connectToSortable",{start:function(ad,ae,ab){var ac=I.extend({},ae,{item:ab.element});ab.sortables=[];I(ab.options.connectToSortable).each(function(){var af=I(this).sortable("instance");if(af&&!af.options.disabled){ab.sortables.push(af);af.refreshPositions();af._trigger("activate",ad,ac)}})},stop:function(ad,ae,ab){var ac=I.extend({},ae,{item:ab.element});ab.cancelHelperRemoval=false;I.each(ab.sortables,function(){var af=this;if(af.isOver){af.isOver=0;ab.cancelHelperRemoval=true;af.cancelHelperRemoval=false;af._storedCSS={position:af.placeholder.css("position"),top:af.placeholder.css("top"),left:af.placeholder.css("left")};af._mouseStop(ad);af.options.helper=af.options._helper}else{af.cancelHelperRemoval=true;af._trigger("deactivate",ad,ac)}})},drag:function(ac,ad,ab){I.each(ab.sortables,function(){var ae=false,af=this;af.positionAbs=ab.positionAbs;af.helperProportions=ab.helperProportions;af.offset.click=ab.offset.click;if(af._intersectsWith(af.containerCache)){ae=true;I.each(ab.sortables,function(){this.positionAbs=ab.positionAbs;this.helperProportions=ab.helperProportions;this.offset.click=ab.offset.click;if(this!==af&&this._intersectsWith(this.containerCache)&&I.contains(af.element[0],this.element[0])){ae=false}return ae})}if(ae){if(!af.isOver){af.isOver=1;af.currentItem=ad.helper.appendTo(af.element).data("ui-sortable-item",true);af.options._helper=af.options.helper;af.options.helper=function(){return ad.helper[0]};ac.target=af.currentItem[0];af._mouseCapture(ac,true);af._mouseStart(ac,true,true);af.offset.click.top=ab.offset.click.top;af.offset.click.left=ab.offset.click.left;af.offset.parent.left-=ab.offset.parent.left-af.offset.parent.left;af.offset.parent.top-=ab.offset.parent.top-af.offset.parent.top;ab._trigger("toSortable",ac);ab.dropped=af.element;I.each(ab.sortables,function(){this.refreshPositions()});ab.currentItem=ab.element;af.fromOutside=ab}if(af.currentItem){af._mouseDrag(ac);ad.position=af.position}}else{if(af.isOver){af.isOver=0;af.cancelHelperRemoval=true;af.options._revert=af.options.revert;af.options.revert=false;af._trigger("out",ac,af._uiHash(af));af._mouseStop(ac,true);af.options.revert=af.options._revert;af.options.helper=af.options._helper;if(af.placeholder){af.placeholder.remove()}ab._refreshOffsets(ac);ad.position=ab._generatePosition(ac,true);ab._trigger("fromSortable",ac);ab.dropped=false;I.each(ab.sortables,function(){this.refreshPositions()})}}})}});I.ui.plugin.add("draggable","cursor",{start:function(ad,ae,ab){var ac=I("body"),af=ab.options;if(ac.css("cursor")){af._cursor=ac.css("cursor")}ac.css("cursor",af.cursor)},stop:function(ac,ad,ab){var ae=ab.options;if(ae._cursor){I("body").css("cursor",ae._cursor)}}});I.ui.plugin.add("draggable","opacity",{start:function(ad,ae,ab){var ac=I(ae.helper),af=ab.options;if(ac.css("opacity")){af._opacity=ac.css("opacity")}ac.css("opacity",af.opacity)},stop:function(ac,ad,ab){var ae=ab.options;if(ae._opacity){I(ad.helper).css("opacity",ae._opacity)}}});I.ui.plugin.add("draggable","scroll",{start:function(ac,ad,ab){if(!ab.scrollParentNotHidden){ab.scrollParentNotHidden=ab.helper.scrollParent(false)}if(ab.scrollParentNotHidden[0]!==ab.document[0]&&ab.scrollParentNotHidden[0].tagName!=="HTML"){ab.overflowOffset=ab.scrollParentNotHidden.offset()}},drag:function(ae,af,ad){var ag=ad.options,ac=false,ah=ad.scrollParentNotHidden[0],ab=ad.document[0];if(ah!==ab&&ah.tagName!=="HTML"){if(!ag.axis||ag.axis!=="x"){if((ad.overflowOffset.top+ah.offsetHeight)-ae.pageY<ag.scrollSensitivity){ah.scrollTop=ac=ah.scrollTop+ag.scrollSpeed}else{if(ae.pageY-ad.overflowOffset.top<ag.scrollSensitivity){ah.scrollTop=ac=ah.scrollTop-ag.scrollSpeed}}}if(!ag.axis||ag.axis!=="y"){if((ad.overflowOffset.left+ah.offsetWidth)-ae.pageX<ag.scrollSensitivity){ah.scrollLeft=ac=ah.scrollLeft+ag.scrollSpeed}else{if(ae.pageX-ad.overflowOffset.left<ag.scrollSensitivity){ah.scrollLeft=ac=ah.scrollLeft-ag.scrollSpeed}}}}else{if(!ag.axis||ag.axis!=="x"){if(ae.pageY-I(ab).scrollTop()<ag.scrollSensitivity){ac=I(ab).scrollTop(I(ab).scrollTop()-ag.scrollSpeed)}else{if(I(window).height()-(ae.pageY-I(ab).scrollTop())<ag.scrollSensitivity){ac=I(ab).scrollTop(I(ab).scrollTop()+ag.scrollSpeed)}}}if(!ag.axis||ag.axis!=="y"){if(ae.pageX-I(ab).scrollLeft()<ag.scrollSensitivity){ac=I(ab).scrollLeft(I(ab).scrollLeft()-ag.scrollSpeed)}else{if(I(window).width()-(ae.pageX-I(ab).scrollLeft())<ag.scrollSensitivity){ac=I(ab).scrollLeft(I(ab).scrollLeft()+ag.scrollSpeed)}}}}if(ac!==false&&I.ui.ddmanager&&!ag.dropBehaviour){I.ui.ddmanager.prepareOffsets(ad,ae)}}});I.ui.plugin.add("draggable","snap",{start:function(ac,ad,ab){var ae=ab.options;ab.snapElements=[];I(ae.snap.constructor!==String?(ae.snap.items||":data(ui-draggable)"):ae.snap).each(function(){var ag=I(this),af=ag.offset();if(this!==ab.element[0]){ab.snapElements.push({item:this,width:ag.outerWidth(),height:ag.outerHeight(),top:af.top,left:af.left})}})},drag:function(an,ak,ae){var ab,at,ag,ah,am,aj,ai,au,ao,af,al=ae.options,ar=al.snapTolerance,aq=ak.offset.left,ap=aq+ae.helperProportions.width,ad=ak.offset.top,ac=ad+ae.helperProportions.height;for(ao=ae.snapElements.length-1;ao>=0;ao--){am=ae.snapElements[ao].left-ae.margins.left;aj=am+ae.snapElements[ao].width;ai=ae.snapElements[ao].top-ae.margins.top;au=ai+ae.snapElements[ao].height;if(ap<am-ar||aq>aj+ar||ac<ai-ar||ad>au+ar||!I.contains(ae.snapElements[ao].item.ownerDocument,ae.snapElements[ao].item)){if(ae.snapElements[ao].snapping){(ae.options.snap.release&&ae.options.snap.release.call(ae.element,an,I.extend(ae._uiHash(),{snapItem:ae.snapElements[ao].item})))}ae.snapElements[ao].snapping=false;continue}if(al.snapMode!=="inner"){ab=Math.abs(ai-ac)<=ar;at=Math.abs(au-ad)<=ar;ag=Math.abs(am-ap)<=ar;ah=Math.abs(aj-aq)<=ar;if(ab){ak.position.top=ae._convertPositionTo("relative",{top:ai-ae.helperProportions.height,left:0}).top}if(at){ak.position.top=ae._convertPositionTo("relative",{top:au,left:0}).top}if(ag){ak.position.left=ae._convertPositionTo("relative",{top:0,left:am-ae.helperProportions.width}).left}if(ah){ak.position.left=ae._convertPositionTo("relative",{top:0,left:aj}).left}}af=(ab||at||ag||ah);if(al.snapMode!=="outer"){ab=Math.abs(ai-ad)<=ar;at=Math.abs(au-ac)<=ar;ag=Math.abs(am-aq)<=ar;ah=Math.abs(aj-ap)<=ar;if(ab){ak.position.top=ae._convertPositionTo("relative",{top:ai,left:0}).top}if(at){ak.position.top=ae._convertPositionTo("relative",{top:au-ae.helperProportions.height,left:0}).top}if(ag){ak.position.left=ae._convertPositionTo("relative",{top:0,left:am}).left}if(ah){ak.position.left=ae._convertPositionTo("relative",{top:0,left:aj-ae.helperProportions.width}).left}}if(!ae.snapElements[ao].snapping&&(ab||at||ag||ah||af)){(ae.options.snap.snap&&ae.options.snap.snap.call(ae.element,an,I.extend(ae._uiHash(),{snapItem:ae.snapElements[ao].item})))}ae.snapElements[ao].snapping=(ab||at||ag||ah||af)}}});I.ui.plugin.add("draggable","stack",{start:function(ad,ae,ab){var ac,ag=ab.options,af=I.makeArray(I(ag.stack)).sort(function(ai,ah){return(parseInt(I(ai).css("zIndex"),10)||0)-(parseInt(I(ah).css("zIndex"),10)||0)});if(!af.length){return}ac=parseInt(I(af[0]).css("zIndex"),10)||0;I(af).each(function(ah){I(this).css("zIndex",ac+ah)});this.css("zIndex",(ac+af.length))}});I.ui.plugin.add("draggable","zIndex",{start:function(ad,ae,ab){var ac=I(ae.helper),af=ab.options;if(ac.css("zIndex")){af._zIndex=ac.css("zIndex")}ac.css("zIndex",af.zIndex)},stop:function(ac,ad,ab){var ae=ab.options;if(ae._zIndex){I(ad.helper).css("zIndex",ae._zIndex)}}});var U=I.ui.draggable;
/*!
 * jQuery UI Droppable 1.11.3
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/droppable/
 */
I.widget("ui.droppable",{version:"1.11.3",widgetEventPrefix:"drop",options:{accept:"*",activeClass:false,addClasses:true,greedy:false,hoverClass:false,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var ac,ad=this.options,ab=ad.accept;this.isover=false;this.isout=true;this.accept=I.isFunction(ab)?ab:function(ae){return ae.is(ab)};this.proportions=function(){if(arguments.length){ac=arguments[0]}else{return ac?ac:ac={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight}}};this._addToManager(ad.scope);ad.addClasses&&this.element.addClass("ui-droppable")},_addToManager:function(ab){I.ui.ddmanager.droppables[ab]=I.ui.ddmanager.droppables[ab]||[];I.ui.ddmanager.droppables[ab].push(this)},_splice:function(ab){var ac=0;for(;ac<ab.length;ac++){if(ab[ac]===this){ab.splice(ac,1)}}},_destroy:function(){var ab=I.ui.ddmanager.droppables[this.options.scope];this._splice(ab);this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(ac,ad){if(ac==="accept"){this.accept=I.isFunction(ad)?ad:function(ae){return ae.is(ad)}}else{if(ac==="scope"){var ab=I.ui.ddmanager.droppables[this.options.scope];this._splice(ab);this._addToManager(ad)}}this._super(ac,ad)},_activate:function(ac){var ab=I.ui.ddmanager.current;if(this.options.activeClass){this.element.addClass(this.options.activeClass)}if(ab){this._trigger("activate",ac,this.ui(ab))}},_deactivate:function(ac){var ab=I.ui.ddmanager.current;if(this.options.activeClass){this.element.removeClass(this.options.activeClass)}if(ab){this._trigger("deactivate",ac,this.ui(ab))}},_over:function(ac){var ab=I.ui.ddmanager.current;if(!ab||(ab.currentItem||ab.element)[0]===this.element[0]){return}if(this.accept.call(this.element[0],(ab.currentItem||ab.element))){if(this.options.hoverClass){this.element.addClass(this.options.hoverClass)}this._trigger("over",ac,this.ui(ab))}},_out:function(ac){var ab=I.ui.ddmanager.current;if(!ab||(ab.currentItem||ab.element)[0]===this.element[0]){return}if(this.accept.call(this.element[0],(ab.currentItem||ab.element))){if(this.options.hoverClass){this.element.removeClass(this.options.hoverClass)}this._trigger("out",ac,this.ui(ab))}},_drop:function(ac,ad){var ab=ad||I.ui.ddmanager.current,ae=false;if(!ab||(ab.currentItem||ab.element)[0]===this.element[0]){return false}this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var af=I(this).droppable("instance");if(af.options.greedy&&!af.options.disabled&&af.options.scope===ab.options.scope&&af.accept.call(af.element[0],(ab.currentItem||ab.element))&&I.ui.intersect(ab,I.extend(af,{offset:af.element.offset()}),af.options.tolerance,ac)){ae=true;return false}});if(ae){return false}if(this.accept.call(this.element[0],(ab.currentItem||ab.element))){if(this.options.activeClass){this.element.removeClass(this.options.activeClass)}if(this.options.hoverClass){this.element.removeClass(this.options.hoverClass)}this._trigger("drop",ac,this.ui(ab));return this.element}return false},ui:function(ab){return{draggable:(ab.currentItem||ab.element),helper:ab.helper,position:ab.position,offset:ab.positionAbs}}});I.ui.intersect=(function(){function ab(ad,ac,ae){return(ad>=ac)&&(ad<(ac+ae))}return function(an,ah,al,ad){if(!ah.offset){return false}var af=(an.positionAbs||an.position.absolute).left+an.margins.left,ak=(an.positionAbs||an.position.absolute).top+an.margins.top,ae=af+an.helperProportions.width,aj=ak+an.helperProportions.height,ag=ah.offset.left,am=ah.offset.top,ac=ag+ah.proportions().width,ai=am+ah.proportions().height;switch(al){case"fit":return(ag<=af&&ae<=ac&&am<=ak&&aj<=ai);case"intersect":return(ag<af+(an.helperProportions.width/2)&&ae-(an.helperProportions.width/2)<ac&&am<ak+(an.helperProportions.height/2)&&aj-(an.helperProportions.height/2)<ai);case"pointer":return ab(ad.pageY,am,ah.proportions().height)&&ab(ad.pageX,ag,ah.proportions().width);case"touch":return((ak>=am&&ak<=ai)||(aj>=am&&aj<=ai)||(ak<am&&aj>ai))&&((af>=ag&&af<=ac)||(ae>=ag&&ae<=ac)||(af<ag&&ae>ac));default:return false}}})();I.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(ae,ag){var ad,ac,ab=I.ui.ddmanager.droppables[ae.options.scope]||[],af=ag?ag.type:null,ah=(ae.currentItem||ae.element).find(":data(ui-droppable)").addBack();droppablesLoop:for(ad=0;ad<ab.length;ad++){if(ab[ad].options.disabled||(ae&&!ab[ad].accept.call(ab[ad].element[0],(ae.currentItem||ae.element)))){continue}for(ac=0;ac<ah.length;ac++){if(ah[ac]===ab[ad].element[0]){ab[ad].proportions().height=0;continue droppablesLoop}}ab[ad].visible=ab[ad].element.css("display")!=="none";if(!ab[ad].visible){continue}if(af==="mousedown"){ab[ad]._activate.call(ab[ad],ag)}ab[ad].offset=ab[ad].element.offset();ab[ad].proportions({width:ab[ad].element[0].offsetWidth,height:ab[ad].element[0].offsetHeight})}},drop:function(ab,ac){var ad=false;I.each((I.ui.ddmanager.droppables[ab.options.scope]||[]).slice(),function(){if(!this.options){return}if(!this.options.disabled&&this.visible&&I.ui.intersect(ab,this,this.options.tolerance,ac)){ad=this._drop.call(this,ac)||ad}if(!this.options.disabled&&this.visible&&this.accept.call(this.element[0],(ab.currentItem||ab.element))){this.isout=true;this.isover=false;this._deactivate.call(this,ac)}});return ad},dragStart:function(ab,ac){ab.element.parentsUntil("body").bind("scroll.droppable",function(){if(!ab.options.refreshPositions){I.ui.ddmanager.prepareOffsets(ab,ac)}})},drag:function(ab,ac){if(ab.options.refreshPositions){I.ui.ddmanager.prepareOffsets(ab,ac)}I.each(I.ui.ddmanager.droppables[ab.options.scope]||[],function(){if(this.options.disabled||this.greedyChild||!this.visible){return}var ag,ae,ad,af=I.ui.intersect(ab,this,this.options.tolerance,ac),ah=!af&&this.isover?"isout":(af&&!this.isover?"isover":null);if(!ah){return}if(this.options.greedy){ae=this.options.scope;ad=this.element.parents(":data(ui-droppable)").filter(function(){return I(this).droppable("instance").options.scope===ae});if(ad.length){ag=I(ad[0]).droppable("instance");ag.greedyChild=(ah==="isover")}}if(ag&&ah==="isover"){ag.isover=false;ag.isout=true;ag._out.call(ag,ac)}this[ah]=true;this[ah==="isout"?"isover":"isout"]=false;this[ah==="isover"?"_over":"_out"].call(this,ac);if(ag&&ah==="isout"){ag.isout=false;ag.isover=true;ag._over.call(ag,ac)}})},dragStop:function(ab,ac){ab.element.parentsUntil("body").unbind("scroll.droppable");if(!ab.options.refreshPositions){I.ui.ddmanager.prepareOffsets(ab,ac)}}};var d=I.ui.droppable;
/*!
 * jQuery UI Resizable 1.11.3
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/resizable/
 */
I.widget("ui.resizable",I.ui.mouse,{version:"1.11.3",widgetEventPrefix:"resize",options:{alsoResize:false,animate:false,animateDuration:"slow",animateEasing:"swing",aspectRatio:false,autoHide:false,containment:false,ghost:false,grid:false,handles:"e,s,se",helper:false,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_num:function(ab){return parseInt(ab,10)||0},_isNumber:function(ab){return !isNaN(parseInt(ab,10))},_hasScroll:function(ae,ac){if(I(ae).css("overflow")==="hidden"){return false}var ab=(ac&&ac==="left")?"scrollLeft":"scrollTop",ad=false;if(ae[ab]>0){return true}ae[ab]=1;ad=(ae[ab]>0);ae[ab]=0;return ad},_create:function(){var ah,ac,af,ad,ab,ae=this,ag=this.options;this.element.addClass("ui-resizable");I.extend(this,{_aspectRatio:!!(ag.aspectRatio),aspectRatio:ag.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:ag.helper||ag.ghost||ag.animate?ag.helper||"ui-resizable-helper":null});if(this.element[0].nodeName.match(/^(canvas|textarea|input|select|button|img)$/i)){this.element.wrap(I("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")}));this.element=this.element.parent().data("ui-resizable",this.element.resizable("instance"));this.elementIsWrapper=true;this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")});this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0});this.originalResizeStyle=this.originalElement.css("resize");this.originalElement.css("resize","none");this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"}));this.originalElement.css({margin:this.originalElement.css("margin")});this._proportionallyResize()}this.handles=ag.handles||(!I(".ui-resizable-handle",this.element).length?"e,s,se":{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"});if(this.handles.constructor===String){if(this.handles==="all"){this.handles="n,e,s,w,se,sw,ne,nw"}ah=this.handles.split(",");this.handles={};for(ac=0;ac<ah.length;ac++){af=I.trim(ah[ac]);ab="ui-resizable-"+af;ad=I("<div class='ui-resizable-handle "+ab+"'></div>");ad.css({zIndex:ag.zIndex});if("se"===af){ad.addClass("ui-icon ui-icon-gripsmall-diagonal-se")}this.handles[af]=".ui-resizable-"+af;this.element.append(ad)}}this._renderAxis=function(am){var aj,ak,ai,al;am=am||this.element;for(aj in this.handles){if(this.handles[aj].constructor===String){this.handles[aj]=this.element.children(this.handles[aj]).first().show()}if(this.elementIsWrapper&&this.originalElement[0].nodeName.match(/^(textarea|input|select|button)$/i)){ak=I(this.handles[aj],this.element);al=/sw|ne|nw|se|n|s/.test(aj)?ak.outerHeight():ak.outerWidth();ai=["padding",/ne|nw|n/.test(aj)?"Top":/se|sw|s/.test(aj)?"Bottom":/^e$/.test(aj)?"Right":"Left"].join("");am.css(ai,al);this._proportionallyResize()}if(!I(this.handles[aj]).length){continue}}};this._renderAxis(this.element);this._handles=I(".ui-resizable-handle",this.element).disableSelection();this._handles.mouseover(function(){if(!ae.resizing){if(this.className){ad=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)}ae.axis=ad&&ad[1]?ad[1]:"se"}});if(ag.autoHide){this._handles.hide();I(this.element).addClass("ui-resizable-autohide").mouseenter(function(){if(ag.disabled){return}I(this).removeClass("ui-resizable-autohide");ae._handles.show()}).mouseleave(function(){if(ag.disabled){return}if(!ae.resizing){I(this).addClass("ui-resizable-autohide");ae._handles.hide()}})}this._mouseInit()},_destroy:function(){this._mouseDestroy();var ac,ab=function(ad){I(ad).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};if(this.elementIsWrapper){ab(this.element);ac=this.element;this.originalElement.css({position:ac.css("position"),width:ac.outerWidth(),height:ac.outerHeight(),top:ac.css("top"),left:ac.css("left")}).insertAfter(ac);ac.remove()}this.originalElement.css("resize",this.originalResizeStyle);ab(this.originalElement);return this},_mouseCapture:function(ad){var ac,ae,ab=false;for(ac in this.handles){ae=I(this.handles[ac])[0];if(ae===ad.target||I.contains(ae,ad.target)){ab=true}}return !this.options.disabled&&ab},_mouseStart:function(ac){var ag,ad,af,ae=this.options,ab=this.element;this.resizing=true;this._renderProxy();ag=this._num(this.helper.css("left"));ad=this._num(this.helper.css("top"));if(ae.containment){ag+=I(ae.containment).scrollLeft()||0;ad+=I(ae.containment).scrollTop()||0}this.offset=this.helper.offset();this.position={left:ag,top:ad};this.size=this._helper?{width:this.helper.width(),height:this.helper.height()}:{width:ab.width(),height:ab.height()};this.originalSize=this._helper?{width:ab.outerWidth(),height:ab.outerHeight()}:{width:ab.width(),height:ab.height()};this.sizeDiff={width:ab.outerWidth()-ab.width(),height:ab.outerHeight()-ab.height()};this.originalPosition={left:ag,top:ad};this.originalMousePosition={left:ac.pageX,top:ac.pageY};this.aspectRatio=(typeof ae.aspectRatio==="number")?ae.aspectRatio:((this.originalSize.width/this.originalSize.height)||1);af=I(".ui-resizable-"+this.axis).css("cursor");I("body").css("cursor",af==="auto"?this.axis+"-resize":af);ab.addClass("ui-resizable-resizing");this._propagate("start",ac);return true},_mouseDrag:function(ag){var ah,af,ai=this.originalMousePosition,ac=this.axis,ad=(ag.pageX-ai.left)||0,ab=(ag.pageY-ai.top)||0,ae=this._change[ac];this._updatePrevProperties();if(!ae){return false}ah=ae.apply(this,[ag,ad,ab]);this._updateVirtualBoundaries(ag.shiftKey);if(this._aspectRatio||ag.shiftKey){ah=this._updateRatio(ah,ag)}ah=this._respectSize(ah,ag);this._updateCache(ah);this._propagate("resize",ag);af=this._applyChanges();if(!this._helper&&this._proportionallyResizeElements.length){this._proportionallyResize()}if(!I.isEmptyObject(af)){this._updatePrevProperties();this._trigger("resize",ag,this.ui());this._applyChanges()}return false},_mouseStop:function(ae){this.resizing=false;var ad,ab,ac,ah,ak,ag,aj,af=this.options,ai=this;if(this._helper){ad=this._proportionallyResizeElements;ab=ad.length&&(/textarea/i).test(ad[0].nodeName);ac=ab&&this._hasScroll(ad[0],"left")?0:ai.sizeDiff.height;ah=ab?0:ai.sizeDiff.width;ak={width:(ai.helper.width()-ah),height:(ai.helper.height()-ac)};ag=(parseInt(ai.element.css("left"),10)+(ai.position.left-ai.originalPosition.left))||null;aj=(parseInt(ai.element.css("top"),10)+(ai.position.top-ai.originalPosition.top))||null;if(!af.animate){this.element.css(I.extend(ak,{top:aj,left:ag}))}ai.helper.height(ai.size.height);ai.helper.width(ai.size.width);if(this._helper&&!af.animate){this._proportionallyResize()}}I("body").css("cursor","auto");this.element.removeClass("ui-resizable-resizing");this._propagate("stop",ae);if(this._helper){this.helper.remove()}return false},_updatePrevProperties:function(){this.prevPosition={top:this.position.top,left:this.position.left};this.prevSize={width:this.size.width,height:this.size.height}},_applyChanges:function(){var ab={};if(this.position.top!==this.prevPosition.top){ab.top=this.position.top+"px"}if(this.position.left!==this.prevPosition.left){ab.left=this.position.left+"px"}if(this.size.width!==this.prevSize.width){ab.width=this.size.width+"px"}if(this.size.height!==this.prevSize.height){ab.height=this.size.height+"px"}this.helper.css(ab);return ab},_updateVirtualBoundaries:function(ad){var af,ae,ac,ah,ab,ag=this.options;ab={minWidth:this._isNumber(ag.minWidth)?ag.minWidth:0,maxWidth:this._isNumber(ag.maxWidth)?ag.maxWidth:Infinity,minHeight:this._isNumber(ag.minHeight)?ag.minHeight:0,maxHeight:this._isNumber(ag.maxHeight)?ag.maxHeight:Infinity};if(this._aspectRatio||ad){af=ab.minHeight*this.aspectRatio;ac=ab.minWidth/this.aspectRatio;ae=ab.maxHeight*this.aspectRatio;ah=ab.maxWidth/this.aspectRatio;if(af>ab.minWidth){ab.minWidth=af}if(ac>ab.minHeight){ab.minHeight=ac}if(ae<ab.maxWidth){ab.maxWidth=ae}if(ah<ab.maxHeight){ab.maxHeight=ah}}this._vBoundaries=ab},_updateCache:function(ab){this.offset=this.helper.offset();if(this._isNumber(ab.left)){this.position.left=ab.left}if(this._isNumber(ab.top)){this.position.top=ab.top}if(this._isNumber(ab.height)){this.size.height=ab.height}if(this._isNumber(ab.width)){this.size.width=ab.width}},_updateRatio:function(ad){var ae=this.position,ac=this.size,ab=this.axis;if(this._isNumber(ad.height)){ad.width=(ad.height*this.aspectRatio)}else{if(this._isNumber(ad.width)){ad.height=(ad.width/this.aspectRatio)}}if(ab==="sw"){ad.left=ae.left+(ac.width-ad.width);ad.top=null}if(ab==="nw"){ad.top=ae.top+(ac.height-ad.height);ad.left=ae.left+(ac.width-ad.width)}return ad},_respectSize:function(ag){var ad=this._vBoundaries,aj=this.axis,al=this._isNumber(ag.width)&&ad.maxWidth&&(ad.maxWidth<ag.width),ah=this._isNumber(ag.height)&&ad.maxHeight&&(ad.maxHeight<ag.height),ae=this._isNumber(ag.width)&&ad.minWidth&&(ad.minWidth>ag.width),ak=this._isNumber(ag.height)&&ad.minHeight&&(ad.minHeight>ag.height),ac=this.originalPosition.left+this.originalSize.width,ai=this.position.top+this.size.height,af=/sw|nw|w/.test(aj),ab=/nw|ne|n/.test(aj);if(ae){ag.width=ad.minWidth}if(ak){ag.height=ad.minHeight}if(al){ag.width=ad.maxWidth}if(ah){ag.height=ad.maxHeight}if(ae&&af){ag.left=ac-ad.minWidth}if(al&&af){ag.left=ac-ad.maxWidth}if(ak&&ab){ag.top=ai-ad.minHeight}if(ah&&ab){ag.top=ai-ad.maxHeight}if(!ag.width&&!ag.height&&!ag.left&&ag.top){ag.top=null}else{if(!ag.width&&!ag.height&&!ag.top&&ag.left){ag.left=null}}return ag},_getPaddingPlusBorderDimensions:function(ad){var ac=0,ae=[],af=[ad.css("borderTopWidth"),ad.css("borderRightWidth"),ad.css("borderBottomWidth"),ad.css("borderLeftWidth")],ab=[ad.css("paddingTop"),ad.css("paddingRight"),ad.css("paddingBottom"),ad.css("paddingLeft")];for(;ac<4;ac++){ae[ac]=(parseInt(af[ac],10)||0);ae[ac]+=(parseInt(ab[ac],10)||0)}return{height:ae[0]+ae[2],width:ae[1]+ae[3]}},_proportionallyResize:function(){if(!this._proportionallyResizeElements.length){return}var ad,ac=0,ab=this.helper||this.element;for(;ac<this._proportionallyResizeElements.length;ac++){ad=this._proportionallyResizeElements[ac];if(!this.outerDimensions){this.outerDimensions=this._getPaddingPlusBorderDimensions(ad)}ad.css({height:(ab.height()-this.outerDimensions.height)||0,width:(ab.width()-this.outerDimensions.width)||0})}},_renderProxy:function(){var ab=this.element,ac=this.options;this.elementOffset=ab.offset();if(this._helper){this.helper=this.helper||I("<div style='overflow:hidden;'></div>");this.helper.addClass(this._helper).css({width:this.element.outerWidth()-1,height:this.element.outerHeight()-1,position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++ac.zIndex});this.helper.appendTo("body").disableSelection()}else{this.helper=this.element}},_change:{e:function(ac,ab){return{width:this.originalSize.width+ab}},w:function(ad,ab){var ac=this.originalSize,ae=this.originalPosition;return{left:ae.left+ab,width:ac.width-ab}},n:function(ae,ac,ab){var ad=this.originalSize,af=this.originalPosition;return{top:af.top+ab,height:ad.height-ab}},s:function(ad,ac,ab){return{height:this.originalSize.height+ab}},se:function(ad,ac,ab){return I.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[ad,ac,ab]))},sw:function(ad,ac,ab){return I.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[ad,ac,ab]))},ne:function(ad,ac,ab){return I.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[ad,ac,ab]))},nw:function(ad,ac,ab){return I.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[ad,ac,ab]))}},_propagate:function(ac,ab){I.ui.plugin.call(this,ac,[ab,this.ui()]);(ac!=="resize"&&this._trigger(ac,ab,this.ui()))},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}});I.ui.plugin.add("resizable","animate",{stop:function(ae){var aj=I(this).resizable("instance"),ag=aj.options,ad=aj._proportionallyResizeElements,ab=ad.length&&(/textarea/i).test(ad[0].nodeName),ac=ab&&aj._hasScroll(ad[0],"left")?0:aj.sizeDiff.height,ai=ab?0:aj.sizeDiff.width,af={width:(aj.size.width-ai),height:(aj.size.height-ac)},ah=(parseInt(aj.element.css("left"),10)+(aj.position.left-aj.originalPosition.left))||null,ak=(parseInt(aj.element.css("top"),10)+(aj.position.top-aj.originalPosition.top))||null;aj.element.animate(I.extend(af,ak&&ah?{top:ak,left:ah}:{}),{duration:ag.animateDuration,easing:ag.animateEasing,step:function(){var al={width:parseInt(aj.element.css("width"),10),height:parseInt(aj.element.css("height"),10),top:parseInt(aj.element.css("top"),10),left:parseInt(aj.element.css("left"),10)};if(ad&&ad.length){I(ad[0]).css({width:al.width,height:al.height})}aj._updateCache(al);aj._propagate("resize",ae)}})}});I.ui.plugin.add("resizable","containment",{start:function(){var aj,ad,al,ab,ai,ae,am,ak=I(this).resizable("instance"),ah=ak.options,ag=ak.element,ac=ah.containment,af=(ac instanceof I)?ac.get(0):(/parent/.test(ac))?ag.parent().get(0):ac;if(!af){return}ak.containerElement=I(af);if(/document/.test(ac)||ac===document){ak.containerOffset={left:0,top:0};ak.containerPosition={left:0,top:0};ak.parentData={element:I(document),left:0,top:0,width:I(document).width(),height:I(document).height()||document.body.parentNode.scrollHeight}}else{aj=I(af);ad=[];I(["Top","Right","Left","Bottom"]).each(function(ao,an){ad[ao]=ak._num(aj.css("padding"+an))});ak.containerOffset=aj.offset();ak.containerPosition=aj.position();ak.containerSize={height:(aj.innerHeight()-ad[3]),width:(aj.innerWidth()-ad[1])};al=ak.containerOffset;ab=ak.containerSize.height;ai=ak.containerSize.width;ae=(ak._hasScroll(af,"left")?af.scrollWidth:ai);am=(ak._hasScroll(af)?af.scrollHeight:ab);ak.parentData={element:af,left:al.left,top:al.top,width:ae,height:am}}},resize:function(ac){var ai,an,ah,af,aj=I(this).resizable("instance"),ae=aj.options,al=aj.containerOffset,ak=aj.position,am=aj._aspectRatio||ac.shiftKey,ab={top:0,left:0},ad=aj.containerElement,ag=true;if(ad[0]!==document&&(/static/).test(ad.css("position"))){ab=al}if(ak.left<(aj._helper?al.left:0)){aj.size.width=aj.size.width+(aj._helper?(aj.position.left-al.left):(aj.position.left-ab.left));if(am){aj.size.height=aj.size.width/aj.aspectRatio;ag=false}aj.position.left=ae.helper?al.left:0}if(ak.top<(aj._helper?al.top:0)){aj.size.height=aj.size.height+(aj._helper?(aj.position.top-al.top):aj.position.top);if(am){aj.size.width=aj.size.height*aj.aspectRatio;ag=false}aj.position.top=aj._helper?al.top:0}ah=aj.containerElement.get(0)===aj.element.parent().get(0);af=/relative|absolute/.test(aj.containerElement.css("position"));if(ah&&af){aj.offset.left=aj.parentData.left+aj.position.left;aj.offset.top=aj.parentData.top+aj.position.top}else{aj.offset.left=aj.element.offset().left;aj.offset.top=aj.element.offset().top}ai=Math.abs(aj.sizeDiff.width+(aj._helper?aj.offset.left-ab.left:(aj.offset.left-al.left)));an=Math.abs(aj.sizeDiff.height+(aj._helper?aj.offset.top-ab.top:(aj.offset.top-al.top)));if(ai+aj.size.width>=aj.parentData.width){aj.size.width=aj.parentData.width-ai;if(am){aj.size.height=aj.size.width/aj.aspectRatio;ag=false}}if(an+aj.size.height>=aj.parentData.height){aj.size.height=aj.parentData.height-an;if(am){aj.size.width=aj.size.height*aj.aspectRatio;ag=false}}if(!ag){aj.position.left=aj.prevPosition.left;aj.position.top=aj.prevPosition.top;aj.size.width=aj.prevSize.width;aj.size.height=aj.prevSize.height}},stop:function(){var ag=I(this).resizable("instance"),ac=ag.options,ah=ag.containerOffset,ab=ag.containerPosition,ad=ag.containerElement,ae=I(ag.helper),aj=ae.offset(),ai=ae.outerWidth()-ag.sizeDiff.width,af=ae.outerHeight()-ag.sizeDiff.height;if(ag._helper&&!ac.animate&&(/relative/).test(ad.css("position"))){I(this).css({left:aj.left-ab.left-ah.left,width:ai,height:af})}if(ag._helper&&!ac.animate&&(/static/).test(ad.css("position"))){I(this).css({left:aj.left-ab.left-ah.left,width:ai,height:af})}}});I.ui.plugin.add("resizable","alsoResize",{start:function(){var ab=I(this).resizable("instance"),ad=ab.options,ac=function(ae){I(ae).each(function(){var af=I(this);af.data("ui-resizable-alsoresize",{width:parseInt(af.width(),10),height:parseInt(af.height(),10),left:parseInt(af.css("left"),10),top:parseInt(af.css("top"),10)})})};if(typeof(ad.alsoResize)==="object"&&!ad.alsoResize.parentNode){if(ad.alsoResize.length){ad.alsoResize=ad.alsoResize[0];ac(ad.alsoResize)}else{I.each(ad.alsoResize,function(ae){ac(ae)})}}else{ac(ad.alsoResize)}},resize:function(ad,af){var ac=I(this).resizable("instance"),ag=ac.options,ae=ac.originalSize,ai=ac.originalPosition,ah={height:(ac.size.height-ae.height)||0,width:(ac.size.width-ae.width)||0,top:(ac.position.top-ai.top)||0,left:(ac.position.left-ai.left)||0},ab=function(aj,ak){I(aj).each(function(){var an=I(this),ao=I(this).data("ui-resizable-alsoresize"),am={},al=ak&&ak.length?ak:an.parents(af.originalElement[0]).length?["width","height"]:["width","height","top","left"];I.each(al,function(ap,ar){var aq=(ao[ar]||0)+(ah[ar]||0);if(aq&&aq>=0){am[ar]=aq||null}});an.css(am)})};if(typeof(ag.alsoResize)==="object"&&!ag.alsoResize.nodeType){I.each(ag.alsoResize,function(aj,ak){ab(aj,ak)})}else{ab(ag.alsoResize)}},stop:function(){I(this).removeData("resizable-alsoresize")}});I.ui.plugin.add("resizable","ghost",{start:function(){var ac=I(this).resizable("instance"),ad=ac.options,ab=ac.size;ac.ghost=ac.originalElement.clone();ac.ghost.css({opacity:0.25,display:"block",position:"relative",height:ab.height,width:ab.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass(typeof ad.ghost==="string"?ad.ghost:"");ac.ghost.appendTo(ac.helper)},resize:function(){var ab=I(this).resizable("instance");if(ab.ghost){ab.ghost.css({position:"relative",height:ab.size.height,width:ab.size.width})}},stop:function(){var ab=I(this).resizable("instance");if(ab.ghost&&ab.helper){ab.helper.get(0).removeChild(ab.ghost.get(0))}}});I.ui.plugin.add("resizable","grid",{resize:function(){var ae,aj=I(this).resizable("instance"),an=aj.options,ah=aj.size,ai=aj.originalSize,ak=aj.originalPosition,at=aj.axis,ab=typeof an.grid==="number"?[an.grid,an.grid]:an.grid,aq=(ab[0]||1),ap=(ab[1]||1),ag=Math.round((ah.width-ai.width)/aq)*aq,af=Math.round((ah.height-ai.height)/ap)*ap,al=ai.width+ag,ao=ai.height+af,ad=an.maxWidth&&(an.maxWidth<al),am=an.maxHeight&&(an.maxHeight<ao),ar=an.minWidth&&(an.minWidth>al),ac=an.minHeight&&(an.minHeight>ao);an.grid=ab;if(ar){al+=aq}if(ac){ao+=ap}if(ad){al-=aq}if(am){ao-=ap}if(/^(se|s|e)$/.test(at)){aj.size.width=al;aj.size.height=ao}else{if(/^(ne)$/.test(at)){aj.size.width=al;aj.size.height=ao;aj.position.top=ak.top-af}else{if(/^(sw)$/.test(at)){aj.size.width=al;aj.size.height=ao;aj.position.left=ak.left-ag}else{if(ao-ap<=0||al-aq<=0){ae=aj._getPaddingPlusBorderDimensions(this)}if(ao-ap>0){aj.size.height=ao;aj.position.top=ak.top-af}else{ao=ap-ae.height;aj.size.height=ao;aj.position.top=ak.top+ai.height-ao}if(al-aq>0){aj.size.width=al;aj.position.left=ak.left-ag}else{al=aq-ae.width;aj.size.width=al;aj.position.left=ak.left+ai.width-al}}}}}});var L=I.ui.resizable;
/*!
 * jQuery UI Selectable 1.11.3
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/selectable/
 */
var e=I.widget("ui.selectable",I.ui.mouse,{version:"1.11.3",options:{appendTo:"body",autoRefresh:true,distance:0,filter:"*",tolerance:"touch",selected:null,selecting:null,start:null,stop:null,unselected:null,unselecting:null},_create:function(){var ac,ab=this;this.element.addClass("ui-selectable");this.dragged=false;this.refresh=function(){ac=I(ab.options.filter,ab.element[0]);ac.addClass("ui-selectee");ac.each(function(){var ad=I(this),ae=ad.offset();I.data(this,"selectable-item",{element:this,$element:ad,left:ae.left,top:ae.top,right:ae.left+ad.outerWidth(),bottom:ae.top+ad.outerHeight(),startselected:false,selected:ad.hasClass("ui-selected"),selecting:ad.hasClass("ui-selecting"),unselecting:ad.hasClass("ui-unselecting")})})};this.refresh();this.selectees=ac.addClass("ui-selectee");this._mouseInit();this.helper=I("<div class='ui-selectable-helper'></div>")},_destroy:function(){this.selectees.removeClass("ui-selectee").removeData("selectable-item");this.element.removeClass("ui-selectable ui-selectable-disabled");this._mouseDestroy()},_mouseStart:function(ad){var ac=this,ab=this.options;this.opos=[ad.pageX,ad.pageY];if(this.options.disabled){return}this.selectees=I(ab.filter,this.element[0]);this._trigger("start",ad);I(ab.appendTo).append(this.helper);this.helper.css({left:ad.pageX,top:ad.pageY,width:0,height:0});if(ab.autoRefresh){this.refresh()}this.selectees.filter(".ui-selected").each(function(){var ae=I.data(this,"selectable-item");ae.startselected=true;if(!ad.metaKey&&!ad.ctrlKey){ae.$element.removeClass("ui-selected");ae.selected=false;ae.$element.addClass("ui-unselecting");ae.unselecting=true;ac._trigger("unselecting",ad,{unselecting:ae.element})}});I(ad.target).parents().addBack().each(function(){var ae,af=I.data(this,"selectable-item");if(af){ae=(!ad.metaKey&&!ad.ctrlKey)||!af.$element.hasClass("ui-selected");af.$element.removeClass(ae?"ui-unselecting":"ui-selected").addClass(ae?"ui-selecting":"ui-unselecting");af.unselecting=!ae;af.selecting=ae;af.selected=ae;if(ae){ac._trigger("selecting",ad,{selecting:af.element})}else{ac._trigger("unselecting",ad,{unselecting:af.element})}return false}})},_mouseDrag:function(ai){this.dragged=true;if(this.options.disabled){return}var af,ah=this,ad=this.options,ac=this.opos[0],ag=this.opos[1],ab=ai.pageX,ae=ai.pageY;if(ac>ab){af=ab;ab=ac;ac=af}if(ag>ae){af=ae;ae=ag;ag=af}this.helper.css({left:ac,top:ag,width:ab-ac,height:ae-ag});this.selectees.each(function(){var aj=I.data(this,"selectable-item"),ak=false;if(!aj||aj.element===ah.element[0]){return}if(ad.tolerance==="touch"){ak=(!(aj.left>ab||aj.right<ac||aj.top>ae||aj.bottom<ag))}else{if(ad.tolerance==="fit"){ak=(aj.left>ac&&aj.right<ab&&aj.top>ag&&aj.bottom<ae)}}if(ak){if(aj.selected){aj.$element.removeClass("ui-selected");aj.selected=false}if(aj.unselecting){aj.$element.removeClass("ui-unselecting");aj.unselecting=false}if(!aj.selecting){aj.$element.addClass("ui-selecting");aj.selecting=true;ah._trigger("selecting",ai,{selecting:aj.element})}}else{if(aj.selecting){if((ai.metaKey||ai.ctrlKey)&&aj.startselected){aj.$element.removeClass("ui-selecting");aj.selecting=false;aj.$element.addClass("ui-selected");aj.selected=true}else{aj.$element.removeClass("ui-selecting");aj.selecting=false;if(aj.startselected){aj.$element.addClass("ui-unselecting");aj.unselecting=true}ah._trigger("unselecting",ai,{unselecting:aj.element})}}if(aj.selected){if(!ai.metaKey&&!ai.ctrlKey&&!aj.startselected){aj.$element.removeClass("ui-selected");aj.selected=false;aj.$element.addClass("ui-unselecting");aj.unselecting=true;ah._trigger("unselecting",ai,{unselecting:aj.element})}}}});return false},_mouseStop:function(ac){var ab=this;this.dragged=false;I(".ui-unselecting",this.element[0]).each(function(){var ad=I.data(this,"selectable-item");ad.$element.removeClass("ui-unselecting");ad.unselecting=false;ad.startselected=false;ab._trigger("unselected",ac,{unselected:ad.element})});I(".ui-selecting",this.element[0]).each(function(){var ad=I.data(this,"selectable-item");ad.$element.removeClass("ui-selecting").addClass("ui-selected");ad.selecting=false;ad.selected=true;ad.startselected=true;ab._trigger("selected",ac,{selected:ad.element})});this._trigger("stop",ac);this.helper.remove();return false}});
/*!
 * jQuery UI Sortable 1.11.3
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/sortable/
 */
var C=I.widget("ui.sortable",I.ui.mouse,{version:"1.11.3",widgetEventPrefix:"sort",ready:false,options:{appendTo:"parent",axis:false,connectWith:false,containment:false,cursor:"auto",cursorAt:false,dropOnEmpty:true,forcePlaceholderSize:false,forceHelperSize:false,grid:false,handle:false,helper:"original",items:"> *",opacity:false,placeholder:false,revert:false,scroll:true,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1000,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_isOverAxis:function(ac,ab,ad){return(ac>=ab)&&(ac<(ab+ad))},_isFloating:function(ab){return(/left|right/).test(ab.css("float"))||(/inline|table-cell/).test(ab.css("display"))},_create:function(){var ab=this.options;this.containerCache={};this.element.addClass("ui-sortable");this.refresh();this.floating=this.items.length?ab.axis==="x"||this._isFloating(this.items[0].item):false;this.offset=this.element.offset();this._mouseInit();this._setHandleClassName();this.ready=true},_setOption:function(ab,ac){this._super(ab,ac);if(ab==="handle"){this._setHandleClassName()}},_setHandleClassName:function(){this.element.find(".ui-sortable-handle").removeClass("ui-sortable-handle");I.each(this.items,function(){(this.instance.options.handle?this.item.find(this.instance.options.handle):this.item).addClass("ui-sortable-handle")})},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled").find(".ui-sortable-handle").removeClass("ui-sortable-handle");this._mouseDestroy();for(var ab=this.items.length-1;ab>=0;ab--){this.items[ab].item.removeData(this.widgetName+"-item")}return this},_mouseCapture:function(ad,ae){var ab=null,af=false,ac=this;if(this.reverting){return false}if(this.options.disabled||this.options.type==="static"){return false}this._refreshItems(ad);I(ad.target).parents().each(function(){if(I.data(this,ac.widgetName+"-item")===ac){ab=I(this);return false}});if(I.data(ad.target,ac.widgetName+"-item")===ac){ab=I(ad.target)}if(!ab){return false}if(this.options.handle&&!ae){I(this.options.handle,ab).find("*").addBack().each(function(){if(this===ad.target){af=true}});if(!af){return false}}this.currentItem=ab;this._removeCurrentsFromItems();return true},_mouseStart:function(ae,af,ac){var ad,ab,ag=this.options;this.currentContainer=this;this.refreshPositions();this.helper=this._createHelper(ae);this._cacheHelperProportions();this._cacheMargins();this.scrollParent=this.helper.scrollParent();this.offset=this.currentItem.offset();this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left};I.extend(this.offset,{click:{left:ae.pageX-this.offset.left,top:ae.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()});this.helper.css("position","absolute");this.cssPosition=this.helper.css("position");this.originalPosition=this._generatePosition(ae);this.originalPageX=ae.pageX;this.originalPageY=ae.pageY;(ag.cursorAt&&this._adjustOffsetFromHelper(ag.cursorAt));this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]};if(this.helper[0]!==this.currentItem[0]){this.currentItem.hide()}this._createPlaceholder();if(ag.containment){this._setContainment()}if(ag.cursor&&ag.cursor!=="auto"){ab=this.document.find("body");this.storedCursor=ab.css("cursor");ab.css("cursor",ag.cursor);this.storedStylesheet=I("<style>*{ cursor: "+ag.cursor+" !important; }</style>").appendTo(ab)}if(ag.opacity){if(this.helper.css("opacity")){this._storedOpacity=this.helper.css("opacity")}this.helper.css("opacity",ag.opacity)}if(ag.zIndex){if(this.helper.css("zIndex")){this._storedZIndex=this.helper.css("zIndex")}this.helper.css("zIndex",ag.zIndex)}if(this.scrollParent[0]!==this.document[0]&&this.scrollParent[0].tagName!=="HTML"){this.overflowOffset=this.scrollParent.offset()}this._trigger("start",ae,this._uiHash());if(!this._preserveHelperProportions){this._cacheHelperProportions()}if(!ac){for(ad=this.containers.length-1;ad>=0;ad--){this.containers[ad]._trigger("activate",ae,this._uiHash(this))}}if(I.ui.ddmanager){I.ui.ddmanager.current=this}if(I.ui.ddmanager&&!ag.dropBehaviour){I.ui.ddmanager.prepareOffsets(this,ae)}this.dragging=true;this.helper.addClass("ui-sortable-helper");this._mouseDrag(ae);return true},_mouseDrag:function(af){var ad,ae,ac,ah,ag=this.options,ab=false;this.position=this._generatePosition(af);this.positionAbs=this._convertPositionTo("absolute");if(!this.lastPositionAbs){this.lastPositionAbs=this.positionAbs}if(this.options.scroll){if(this.scrollParent[0]!==this.document[0]&&this.scrollParent[0].tagName!=="HTML"){if((this.overflowOffset.top+this.scrollParent[0].offsetHeight)-af.pageY<ag.scrollSensitivity){this.scrollParent[0].scrollTop=ab=this.scrollParent[0].scrollTop+ag.scrollSpeed}else{if(af.pageY-this.overflowOffset.top<ag.scrollSensitivity){this.scrollParent[0].scrollTop=ab=this.scrollParent[0].scrollTop-ag.scrollSpeed}}if((this.overflowOffset.left+this.scrollParent[0].offsetWidth)-af.pageX<ag.scrollSensitivity){this.scrollParent[0].scrollLeft=ab=this.scrollParent[0].scrollLeft+ag.scrollSpeed}else{if(af.pageX-this.overflowOffset.left<ag.scrollSensitivity){this.scrollParent[0].scrollLeft=ab=this.scrollParent[0].scrollLeft-ag.scrollSpeed}}}else{if(af.pageY-this.document.scrollTop()<ag.scrollSensitivity){ab=this.document.scrollTop(this.document.scrollTop()-ag.scrollSpeed)}else{if(this.window.height()-(af.pageY-this.document.scrollTop())<ag.scrollSensitivity){ab=this.document.scrollTop(this.document.scrollTop()+ag.scrollSpeed)}}if(af.pageX-this.document.scrollLeft()<ag.scrollSensitivity){ab=this.document.scrollLeft(this.document.scrollLeft()-ag.scrollSpeed)}else{if(this.window.width()-(af.pageX-this.document.scrollLeft())<ag.scrollSensitivity){ab=this.document.scrollLeft(this.document.scrollLeft()+ag.scrollSpeed)}}}if(ab!==false&&I.ui.ddmanager&&!ag.dropBehaviour){I.ui.ddmanager.prepareOffsets(this,af)}}this.positionAbs=this._convertPositionTo("absolute");if(!this.options.axis||this.options.axis!=="y"){this.helper[0].style.left=this.position.left+"px"}if(!this.options.axis||this.options.axis!=="x"){this.helper[0].style.top=this.position.top+"px"}for(ad=this.items.length-1;ad>=0;ad--){ae=this.items[ad];ac=ae.item[0];ah=this._intersectsWithPointer(ae);if(!ah){continue}if(ae.instance!==this.currentContainer){continue}if(ac!==this.currentItem[0]&&this.placeholder[ah===1?"next":"prev"]()[0]!==ac&&!I.contains(this.placeholder[0],ac)&&(this.options.type==="semi-dynamic"?!I.contains(this.element[0],ac):true)){this.direction=ah===1?"down":"up";if(this.options.tolerance==="pointer"||this._intersectsWithSides(ae)){this._rearrange(af,ae)}else{break}this._trigger("change",af,this._uiHash());break}}this._contactContainers(af);if(I.ui.ddmanager){I.ui.ddmanager.drag(this,af)}this._trigger("sort",af,this._uiHash());this.lastPositionAbs=this.positionAbs;return false},_mouseStop:function(ad,af){if(!ad){return}if(I.ui.ddmanager&&!this.options.dropBehaviour){I.ui.ddmanager.drop(this,ad)}if(this.options.revert){var ac=this,ag=this.placeholder.offset(),ab=this.options.axis,ae={};if(!ab||ab==="x"){ae.left=ag.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollLeft)}if(!ab||ab==="y"){ae.top=ag.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollTop)}this.reverting=true;I(this.helper).animate(ae,parseInt(this.options.revert,10)||500,function(){ac._clear(ad)})}else{this._clear(ad,af)}return false},cancel:function(){if(this.dragging){this._mouseUp({target:null});if(this.options.helper==="original"){this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else{this.currentItem.show()}for(var ab=this.containers.length-1;ab>=0;ab--){this.containers[ab]._trigger("deactivate",null,this._uiHash(this));if(this.containers[ab].containerCache.over){this.containers[ab]._trigger("out",null,this._uiHash(this));this.containers[ab].containerCache.over=0}}}if(this.placeholder){if(this.placeholder[0].parentNode){this.placeholder[0].parentNode.removeChild(this.placeholder[0])}if(this.options.helper!=="original"&&this.helper&&this.helper[0].parentNode){this.helper.remove()}I.extend(this,{helper:null,dragging:false,reverting:false,_noFinalSort:null});if(this.domPosition.prev){I(this.domPosition.prev).after(this.currentItem)}else{I(this.domPosition.parent).prepend(this.currentItem)}}return this},serialize:function(ad){var ab=this._getItemsAsjQuery(ad&&ad.connected),ac=[];ad=ad||{};I(ab).each(function(){var ae=(I(ad.item||this).attr(ad.attribute||"id")||"").match(ad.expression||(/(.+)[\-=_](.+)/));if(ae){ac.push((ad.key||ae[1]+"[]")+"="+(ad.key&&ad.expression?ae[1]:ae[2]))}});if(!ac.length&&ad.key){ac.push(ad.key+"=")}return ac.join("&")},toArray:function(ad){var ab=this._getItemsAsjQuery(ad&&ad.connected),ac=[];ad=ad||{};ab.each(function(){ac.push(I(ad.item||this).attr(ad.attribute||"id")||"")});return ac},_intersectsWith:function(am){var ad=this.positionAbs.left,ac=ad+this.helperProportions.width,ak=this.positionAbs.top,aj=ak+this.helperProportions.height,ae=am.left,ab=ae+am.width,an=am.top,ai=an+am.height,ao=this.offset.click.top,ah=this.offset.click.left,ag=(this.options.axis==="x")||((ak+ao)>an&&(ak+ao)<ai),al=(this.options.axis==="y")||((ad+ah)>ae&&(ad+ah)<ab),af=ag&&al;if(this.options.tolerance==="pointer"||this.options.forcePointerForContainers||(this.options.tolerance!=="pointer"&&this.helperProportions[this.floating?"width":"height"]>am[this.floating?"width":"height"])){return af}else{return(ae<ad+(this.helperProportions.width/2)&&ac-(this.helperProportions.width/2)<ab&&an<ak+(this.helperProportions.height/2)&&aj-(this.helperProportions.height/2)<ai)}},_intersectsWithPointer:function(ad){var ae=(this.options.axis==="x")||this._isOverAxis(this.positionAbs.top+this.offset.click.top,ad.top,ad.height),ac=(this.options.axis==="y")||this._isOverAxis(this.positionAbs.left+this.offset.click.left,ad.left,ad.width),ag=ae&&ac,ab=this._getDragVerticalDirection(),af=this._getDragHorizontalDirection();if(!ag){return false}return this.floating?(((af&&af==="right")||ab==="down")?2:1):(ab&&(ab==="down"?2:1))},_intersectsWithSides:function(ae){var ac=this._isOverAxis(this.positionAbs.top+this.offset.click.top,ae.top+(ae.height/2),ae.height),ad=this._isOverAxis(this.positionAbs.left+this.offset.click.left,ae.left+(ae.width/2),ae.width),ab=this._getDragVerticalDirection(),af=this._getDragHorizontalDirection();if(this.floating&&af){return((af==="right"&&ad)||(af==="left"&&!ad))}else{return ab&&((ab==="down"&&ac)||(ab==="up"&&!ac))}},_getDragVerticalDirection:function(){var ab=this.positionAbs.top-this.lastPositionAbs.top;return ab!==0&&(ab>0?"down":"up")},_getDragHorizontalDirection:function(){var ab=this.positionAbs.left-this.lastPositionAbs.left;return ab!==0&&(ab>0?"right":"left")},refresh:function(ab){this._refreshItems(ab);this._setHandleClassName();this.refreshPositions();return this},_connectWith:function(){var ab=this.options;return ab.connectWith.constructor===String?[ab.connectWith]:ab.connectWith},_getItemsAsjQuery:function(ab){var ad,ac,ai,af,ag=[],ae=[],ah=this._connectWith();if(ah&&ab){for(ad=ah.length-1;ad>=0;ad--){ai=I(ah[ad],this.document[0]);for(ac=ai.length-1;ac>=0;ac--){af=I.data(ai[ac],this.widgetFullName);if(af&&af!==this&&!af.options.disabled){ae.push([I.isFunction(af.options.items)?af.options.items.call(af.element):I(af.options.items,af.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),af])}}}}ae.push([I.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):I(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]);function aj(){ag.push(this)}for(ad=ae.length-1;ad>=0;ad--){ae[ad][0].each(aj)}return I(ag)},_removeCurrentsFromItems:function(){var ab=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=I.grep(this.items,function(ad){for(var ac=0;ac<ab.length;ac++){if(ab[ac]===ad.item[0]){return false}}return true})},_refreshItems:function(ab){this.items=[];this.containers=[this];var af,ad,ak,ag,aj,ac,am,al,ah=this.items,ae=[[I.isFunction(this.options.items)?this.options.items.call(this.element[0],ab,{item:this.currentItem}):I(this.options.items,this.element),this]],ai=this._connectWith();if(ai&&this.ready){for(af=ai.length-1;af>=0;af--){ak=I(ai[af],this.document[0]);for(ad=ak.length-1;ad>=0;ad--){ag=I.data(ak[ad],this.widgetFullName);if(ag&&ag!==this&&!ag.options.disabled){ae.push([I.isFunction(ag.options.items)?ag.options.items.call(ag.element[0],ab,{item:this.currentItem}):I(ag.options.items,ag.element),ag]);this.containers.push(ag)}}}}for(af=ae.length-1;af>=0;af--){aj=ae[af][1];ac=ae[af][0];for(ad=0,al=ac.length;ad<al;ad++){am=I(ac[ad]);am.data(this.widgetName+"-item",aj);ah.push({item:am,instance:aj,width:0,height:0,left:0,top:0})}}},refreshPositions:function(ab){if(this.offsetParent&&this.helper){this.offset.parent=this._getParentOffset()}var ad,ae,ac,af;for(ad=this.items.length-1;ad>=0;ad--){ae=this.items[ad];if(ae.instance!==this.currentContainer&&this.currentContainer&&ae.item[0]!==this.currentItem[0]){continue}ac=this.options.toleranceElement?I(this.options.toleranceElement,ae.item):ae.item;if(!ab){ae.width=ac.outerWidth();ae.height=ac.outerHeight()}af=ac.offset();ae.left=af.left;ae.top=af.top}if(this.options.custom&&this.options.custom.refreshContainers){this.options.custom.refreshContainers.call(this)}else{for(ad=this.containers.length-1;ad>=0;ad--){af=this.containers[ad].element.offset();this.containers[ad].containerCache.left=af.left;this.containers[ad].containerCache.top=af.top;this.containers[ad].containerCache.width=this.containers[ad].element.outerWidth();this.containers[ad].containerCache.height=this.containers[ad].element.outerHeight()}}return this},_createPlaceholder:function(ac){ac=ac||this;var ab,ad=ac.options;if(!ad.placeholder||ad.placeholder.constructor===String){ab=ad.placeholder;ad.placeholder={element:function(){var af=ac.currentItem[0].nodeName.toLowerCase(),ae=I("<"+af+">",ac.document[0]).addClass(ab||ac.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper");if(af==="tr"){ac.currentItem.children().each(function(){I("<td>&#160;</td>",ac.document[0]).attr("colspan",I(this).attr("colspan")||1).appendTo(ae)})}else{if(af==="img"){ae.attr("src",ac.currentItem.attr("src"))}}if(!ab){ae.css("visibility","hidden")}return ae},update:function(ae,af){if(ab&&!ad.forcePlaceholderSize){return}if(!af.height()){af.height(ac.currentItem.innerHeight()-parseInt(ac.currentItem.css("paddingTop")||0,10)-parseInt(ac.currentItem.css("paddingBottom")||0,10))}if(!af.width()){af.width(ac.currentItem.innerWidth()-parseInt(ac.currentItem.css("paddingLeft")||0,10)-parseInt(ac.currentItem.css("paddingRight")||0,10))}}}}ac.placeholder=I(ad.placeholder.element.call(ac.element,ac.currentItem));ac.currentItem.after(ac.placeholder);ad.placeholder.update(ac,ac.placeholder)},_contactContainers:function(ab){var ag,ae,ak,ah,ai,am,an,af,aj,ad,ac=null,al=null;for(ag=this.containers.length-1;ag>=0;ag--){if(I.contains(this.currentItem[0],this.containers[ag].element[0])){continue}if(this._intersectsWith(this.containers[ag].containerCache)){if(ac&&I.contains(this.containers[ag].element[0],ac.element[0])){continue}ac=this.containers[ag];al=ag}else{if(this.containers[ag].containerCache.over){this.containers[ag]._trigger("out",ab,this._uiHash(this));this.containers[ag].containerCache.over=0}}}if(!ac){return}if(this.containers.length===1){if(!this.containers[al].containerCache.over){this.containers[al]._trigger("over",ab,this._uiHash(this));this.containers[al].containerCache.over=1}}else{ak=10000;ah=null;aj=ac.floating||this._isFloating(this.currentItem);ai=aj?"left":"top";am=aj?"width":"height";ad=aj?"clientX":"clientY";for(ae=this.items.length-1;ae>=0;ae--){if(!I.contains(this.containers[al].element[0],this.items[ae].item[0])){continue}if(this.items[ae].item[0]===this.currentItem[0]){continue}an=this.items[ae].item.offset()[ai];af=false;if(ab[ad]-an>this.items[ae][am]/2){af=true}if(Math.abs(ab[ad]-an)<ak){ak=Math.abs(ab[ad]-an);ah=this.items[ae];this.direction=af?"up":"down"}}if(!ah&&!this.options.dropOnEmpty){return}if(this.currentContainer===this.containers[al]){if(!this.currentContainer.containerCache.over){this.containers[al]._trigger("over",ab,this._uiHash());this.currentContainer.containerCache.over=1}return}ah?this._rearrange(ab,ah,null,true):this._rearrange(ab,null,this.containers[al].element,true);this._trigger("change",ab,this._uiHash());this.containers[al]._trigger("change",ab,this._uiHash(this));this.currentContainer=this.containers[al];this.options.placeholder.update(this.currentContainer,this.placeholder);this.containers[al]._trigger("over",ab,this._uiHash(this));this.containers[al].containerCache.over=1}},_createHelper:function(ac){var ad=this.options,ab=I.isFunction(ad.helper)?I(ad.helper.apply(this.element[0],[ac,this.currentItem])):(ad.helper==="clone"?this.currentItem.clone():this.currentItem);if(!ab.parents("body").length){I(ad.appendTo!=="parent"?ad.appendTo:this.currentItem[0].parentNode)[0].appendChild(ab[0])}if(ab[0]===this.currentItem[0]){this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}}if(!ab[0].style.width||ad.forceHelperSize){ab.width(this.currentItem.width())}if(!ab[0].style.height||ad.forceHelperSize){ab.height(this.currentItem.height())}return ab},_adjustOffsetFromHelper:function(ab){if(typeof ab==="string"){ab=ab.split(" ")}if(I.isArray(ab)){ab={left:+ab[0],top:+ab[1]||0}}if("left" in ab){this.offset.click.left=ab.left+this.margins.left}if("right" in ab){this.offset.click.left=this.helperProportions.width-ab.right+this.margins.left}if("top" in ab){this.offset.click.top=ab.top+this.margins.top}if("bottom" in ab){this.offset.click.top=this.helperProportions.height-ab.bottom+this.margins.top}},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var ab=this.offsetParent.offset();if(this.cssPosition==="absolute"&&this.scrollParent[0]!==this.document[0]&&I.contains(this.scrollParent[0],this.offsetParent[0])){ab.left+=this.scrollParent.scrollLeft();ab.top+=this.scrollParent.scrollTop()}if(this.offsetParent[0]===this.document[0].body||(this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()==="html"&&I.ui.ie)){ab={top:0,left:0}}return{top:ab.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:ab.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition==="relative"){var ab=this.currentItem.position();return{top:ab.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:ab.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}else{return{top:0,left:0}}},_cacheMargins:function(){this.margins={left:(parseInt(this.currentItem.css("marginLeft"),10)||0),top:(parseInt(this.currentItem.css("marginTop"),10)||0)}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var ac,ae,ab,ad=this.options;if(ad.containment==="parent"){ad.containment=this.helper[0].parentNode}if(ad.containment==="document"||ad.containment==="window"){this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,ad.containment==="document"?this.document.width():this.window.width()-this.helperProportions.width-this.margins.left,(ad.containment==="document"?this.document.width():this.window.height()||this.document[0].body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]}if(!(/^(document|window|parent)$/).test(ad.containment)){ac=I(ad.containment)[0];ae=I(ad.containment).offset();ab=(I(ac).css("overflow")!=="hidden");this.containment=[ae.left+(parseInt(I(ac).css("borderLeftWidth"),10)||0)+(parseInt(I(ac).css("paddingLeft"),10)||0)-this.margins.left,ae.top+(parseInt(I(ac).css("borderTopWidth"),10)||0)+(parseInt(I(ac).css("paddingTop"),10)||0)-this.margins.top,ae.left+(ab?Math.max(ac.scrollWidth,ac.offsetWidth):ac.offsetWidth)-(parseInt(I(ac).css("borderLeftWidth"),10)||0)-(parseInt(I(ac).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,ae.top+(ab?Math.max(ac.scrollHeight,ac.offsetHeight):ac.offsetHeight)-(parseInt(I(ac).css("borderTopWidth"),10)||0)-(parseInt(I(ac).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top]}},_convertPositionTo:function(ad,af){if(!af){af=this.position}var ac=ad==="absolute"?1:-1,ab=this.cssPosition==="absolute"&&!(this.scrollParent[0]!==this.document[0]&&I.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,ae=(/(html|body)/i).test(ab[0].tagName);return{top:(af.top+this.offset.relative.top*ac+this.offset.parent.top*ac-((this.cssPosition==="fixed"?-this.scrollParent.scrollTop():(ae?0:ab.scrollTop()))*ac)),left:(af.left+this.offset.relative.left*ac+this.offset.parent.left*ac-((this.cssPosition==="fixed"?-this.scrollParent.scrollLeft():ae?0:ab.scrollLeft())*ac))}},_generatePosition:function(ae){var ag,af,ah=this.options,ad=ae.pageX,ac=ae.pageY,ab=this.cssPosition==="absolute"&&!(this.scrollParent[0]!==this.document[0]&&I.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,ai=(/(html|body)/i).test(ab[0].tagName);if(this.cssPosition==="relative"&&!(this.scrollParent[0]!==this.document[0]&&this.scrollParent[0]!==this.offsetParent[0])){this.offset.relative=this._getRelativeOffset()}if(this.originalPosition){if(this.containment){if(ae.pageX-this.offset.click.left<this.containment[0]){ad=this.containment[0]+this.offset.click.left}if(ae.pageY-this.offset.click.top<this.containment[1]){ac=this.containment[1]+this.offset.click.top}if(ae.pageX-this.offset.click.left>this.containment[2]){ad=this.containment[2]+this.offset.click.left}if(ae.pageY-this.offset.click.top>this.containment[3]){ac=this.containment[3]+this.offset.click.top}}if(ah.grid){ag=this.originalPageY+Math.round((ac-this.originalPageY)/ah.grid[1])*ah.grid[1];ac=this.containment?((ag-this.offset.click.top>=this.containment[1]&&ag-this.offset.click.top<=this.containment[3])?ag:((ag-this.offset.click.top>=this.containment[1])?ag-ah.grid[1]:ag+ah.grid[1])):ag;af=this.originalPageX+Math.round((ad-this.originalPageX)/ah.grid[0])*ah.grid[0];ad=this.containment?((af-this.offset.click.left>=this.containment[0]&&af-this.offset.click.left<=this.containment[2])?af:((af-this.offset.click.left>=this.containment[0])?af-ah.grid[0]:af+ah.grid[0])):af}}return{top:(ac-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+((this.cssPosition==="fixed"?-this.scrollParent.scrollTop():(ai?0:ab.scrollTop())))),left:(ad-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+((this.cssPosition==="fixed"?-this.scrollParent.scrollLeft():ai?0:ab.scrollLeft())))}},_rearrange:function(af,ae,ac,ad){ac?ac[0].appendChild(this.placeholder[0]):ae.item[0].parentNode.insertBefore(this.placeholder[0],(this.direction==="down"?ae.item[0]:ae.item[0].nextSibling));this.counter=this.counter?++this.counter:1;var ab=this.counter;this._delay(function(){if(ab===this.counter){this.refreshPositions(!ad)}})},_clear:function(ac,ae){this.reverting=false;var ab,af=[];if(!this._noFinalSort&&this.currentItem.parent().length){this.placeholder.before(this.currentItem)}this._noFinalSort=null;if(this.helper[0]===this.currentItem[0]){for(ab in this._storedCSS){if(this._storedCSS[ab]==="auto"||this._storedCSS[ab]==="static"){this._storedCSS[ab]=""}}this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else{this.currentItem.show()}if(this.fromOutside&&!ae){af.push(function(ag){this._trigger("receive",ag,this._uiHash(this.fromOutside))})}if((this.fromOutside||this.domPosition.prev!==this.currentItem.prev().not(".ui-sortable-helper")[0]||this.domPosition.parent!==this.currentItem.parent()[0])&&!ae){af.push(function(ag){this._trigger("update",ag,this._uiHash())})}if(this!==this.currentContainer){if(!ae){af.push(function(ag){this._trigger("remove",ag,this._uiHash())});af.push((function(ag){return function(ah){ag._trigger("receive",ah,this._uiHash(this))}}).call(this,this.currentContainer));af.push((function(ag){return function(ah){ag._trigger("update",ah,this._uiHash(this))}}).call(this,this.currentContainer))}}function ad(ai,ag,ah){return function(aj){ah._trigger(ai,aj,ag._uiHash(ag))}}for(ab=this.containers.length-1;ab>=0;ab--){if(!ae){af.push(ad("deactivate",this,this.containers[ab]))}if(this.containers[ab].containerCache.over){af.push(ad("out",this,this.containers[ab]));this.containers[ab].containerCache.over=0}}if(this.storedCursor){this.document.find("body").css("cursor",this.storedCursor);this.storedStylesheet.remove()}if(this._storedOpacity){this.helper.css("opacity",this._storedOpacity)}if(this._storedZIndex){this.helper.css("zIndex",this._storedZIndex==="auto"?"":this._storedZIndex)}this.dragging=false;if(!ae){this._trigger("beforeStop",ac,this._uiHash())}this.placeholder[0].parentNode.removeChild(this.placeholder[0]);if(!this.cancelHelperRemoval){if(this.helper[0]!==this.currentItem[0]){this.helper.remove()}this.helper=null}if(!ae){for(ab=0;ab<af.length;ab++){af[ab].call(this,ac)}this._trigger("stop",ac,this._uiHash())}this.fromOutside=false;return !this.cancelHelperRemoval},_trigger:function(){if(I.Widget.prototype._trigger.apply(this,arguments)===false){this.cancel()}},_uiHash:function(ab){var ac=ab||this;return{helper:ac.helper,placeholder:ac.placeholder||I([]),position:ac.position,originalPosition:ac.originalPosition,offset:ac.positionAbs,item:ac.currentItem,sender:ab?ab.element:null}}});
/*!
 * jQuery UI Accordion 1.11.3
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/accordion/
 */
var aa=I.widget("ui.accordion",{version:"1.11.3",options:{active:0,animate:{},collapsible:false,event:"click",header:"> li > :first-child,> :not(li):even",heightStyle:"auto",icons:{activeHeader:"ui-icon-triangle-1-s",header:"ui-icon-triangle-1-e"},activate:null,beforeActivate:null},hideProps:{borderTopWidth:"hide",borderBottomWidth:"hide",paddingTop:"hide",paddingBottom:"hide",height:"hide"},showProps:{borderTopWidth:"show",borderBottomWidth:"show",paddingTop:"show",paddingBottom:"show",height:"show"},_create:function(){var ab=this.options;this.prevShow=this.prevHide=I();this.element.addClass("ui-accordion ui-widget ui-helper-reset").attr("role","tablist");if(!ab.collapsible&&(ab.active===false||ab.active==null)){ab.active=0}this._processPanels();if(ab.active<0){ab.active+=this.headers.length}this._refresh()},_getCreateEventData:function(){return{header:this.active,panel:!this.active.length?I():this.active.next()}},_createIcons:function(){var ab=this.options.icons;if(ab){I("<span>").addClass("ui-accordion-header-icon ui-icon "+ab.header).prependTo(this.headers);this.active.children(".ui-accordion-header-icon").removeClass(ab.header).addClass(ab.activeHeader);this.headers.addClass("ui-accordion-icons")}},_destroyIcons:function(){this.headers.removeClass("ui-accordion-icons").children(".ui-accordion-header-icon").remove()},_destroy:function(){var ab;this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role");this.headers.removeClass("ui-accordion-header ui-accordion-header-active ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top").removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-selected").removeAttr("aria-controls").removeAttr("tabIndex").removeUniqueId();this._destroyIcons();ab=this.headers.next().removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-state-disabled").css("display","").removeAttr("role").removeAttr("aria-hidden").removeAttr("aria-labelledby").removeUniqueId();if(this.options.heightStyle!=="content"){ab.css("height","")}},_setOption:function(ab,ac){if(ab==="active"){this._activate(ac);return}if(ab==="event"){if(this.options.event){this._off(this.headers,this.options.event)}this._setupEvents(ac)}this._super(ab,ac);if(ab==="collapsible"&&!ac&&this.options.active===false){this._activate(0)}if(ab==="icons"){this._destroyIcons();if(ac){this._createIcons()}}if(ab==="disabled"){this.element.toggleClass("ui-state-disabled",!!ac).attr("aria-disabled",ac);this.headers.add(this.headers.next()).toggleClass("ui-state-disabled",!!ac)}},_keydown:function(ae){if(ae.altKey||ae.ctrlKey){return}var af=I.ui.keyCode,ad=this.headers.length,ab=this.headers.index(ae.target),ac=false;switch(ae.keyCode){case af.RIGHT:case af.DOWN:ac=this.headers[(ab+1)%ad];break;case af.LEFT:case af.UP:ac=this.headers[(ab-1+ad)%ad];break;case af.SPACE:case af.ENTER:this._eventHandler(ae);break;case af.HOME:ac=this.headers[0];break;case af.END:ac=this.headers[ad-1];break}if(ac){I(ae.target).attr("tabIndex",-1);I(ac).attr("tabIndex",0);ac.focus();ae.preventDefault()}},_panelKeyDown:function(ab){if(ab.keyCode===I.ui.keyCode.UP&&ab.ctrlKey){I(ab.currentTarget).prev().focus()}},refresh:function(){var ab=this.options;this._processPanels();if((ab.active===false&&ab.collapsible===true)||!this.headers.length){ab.active=false;this.active=I()}else{if(ab.active===false){this._activate(0)}else{if(this.active.length&&!I.contains(this.element[0],this.active[0])){if(this.headers.length===this.headers.find(".ui-state-disabled").length){ab.active=false;this.active=I()}else{this._activate(Math.max(0,ab.active-1))}}else{ab.active=this.headers.index(this.active)}}}this._destroyIcons();this._refresh()},_processPanels:function(){var ac=this.headers,ab=this.panels;this.headers=this.element.find(this.options.header).addClass("ui-accordion-header ui-state-default ui-corner-all");this.panels=this.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom").filter(":not(.ui-accordion-content-active)").hide();if(ab){this._off(ac.not(this.headers));this._off(ab.not(this.panels))}},_refresh:function(){var ae,ac=this.options,ab=ac.heightStyle,ad=this.element.parent();this.active=this._findActive(ac.active).addClass("ui-accordion-header-active ui-state-active ui-corner-top").removeClass("ui-corner-all");this.active.next().addClass("ui-accordion-content-active").show();this.headers.attr("role","tab").each(function(){var ai=I(this),ah=ai.uniqueId().attr("id"),af=ai.next(),ag=af.uniqueId().attr("id");ai.attr("aria-controls",ag);af.attr("aria-labelledby",ah)}).next().attr("role","tabpanel");this.headers.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}).next().attr({"aria-hidden":"true"}).hide();if(!this.active.length){this.headers.eq(0).attr("tabIndex",0)}else{this.active.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}).next().attr({"aria-hidden":"false"})}this._createIcons();this._setupEvents(ac.event);if(ab==="fill"){ae=ad.height();this.element.siblings(":visible").each(function(){var ag=I(this),af=ag.css("position");if(af==="absolute"||af==="fixed"){return}ae-=ag.outerHeight(true)});this.headers.each(function(){ae-=I(this).outerHeight(true)});this.headers.next().each(function(){I(this).height(Math.max(0,ae-I(this).innerHeight()+I(this).height()))}).css("overflow","auto")}else{if(ab==="auto"){ae=0;this.headers.next().each(function(){ae=Math.max(ae,I(this).css("height","").height())}).height(ae)}}},_activate:function(ab){var ac=this._findActive(ab)[0];if(ac===this.active[0]){return}ac=ac||this.active[0];this._eventHandler({target:ac,currentTarget:ac,preventDefault:I.noop})},_findActive:function(ab){return typeof ab==="number"?this.headers.eq(ab):I()},_setupEvents:function(ac){var ab={keydown:"_keydown"};if(ac){I.each(ac.split(" "),function(ae,ad){ab[ad]="_eventHandler"})}this._off(this.headers.add(this.headers.next()));this._on(this.headers,ab);this._on(this.headers.next(),{keydown:"_panelKeyDown"});this._hoverable(this.headers);this._focusable(this.headers)},_eventHandler:function(ab){var aj=this.options,ae=this.active,af=I(ab.currentTarget),ah=af[0]===ae[0],ac=ah&&aj.collapsible,ad=ac?I():af.next(),ag=ae.next(),ai={oldHeader:ae,oldPanel:ag,newHeader:ac?I():af,newPanel:ad};ab.preventDefault();if((ah&&!aj.collapsible)||(this._trigger("beforeActivate",ab,ai)===false)){return}aj.active=ac?false:this.headers.index(af);this.active=ah?I():af;this._toggle(ai);ae.removeClass("ui-accordion-header-active ui-state-active");if(aj.icons){ae.children(".ui-accordion-header-icon").removeClass(aj.icons.activeHeader).addClass(aj.icons.header)}if(!ah){af.removeClass("ui-corner-all").addClass("ui-accordion-header-active ui-state-active ui-corner-top");if(aj.icons){af.children(".ui-accordion-header-icon").removeClass(aj.icons.header).addClass(aj.icons.activeHeader)}af.next().addClass("ui-accordion-content-active")}},_toggle:function(ad){var ab=ad.newPanel,ac=this.prevShow.length?this.prevShow:ad.oldPanel;this.prevShow.add(this.prevHide).stop(true,true);this.prevShow=ab;this.prevHide=ac;if(this.options.animate){this._animate(ab,ac,ad)}else{ac.hide();ab.show();this._toggleComplete(ad)}ac.attr({"aria-hidden":"true"});ac.prev().attr({"aria-selected":"false","aria-expanded":"false"});if(ab.length&&ac.length){ac.prev().attr({tabIndex:-1,"aria-expanded":"false"})}else{if(ab.length){this.headers.filter(function(){return parseInt(I(this).attr("tabIndex"),10)===0}).attr("tabIndex",-1)}}ab.attr("aria-hidden","false").prev().attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0})},_animate:function(ab,aj,af){var ai,ah,ae,ag=this,ak=0,al=ab.length&&(!aj.length||(ab.index()<aj.index())),ad=this.options.animate||{},am=al&&ad.down||ad,ac=function(){ag._toggleComplete(af)};if(typeof am==="number"){ae=am}if(typeof am==="string"){ah=am}ah=ah||am.easing||ad.easing;ae=ae||am.duration||ad.duration;if(!aj.length){return ab.animate(this.showProps,ae,ah,ac)}if(!ab.length){return aj.animate(this.hideProps,ae,ah,ac)}ai=ab.show().outerHeight();aj.animate(this.hideProps,{duration:ae,easing:ah,step:function(an,ao){ao.now=Math.round(an)}});ab.hide().animate(this.showProps,{duration:ae,easing:ah,complete:ac,step:function(an,ao){ao.now=Math.round(an);if(ao.prop!=="height"){ak+=ao.now}else{if(ag.options.heightStyle!=="content"){ao.now=Math.round(ai-aj.outerHeight()-ak);ak=0}}}})},_toggleComplete:function(ac){var ab=ac.oldPanel;ab.removeClass("ui-accordion-content-active").prev().removeClass("ui-corner-top").addClass("ui-corner-all");if(ab.length){ab.parent()[0].className=ab.parent()[0].className}this._trigger("activate",null,ac)}});
/*!
 * jQuery UI Menu 1.11.3
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/menu/
 */
var X=I.widget("ui.menu",{version:"1.11.3",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-carat-1-e"},items:"> *",menus:"ul",position:{my:"left-1 top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element;this.mouseHandled=false;this.element.uniqueId().addClass("ui-menu ui-widget ui-widget-content").toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length).attr({role:this.options.role,tabIndex:0});if(this.options.disabled){this.element.addClass("ui-state-disabled").attr("aria-disabled","true")}this._on({"mousedown .ui-menu-item":function(ab){ab.preventDefault()},"click .ui-menu-item":function(ab){var ac=I(ab.target);if(!this.mouseHandled&&ac.not(".ui-state-disabled").length){this.select(ab);if(!ab.isPropagationStopped()){this.mouseHandled=true}if(ac.has(".ui-menu").length){this.expand(ab)}else{if(!this.element.is(":focus")&&I(this.document[0].activeElement).closest(".ui-menu").length){this.element.trigger("focus",[true]);if(this.active&&this.active.parents(".ui-menu").length===1){clearTimeout(this.timer)}}}}},"mouseenter .ui-menu-item":function(ab){if(this.previousFilter){return}var ac=I(ab.currentTarget);ac.siblings(".ui-state-active").removeClass("ui-state-active");this.focus(ab,ac)},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(ad,ab){var ac=this.active||this.element.find(this.options.items).eq(0);if(!ab){this.focus(ad,ac)}},blur:function(ab){this._delay(function(){if(!I.contains(this.element[0],this.document[0].activeElement)){this.collapseAll(ab)}})},keydown:"_keydown"});this.refresh();this._on(this.document,{click:function(ab){if(this._closeOnDocumentClick(ab)){this.collapseAll(ab)}this.mouseHandled=false}})},_destroy:function(){this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeClass("ui-menu ui-widget ui-widget-content ui-menu-icons ui-front").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-disabled").removeUniqueId().show();this.element.find(".ui-menu-item").removeClass("ui-menu-item").removeAttr("role").removeAttr("aria-disabled").removeUniqueId().removeClass("ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").children().each(function(){var ab=I(this);if(ab.data("ui-menu-submenu-carat")){ab.remove()}});this.element.find(".ui-menu-divider").removeClass("ui-menu-divider ui-widget-content")},_keydown:function(af){var ac,ae,ag,ad,ab=true;switch(af.keyCode){case I.ui.keyCode.PAGE_UP:this.previousPage(af);break;case I.ui.keyCode.PAGE_DOWN:this.nextPage(af);break;case I.ui.keyCode.HOME:this._move("first","first",af);break;case I.ui.keyCode.END:this._move("last","last",af);break;case I.ui.keyCode.UP:this.previous(af);break;case I.ui.keyCode.DOWN:this.next(af);break;case I.ui.keyCode.LEFT:this.collapse(af);break;case I.ui.keyCode.RIGHT:if(this.active&&!this.active.is(".ui-state-disabled")){this.expand(af)}break;case I.ui.keyCode.ENTER:case I.ui.keyCode.SPACE:this._activate(af);break;case I.ui.keyCode.ESCAPE:this.collapse(af);break;default:ab=false;ae=this.previousFilter||"";ag=String.fromCharCode(af.keyCode);ad=false;clearTimeout(this.filterTimer);if(ag===ae){ad=true}else{ag=ae+ag}ac=this._filterMenuItems(ag);ac=ad&&ac.index(this.active.next())!==-1?this.active.nextAll(".ui-menu-item"):ac;if(!ac.length){ag=String.fromCharCode(af.keyCode);ac=this._filterMenuItems(ag)}if(ac.length){this.focus(af,ac);this.previousFilter=ag;this.filterTimer=this._delay(function(){delete this.previousFilter},1000)}else{delete this.previousFilter}}if(ab){af.preventDefault()}},_activate:function(ab){if(!this.active.is(".ui-state-disabled")){if(this.active.is("[aria-haspopup='true']")){this.expand(ab)}else{this.select(ab)}}},refresh:function(){var af,ac,ae=this,ad=this.options.icons.submenu,ab=this.element.find(this.options.menus);this.element.toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length);ab.filter(":not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-front").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var ai=I(this),ah=ai.parent(),ag=I("<span>").addClass("ui-menu-icon ui-icon "+ad).data("ui-menu-submenu-carat",true);ah.attr("aria-haspopup","true").prepend(ag);ai.attr("aria-labelledby",ah.attr("id"))});af=ab.add(this.element);ac=af.find(this.options.items);ac.not(".ui-menu-item").each(function(){var ag=I(this);if(ae._isDivider(ag)){ag.addClass("ui-widget-content ui-menu-divider")}});ac.not(".ui-menu-item, .ui-menu-divider").addClass("ui-menu-item").uniqueId().attr({tabIndex:-1,role:this._itemRole()});ac.filter(".ui-state-disabled").attr("aria-disabled","true");if(this.active&&!I.contains(this.element[0],this.active[0])){this.blur()}},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(ab,ac){if(ab==="icons"){this.element.find(".ui-menu-icon").removeClass(this.options.icons.submenu).addClass(ac.submenu)}if(ab==="disabled"){this.element.toggleClass("ui-state-disabled",!!ac).attr("aria-disabled",ac)}this._super(ab,ac)},focus:function(ac,ab){var ae,ad;this.blur(ac,ac&&ac.type==="focus");this._scrollIntoView(ab);this.active=ab.first();ad=this.active.addClass("ui-state-focus").removeClass("ui-state-active");if(this.options.role){this.element.attr("aria-activedescendant",ad.attr("id"))}this.active.parent().closest(".ui-menu-item").addClass("ui-state-active");if(ac&&ac.type==="keydown"){this._close()}else{this.timer=this._delay(function(){this._close()},this.delay)}ae=ab.children(".ui-menu");if(ae.length&&ac&&(/^mouse/.test(ac.type))){this._startOpening(ae)}this.activeMenu=ab.parent();this._trigger("focus",ac,{item:ab})},_scrollIntoView:function(ae){var ah,ad,af,ab,ac,ag;if(this._hasScroll()){ah=parseFloat(I.css(this.activeMenu[0],"borderTopWidth"))||0;ad=parseFloat(I.css(this.activeMenu[0],"paddingTop"))||0;af=ae.offset().top-this.activeMenu.offset().top-ah-ad;ab=this.activeMenu.scrollTop();ac=this.activeMenu.height();ag=ae.outerHeight();if(af<0){this.activeMenu.scrollTop(ab+af)}else{if(af+ag>ac){this.activeMenu.scrollTop(ab+af-ac+ag)}}}},blur:function(ac,ab){if(!ab){clearTimeout(this.timer)}if(!this.active){return}this.active.removeClass("ui-state-focus");this.active=null;this._trigger("blur",ac,{item:this.active})},_startOpening:function(ab){clearTimeout(this.timer);if(ab.attr("aria-hidden")!=="true"){return}this.timer=this._delay(function(){this._close();this._open(ab)},this.delay)},_open:function(ac){var ab=I.extend({of:this.active},this.options.position);clearTimeout(this.timer);this.element.find(".ui-menu").not(ac.parents(".ui-menu")).hide().attr("aria-hidden","true");ac.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(ab)},collapseAll:function(ac,ab){clearTimeout(this.timer);this.timer=this._delay(function(){var ad=ab?this.element:I(ac&&ac.target).closest(this.element.find(".ui-menu"));if(!ad.length){ad=this.element}this._close(ad);this.blur(ac);this.activeMenu=ad},this.delay)},_close:function(ab){if(!ab){ab=this.active?this.active.parent():this.element}ab.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find(".ui-state-active").not(".ui-state-focus").removeClass("ui-state-active")},_closeOnDocumentClick:function(ab){return !I(ab.target).closest(".ui-menu").length},_isDivider:function(ab){return !/[^\-\u2014\u2013\s]/.test(ab.text())},collapse:function(ac){var ab=this.active&&this.active.parent().closest(".ui-menu-item",this.element);if(ab&&ab.length){this._close();this.focus(ac,ab)}},expand:function(ac){var ab=this.active&&this.active.children(".ui-menu ").find(this.options.items).first();if(ab&&ab.length){this._open(ab.parent());this._delay(function(){this.focus(ac,ab)})}},next:function(ab){this._move("next","first",ab)},previous:function(ab){this._move("prev","last",ab)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(ae,ac,ad){var ab;if(this.active){if(ae==="first"||ae==="last"){ab=this.active[ae==="first"?"prevAll":"nextAll"](".ui-menu-item").eq(-1)}else{ab=this.active[ae+"All"](".ui-menu-item").eq(0)}}if(!ab||!ab.length||!this.active){ab=this.activeMenu.find(this.options.items)[ac]()}this.focus(ad,ab)},nextPage:function(ad){var ac,ae,ab;if(!this.active){this.next(ad);return}if(this.isLastItem()){return}if(this._hasScroll()){ae=this.active.offset().top;ab=this.element.height();this.active.nextAll(".ui-menu-item").each(function(){ac=I(this);return ac.offset().top-ae-ab<0});this.focus(ad,ac)}else{this.focus(ad,this.activeMenu.find(this.options.items)[!this.active?"first":"last"]())}},previousPage:function(ad){var ac,ae,ab;if(!this.active){this.next(ad);return}if(this.isFirstItem()){return}if(this._hasScroll()){ae=this.active.offset().top;ab=this.element.height();this.active.prevAll(".ui-menu-item").each(function(){ac=I(this);return ac.offset().top-ae+ab>0});this.focus(ad,ac)}else{this.focus(ad,this.activeMenu.find(this.options.items).first())}},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(ab){this.active=this.active||I(ab.target).closest(".ui-menu-item");var ac={item:this.active};if(!this.active.has(".ui-menu").length){this.collapseAll(ab,true)}this._trigger("select",ab,ac)},_filterMenuItems:function(ad){var ab=ad.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&"),ac=new RegExp("^"+ab,"i");return this.activeMenu.find(this.options.items).filter(".ui-menu-item").filter(function(){return ac.test(I.trim(I(this).text()))})}});
/*!
 * jQuery UI Autocomplete 1.11.3
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/autocomplete/
 */
I.widget("ui.autocomplete",{version:"1.11.3",defaultElement:"<input>",options:{appendTo:null,autoFocus:false,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},requestIndex:0,pending:0,_create:function(){var ad,ab,ae,ag=this.element[0].nodeName.toLowerCase(),af=ag==="textarea",ac=ag==="input";this.isMultiLine=af?true:ac?false:this.element.prop("isContentEditable");this.valueMethod=this.element[af||ac?"val":"text"];this.isNewMenu=true;this.element.addClass("ui-autocomplete-input").attr("autocomplete","off");this._on(this.element,{keydown:function(ah){if(this.element.prop("readOnly")){ad=true;ae=true;ab=true;return}ad=false;ae=false;ab=false;var ai=I.ui.keyCode;switch(ah.keyCode){case ai.PAGE_UP:ad=true;this._move("previousPage",ah);break;case ai.PAGE_DOWN:ad=true;this._move("nextPage",ah);break;case ai.UP:ad=true;this._keyEvent("previous",ah);break;case ai.DOWN:ad=true;this._keyEvent("next",ah);break;case ai.ENTER:if(this.menu.active){ad=true;ah.preventDefault();this.menu.select(ah)}break;case ai.TAB:if(this.menu.active){this.menu.select(ah)}break;case ai.ESCAPE:if(this.menu.element.is(":visible")){if(!this.isMultiLine){this._value(this.term)}this.close(ah);ah.preventDefault()}break;default:ab=true;this._searchTimeout(ah);break}},keypress:function(ah){if(ad){ad=false;if(!this.isMultiLine||this.menu.element.is(":visible")){ah.preventDefault()}return}if(ab){return}var ai=I.ui.keyCode;switch(ah.keyCode){case ai.PAGE_UP:this._move("previousPage",ah);break;case ai.PAGE_DOWN:this._move("nextPage",ah);break;case ai.UP:this._keyEvent("previous",ah);break;case ai.DOWN:this._keyEvent("next",ah);break}},input:function(ah){if(ae){ae=false;ah.preventDefault();return}this._searchTimeout(ah)},focus:function(){this.selectedItem=null;this.previous=this._value()},blur:function(ah){if(this.cancelBlur){delete this.cancelBlur;return}clearTimeout(this.searching);this.close(ah);this._change(ah)}});this._initSource();this.menu=I("<ul>").addClass("ui-autocomplete ui-front").appendTo(this._appendTo()).menu({role:null}).hide().menu("instance");this._on(this.menu.element,{mousedown:function(ah){ah.preventDefault();this.cancelBlur=true;this._delay(function(){delete this.cancelBlur});var ai=this.menu.element[0];if(!I(ah.target).closest(".ui-menu-item").length){this._delay(function(){var aj=this;this.document.one("mousedown",function(ak){if(ak.target!==aj.element[0]&&ak.target!==ai&&!I.contains(ai,ak.target)){aj.close()}})})}},menufocus:function(aj,ak){var ah,ai;if(this.isNewMenu){this.isNewMenu=false;if(aj.originalEvent&&/^mouse/.test(aj.originalEvent.type)){this.menu.blur();this.document.one("mousemove",function(){I(aj.target).trigger(aj.originalEvent)});return}}ai=ak.item.data("ui-autocomplete-item");if(false!==this._trigger("focus",aj,{item:ai})){if(aj.originalEvent&&/^key/.test(aj.originalEvent.type)){this._value(ai.value)}}ah=ak.item.attr("aria-label")||ai.value;if(ah&&I.trim(ah).length){this.liveRegion.children().hide();I("<div>").text(ah).appendTo(this.liveRegion)}},menuselect:function(aj,ak){var ai=ak.item.data("ui-autocomplete-item"),ah=this.previous;if(this.element[0]!==this.document[0].activeElement){this.element.focus();this.previous=ah;this._delay(function(){this.previous=ah;this.selectedItem=ai})}if(false!==this._trigger("select",aj,{item:ai})){this._value(ai.value)}this.term=this._value();this.close(aj);this.selectedItem=ai}});this.liveRegion=I("<span>",{role:"status","aria-live":"assertive","aria-relevant":"additions"}).addClass("ui-helper-hidden-accessible").appendTo(this.document[0].body);this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching);this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete");this.menu.element.remove();this.liveRegion.remove()},_setOption:function(ab,ac){this._super(ab,ac);if(ab==="source"){this._initSource()}if(ab==="appendTo"){this.menu.element.appendTo(this._appendTo())}if(ab==="disabled"&&ac&&this.xhr){this.xhr.abort()}},_appendTo:function(){var ab=this.options.appendTo;if(ab){ab=ab.jquery||ab.nodeType?I(ab):this.document.find(ab).eq(0)}if(!ab||!ab[0]){ab=this.element.closest(".ui-front")}if(!ab.length){ab=this.document[0].body}return ab},_initSource:function(){var ad,ab,ac=this;if(I.isArray(this.options.source)){ad=this.options.source;this.source=function(af,ae){ae(I.ui.autocomplete.filter(ad,af.term))}}else{if(typeof this.options.source==="string"){ab=this.options.source;this.source=function(af,ae){if(ac.xhr){ac.xhr.abort()}ac.xhr=I.ajax({url:ab,data:af,dataType:"json",success:function(ag){ae(ag)},error:function(){ae([])}})}}else{this.source=this.options.source}}},_searchTimeout:function(ab){clearTimeout(this.searching);this.searching=this._delay(function(){var ad=this.term===this._value(),ac=this.menu.element.is(":visible"),ae=ab.altKey||ab.ctrlKey||ab.metaKey||ab.shiftKey;if(!ad||(ad&&!ac&&!ae)){this.selectedItem=null;this.search(null,ab)}},this.options.delay)},search:function(ac,ab){ac=ac!=null?ac:this._value();this.term=this._value();if(ac.length<this.options.minLength){return this.close(ab)}if(this._trigger("search",ab)===false){return}return this._search(ac)},_search:function(ab){this.pending++;this.element.addClass("ui-autocomplete-loading");this.cancelSearch=false;this.source({term:ab},this._response())},_response:function(){var ab=++this.requestIndex;return I.proxy(function(ac){if(ab===this.requestIndex){this.__response(ac)}this.pending--;if(!this.pending){this.element.removeClass("ui-autocomplete-loading")}},this)},__response:function(ab){if(ab){ab=this._normalize(ab)}this._trigger("response",null,{content:ab});if(!this.options.disabled&&ab&&ab.length&&!this.cancelSearch){this._suggest(ab);this._trigger("open")}else{this._close()}},close:function(ab){this.cancelSearch=true;this._close(ab)},_close:function(ab){if(this.menu.element.is(":visible")){this.menu.element.hide();this.menu.blur();this.isNewMenu=true;this._trigger("close",ab)}},_change:function(ab){if(this.previous!==this._value()){this._trigger("change",ab,{item:this.selectedItem})}},_normalize:function(ab){if(ab.length&&ab[0].label&&ab[0].value){return ab}return I.map(ab,function(ac){if(typeof ac==="string"){return{label:ac,value:ac}}return I.extend({},ac,{label:ac.label||ac.value,value:ac.value||ac.label})})},_suggest:function(ab){var ac=this.menu.element.empty();this._renderMenu(ac,ab);this.isNewMenu=true;this.menu.refresh();ac.show();this._resizeMenu();ac.position(I.extend({of:this.element},this.options.position));if(this.options.autoFocus){this.menu.next()}},_resizeMenu:function(){var ab=this.menu.element;ab.outerWidth(Math.max(ab.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(ac,ab){var ad=this;I.each(ab,function(ae,af){ad._renderItemData(ac,af)})},_renderItemData:function(ab,ac){return this._renderItem(ab,ac).data("ui-autocomplete-item",ac)},_renderItem:function(ab,ac){return I("<li>").text(ac.label).appendTo(ab)},_move:function(ac,ab){if(!this.menu.element.is(":visible")){this.search(null,ab);return}if(this.menu.isFirstItem()&&/^previous/.test(ac)||this.menu.isLastItem()&&/^next/.test(ac)){if(!this.isMultiLine){this._value(this.term)}this.menu.blur();return}this.menu[ac](ab)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(ac,ab){if(!this.isMultiLine||this.menu.element.is(":visible")){this._move(ac,ab);ab.preventDefault()}}});I.extend(I.ui.autocomplete,{escapeRegex:function(ab){return ab.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(ad,ab){var ac=new RegExp(I.ui.autocomplete.escapeRegex(ab),"i");return I.grep(ad,function(ae){return ac.test(ae.label||ae.value||ae)})}});I.widget("ui.autocomplete",I.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(ab){return ab+(ab>1?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(ac){var ab;this._superApply(arguments);if(this.options.disabled||this.cancelSearch){return}if(ac&&ac.length){ab=this.options.messages.results(ac.length)}else{ab=this.options.messages.noResults}this.liveRegion.children().hide();I("<div>").text(ab).appendTo(this.liveRegion)}});var c=I.ui.autocomplete;
/*!
 * jQuery UI Button 1.11.3
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/button/
 */
var s,W="ui-button ui-widget ui-state-default ui-corner-all",y="ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only",o=function(){var ab=I(this);setTimeout(function(){ab.find(":ui-button").button("refresh")},1)},z=function(ac){var ab=ac.name,ad=ac.form,ae=I([]);if(ab){ab=ab.replace(/'/g,"\\'");if(ad){ae=I(ad).find("[name='"+ab+"'][type=radio]")}else{ae=I("[name='"+ab+"'][type=radio]",ac.ownerDocument).filter(function(){return !this.form})}}return ae};I.widget("ui.button",{version:"1.11.3",defaultElement:"<button>",options:{disabled:null,text:true,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset"+this.eventNamespace).bind("reset"+this.eventNamespace,o);if(typeof this.options.disabled!=="boolean"){this.options.disabled=!!this.element.prop("disabled")}else{this.element.prop("disabled",this.options.disabled)}this._determineButtonType();this.hasTitle=!!this.buttonElement.attr("title");var ad=this,ab=this.options,ae=this.type==="checkbox"||this.type==="radio",ac=!ae?"ui-state-active":"";if(ab.label===null){ab.label=(this.type==="input"?this.buttonElement.val():this.buttonElement.html())}this._hoverable(this.buttonElement);this.buttonElement.addClass(W).attr("role","button").bind("mouseenter"+this.eventNamespace,function(){if(ab.disabled){return}if(this===s){I(this).addClass("ui-state-active")}}).bind("mouseleave"+this.eventNamespace,function(){if(ab.disabled){return}I(this).removeClass(ac)}).bind("click"+this.eventNamespace,function(af){if(ab.disabled){af.preventDefault();af.stopImmediatePropagation()}});this._on({focus:function(){this.buttonElement.addClass("ui-state-focus")},blur:function(){this.buttonElement.removeClass("ui-state-focus")}});if(ae){this.element.bind("change"+this.eventNamespace,function(){ad.refresh()})}if(this.type==="checkbox"){this.buttonElement.bind("click"+this.eventNamespace,function(){if(ab.disabled){return false}})}else{if(this.type==="radio"){this.buttonElement.bind("click"+this.eventNamespace,function(){if(ab.disabled){return false}I(this).addClass("ui-state-active");ad.buttonElement.attr("aria-pressed","true");var af=ad.element[0];z(af).not(af).map(function(){return I(this).button("widget")[0]}).removeClass("ui-state-active").attr("aria-pressed","false")})}else{this.buttonElement.bind("mousedown"+this.eventNamespace,function(){if(ab.disabled){return false}I(this).addClass("ui-state-active");s=this;ad.document.one("mouseup",function(){s=null})}).bind("mouseup"+this.eventNamespace,function(){if(ab.disabled){return false}I(this).removeClass("ui-state-active")}).bind("keydown"+this.eventNamespace,function(af){if(ab.disabled){return false}if(af.keyCode===I.ui.keyCode.SPACE||af.keyCode===I.ui.keyCode.ENTER){I(this).addClass("ui-state-active")}}).bind("keyup"+this.eventNamespace+" blur"+this.eventNamespace,function(){I(this).removeClass("ui-state-active")});if(this.buttonElement.is("a")){this.buttonElement.keyup(function(af){if(af.keyCode===I.ui.keyCode.SPACE){I(this).click()}})}}}this._setOption("disabled",ab.disabled);this._resetButton()},_determineButtonType:function(){var ab,ad,ac;if(this.element.is("[type=checkbox]")){this.type="checkbox"}else{if(this.element.is("[type=radio]")){this.type="radio"}else{if(this.element.is("input")){this.type="input"}else{this.type="button"}}}if(this.type==="checkbox"||this.type==="radio"){ab=this.element.parents().last();ad="label[for='"+this.element.attr("id")+"']";this.buttonElement=ab.find(ad);if(!this.buttonElement.length){ab=ab.length?ab.siblings():this.element.siblings();this.buttonElement=ab.filter(ad);if(!this.buttonElement.length){this.buttonElement=ab.find(ad)}}this.element.addClass("ui-helper-hidden-accessible");ac=this.element.is(":checked");if(ac){this.buttonElement.addClass("ui-state-active")}this.buttonElement.prop("aria-pressed",ac)}else{this.buttonElement=this.element}},widget:function(){return this.buttonElement},_destroy:function(){this.element.removeClass("ui-helper-hidden-accessible");this.buttonElement.removeClass(W+" ui-state-active "+y).removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html());if(!this.hasTitle){this.buttonElement.removeAttr("title")}},_setOption:function(ab,ac){this._super(ab,ac);if(ab==="disabled"){this.widget().toggleClass("ui-state-disabled",!!ac);this.element.prop("disabled",!!ac);if(ac){if(this.type==="checkbox"||this.type==="radio"){this.buttonElement.removeClass("ui-state-focus")}else{this.buttonElement.removeClass("ui-state-focus ui-state-active")}}return}this._resetButton()},refresh:function(){var ab=this.element.is("input, button")?this.element.is(":disabled"):this.element.hasClass("ui-button-disabled");if(ab!==this.options.disabled){this._setOption("disabled",ab)}if(this.type==="radio"){z(this.element[0]).each(function(){if(I(this).is(":checked")){I(this).button("widget").addClass("ui-state-active").attr("aria-pressed","true")}else{I(this).button("widget").removeClass("ui-state-active").attr("aria-pressed","false")}})}else{if(this.type==="checkbox"){if(this.element.is(":checked")){this.buttonElement.addClass("ui-state-active").attr("aria-pressed","true")}else{this.buttonElement.removeClass("ui-state-active").attr("aria-pressed","false")}}}},_resetButton:function(){if(this.type==="input"){if(this.options.label){this.element.val(this.options.label)}return}var af=this.buttonElement.removeClass(y),ad=I("<span></span>",this.document[0]).addClass("ui-button-text").html(this.options.label).appendTo(af.empty()).text(),ac=this.options.icons,ab=ac.primary&&ac.secondary,ae=[];if(ac.primary||ac.secondary){if(this.options.text){ae.push("ui-button-text-icon"+(ab?"s":(ac.primary?"-primary":"-secondary")))}if(ac.primary){af.prepend("<span class='ui-button-icon-primary ui-icon "+ac.primary+"'></span>")}if(ac.secondary){af.append("<span class='ui-button-icon-secondary ui-icon "+ac.secondary+"'></span>")}if(!this.options.text){ae.push(ab?"ui-button-icons-only":"ui-button-icon-only");if(!this.hasTitle){af.attr("title",I.trim(ad))}}}else{ae.push("ui-button-text-only")}af.addClass(ae.join(" "))}});I.widget("ui.buttonset",{version:"1.11.3",options:{items:"button, input[type=button], input[type=submit], input[type=reset], input[type=checkbox], input[type=radio], a, :data(ui-button)"},_create:function(){this.element.addClass("ui-buttonset")},_init:function(){this.refresh()},_setOption:function(ab,ac){if(ab==="disabled"){this.buttons.button("option",ab,ac)}this._super(ab,ac)},refresh:function(){var ac=this.element.css("direction")==="rtl",ab=this.element.find(this.options.items),ad=ab.filter(":ui-button");ab.not(":ui-button").button();ad.button("refresh");this.buttons=ab.map(function(){return I(this).button("widget")[0]}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(ac?"ui-corner-right":"ui-corner-left").end().filter(":last").addClass(ac?"ui-corner-left":"ui-corner-right").end().end()},_destroy:function(){this.element.removeClass("ui-buttonset");this.buttons.map(function(){return I(this).button("widget")[0]}).removeClass("ui-corner-left ui-corner-right").end().button("destroy")}});var r=I.ui.button;
/*!
 * jQuery UI Datepicker 1.11.3
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/datepicker/
 */
I.extend(I.ui,{datepicker:{version:"1.11.3"}});var m;function u(ac){var ab,ad;while(ac.length&&ac[0]!==document){ab=ac.css("position");if(ab==="absolute"||ab==="relative"||ab==="fixed"){ad=parseInt(ac.css("zIndex"),10);if(!isNaN(ad)&&ad!==0){return ad}}ac=ac.parent()}return 0}function Z(){this._curInst=null;this._keyEvent=false;this._disabledInputs=[];this._datepickerShowing=false;this._inDialog=false;this._mainDivId="ui-datepicker-div";this._inlineClass="ui-datepicker-inline";this._appendClass="ui-datepicker-append";this._triggerClass="ui-datepicker-trigger";this._dialogClass="ui-datepicker-dialog";this._disableClass="ui-datepicker-disabled";this._unselectableClass="ui-datepicker-unselectable";this._currentClass="ui-datepicker-current-day";this._dayOverClass="ui-datepicker-days-cell-over";this.regional=[];this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:false,showMonthAfterYear:false,yearSuffix:""};this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:false,hideIfNoPrevNext:false,navigationAsDateFormat:false,gotoCurrent:false,changeMonth:false,changeYear:false,yearRange:"c-10:c+10",showOtherMonths:false,selectOtherMonths:false,showWeek:false,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:true,showButtonPanel:false,autoSize:false,disabled:false};I.extend(this._defaults,this.regional[""]);this.regional.en=I.extend(true,{},this.regional[""]);this.regional["en-US"]=I.extend(true,{},this.regional.en);this.dpDiv=h(I("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))}I.extend(Z.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(ab){x(this._defaults,ab||{});return this},_attachDatepicker:function(ae,ab){var af,ad,ac;af=ae.nodeName.toLowerCase();ad=(af==="div"||af==="span");if(!ae.id){this.uuid+=1;ae.id="dp"+this.uuid}ac=this._newInst(I(ae),ad);ac.settings=I.extend({},ab||{});if(af==="input"){this._connectDatepicker(ae,ac)}else{if(ad){this._inlineDatepicker(ae,ac)}}},_newInst:function(ac,ab){var ad=ac[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1");return{id:ad,input:ac,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:ab,dpDiv:(!ab?this.dpDiv:h(I("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")))}},_connectDatepicker:function(ad,ac){var ab=I(ad);ac.append=I([]);ac.trigger=I([]);if(ab.hasClass(this.markerClassName)){return}this._attachments(ab,ac);ab.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp);this._autoSize(ac);I.data(ad,"datepicker",ac);if(ac.settings.disabled){this._disableDatepicker(ad)}},_attachments:function(ad,ag){var ac,af,ab,ah=this._get(ag,"appendText"),ae=this._get(ag,"isRTL");if(ag.append){ag.append.remove()}if(ah){ag.append=I("<span class='"+this._appendClass+"'>"+ah+"</span>");ad[ae?"before":"after"](ag.append)}ad.unbind("focus",this._showDatepicker);if(ag.trigger){ag.trigger.remove()}ac=this._get(ag,"showOn");if(ac==="focus"||ac==="both"){ad.focus(this._showDatepicker)}if(ac==="button"||ac==="both"){af=this._get(ag,"buttonText");ab=this._get(ag,"buttonImage");ag.trigger=I(this._get(ag,"buttonImageOnly")?I("<img/>").addClass(this._triggerClass).attr({src:ab,alt:af,title:af}):I("<button type='button'></button>").addClass(this._triggerClass).html(!ab?af:I("<img/>").attr({src:ab,alt:af,title:af})));ad[ae?"before":"after"](ag.trigger);ag.trigger.click(function(){if(I.datepicker._datepickerShowing&&I.datepicker._lastInput===ad[0]){I.datepicker._hideDatepicker()}else{if(I.datepicker._datepickerShowing&&I.datepicker._lastInput!==ad[0]){I.datepicker._hideDatepicker();I.datepicker._showDatepicker(ad[0])}else{I.datepicker._showDatepicker(ad[0])}}return false})}},_autoSize:function(ah){if(this._get(ah,"autoSize")&&!ah.inline){var ae,ac,ad,ag,af=new Date(2009,12-1,20),ab=this._get(ah,"dateFormat");if(ab.match(/[DM]/)){ae=function(ai){ac=0;ad=0;for(ag=0;ag<ai.length;ag++){if(ai[ag].length>ac){ac=ai[ag].length;ad=ag}}return ad};af.setMonth(ae(this._get(ah,(ab.match(/MM/)?"monthNames":"monthNamesShort"))));af.setDate(ae(this._get(ah,(ab.match(/DD/)?"dayNames":"dayNamesShort")))+20-af.getDay())}ah.input.attr("size",this._formatDate(ah,af).length)}},_inlineDatepicker:function(ac,ab){var ad=I(ac);if(ad.hasClass(this.markerClassName)){return}ad.addClass(this.markerClassName).append(ab.dpDiv);I.data(ac,"datepicker",ab);this._setDate(ab,this._getDefaultDate(ab),true);this._updateDatepicker(ab);this._updateAlternate(ab);if(ab.settings.disabled){this._disableDatepicker(ac)}ab.dpDiv.css("display","block")},_dialogDatepicker:function(ai,ac,ag,ad,ah){var ab,al,af,ak,aj,ae=this._dialogInst;if(!ae){this.uuid+=1;ab="dp"+this.uuid;this._dialogInput=I("<input type='text' id='"+ab+"' style='position: absolute; top: -100px; width: 0px;'/>");this._dialogInput.keydown(this._doKeyDown);I("body").append(this._dialogInput);ae=this._dialogInst=this._newInst(this._dialogInput,false);ae.settings={};I.data(this._dialogInput[0],"datepicker",ae)}x(ae.settings,ad||{});ac=(ac&&ac.constructor===Date?this._formatDate(ae,ac):ac);this._dialogInput.val(ac);this._pos=(ah?(ah.length?ah:[ah.pageX,ah.pageY]):null);if(!this._pos){al=document.documentElement.clientWidth;af=document.documentElement.clientHeight;ak=document.documentElement.scrollLeft||document.body.scrollLeft;aj=document.documentElement.scrollTop||document.body.scrollTop;this._pos=[(al/2)-100+ak,(af/2)-150+aj]}this._dialogInput.css("left",(this._pos[0]+20)+"px").css("top",this._pos[1]+"px");ae.settings.onSelect=ag;this._inDialog=true;this.dpDiv.addClass(this._dialogClass);this._showDatepicker(this._dialogInput[0]);if(I.blockUI){I.blockUI(this.dpDiv)}I.data(this._dialogInput[0],"datepicker",ae);return this},_destroyDatepicker:function(ad){var ae,ab=I(ad),ac=I.data(ad,"datepicker");if(!ab.hasClass(this.markerClassName)){return}ae=ad.nodeName.toLowerCase();I.removeData(ad,"datepicker");if(ae==="input"){ac.append.remove();ac.trigger.remove();ab.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)}else{if(ae==="div"||ae==="span"){ab.removeClass(this.markerClassName).empty()}}if(m===ac){m=null}},_enableDatepicker:function(ae){var af,ad,ab=I(ae),ac=I.data(ae,"datepicker");if(!ab.hasClass(this.markerClassName)){return}af=ae.nodeName.toLowerCase();if(af==="input"){ae.disabled=false;ac.trigger.filter("button").each(function(){this.disabled=false}).end().filter("img").css({opacity:"1.0",cursor:""})}else{if(af==="div"||af==="span"){ad=ab.children("."+this._inlineClass);ad.children().removeClass("ui-state-disabled");ad.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",false)}}this._disabledInputs=I.map(this._disabledInputs,function(ag){return(ag===ae?null:ag)})},_disableDatepicker:function(ae){var af,ad,ab=I(ae),ac=I.data(ae,"datepicker");if(!ab.hasClass(this.markerClassName)){return}af=ae.nodeName.toLowerCase();if(af==="input"){ae.disabled=true;ac.trigger.filter("button").each(function(){this.disabled=true}).end().filter("img").css({opacity:"0.5",cursor:"default"})}else{if(af==="div"||af==="span"){ad=ab.children("."+this._inlineClass);ad.children().addClass("ui-state-disabled");ad.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",true)}}this._disabledInputs=I.map(this._disabledInputs,function(ag){return(ag===ae?null:ag)});this._disabledInputs[this._disabledInputs.length]=ae},_isDisabledDatepicker:function(ac){if(!ac){return false}for(var ab=0;ab<this._disabledInputs.length;ab++){if(this._disabledInputs[ab]===ac){return true}}return false},_getInst:function(ac){try{return I.data(ac,"datepicker")}catch(ab){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(ah,ac,ag){var ad,ab,af,ai,ae=this._getInst(ah);if(arguments.length===2&&typeof ac==="string"){return(ac==="defaults"?I.extend({},I.datepicker._defaults):(ae?(ac==="all"?I.extend({},ae.settings):this._get(ae,ac)):null))}ad=ac||{};if(typeof ac==="string"){ad={};ad[ac]=ag}if(ae){if(this._curInst===ae){this._hideDatepicker()}ab=this._getDateDatepicker(ah,true);af=this._getMinMaxDate(ae,"min");ai=this._getMinMaxDate(ae,"max");x(ae.settings,ad);if(af!==null&&ad.dateFormat!==undefined&&ad.minDate===undefined){ae.settings.minDate=this._formatDate(ae,af)}if(ai!==null&&ad.dateFormat!==undefined&&ad.maxDate===undefined){ae.settings.maxDate=this._formatDate(ae,ai)}if("disabled" in ad){if(ad.disabled){this._disableDatepicker(ah)}else{this._enableDatepicker(ah)}}this._attachments(I(ah),ae);this._autoSize(ae);this._setDate(ae,ab);this._updateAlternate(ae);this._updateDatepicker(ae)}},_changeDatepicker:function(ad,ab,ac){this._optionDatepicker(ad,ab,ac)},_refreshDatepicker:function(ac){var ab=this._getInst(ac);if(ab){this._updateDatepicker(ab)}},_setDateDatepicker:function(ad,ab){var ac=this._getInst(ad);if(ac){this._setDate(ac,ab);this._updateDatepicker(ac);this._updateAlternate(ac)}},_getDateDatepicker:function(ad,ab){var ac=this._getInst(ad);if(ac&&!ac.inline){this._setDateFromField(ac,ab)}return(ac?this._getDate(ac):null)},_doKeyDown:function(ae){var ac,ab,ag,af=I.datepicker._getInst(ae.target),ah=true,ad=af.dpDiv.is(".ui-datepicker-rtl");af._keyEvent=true;if(I.datepicker._datepickerShowing){switch(ae.keyCode){case 9:I.datepicker._hideDatepicker();ah=false;break;case 13:ag=I("td."+I.datepicker._dayOverClass+":not(."+I.datepicker._currentClass+")",af.dpDiv);if(ag[0]){I.datepicker._selectDay(ae.target,af.selectedMonth,af.selectedYear,ag[0])}ac=I.datepicker._get(af,"onSelect");if(ac){ab=I.datepicker._formatDate(af);ac.apply((af.input?af.input[0]:null),[ab,af])}else{I.datepicker._hideDatepicker()}return false;case 27:I.datepicker._hideDatepicker();break;case 33:I.datepicker._adjustDate(ae.target,(ae.ctrlKey?-I.datepicker._get(af,"stepBigMonths"):-I.datepicker._get(af,"stepMonths")),"M");break;case 34:I.datepicker._adjustDate(ae.target,(ae.ctrlKey?+I.datepicker._get(af,"stepBigMonths"):+I.datepicker._get(af,"stepMonths")),"M");break;case 35:if(ae.ctrlKey||ae.metaKey){I.datepicker._clearDate(ae.target)}ah=ae.ctrlKey||ae.metaKey;break;case 36:if(ae.ctrlKey||ae.metaKey){I.datepicker._gotoToday(ae.target)}ah=ae.ctrlKey||ae.metaKey;break;case 37:if(ae.ctrlKey||ae.metaKey){I.datepicker._adjustDate(ae.target,(ad?+1:-1),"D")}ah=ae.ctrlKey||ae.metaKey;if(ae.originalEvent.altKey){I.datepicker._adjustDate(ae.target,(ae.ctrlKey?-I.datepicker._get(af,"stepBigMonths"):-I.datepicker._get(af,"stepMonths")),"M")}break;case 38:if(ae.ctrlKey||ae.metaKey){I.datepicker._adjustDate(ae.target,-7,"D")}ah=ae.ctrlKey||ae.metaKey;break;case 39:if(ae.ctrlKey||ae.metaKey){I.datepicker._adjustDate(ae.target,(ad?-1:+1),"D")}ah=ae.ctrlKey||ae.metaKey;if(ae.originalEvent.altKey){I.datepicker._adjustDate(ae.target,(ae.ctrlKey?+I.datepicker._get(af,"stepBigMonths"):+I.datepicker._get(af,"stepMonths")),"M")}break;case 40:if(ae.ctrlKey||ae.metaKey){I.datepicker._adjustDate(ae.target,+7,"D")}ah=ae.ctrlKey||ae.metaKey;break;default:ah=false}}else{if(ae.keyCode===36&&ae.ctrlKey){I.datepicker._showDatepicker(this)}else{ah=false}}if(ah){ae.preventDefault();ae.stopPropagation()}},_doKeyPress:function(ad){var ac,ab,ae=I.datepicker._getInst(ad.target);if(I.datepicker._get(ae,"constrainInput")){ac=I.datepicker._possibleChars(I.datepicker._get(ae,"dateFormat"));ab=String.fromCharCode(ad.charCode==null?ad.keyCode:ad.charCode);return ad.ctrlKey||ad.metaKey||(ab<" "||!ac||ac.indexOf(ab)>-1)}},_doKeyUp:function(ad){var ab,ae=I.datepicker._getInst(ad.target);if(ae.input.val()!==ae.lastVal){try{ab=I.datepicker.parseDate(I.datepicker._get(ae,"dateFormat"),(ae.input?ae.input.val():null),I.datepicker._getFormatConfig(ae));if(ab){I.datepicker._setDateFromField(ae);I.datepicker._updateAlternate(ae);I.datepicker._updateDatepicker(ae)}}catch(ac){}}return true},_showDatepicker:function(ac){ac=ac.target||ac;if(ac.nodeName.toLowerCase()!=="input"){ac=I("input",ac.parentNode)[0]}if(I.datepicker._isDisabledDatepicker(ac)||I.datepicker._lastInput===ac){return}var ae,ai,ad,ag,ah,ab,af;ae=I.datepicker._getInst(ac);if(I.datepicker._curInst&&I.datepicker._curInst!==ae){I.datepicker._curInst.dpDiv.stop(true,true);if(ae&&I.datepicker._datepickerShowing){I.datepicker._hideDatepicker(I.datepicker._curInst.input[0])}}ai=I.datepicker._get(ae,"beforeShow");ad=ai?ai.apply(ac,[ac,ae]):{};if(ad===false){return}x(ae.settings,ad);ae.lastVal=null;I.datepicker._lastInput=ac;I.datepicker._setDateFromField(ae);if(I.datepicker._inDialog){ac.value=""}if(!I.datepicker._pos){I.datepicker._pos=I.datepicker._findPos(ac);I.datepicker._pos[1]+=ac.offsetHeight}ag=false;I(ac).parents().each(function(){ag|=I(this).css("position")==="fixed";return !ag});ah={left:I.datepicker._pos[0],top:I.datepicker._pos[1]};I.datepicker._pos=null;ae.dpDiv.empty();ae.dpDiv.css({position:"absolute",display:"block",top:"-1000px"});I.datepicker._updateDatepicker(ae);ah=I.datepicker._checkOffset(ae,ah,ag);ae.dpDiv.css({position:(I.datepicker._inDialog&&I.blockUI?"static":(ag?"fixed":"absolute")),display:"none",left:ah.left+"px",top:ah.top+"px"});if(!ae.inline){ab=I.datepicker._get(ae,"showAnim");af=I.datepicker._get(ae,"duration");ae.dpDiv.css("z-index",u(I(ac))+1);I.datepicker._datepickerShowing=true;if(I.effects&&I.effects.effect[ab]){ae.dpDiv.show(ab,I.datepicker._get(ae,"showOptions"),af)}else{ae.dpDiv[ab||"show"](ab?af:null)}if(I.datepicker._shouldFocusInput(ae)){ae.input.focus()}I.datepicker._curInst=ae}},_updateDatepicker:function(ae){this.maxRows=4;m=ae;ae.dpDiv.empty().append(this._generateHTML(ae));this._attachHandlers(ae);var ag,ab=this._getNumberOfMonths(ae),af=ab[1],ad=17,ac=ae.dpDiv.find("."+this._dayOverClass+" a");if(ac.length>0){q.apply(ac.get(0))}ae.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width("");if(af>1){ae.dpDiv.addClass("ui-datepicker-multi-"+af).css("width",(ad*af)+"em")}ae.dpDiv[(ab[0]!==1||ab[1]!==1?"add":"remove")+"Class"]("ui-datepicker-multi");ae.dpDiv[(this._get(ae,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl");if(ae===I.datepicker._curInst&&I.datepicker._datepickerShowing&&I.datepicker._shouldFocusInput(ae)){ae.input.focus()}if(ae.yearshtml){ag=ae.yearshtml;setTimeout(function(){if(ag===ae.yearshtml&&ae.yearshtml){ae.dpDiv.find("select.ui-datepicker-year:first").replaceWith(ae.yearshtml)}ag=ae.yearshtml=null},0)}},_shouldFocusInput:function(ab){return ab.input&&ab.input.is(":visible")&&!ab.input.is(":disabled")&&!ab.input.is(":focus")},_checkOffset:function(ag,ae,ad){var af=ag.dpDiv.outerWidth(),aj=ag.dpDiv.outerHeight(),ai=ag.input?ag.input.outerWidth():0,ab=ag.input?ag.input.outerHeight():0,ah=document.documentElement.clientWidth+(ad?0:I(document).scrollLeft()),ac=document.documentElement.clientHeight+(ad?0:I(document).scrollTop());ae.left-=(this._get(ag,"isRTL")?(af-ai):0);ae.left-=(ad&&ae.left===ag.input.offset().left)?I(document).scrollLeft():0;ae.top-=(ad&&ae.top===(ag.input.offset().top+ab))?I(document).scrollTop():0;ae.left-=Math.min(ae.left,(ae.left+af>ah&&ah>af)?Math.abs(ae.left+af-ah):0);ae.top-=Math.min(ae.top,(ae.top+aj>ac&&ac>aj)?Math.abs(aj+ab):0);return ae},_findPos:function(ae){var ab,ad=this._getInst(ae),ac=this._get(ad,"isRTL");while(ae&&(ae.type==="hidden"||ae.nodeType!==1||I.expr.filters.hidden(ae))){ae=ae[ac?"previousSibling":"nextSibling"]}ab=I(ae).offset();return[ab.left,ab.top]},_hideDatepicker:function(ad){var ac,ag,af,ab,ae=this._curInst;if(!ae||(ad&&ae!==I.data(ad,"datepicker"))){return}if(this._datepickerShowing){ac=this._get(ae,"showAnim");ag=this._get(ae,"duration");af=function(){I.datepicker._tidyDialog(ae)};if(I.effects&&(I.effects.effect[ac]||I.effects[ac])){ae.dpDiv.hide(ac,I.datepicker._get(ae,"showOptions"),ag,af)}else{ae.dpDiv[(ac==="slideDown"?"slideUp":(ac==="fadeIn"?"fadeOut":"hide"))]((ac?ag:null),af)}if(!ac){af()}this._datepickerShowing=false;ab=this._get(ae,"onClose");if(ab){ab.apply((ae.input?ae.input[0]:null),[(ae.input?ae.input.val():""),ae])}this._lastInput=null;if(this._inDialog){this._dialogInput.css({position:"absolute",left:"0",top:"-100px"});if(I.blockUI){I.unblockUI();I("body").append(this.dpDiv)}}this._inDialog=false}},_tidyDialog:function(ab){ab.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(ac){if(!I.datepicker._curInst){return}var ab=I(ac.target),ad=I.datepicker._getInst(ab[0]);if(((ab[0].id!==I.datepicker._mainDivId&&ab.parents("#"+I.datepicker._mainDivId).length===0&&!ab.hasClass(I.datepicker.markerClassName)&&!ab.closest("."+I.datepicker._triggerClass).length&&I.datepicker._datepickerShowing&&!(I.datepicker._inDialog&&I.blockUI)))||(ab.hasClass(I.datepicker.markerClassName)&&I.datepicker._curInst!==ad)){I.datepicker._hideDatepicker()}},_adjustDate:function(af,ae,ad){var ac=I(af),ab=this._getInst(ac[0]);if(this._isDisabledDatepicker(ac[0])){return}this._adjustInstDate(ab,ae+(ad==="M"?this._get(ab,"showCurrentAtPos"):0),ad);this._updateDatepicker(ab)},_gotoToday:function(ae){var ab,ad=I(ae),ac=this._getInst(ad[0]);if(this._get(ac,"gotoCurrent")&&ac.currentDay){ac.selectedDay=ac.currentDay;ac.drawMonth=ac.selectedMonth=ac.currentMonth;ac.drawYear=ac.selectedYear=ac.currentYear}else{ab=new Date();ac.selectedDay=ab.getDate();ac.drawMonth=ac.selectedMonth=ab.getMonth();ac.drawYear=ac.selectedYear=ab.getFullYear()}this._notifyChange(ac);this._adjustDate(ad)},_selectMonthYear:function(af,ab,ae){var ad=I(af),ac=this._getInst(ad[0]);ac["selected"+(ae==="M"?"Month":"Year")]=ac["draw"+(ae==="M"?"Month":"Year")]=parseInt(ab.options[ab.selectedIndex].value,10);this._notifyChange(ac);this._adjustDate(ad)},_selectDay:function(ag,ae,ab,af){var ac,ad=I(ag);if(I(af).hasClass(this._unselectableClass)||this._isDisabledDatepicker(ad[0])){return}ac=this._getInst(ad[0]);ac.selectedDay=ac.currentDay=I("a",af).html();ac.selectedMonth=ac.currentMonth=ae;ac.selectedYear=ac.currentYear=ab;this._selectDate(ag,this._formatDate(ac,ac.currentDay,ac.currentMonth,ac.currentYear))},_clearDate:function(ac){var ab=I(ac);this._selectDate(ab,"")},_selectDate:function(af,ab){var ac,ae=I(af),ad=this._getInst(ae[0]);ab=(ab!=null?ab:this._formatDate(ad));if(ad.input){ad.input.val(ab)}this._updateAlternate(ad);ac=this._get(ad,"onSelect");if(ac){ac.apply((ad.input?ad.input[0]:null),[ab,ad])}else{if(ad.input){ad.input.trigger("change")}}if(ad.inline){this._updateDatepicker(ad)}else{this._hideDatepicker();this._lastInput=ad.input[0];if(typeof(ad.input[0])!=="object"){ad.input.focus()}this._lastInput=null}},_updateAlternate:function(af){var ae,ad,ab,ac=this._get(af,"altField");if(ac){ae=this._get(af,"altFormat")||this._get(af,"dateFormat");ad=this._getDate(af);ab=this.formatDate(ae,ad,this._getFormatConfig(af));I(ac).each(function(){I(this).val(ab)})}},noWeekends:function(ac){var ab=ac.getDay();return[(ab>0&&ab<6),""]},iso8601Week:function(ab){var ac,ad=new Date(ab.getTime());ad.setDate(ad.getDate()+4-(ad.getDay()||7));ac=ad.getTime();ad.setMonth(0);ad.setDate(1);return Math.floor(Math.round((ac-ad)/86400000)/7)+1},parseDate:function(ar,am,au){if(ar==null||am==null){throw"Invalid arguments"}am=(typeof am==="object"?am.toString():am+"");if(am===""){return null}var ae,ao,ac,at=0,ah=(au?au.shortYearCutoff:null)||this._defaults.shortYearCutoff,ad=(typeof ah!=="string"?ah:new Date().getFullYear()%100+parseInt(ah,10)),ak=(au?au.dayNamesShort:null)||this._defaults.dayNamesShort,aw=(au?au.dayNames:null)||this._defaults.dayNames,ab=(au?au.monthNamesShort:null)||this._defaults.monthNamesShort,af=(au?au.monthNames:null)||this._defaults.monthNames,ag=-1,ax=-1,aq=-1,aj=-1,ap=false,av,al=function(az){var aA=(ae+1<ar.length&&ar.charAt(ae+1)===az);if(aA){ae++}return aA},ay=function(aB){var az=al(aB),aC=(aB==="@"?14:(aB==="!"?20:(aB==="y"&&az?4:(aB==="o"?3:2)))),aE=(aB==="y"?aC:1),aD=new RegExp("^\\d{"+aE+","+aC+"}"),aA=am.substring(at).match(aD);if(!aA){throw"Missing number at position "+at}at+=aA[0].length;return parseInt(aA[0],10)},ai=function(aA,aB,aD){var az=-1,aC=I.map(al(aA)?aD:aB,function(aF,aE){return[[aE,aF]]}).sort(function(aF,aE){return -(aF[1].length-aE[1].length)});I.each(aC,function(aF,aG){var aE=aG[1];if(am.substr(at,aE.length).toLowerCase()===aE.toLowerCase()){az=aG[0];at+=aE.length;return false}});if(az!==-1){return az+1}else{throw"Unknown name at position "+at}},an=function(){if(am.charAt(at)!==ar.charAt(ae)){throw"Unexpected literal at position "+at}at++};for(ae=0;ae<ar.length;ae++){if(ap){if(ar.charAt(ae)==="'"&&!al("'")){ap=false}else{an()}}else{switch(ar.charAt(ae)){case"d":aq=ay("d");break;case"D":ai("D",ak,aw);break;case"o":aj=ay("o");break;case"m":ax=ay("m");break;case"M":ax=ai("M",ab,af);break;case"y":ag=ay("y");break;case"@":av=new Date(ay("@"));ag=av.getFullYear();ax=av.getMonth()+1;aq=av.getDate();break;case"!":av=new Date((ay("!")-this._ticksTo1970)/10000);ag=av.getFullYear();ax=av.getMonth()+1;aq=av.getDate();break;case"'":if(al("'")){an()}else{ap=true}break;default:an()}}}if(at<am.length){ac=am.substr(at);if(!/^\s+/.test(ac)){throw"Extra/unparsed characters found in date: "+ac}}if(ag===-1){ag=new Date().getFullYear()}else{if(ag<100){ag+=new Date().getFullYear()-new Date().getFullYear()%100+(ag<=ad?0:-100)}}if(aj>-1){ax=1;aq=aj;do{ao=this._getDaysInMonth(ag,ax-1);if(aq<=ao){break}ax++;aq-=ao}while(true)}av=this._daylightSavingAdjust(new Date(ag,ax-1,aq));if(av.getFullYear()!==ag||av.getMonth()+1!==ax||av.getDate()!==aq){throw"Invalid date"}return av},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:(((1970-1)*365+Math.floor(1970/4)-Math.floor(1970/100)+Math.floor(1970/400))*24*60*60*10000000),formatDate:function(ak,ae,af){if(!ae){return""}var am,an=(af?af.dayNamesShort:null)||this._defaults.dayNamesShort,ac=(af?af.dayNames:null)||this._defaults.dayNames,ai=(af?af.monthNamesShort:null)||this._defaults.monthNamesShort,ag=(af?af.monthNames:null)||this._defaults.monthNames,al=function(ao){var ap=(am+1<ak.length&&ak.charAt(am+1)===ao);if(ap){am++}return ap},ab=function(aq,ar,ao){var ap=""+ar;if(al(aq)){while(ap.length<ao){ap="0"+ap}}return ap},ah=function(ao,aq,ap,ar){return(al(ao)?ar[aq]:ap[aq])},ad="",aj=false;if(ae){for(am=0;am<ak.length;am++){if(aj){if(ak.charAt(am)==="'"&&!al("'")){aj=false}else{ad+=ak.charAt(am)}}else{switch(ak.charAt(am)){case"d":ad+=ab("d",ae.getDate(),2);break;case"D":ad+=ah("D",ae.getDay(),an,ac);break;case"o":ad+=ab("o",Math.round((new Date(ae.getFullYear(),ae.getMonth(),ae.getDate()).getTime()-new Date(ae.getFullYear(),0,0).getTime())/86400000),3);break;case"m":ad+=ab("m",ae.getMonth()+1,2);break;case"M":ad+=ah("M",ae.getMonth(),ai,ag);break;case"y":ad+=(al("y")?ae.getFullYear():(ae.getYear()%100<10?"0":"")+ae.getYear()%100);break;case"@":ad+=ae.getTime();break;case"!":ad+=ae.getTime()*10000+this._ticksTo1970;break;case"'":if(al("'")){ad+="'"}else{aj=true}break;default:ad+=ak.charAt(am)}}}}return ad},_possibleChars:function(af){var ae,ad="",ac=false,ab=function(ag){var ah=(ae+1<af.length&&af.charAt(ae+1)===ag);if(ah){ae++}return ah};for(ae=0;ae<af.length;ae++){if(ac){if(af.charAt(ae)==="'"&&!ab("'")){ac=false}else{ad+=af.charAt(ae)}}else{switch(af.charAt(ae)){case"d":case"m":case"y":case"@":ad+="0123456789";break;case"D":case"M":return null;case"'":if(ab("'")){ad+="'"}else{ac=true}break;default:ad+=af.charAt(ae)}}}return ad},_get:function(ac,ab){return ac.settings[ab]!==undefined?ac.settings[ab]:this._defaults[ab]},_setDateFromField:function(ag,ad){if(ag.input.val()===ag.lastVal){return}var ab=this._get(ag,"dateFormat"),ai=ag.lastVal=ag.input?ag.input.val():null,ah=this._getDefaultDate(ag),ac=ah,ae=this._getFormatConfig(ag);try{ac=this.parseDate(ab,ai,ae)||ah}catch(af){ai=(ad?"":ai)}ag.selectedDay=ac.getDate();ag.drawMonth=ag.selectedMonth=ac.getMonth();ag.drawYear=ag.selectedYear=ac.getFullYear();ag.currentDay=(ai?ac.getDate():0);ag.currentMonth=(ai?ac.getMonth():0);ag.currentYear=(ai?ac.getFullYear():0);this._adjustInstDate(ag)},_getDefaultDate:function(ab){return this._restrictMinMax(ab,this._determineDate(ab,this._get(ab,"defaultDate"),new Date()))},_determineDate:function(af,ac,ag){var ae=function(ai){var ah=new Date();ah.setDate(ah.getDate()+ai);return ah},ad=function(ao){try{return I.datepicker.parseDate(I.datepicker._get(af,"dateFormat"),ao,I.datepicker._getFormatConfig(af))}catch(an){}var ai=(ao.toLowerCase().match(/^c/)?I.datepicker._getDate(af):null)||new Date(),aj=ai.getFullYear(),am=ai.getMonth(),ah=ai.getDate(),al=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,ak=al.exec(ao);while(ak){switch(ak[2]||"d"){case"d":case"D":ah+=parseInt(ak[1],10);break;case"w":case"W":ah+=parseInt(ak[1],10)*7;break;case"m":case"M":am+=parseInt(ak[1],10);ah=Math.min(ah,I.datepicker._getDaysInMonth(aj,am));break;case"y":case"Y":aj+=parseInt(ak[1],10);ah=Math.min(ah,I.datepicker._getDaysInMonth(aj,am));break}ak=al.exec(ao)}return new Date(aj,am,ah)},ab=(ac==null||ac===""?ag:(typeof ac==="string"?ad(ac):(typeof ac==="number"?(isNaN(ac)?ag:ae(ac)):new Date(ac.getTime()))));ab=(ab&&ab.toString()==="Invalid Date"?ag:ab);if(ab){ab.setHours(0);ab.setMinutes(0);ab.setSeconds(0);ab.setMilliseconds(0)}return this._daylightSavingAdjust(ab)},_daylightSavingAdjust:function(ab){if(!ab){return null}ab.setHours(ab.getHours()>12?ab.getHours()+2:0);return ab},_setDate:function(ah,ae,ag){var ab=!ae,ad=ah.selectedMonth,af=ah.selectedYear,ac=this._restrictMinMax(ah,this._determineDate(ah,ae,new Date()));ah.selectedDay=ah.currentDay=ac.getDate();ah.drawMonth=ah.selectedMonth=ah.currentMonth=ac.getMonth();ah.drawYear=ah.selectedYear=ah.currentYear=ac.getFullYear();if((ad!==ah.selectedMonth||af!==ah.selectedYear)&&!ag){this._notifyChange(ah)}this._adjustInstDate(ah);if(ah.input){ah.input.val(ab?"":this._formatDate(ah))}},_getDate:function(ac){var ab=(!ac.currentYear||(ac.input&&ac.input.val()==="")?null:this._daylightSavingAdjust(new Date(ac.currentYear,ac.currentMonth,ac.currentDay)));return ab},_attachHandlers:function(ac){var ab=this._get(ac,"stepMonths"),ad="#"+ac.id.replace(/\\\\/g,"\\");ac.dpDiv.find("[data-handler]").map(function(){var ae={prev:function(){I.datepicker._adjustDate(ad,-ab,"M")},next:function(){I.datepicker._adjustDate(ad,+ab,"M")},hide:function(){I.datepicker._hideDatepicker()},today:function(){I.datepicker._gotoToday(ad)},selectDay:function(){I.datepicker._selectDay(ad,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this);return false},selectMonth:function(){I.datepicker._selectMonthYear(ad,this,"M");return false},selectYear:function(){I.datepicker._selectMonthYear(ad,this,"Y");return false}};I(this).bind(this.getAttribute("data-event"),ae[this.getAttribute("data-handler")])})},_generateHTML:function(aS){var av,au,aN,aF,af,aW,aQ,aJ,aZ,aD,a3,am,ao,an,ac,aV,ak,ay,aY,aL,a4,ax,aC,al,ag,aO,aH,aK,aI,aj,aA,ap,aR,aU,ae,aX,a1,aG,aq,aT=new Date(),aw=this._daylightSavingAdjust(new Date(aT.getFullYear(),aT.getMonth(),aT.getDate())),a0=this._get(aS,"isRTL"),a2=this._get(aS,"showButtonPanel"),aM=this._get(aS,"hideIfNoPrevNext"),aB=this._get(aS,"navigationAsDateFormat"),ar=this._getNumberOfMonths(aS),ai=this._get(aS,"showCurrentAtPos"),aE=this._get(aS,"stepMonths"),az=(ar[0]!==1||ar[1]!==1),ad=this._daylightSavingAdjust((!aS.currentDay?new Date(9999,9,9):new Date(aS.currentYear,aS.currentMonth,aS.currentDay))),ah=this._getMinMaxDate(aS,"min"),at=this._getMinMaxDate(aS,"max"),ab=aS.drawMonth-ai,aP=aS.drawYear;if(ab<0){ab+=12;aP--}if(at){av=this._daylightSavingAdjust(new Date(at.getFullYear(),at.getMonth()-(ar[0]*ar[1])+1,at.getDate()));av=(ah&&av<ah?ah:av);while(this._daylightSavingAdjust(new Date(aP,ab,1))>av){ab--;if(ab<0){ab=11;aP--}}}aS.drawMonth=ab;aS.drawYear=aP;au=this._get(aS,"prevText");au=(!aB?au:this.formatDate(au,this._daylightSavingAdjust(new Date(aP,ab-aE,1)),this._getFormatConfig(aS)));aN=(this._canAdjustMonth(aS,-1,aP,ab)?"<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click' title='"+au+"'><span class='ui-icon ui-icon-circle-triangle-"+(a0?"e":"w")+"'>"+au+"</span></a>":(aM?"":"<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='"+au+"'><span class='ui-icon ui-icon-circle-triangle-"+(a0?"e":"w")+"'>"+au+"</span></a>"));aF=this._get(aS,"nextText");aF=(!aB?aF:this.formatDate(aF,this._daylightSavingAdjust(new Date(aP,ab+aE,1)),this._getFormatConfig(aS)));af=(this._canAdjustMonth(aS,+1,aP,ab)?"<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click' title='"+aF+"'><span class='ui-icon ui-icon-circle-triangle-"+(a0?"w":"e")+"'>"+aF+"</span></a>":(aM?"":"<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='"+aF+"'><span class='ui-icon ui-icon-circle-triangle-"+(a0?"w":"e")+"'>"+aF+"</span></a>"));aW=this._get(aS,"currentText");aQ=(this._get(aS,"gotoCurrent")&&aS.currentDay?ad:aw);aW=(!aB?aW:this.formatDate(aW,aQ,this._getFormatConfig(aS)));aJ=(!aS.inline?"<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>"+this._get(aS,"closeText")+"</button>":"");aZ=(a2)?"<div class='ui-datepicker-buttonpane ui-widget-content'>"+(a0?aJ:"")+(this._isInRange(aS,aQ)?"<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'>"+aW+"</button>":"")+(a0?"":aJ)+"</div>":"";aD=parseInt(this._get(aS,"firstDay"),10);aD=(isNaN(aD)?0:aD);a3=this._get(aS,"showWeek");am=this._get(aS,"dayNames");ao=this._get(aS,"dayNamesMin");an=this._get(aS,"monthNames");ac=this._get(aS,"monthNamesShort");aV=this._get(aS,"beforeShowDay");ak=this._get(aS,"showOtherMonths");ay=this._get(aS,"selectOtherMonths");aY=this._getDefaultDate(aS);aL="";a4;for(ax=0;ax<ar[0];ax++){aC="";this.maxRows=4;for(al=0;al<ar[1];al++){ag=this._daylightSavingAdjust(new Date(aP,ab,aS.selectedDay));aO=" ui-corner-all";aH="";if(az){aH+="<div class='ui-datepicker-group";if(ar[1]>1){switch(al){case 0:aH+=" ui-datepicker-group-first";aO=" ui-corner-"+(a0?"right":"left");break;case ar[1]-1:aH+=" ui-datepicker-group-last";aO=" ui-corner-"+(a0?"left":"right");break;default:aH+=" ui-datepicker-group-middle";aO="";break}}aH+="'>"}aH+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+aO+"'>"+(/all|left/.test(aO)&&ax===0?(a0?af:aN):"")+(/all|right/.test(aO)&&ax===0?(a0?aN:af):"")+this._generateMonthYearHeader(aS,ab,aP,ah,at,ax>0||al>0,an,ac)+"</div><table class='ui-datepicker-calendar'><thead><tr>";aK=(a3?"<th class='ui-datepicker-week-col'>"+this._get(aS,"weekHeader")+"</th>":"");for(a4=0;a4<7;a4++){aI=(a4+aD)%7;aK+="<th scope='col'"+((a4+aD+6)%7>=5?" class='ui-datepicker-week-end'":"")+"><span title='"+am[aI]+"'>"+ao[aI]+"</span></th>"}aH+=aK+"</tr></thead><tbody>";aj=this._getDaysInMonth(aP,ab);if(aP===aS.selectedYear&&ab===aS.selectedMonth){aS.selectedDay=Math.min(aS.selectedDay,aj)}aA=(this._getFirstDayOfMonth(aP,ab)-aD+7)%7;ap=Math.ceil((aA+aj)/7);aR=(az?this.maxRows>ap?this.maxRows:ap:ap);this.maxRows=aR;aU=this._daylightSavingAdjust(new Date(aP,ab,1-aA));for(ae=0;ae<aR;ae++){aH+="<tr>";aX=(!a3?"":"<td class='ui-datepicker-week-col'>"+this._get(aS,"calculateWeek")(aU)+"</td>");for(a4=0;a4<7;a4++){a1=(aV?aV.apply((aS.input?aS.input[0]:null),[aU]):[true,""]);aG=(aU.getMonth()!==ab);aq=(aG&&!ay)||!a1[0]||(ah&&aU<ah)||(at&&aU>at);aX+="<td class='"+((a4+aD+6)%7>=5?" ui-datepicker-week-end":"")+(aG?" ui-datepicker-other-month":"")+((aU.getTime()===ag.getTime()&&ab===aS.selectedMonth&&aS._keyEvent)||(aY.getTime()===aU.getTime()&&aY.getTime()===ag.getTime())?" "+this._dayOverClass:"")+(aq?" "+this._unselectableClass+" ui-state-disabled":"")+(aG&&!ak?"":" "+a1[1]+(aU.getTime()===ad.getTime()?" "+this._currentClass:"")+(aU.getTime()===aw.getTime()?" ui-datepicker-today":""))+"'"+((!aG||ak)&&a1[2]?" title='"+a1[2].replace(/'/g,"&#39;")+"'":"")+(aq?"":" data-handler='selectDay' data-event='click' data-month='"+aU.getMonth()+"' data-year='"+aU.getFullYear()+"'")+">"+(aG&&!ak?"&#xa0;":(aq?"<span class='ui-state-default'>"+aU.getDate()+"</span>":"<a class='ui-state-default"+(aU.getTime()===aw.getTime()?" ui-state-highlight":"")+(aU.getTime()===ad.getTime()?" ui-state-active":"")+(aG?" ui-priority-secondary":"")+"' href='#'>"+aU.getDate()+"</a>"))+"</td>";aU.setDate(aU.getDate()+1);aU=this._daylightSavingAdjust(aU)}aH+=aX+"</tr>"}ab++;if(ab>11){ab=0;aP++}aH+="</tbody></table>"+(az?"</div>"+((ar[0]>0&&al===ar[1]-1)?"<div class='ui-datepicker-row-break'></div>":""):"");aC+=aH}aL+=aC}aL+=aZ;aS._keyEvent=false;return aL},_generateMonthYearHeader:function(af,ad,an,ah,al,ao,aj,ab){var at,ac,au,aq,ag,ap,am,ai,ae=this._get(af,"changeMonth"),av=this._get(af,"changeYear"),aw=this._get(af,"showMonthAfterYear"),ak="<div class='ui-datepicker-title'>",ar="";if(ao||!ae){ar+="<span class='ui-datepicker-month'>"+aj[ad]+"</span>"}else{at=(ah&&ah.getFullYear()===an);ac=(al&&al.getFullYear()===an);ar+="<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>";for(au=0;au<12;au++){if((!at||au>=ah.getMonth())&&(!ac||au<=al.getMonth())){ar+="<option value='"+au+"'"+(au===ad?" selected='selected'":"")+">"+ab[au]+"</option>"}}ar+="</select>"}if(!aw){ak+=ar+(ao||!(ae&&av)?"&#xa0;":"")}if(!af.yearshtml){af.yearshtml="";if(ao||!av){ak+="<span class='ui-datepicker-year'>"+an+"</span>"}else{aq=this._get(af,"yearRange").split(":");ag=new Date().getFullYear();ap=function(ay){var ax=(ay.match(/c[+\-].*/)?an+parseInt(ay.substring(1),10):(ay.match(/[+\-].*/)?ag+parseInt(ay,10):parseInt(ay,10)));return(isNaN(ax)?ag:ax)};am=ap(aq[0]);ai=Math.max(am,ap(aq[1]||""));am=(ah?Math.max(am,ah.getFullYear()):am);ai=(al?Math.min(ai,al.getFullYear()):ai);af.yearshtml+="<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>";for(;am<=ai;am++){af.yearshtml+="<option value='"+am+"'"+(am===an?" selected='selected'":"")+">"+am+"</option>"}af.yearshtml+="</select>";ak+=af.yearshtml;af.yearshtml=null}}ak+=this._get(af,"yearSuffix");if(aw){ak+=(ao||!(ae&&av)?"&#xa0;":"")+ar}ak+="</div>";return ak},_adjustInstDate:function(ae,ah,ag){var ad=ae.drawYear+(ag==="Y"?ah:0),af=ae.drawMonth+(ag==="M"?ah:0),ab=Math.min(ae.selectedDay,this._getDaysInMonth(ad,af))+(ag==="D"?ah:0),ac=this._restrictMinMax(ae,this._daylightSavingAdjust(new Date(ad,af,ab)));ae.selectedDay=ac.getDate();ae.drawMonth=ae.selectedMonth=ac.getMonth();ae.drawYear=ae.selectedYear=ac.getFullYear();if(ag==="M"||ag==="Y"){this._notifyChange(ae)}},_restrictMinMax:function(ae,ac){var ad=this._getMinMaxDate(ae,"min"),af=this._getMinMaxDate(ae,"max"),ab=(ad&&ac<ad?ad:ac);return(af&&ab>af?af:ab)},_notifyChange:function(ac){var ab=this._get(ac,"onChangeMonthYear");if(ab){ab.apply((ac.input?ac.input[0]:null),[ac.selectedYear,ac.selectedMonth+1,ac])}},_getNumberOfMonths:function(ac){var ab=this._get(ac,"numberOfMonths");return(ab==null?[1,1]:(typeof ab==="number"?[1,ab]:ab))},_getMinMaxDate:function(ac,ab){return this._determineDate(ac,this._get(ac,ab+"Date"),null)},_getDaysInMonth:function(ab,ac){return 32-this._daylightSavingAdjust(new Date(ab,ac,32)).getDate()},_getFirstDayOfMonth:function(ab,ac){return new Date(ab,ac,1).getDay()},_canAdjustMonth:function(ae,ag,ad,af){var ab=this._getNumberOfMonths(ae),ac=this._daylightSavingAdjust(new Date(ad,af+(ag<0?ag:ab[0]*ab[1]),1));if(ag<0){ac.setDate(this._getDaysInMonth(ac.getFullYear(),ac.getMonth()))}return this._isInRange(ae,ac)},_isInRange:function(af,ad){var ac,ai,ae=this._getMinMaxDate(af,"min"),ab=this._getMinMaxDate(af,"max"),aj=null,ag=null,ah=this._get(af,"yearRange");if(ah){ac=ah.split(":");ai=new Date().getFullYear();aj=parseInt(ac[0],10);ag=parseInt(ac[1],10);if(ac[0].match(/[+\-].*/)){aj+=ai}if(ac[1].match(/[+\-].*/)){ag+=ai}}return((!ae||ad.getTime()>=ae.getTime())&&(!ab||ad.getTime()<=ab.getTime())&&(!aj||ad.getFullYear()>=aj)&&(!ag||ad.getFullYear()<=ag))},_getFormatConfig:function(ab){var ac=this._get(ab,"shortYearCutoff");ac=(typeof ac!=="string"?ac:new Date().getFullYear()%100+parseInt(ac,10));return{shortYearCutoff:ac,dayNamesShort:this._get(ab,"dayNamesShort"),dayNames:this._get(ab,"dayNames"),monthNamesShort:this._get(ab,"monthNamesShort"),monthNames:this._get(ab,"monthNames")}},_formatDate:function(ae,ab,af,ad){if(!ab){ae.currentDay=ae.selectedDay;ae.currentMonth=ae.selectedMonth;ae.currentYear=ae.selectedYear}var ac=(ab?(typeof ab==="object"?ab:this._daylightSavingAdjust(new Date(ad,af,ab))):this._daylightSavingAdjust(new Date(ae.currentYear,ae.currentMonth,ae.currentDay)));return this.formatDate(this._get(ae,"dateFormat"),ac,this._getFormatConfig(ae))}});function h(ac){var ab="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return ac.delegate(ab,"mouseout",function(){I(this).removeClass("ui-state-hover");if(this.className.indexOf("ui-datepicker-prev")!==-1){I(this).removeClass("ui-datepicker-prev-hover")}if(this.className.indexOf("ui-datepicker-next")!==-1){I(this).removeClass("ui-datepicker-next-hover")}}).delegate(ab,"mouseover",q)}function q(){if(!I.datepicker._isDisabledDatepicker(m.inline?m.dpDiv.parent()[0]:m.input[0])){I(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover");I(this).addClass("ui-state-hover");if(this.className.indexOf("ui-datepicker-prev")!==-1){I(this).addClass("ui-datepicker-prev-hover")}if(this.className.indexOf("ui-datepicker-next")!==-1){I(this).addClass("ui-datepicker-next-hover")}}}function x(ad,ac){I.extend(ad,ac);for(var ab in ac){if(ac[ab]==null){ad[ab]=ac[ab]}}return ad}I.fn.datepicker=function(ac){if(!this.length){return this}if(!I.datepicker.initialized){I(document).mousedown(I.datepicker._checkExternalClick);I.datepicker.initialized=true}if(I("#"+I.datepicker._mainDivId).length===0){I("body").append(I.datepicker.dpDiv)}var ab=Array.prototype.slice.call(arguments,1);if(typeof ac==="string"&&(ac==="isDisabled"||ac==="getDate"||ac==="widget")){return I.datepicker["_"+ac+"Datepicker"].apply(I.datepicker,[this[0]].concat(ab))}if(ac==="option"&&arguments.length===2&&typeof arguments[1]==="string"){return I.datepicker["_"+ac+"Datepicker"].apply(I.datepicker,[this[0]].concat(ab))}return this.each(function(){typeof ac==="string"?I.datepicker["_"+ac+"Datepicker"].apply(I.datepicker,[this].concat(ab)):I.datepicker._attachDatepicker(this,ac)})};I.datepicker=new Z();I.datepicker.initialized=false;I.datepicker.uuid=new Date().getTime();I.datepicker.version="1.11.3";var E=I.datepicker;
/*!
 * jQuery UI Dialog 1.11.3
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/dialog/
 */
var S=I.widget("ui.dialog",{version:"1.11.3",options:{appendTo:"body",autoOpen:true,buttons:[],closeOnEscape:true,closeText:"Close",dialogClass:"",draggable:true,hide:null,height:"auto",maxHeight:null,maxWidth:null,minHeight:150,minWidth:150,modal:false,position:{my:"center",at:"center",of:window,collision:"fit",using:function(ac){var ab=I(this).css(ac).offset().top;if(ab<0){I(this).css("top",ac.top-ab)}}},resizable:true,show:null,title:null,width:300,beforeClose:null,close:null,drag:null,dragStart:null,dragStop:null,focus:null,open:null,resize:null,resizeStart:null,resizeStop:null},sizeRelatedOptions:{buttons:true,height:true,maxHeight:true,maxWidth:true,minHeight:true,minWidth:true,width:true},resizableRelatedOptions:{maxHeight:true,maxWidth:true,minHeight:true,minWidth:true},_create:function(){this.originalCss={display:this.element[0].style.display,width:this.element[0].style.width,minHeight:this.element[0].style.minHeight,maxHeight:this.element[0].style.maxHeight,height:this.element[0].style.height};this.originalPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)};this.originalTitle=this.element.attr("title");this.options.title=this.options.title||this.originalTitle;this._createWrapper();this.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(this.uiDialog);this._createTitlebar();this._createButtonPane();if(this.options.draggable&&I.fn.draggable){this._makeDraggable()}if(this.options.resizable&&I.fn.resizable){this._makeResizable()}this._isOpen=false;this._trackFocus()},_init:function(){if(this.options.autoOpen){this.open()}},_appendTo:function(){var ab=this.options.appendTo;if(ab&&(ab.jquery||ab.nodeType)){return I(ab)}return this.document.find(ab||"body").eq(0)},_destroy:function(){var ac,ab=this.originalPosition;this._destroyOverlay();this.element.removeUniqueId().removeClass("ui-dialog-content ui-widget-content").css(this.originalCss).detach();this.uiDialog.stop(true,true).remove();if(this.originalTitle){this.element.attr("title",this.originalTitle)}ac=ab.parent.children().eq(ab.index);if(ac.length&&ac[0]!==this.element[0]){ac.before(this.element)}else{ab.parent.append(this.element)}},widget:function(){return this.uiDialog},disable:I.noop,enable:I.noop,close:function(ae){var ad,ac=this;if(!this._isOpen||this._trigger("beforeClose",ae)===false){return}this._isOpen=false;this._focusedElement=null;this._destroyOverlay();this._untrackInstance();if(!this.opener.filter(":focusable").focus().length){try{ad=this.document[0].activeElement;if(ad&&ad.nodeName.toLowerCase()!=="body"){I(ad).blur()}}catch(ab){}}this._hide(this.uiDialog,this.options.hide,function(){ac._trigger("close",ae)})},isOpen:function(){return this._isOpen},moveToTop:function(){this._moveToTop()},_moveToTop:function(af,ac){var ae=false,ab=this.uiDialog.siblings(".ui-front:visible").map(function(){return +I(this).css("z-index")}).get(),ad=Math.max.apply(null,ab);if(ad>=+this.uiDialog.css("z-index")){this.uiDialog.css("z-index",ad+1);ae=true}if(ae&&!ac){this._trigger("focus",af)}return ae},open:function(){var ab=this;if(this._isOpen){if(this._moveToTop()){this._focusTabbable()}return}this._isOpen=true;this.opener=I(this.document[0].activeElement);this._size();this._position();this._createOverlay();this._moveToTop(null,true);if(this.overlay){this.overlay.css("z-index",this.uiDialog.css("z-index")-1)}this._show(this.uiDialog,this.options.show,function(){ab._focusTabbable();ab._trigger("focus")});this._makeFocusTarget();this._trigger("open")},_focusTabbable:function(){var ab=this._focusedElement;if(!ab){ab=this.element.find("[autofocus]")}if(!ab.length){ab=this.element.find(":tabbable")}if(!ab.length){ab=this.uiDialogButtonPane.find(":tabbable")}if(!ab.length){ab=this.uiDialogTitlebarClose.filter(":tabbable")}if(!ab.length){ab=this.uiDialog}ab.eq(0).focus()},_keepFocus:function(ab){function ac(){var ae=this.document[0].activeElement,ad=this.uiDialog[0]===ae||I.contains(this.uiDialog[0],ae);if(!ad){this._focusTabbable()}}ab.preventDefault();ac.call(this);this._delay(ac)},_createWrapper:function(){this.uiDialog=I("<div>").addClass("ui-dialog ui-widget ui-widget-content ui-corner-all ui-front "+this.options.dialogClass).hide().attr({tabIndex:-1,role:"dialog"}).appendTo(this._appendTo());this._on(this.uiDialog,{keydown:function(ad){if(this.options.closeOnEscape&&!ad.isDefaultPrevented()&&ad.keyCode&&ad.keyCode===I.ui.keyCode.ESCAPE){ad.preventDefault();this.close(ad);return}if(ad.keyCode!==I.ui.keyCode.TAB||ad.isDefaultPrevented()){return}var ac=this.uiDialog.find(":tabbable"),ae=ac.filter(":first"),ab=ac.filter(":last");if((ad.target===ab[0]||ad.target===this.uiDialog[0])&&!ad.shiftKey){this._delay(function(){ae.focus()});ad.preventDefault()}else{if((ad.target===ae[0]||ad.target===this.uiDialog[0])&&ad.shiftKey){this._delay(function(){ab.focus()});ad.preventDefault()}}},mousedown:function(ab){if(this._moveToTop(ab)){this._focusTabbable()}}});if(!this.element.find("[aria-describedby]").length){this.uiDialog.attr({"aria-describedby":this.element.uniqueId().attr("id")})}},_createTitlebar:function(){var ab;this.uiDialogTitlebar=I("<div>").addClass("ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix").prependTo(this.uiDialog);this._on(this.uiDialogTitlebar,{mousedown:function(ac){if(!I(ac.target).closest(".ui-dialog-titlebar-close")){this.uiDialog.focus()}}});this.uiDialogTitlebarClose=I("<button type='button'></button>").button({label:this.options.closeText,icons:{primary:"ui-icon-closethick"},text:false}).addClass("ui-dialog-titlebar-close").appendTo(this.uiDialogTitlebar);this._on(this.uiDialogTitlebarClose,{click:function(ac){ac.preventDefault();this.close(ac)}});ab=I("<span>").uniqueId().addClass("ui-dialog-title").prependTo(this.uiDialogTitlebar);this._title(ab);this.uiDialog.attr({"aria-labelledby":ab.attr("id")})},_title:function(ab){if(!this.options.title){ab.html("&#160;")}ab.text(this.options.title)},_createButtonPane:function(){this.uiDialogButtonPane=I("<div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix");this.uiButtonSet=I("<div>").addClass("ui-dialog-buttonset").appendTo(this.uiDialogButtonPane);this._createButtons()},_createButtons:function(){var ac=this,ab=this.options.buttons;this.uiDialogButtonPane.remove();this.uiButtonSet.empty();if(I.isEmptyObject(ab)||(I.isArray(ab)&&!ab.length)){this.uiDialog.removeClass("ui-dialog-buttons");return}I.each(ab,function(ad,ae){var af,ag;ae=I.isFunction(ae)?{click:ae,text:ad}:ae;ae=I.extend({type:"button"},ae);af=ae.click;ae.click=function(){af.apply(ac.element[0],arguments)};ag={icons:ae.icons,text:ae.showText};delete ae.icons;delete ae.showText;I("<button></button>",ae).button(ag).appendTo(ac.uiButtonSet)});this.uiDialog.addClass("ui-dialog-buttons");this.uiDialogButtonPane.appendTo(this.uiDialog)},_makeDraggable:function(){var ad=this,ac=this.options;function ab(ae){return{position:ae.position,offset:ae.offset}}this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(ae,af){I(this).addClass("ui-dialog-dragging");ad._blockFrames();ad._trigger("dragStart",ae,ab(af))},drag:function(ae,af){ad._trigger("drag",ae,ab(af))},stop:function(ae,af){var ah=af.offset.left-ad.document.scrollLeft(),ag=af.offset.top-ad.document.scrollTop();ac.position={my:"left top",at:"left"+(ah>=0?"+":"")+ah+" top"+(ag>=0?"+":"")+ag,of:ad.window};I(this).removeClass("ui-dialog-dragging");ad._unblockFrames();ad._trigger("dragStop",ae,ab(af))}})},_makeResizable:function(){var ag=this,ae=this.options,af=ae.resizable,ab=this.uiDialog.css("position"),ad=typeof af==="string"?af:"n,e,s,w,se,sw,ne,nw";function ac(ah){return{originalPosition:ah.originalPosition,originalSize:ah.originalSize,position:ah.position,size:ah.size}}this.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:this.element,maxWidth:ae.maxWidth,maxHeight:ae.maxHeight,minWidth:ae.minWidth,minHeight:this._minHeight(),handles:ad,start:function(ah,ai){I(this).addClass("ui-dialog-resizing");ag._blockFrames();ag._trigger("resizeStart",ah,ac(ai))},resize:function(ah,ai){ag._trigger("resize",ah,ac(ai))},stop:function(ah,ai){var al=ag.uiDialog.offset(),ak=al.left-ag.document.scrollLeft(),aj=al.top-ag.document.scrollTop();ae.height=ag.uiDialog.height();ae.width=ag.uiDialog.width();ae.position={my:"left top",at:"left"+(ak>=0?"+":"")+ak+" top"+(aj>=0?"+":"")+aj,of:ag.window};I(this).removeClass("ui-dialog-resizing");ag._unblockFrames();ag._trigger("resizeStop",ah,ac(ai))}}).css("position",ab)},_trackFocus:function(){this._on(this.widget(),{focusin:function(ab){this._makeFocusTarget();this._focusedElement=I(ab.target)}})},_makeFocusTarget:function(){this._untrackInstance();this._trackingInstances().unshift(this)},_untrackInstance:function(){var ac=this._trackingInstances(),ab=I.inArray(this,ac);if(ab!==-1){ac.splice(ab,1)}},_trackingInstances:function(){var ab=this.document.data("ui-dialog-instances");if(!ab){ab=[];this.document.data("ui-dialog-instances",ab)}return ab},_minHeight:function(){var ab=this.options;return ab.height==="auto"?ab.minHeight:Math.min(ab.minHeight,ab.height)},_position:function(){var ab=this.uiDialog.is(":visible");if(!ab){this.uiDialog.show()}this.uiDialog.position(this.options.position);if(!ab){this.uiDialog.hide()}},_setOptions:function(ad){var ae=this,ac=false,ab={};I.each(ad,function(af,ag){ae._setOption(af,ag);if(af in ae.sizeRelatedOptions){ac=true}if(af in ae.resizableRelatedOptions){ab[af]=ag}});if(ac){this._size();this._position()}if(this.uiDialog.is(":data(ui-resizable)")){this.uiDialog.resizable("option",ab)}},_setOption:function(ad,ae){var ac,af,ab=this.uiDialog;if(ad==="dialogClass"){ab.removeClass(this.options.dialogClass).addClass(ae)}if(ad==="disabled"){return}this._super(ad,ae);if(ad==="appendTo"){this.uiDialog.appendTo(this._appendTo())}if(ad==="buttons"){this._createButtons()}if(ad==="closeText"){this.uiDialogTitlebarClose.button({label:""+ae})}if(ad==="draggable"){ac=ab.is(":data(ui-draggable)");if(ac&&!ae){ab.draggable("destroy")}if(!ac&&ae){this._makeDraggable()}}if(ad==="position"){this._position()}if(ad==="resizable"){af=ab.is(":data(ui-resizable)");if(af&&!ae){ab.resizable("destroy")}if(af&&typeof ae==="string"){ab.resizable("option","handles",ae)}if(!af&&ae!==false){this._makeResizable()}}if(ad==="title"){this._title(this.uiDialogTitlebar.find(".ui-dialog-title"))}},_size:function(){var ab,ad,ae,ac=this.options;this.element.show().css({width:"auto",minHeight:0,maxHeight:"none",height:0});if(ac.minWidth>ac.width){ac.width=ac.minWidth}ab=this.uiDialog.css({height:"auto",width:ac.width}).outerHeight();ad=Math.max(0,ac.minHeight-ab);ae=typeof ac.maxHeight==="number"?Math.max(0,ac.maxHeight-ab):"none";if(ac.height==="auto"){this.element.css({minHeight:ad,maxHeight:ae,height:"auto"})}else{this.element.height(Math.max(0,ac.height-ab))}if(this.uiDialog.is(":data(ui-resizable)")){this.uiDialog.resizable("option","minHeight",this._minHeight())}},_blockFrames:function(){this.iframeBlocks=this.document.find("iframe").map(function(){var ab=I(this);return I("<div>").css({position:"absolute",width:ab.outerWidth(),height:ab.outerHeight()}).appendTo(ab.parent()).offset(ab.offset())[0]})},_unblockFrames:function(){if(this.iframeBlocks){this.iframeBlocks.remove();delete this.iframeBlocks}},_allowInteraction:function(ab){if(I(ab.target).closest(".ui-dialog").length){return true}return !!I(ab.target).closest(".ui-datepicker").length},_createOverlay:function(){if(!this.options.modal){return}var ab=true;this._delay(function(){ab=false});if(!this.document.data("ui-dialog-overlays")){this._on(this.document,{focusin:function(ac){if(ab){return}if(!this._allowInteraction(ac)){ac.preventDefault();this._trackingInstances()[0]._focusTabbable()}}})}this.overlay=I("<div>").addClass("ui-widget-overlay ui-front").appendTo(this._appendTo());this._on(this.overlay,{mousedown:"_keepFocus"});this.document.data("ui-dialog-overlays",(this.document.data("ui-dialog-overlays")||0)+1)},_destroyOverlay:function(){if(!this.options.modal){return}if(this.overlay){var ab=this.document.data("ui-dialog-overlays")-1;if(!ab){this.document.unbind("focusin").removeData("ui-dialog-overlays")}else{this.document.data("ui-dialog-overlays",ab)}this.overlay.remove();this.overlay=null}}});
/*!
 * jQuery UI Progressbar 1.11.3
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/progressbar/
 */
var T=I.widget("ui.progressbar",{version:"1.11.3",options:{max:100,value:0,change:null,complete:null},min:0,_create:function(){this.oldValue=this.options.value=this._constrainedValue();this.element.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").attr({role:"progressbar","aria-valuemin":this.min});this.valueDiv=I("<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>").appendTo(this.element);this._refreshValue()},_destroy:function(){this.element.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow");this.valueDiv.remove()},value:function(ab){if(ab===undefined){return this.options.value}this.options.value=this._constrainedValue(ab);this._refreshValue()},_constrainedValue:function(ab){if(ab===undefined){ab=this.options.value}this.indeterminate=ab===false;if(typeof ab!=="number"){ab=0}return this.indeterminate?false:Math.min(this.options.max,Math.max(this.min,ab))},_setOptions:function(ab){var ac=ab.value;delete ab.value;this._super(ab);this.options.value=this._constrainedValue(ac);this._refreshValue()},_setOption:function(ab,ac){if(ab==="max"){ac=Math.max(this.min,ac)}if(ab==="disabled"){this.element.toggleClass("ui-state-disabled",!!ac).attr("aria-disabled",ac)}this._super(ab,ac)},_percentage:function(){return this.indeterminate?100:100*(this.options.value-this.min)/(this.options.max-this.min)},_refreshValue:function(){var ac=this.options.value,ab=this._percentage();this.valueDiv.toggle(this.indeterminate||ac>this.min).toggleClass("ui-corner-right",ac===this.options.max).width(ab.toFixed(0)+"%");this.element.toggleClass("ui-progressbar-indeterminate",this.indeterminate);if(this.indeterminate){this.element.removeAttr("aria-valuenow");if(!this.overlayDiv){this.overlayDiv=I("<div class='ui-progressbar-overlay'></div>").appendTo(this.valueDiv)}}else{this.element.attr({"aria-valuemax":this.options.max,"aria-valuenow":ac});if(this.overlayDiv){this.overlayDiv.remove();this.overlayDiv=null}}if(this.oldValue!==ac){this.oldValue=ac;this._trigger("change")}if(ac===this.options.max){this._trigger("complete")}}});
/*!
 * jQuery UI Slider 1.11.3
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/slider/
 */
var g=I.widget("ui.slider",I.ui.mouse,{version:"1.11.3",widgetEventPrefix:"slide",options:{animate:false,distance:0,max:100,min:0,orientation:"horizontal",range:false,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},numPages:5,_create:function(){this._keySliding=false;this._mouseSliding=false;this._animateOff=true;this._handleIndex=null;this._detectOrientation();this._mouseInit();this._calculateNewMax();this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget ui-widget-content ui-corner-all");this._refresh();this._setOption("disabled",this.options.disabled);this._animateOff=false},_refresh:function(){this._createRange();this._createHandles();this._setupEvents();this._refreshValue()},_createHandles:function(){var ae,ab,ac=this.options,ag=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),af="<span class='ui-slider-handle ui-state-default ui-corner-all' tabindex='0'></span>",ad=[];ab=(ac.values&&ac.values.length)||1;if(ag.length>ab){ag.slice(ab).remove();ag=ag.slice(0,ab)}for(ae=ag.length;ae<ab;ae++){ad.push(af)}this.handles=ag.add(I(ad.join("")).appendTo(this.element));this.handle=this.handles.eq(0);this.handles.each(function(ah){I(this).data("ui-slider-handle-index",ah)})},_createRange:function(){var ab=this.options,ac="";if(ab.range){if(ab.range===true){if(!ab.values){ab.values=[this._valueMin(),this._valueMin()]}else{if(ab.values.length&&ab.values.length!==2){ab.values=[ab.values[0],ab.values[0]]}else{if(I.isArray(ab.values)){ab.values=ab.values.slice(0)}}}}if(!this.range||!this.range.length){this.range=I("<div></div>").appendTo(this.element);ac="ui-slider-range ui-widget-header ui-corner-all"}else{this.range.removeClass("ui-slider-range-min ui-slider-range-max").css({left:"",bottom:""})}this.range.addClass(ac+((ab.range==="min"||ab.range==="max")?" ui-slider-range-"+ab.range:""))}else{if(this.range){this.range.remove()}this.range=null}},_setupEvents:function(){this._off(this.handles);this._on(this.handles,this._handleEvents);this._hoverable(this.handles);this._focusable(this.handles)},_destroy:function(){this.handles.remove();if(this.range){this.range.remove()}this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-widget ui-widget-content ui-corner-all");this._mouseDestroy()},_mouseCapture:function(ad){var ah,ak,ac,af,aj,al,ag,ab,ai=this,ae=this.options;if(ae.disabled){return false}this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()};this.elementOffset=this.element.offset();ah={x:ad.pageX,y:ad.pageY};ak=this._normValueFromMouse(ah);ac=this._valueMax()-this._valueMin()+1;this.handles.each(function(am){var an=Math.abs(ak-ai.values(am));if((ac>an)||(ac===an&&(am===ai._lastChangedValue||ai.values(am)===ae.min))){ac=an;af=I(this);aj=am}});al=this._start(ad,aj);if(al===false){return false}this._mouseSliding=true;this._handleIndex=aj;af.addClass("ui-state-active").focus();ag=af.offset();ab=!I(ad.target).parents().addBack().is(".ui-slider-handle");this._clickOffset=ab?{left:0,top:0}:{left:ad.pageX-ag.left-(af.width()/2),top:ad.pageY-ag.top-(af.height()/2)-(parseInt(af.css("borderTopWidth"),10)||0)-(parseInt(af.css("borderBottomWidth"),10)||0)+(parseInt(af.css("marginTop"),10)||0)};if(!this.handles.hasClass("ui-state-hover")){this._slide(ad,aj,ak)}this._animateOff=true;return true},_mouseStart:function(){return true},_mouseDrag:function(ad){var ab={x:ad.pageX,y:ad.pageY},ac=this._normValueFromMouse(ab);this._slide(ad,this._handleIndex,ac);return false},_mouseStop:function(ab){this.handles.removeClass("ui-state-active");this._mouseSliding=false;this._stop(ab,this._handleIndex);this._change(ab,this._handleIndex);this._handleIndex=null;this._clickOffset=null;this._animateOff=false;return false},_detectOrientation:function(){this.orientation=(this.options.orientation==="vertical")?"vertical":"horizontal"},_normValueFromMouse:function(ac){var ab,af,ae,ad,ag;if(this.orientation==="horizontal"){ab=this.elementSize.width;af=ac.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)}else{ab=this.elementSize.height;af=ac.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)}ae=(af/ab);if(ae>1){ae=1}if(ae<0){ae=0}if(this.orientation==="vertical"){ae=1-ae}ad=this._valueMax()-this._valueMin();ag=this._valueMin()+ae*ad;return this._trimAlignValue(ag)},_start:function(ad,ac){var ab={handle:this.handles[ac],value:this.value()};if(this.options.values&&this.options.values.length){ab.value=this.values(ac);ab.values=this.values()}return this._trigger("start",ad,ab)},_slide:function(af,ae,ad){var ab,ac,ag;if(this.options.values&&this.options.values.length){ab=this.values(ae?0:1);if((this.options.values.length===2&&this.options.range===true)&&((ae===0&&ad>ab)||(ae===1&&ad<ab))){ad=ab}if(ad!==this.values(ae)){ac=this.values();ac[ae]=ad;ag=this._trigger("slide",af,{handle:this.handles[ae],value:ad,values:ac});ab=this.values(ae?0:1);if(ag!==false){this.values(ae,ad)}}}else{if(ad!==this.value()){ag=this._trigger("slide",af,{handle:this.handles[ae],value:ad});if(ag!==false){this.value(ad)}}}},_stop:function(ad,ac){var ab={handle:this.handles[ac],value:this.value()};if(this.options.values&&this.options.values.length){ab.value=this.values(ac);ab.values=this.values()}this._trigger("stop",ad,ab)},_change:function(ad,ac){if(!this._keySliding&&!this._mouseSliding){var ab={handle:this.handles[ac],value:this.value()};if(this.options.values&&this.options.values.length){ab.value=this.values(ac);ab.values=this.values()}this._lastChangedValue=ac;this._trigger("change",ad,ab)}},value:function(ab){if(arguments.length){this.options.value=this._trimAlignValue(ab);this._refreshValue();this._change(null,0);return}return this._value()},values:function(ac,af){var ae,ab,ad;if(arguments.length>1){this.options.values[ac]=this._trimAlignValue(af);this._refreshValue();this._change(null,ac);return}if(arguments.length){if(I.isArray(arguments[0])){ae=this.options.values;ab=arguments[0];for(ad=0;ad<ae.length;ad+=1){ae[ad]=this._trimAlignValue(ab[ad]);this._change(null,ad)}this._refreshValue()}else{if(this.options.values&&this.options.values.length){return this._values(ac)}else{return this.value()}}}else{return this._values()}},_setOption:function(ac,ad){var ab,ae=0;if(ac==="range"&&this.options.range===true){if(ad==="min"){this.options.value=this._values(0);this.options.values=null}else{if(ad==="max"){this.options.value=this._values(this.options.values.length-1);this.options.values=null}}}if(I.isArray(this.options.values)){ae=this.options.values.length}if(ac==="disabled"){this.element.toggleClass("ui-state-disabled",!!ad)}this._super(ac,ad);switch(ac){case"orientation":this._detectOrientation();this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation);this._refreshValue();this.handles.css(ad==="horizontal"?"bottom":"left","");break;case"value":this._animateOff=true;this._refreshValue();this._change(null,0);this._animateOff=false;break;case"values":this._animateOff=true;this._refreshValue();for(ab=0;ab<ae;ab+=1){this._change(null,ab)}this._animateOff=false;break;case"step":case"min":case"max":this._animateOff=true;this._calculateNewMax();this._refreshValue();this._animateOff=false;break;case"range":this._animateOff=true;this._refresh();this._animateOff=false;break}},_value:function(){var ab=this.options.value;ab=this._trimAlignValue(ab);return ab},_values:function(ab){var ae,ad,ac;if(arguments.length){ae=this.options.values[ab];ae=this._trimAlignValue(ae);return ae}else{if(this.options.values&&this.options.values.length){ad=this.options.values.slice();for(ac=0;ac<ad.length;ac+=1){ad[ac]=this._trimAlignValue(ad[ac])}return ad}else{return[]}}},_trimAlignValue:function(ae){if(ae<=this._valueMin()){return this._valueMin()}if(ae>=this._valueMax()){return this._valueMax()}var ab=(this.options.step>0)?this.options.step:1,ad=(ae-this._valueMin())%ab,ac=ae-ad;if(Math.abs(ad)*2>=ab){ac+=(ad>0)?ab:(-ab)}return parseFloat(ac.toFixed(5))},_calculateNewMax:function(){var ab=this.options.max,ac=this._valueMin(),ad=this.options.step,ae=Math.floor((ab-ac)/ad)*ad;ab=ae+ac;this.max=parseFloat(ab.toFixed(this._precision()))},_precision:function(){var ab=this._precisionOf(this.options.step);if(this.options.min!==null){ab=Math.max(ab,this._precisionOf(this.options.min))}return ab},_precisionOf:function(ac){var ad=ac.toString(),ab=ad.indexOf(".");return ab===-1?0:ad.length-ab-1},_valueMin:function(){return this.options.min},_valueMax:function(){return this.max},_refreshValue:function(){var ag,af,aj,ah,ak,ae=this.options.range,ad=this.options,ai=this,ac=(!this._animateOff)?ad.animate:false,ab={};if(this.options.values&&this.options.values.length){this.handles.each(function(al){af=(ai.values(al)-ai._valueMin())/(ai._valueMax()-ai._valueMin())*100;ab[ai.orientation==="horizontal"?"left":"bottom"]=af+"%";I(this).stop(1,1)[ac?"animate":"css"](ab,ad.animate);if(ai.options.range===true){if(ai.orientation==="horizontal"){if(al===0){ai.range.stop(1,1)[ac?"animate":"css"]({left:af+"%"},ad.animate)}if(al===1){ai.range[ac?"animate":"css"]({width:(af-ag)+"%"},{queue:false,duration:ad.animate})}}else{if(al===0){ai.range.stop(1,1)[ac?"animate":"css"]({bottom:(af)+"%"},ad.animate)}if(al===1){ai.range[ac?"animate":"css"]({height:(af-ag)+"%"},{queue:false,duration:ad.animate})}}}ag=af})}else{aj=this.value();ah=this._valueMin();ak=this._valueMax();af=(ak!==ah)?(aj-ah)/(ak-ah)*100:0;ab[this.orientation==="horizontal"?"left":"bottom"]=af+"%";this.handle.stop(1,1)[ac?"animate":"css"](ab,ad.animate);if(ae==="min"&&this.orientation==="horizontal"){this.range.stop(1,1)[ac?"animate":"css"]({width:af+"%"},ad.animate)}if(ae==="max"&&this.orientation==="horizontal"){this.range[ac?"animate":"css"]({width:(100-af)+"%"},{queue:false,duration:ad.animate})}if(ae==="min"&&this.orientation==="vertical"){this.range.stop(1,1)[ac?"animate":"css"]({height:af+"%"},ad.animate)}if(ae==="max"&&this.orientation==="vertical"){this.range[ac?"animate":"css"]({height:(100-af)+"%"},{queue:false,duration:ad.animate})}}},_handleEvents:{keydown:function(af){var ag,ad,ac,ae,ab=I(af.target).data("ui-slider-handle-index");switch(af.keyCode){case I.ui.keyCode.HOME:case I.ui.keyCode.END:case I.ui.keyCode.PAGE_UP:case I.ui.keyCode.PAGE_DOWN:case I.ui.keyCode.UP:case I.ui.keyCode.RIGHT:case I.ui.keyCode.DOWN:case I.ui.keyCode.LEFT:af.preventDefault();if(!this._keySliding){this._keySliding=true;I(af.target).addClass("ui-state-active");ag=this._start(af,ab);if(ag===false){return}}break}ae=this.options.step;if(this.options.values&&this.options.values.length){ad=ac=this.values(ab)}else{ad=ac=this.value()}switch(af.keyCode){case I.ui.keyCode.HOME:ac=this._valueMin();break;case I.ui.keyCode.END:ac=this._valueMax();break;case I.ui.keyCode.PAGE_UP:ac=this._trimAlignValue(ad+((this._valueMax()-this._valueMin())/this.numPages));break;case I.ui.keyCode.PAGE_DOWN:ac=this._trimAlignValue(ad-((this._valueMax()-this._valueMin())/this.numPages));break;case I.ui.keyCode.UP:case I.ui.keyCode.RIGHT:if(ad===this._valueMax()){return}ac=this._trimAlignValue(ad+ae);break;case I.ui.keyCode.DOWN:case I.ui.keyCode.LEFT:if(ad===this._valueMin()){return}ac=this._trimAlignValue(ad-ae);break}this._slide(af,ab,ac)},keyup:function(ac){var ab=I(ac.target).data("ui-slider-handle-index");if(this._keySliding){this._keySliding=false;this._stop(ac,ab);this._change(ac,ab);I(ac.target).removeClass("ui-state-active")}}}});
/*!
 * jQuery UI Tabs 1.11.3
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/tabs/
 */
var k=I.widget("ui.tabs",{version:"1.11.3",delay:300,options:{active:null,collapsible:false,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_isLocal:(function(){var ab=/#.*$/;return function(ad){var af,ae;ad=ad.cloneNode(false);af=ad.href.replace(ab,"");ae=location.href.replace(ab,"");try{af=decodeURIComponent(af)}catch(ac){}try{ae=decodeURIComponent(ae)}catch(ac){}return ad.hash.length>1&&af===ae}})(),_create:function(){var ac=this,ab=this.options;this.running=false;this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all").toggleClass("ui-tabs-collapsible",ab.collapsible);this._processTabs();ab.active=this._initialActive();if(I.isArray(ab.disabled)){ab.disabled=I.unique(ab.disabled.concat(I.map(this.tabs.filter(".ui-state-disabled"),function(ad){return ac.tabs.index(ad)}))).sort()}if(this.options.active!==false&&this.anchors.length){this.active=this._findActive(ab.active)}else{this.active=I()}this._refresh();if(this.active.length){this.load(ab.active)}},_initialActive:function(){var ac=this.options.active,ab=this.options.collapsible,ad=location.hash.substring(1);if(ac===null){if(ad){this.tabs.each(function(ae,af){if(I(af).attr("aria-controls")===ad){ac=ae;return false}})}if(ac===null){ac=this.tabs.index(this.tabs.filter(".ui-tabs-active"))}if(ac===null||ac===-1){ac=this.tabs.length?0:false}}if(ac!==false){ac=this.tabs.index(this.tabs.eq(ac));if(ac===-1){ac=ab?false:0}}if(!ab&&ac===false&&this.anchors.length){ac=0}return ac},_getCreateEventData:function(){return{tab:this.active,panel:!this.active.length?I():this._getPanelForTab(this.active)}},_tabKeydown:function(ad){var ac=I(this.document[0].activeElement).closest("li"),ab=this.tabs.index(ac),ae=true;if(this._handlePageNav(ad)){return}switch(ad.keyCode){case I.ui.keyCode.RIGHT:case I.ui.keyCode.DOWN:ab++;break;case I.ui.keyCode.UP:case I.ui.keyCode.LEFT:ae=false;ab--;break;case I.ui.keyCode.END:ab=this.anchors.length-1;break;case I.ui.keyCode.HOME:ab=0;break;case I.ui.keyCode.SPACE:ad.preventDefault();clearTimeout(this.activating);this._activate(ab);return;case I.ui.keyCode.ENTER:ad.preventDefault();clearTimeout(this.activating);this._activate(ab===this.options.active?false:ab);return;default:return}ad.preventDefault();clearTimeout(this.activating);ab=this._focusNextTab(ab,ae);if(!ad.ctrlKey&&!ad.metaKey){ac.attr("aria-selected","false");this.tabs.eq(ab).attr("aria-selected","true");this.activating=this._delay(function(){this.option("active",ab)},this.delay)}},_panelKeydown:function(ab){if(this._handlePageNav(ab)){return}if(ab.ctrlKey&&ab.keyCode===I.ui.keyCode.UP){ab.preventDefault();this.active.focus()}},_handlePageNav:function(ab){if(ab.altKey&&ab.keyCode===I.ui.keyCode.PAGE_UP){this._activate(this._focusNextTab(this.options.active-1,false));return true}if(ab.altKey&&ab.keyCode===I.ui.keyCode.PAGE_DOWN){this._activate(this._focusNextTab(this.options.active+1,true));return true}},_findNextTab:function(ac,ad){var ab=this.tabs.length-1;function ae(){if(ac>ab){ac=0}if(ac<0){ac=ab}return ac}while(I.inArray(ae(),this.options.disabled)!==-1){ac=ad?ac+1:ac-1}return ac},_focusNextTab:function(ab,ac){ab=this._findNextTab(ab,ac);this.tabs.eq(ab).focus();return ab},_setOption:function(ab,ac){if(ab==="active"){this._activate(ac);return}if(ab==="disabled"){this._setupDisabled(ac);return}this._super(ab,ac);if(ab==="collapsible"){this.element.toggleClass("ui-tabs-collapsible",ac);if(!ac&&this.options.active===false){this._activate(0)}}if(ab==="event"){this._setupEvents(ac)}if(ab==="heightStyle"){this._setupHeightStyle(ac)}},_sanitizeSelector:function(ab){return ab?ab.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):""},refresh:function(){var ac=this.options,ab=this.tablist.children(":has(a[href])");ac.disabled=I.map(ab.filter(".ui-state-disabled"),function(ad){return ab.index(ad)});this._processTabs();if(ac.active===false||!this.anchors.length){ac.active=false;this.active=I()}else{if(this.active.length&&!I.contains(this.tablist[0],this.active[0])){if(this.tabs.length===ac.disabled.length){ac.active=false;this.active=I()}else{this._activate(this._findNextTab(Math.max(0,ac.active-1),false))}}else{ac.active=this.tabs.index(this.active)}}this._refresh()},_refresh:function(){this._setupDisabled(this.options.disabled);this._setupEvents(this.options.event);this._setupHeightStyle(this.options.heightStyle);this.tabs.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1});this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-hidden":"true"});if(!this.active.length){this.tabs.eq(0).attr("tabIndex",0)}else{this.active.addClass("ui-tabs-active ui-state-active").attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0});this._getPanelForTab(this.active).show().attr({"aria-hidden":"false"})}},_processTabs:function(){var ad=this,ae=this.tabs,ac=this.anchors,ab=this.panels;this.tablist=this._getList().addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").attr("role","tablist").delegate("> li","mousedown"+this.eventNamespace,function(af){if(I(this).is(".ui-state-disabled")){af.preventDefault()}}).delegate(".ui-tabs-anchor","focus"+this.eventNamespace,function(){if(I(this).closest("li").is(".ui-state-disabled")){this.blur()}});this.tabs=this.tablist.find("> li:has(a[href])").addClass("ui-state-default ui-corner-top").attr({role:"tab",tabIndex:-1});this.anchors=this.tabs.map(function(){return I("a",this)[0]}).addClass("ui-tabs-anchor").attr({role:"presentation",tabIndex:-1});this.panels=I();this.anchors.each(function(ak,ai){var af,ag,aj,ah=I(ai).uniqueId().attr("id"),al=I(ai).closest("li"),am=al.attr("aria-controls");if(ad._isLocal(ai)){af=ai.hash;aj=af.substring(1);ag=ad.element.find(ad._sanitizeSelector(af))}else{aj=al.attr("aria-controls")||I({}).uniqueId()[0].id;af="#"+aj;ag=ad.element.find(af);if(!ag.length){ag=ad._createPanel(aj);ag.insertAfter(ad.panels[ak-1]||ad.tablist)}ag.attr("aria-live","polite")}if(ag.length){ad.panels=ad.panels.add(ag)}if(am){al.data("ui-tabs-aria-controls",am)}al.attr({"aria-controls":aj,"aria-labelledby":ah});ag.attr("aria-labelledby",ah)});this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").attr("role","tabpanel");if(ae){this._off(ae.not(this.tabs));this._off(ac.not(this.anchors));this._off(ab.not(this.panels))}},_getList:function(){return this.tablist||this.element.find("ol,ul").eq(0)},_createPanel:function(ab){return I("<div>").attr("id",ab).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("ui-tabs-destroy",true)},_setupDisabled:function(ad){if(I.isArray(ad)){if(!ad.length){ad=false}else{if(ad.length===this.anchors.length){ad=true}}}for(var ac=0,ab;(ab=this.tabs[ac]);ac++){if(ad===true||I.inArray(ac,ad)!==-1){I(ab).addClass("ui-state-disabled").attr("aria-disabled","true")}else{I(ab).removeClass("ui-state-disabled").removeAttr("aria-disabled")}}this.options.disabled=ad},_setupEvents:function(ac){var ab={};if(ac){I.each(ac.split(" "),function(ae,ad){ab[ad]="_eventHandler"})}this._off(this.anchors.add(this.tabs).add(this.panels));this._on(true,this.anchors,{click:function(ad){ad.preventDefault()}});this._on(this.anchors,ab);this._on(this.tabs,{keydown:"_tabKeydown"});this._on(this.panels,{keydown:"_panelKeydown"});this._focusable(this.tabs);this._hoverable(this.tabs)},_setupHeightStyle:function(ab){var ad,ac=this.element.parent();if(ab==="fill"){ad=ac.height();ad-=this.element.outerHeight()-this.element.height();this.element.siblings(":visible").each(function(){var af=I(this),ae=af.css("position");if(ae==="absolute"||ae==="fixed"){return}ad-=af.outerHeight(true)});this.element.children().not(this.panels).each(function(){ad-=I(this).outerHeight(true)});this.panels.each(function(){I(this).height(Math.max(0,ad-I(this).innerHeight()+I(this).height()))}).css("overflow","auto")}else{if(ab==="auto"){ad=0;this.panels.each(function(){ad=Math.max(ad,I(this).height("").height())}).height(ad)}}},_eventHandler:function(ab){var ak=this.options,af=this.active,ag=I(ab.currentTarget),ae=ag.closest("li"),ai=ae[0]===af[0],ac=ai&&ak.collapsible,ad=ac?I():this._getPanelForTab(ae),ah=!af.length?I():this._getPanelForTab(af),aj={oldTab:af,oldPanel:ah,newTab:ac?I():ae,newPanel:ad};ab.preventDefault();if(ae.hasClass("ui-state-disabled")||ae.hasClass("ui-tabs-loading")||this.running||(ai&&!ak.collapsible)||(this._trigger("beforeActivate",ab,aj)===false)){return}ak.active=ac?false:this.tabs.index(ae);this.active=ai?I():ae;if(this.xhr){this.xhr.abort()}if(!ah.length&&!ad.length){I.error("jQuery UI Tabs: Mismatching fragment identifier.")}if(ad.length){this.load(this.tabs.index(ae),ab)}this._toggle(ab,aj)},_toggle:function(ah,ag){var af=this,ab=ag.newPanel,ae=ag.oldPanel;this.running=true;function ad(){af.running=false;af._trigger("activate",ah,ag)}function ac(){ag.newTab.closest("li").addClass("ui-tabs-active ui-state-active");if(ab.length&&af.options.show){af._show(ab,af.options.show,ad)}else{ab.show();ad()}}if(ae.length&&this.options.hide){this._hide(ae,this.options.hide,function(){ag.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active");ac()})}else{ag.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active");ae.hide();ac()}ae.attr("aria-hidden","true");ag.oldTab.attr({"aria-selected":"false","aria-expanded":"false"});if(ab.length&&ae.length){ag.oldTab.attr("tabIndex",-1)}else{if(ab.length){this.tabs.filter(function(){return I(this).attr("tabIndex")===0}).attr("tabIndex",-1)}}ab.attr("aria-hidden","false");ag.newTab.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0})},_activate:function(ac){var ab,ad=this._findActive(ac);if(ad[0]===this.active[0]){return}if(!ad.length){ad=this.active}ab=ad.find(".ui-tabs-anchor")[0];this._eventHandler({target:ab,currentTarget:ab,preventDefault:I.noop})},_findActive:function(ab){return ab===false?I():this.tabs.eq(ab)},_getIndex:function(ab){if(typeof ab==="string"){ab=this.anchors.index(this.anchors.filter("[href$='"+ab+"']"))}return ab},_destroy:function(){if(this.xhr){this.xhr.abort()}this.element.removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible");this.tablist.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").removeAttr("role");this.anchors.removeClass("ui-tabs-anchor").removeAttr("role").removeAttr("tabIndex").removeUniqueId();this.tablist.unbind(this.eventNamespace);this.tabs.add(this.panels).each(function(){if(I.data(this,"ui-tabs-destroy")){I(this).remove()}else{I(this).removeClass("ui-state-default ui-state-active ui-state-disabled ui-corner-top ui-corner-bottom ui-widget-content ui-tabs-active ui-tabs-panel").removeAttr("tabIndex").removeAttr("aria-live").removeAttr("aria-busy").removeAttr("aria-selected").removeAttr("aria-labelledby").removeAttr("aria-hidden").removeAttr("aria-expanded").removeAttr("role")}});this.tabs.each(function(){var ab=I(this),ac=ab.data("ui-tabs-aria-controls");if(ac){ab.attr("aria-controls",ac).removeData("ui-tabs-aria-controls")}else{ab.removeAttr("aria-controls")}});this.panels.show();if(this.options.heightStyle!=="content"){this.panels.css("height","")}},enable:function(ab){var ac=this.options.disabled;if(ac===false){return}if(ab===undefined){ac=false}else{ab=this._getIndex(ab);if(I.isArray(ac)){ac=I.map(ac,function(ad){return ad!==ab?ad:null})}else{ac=I.map(this.tabs,function(ad,ae){return ae!==ab?ae:null})}}this._setupDisabled(ac)},disable:function(ab){var ac=this.options.disabled;if(ac===true){return}if(ab===undefined){ac=true}else{ab=this._getIndex(ab);if(I.inArray(ab,ac)!==-1){return}if(I.isArray(ac)){ac=I.merge([ab],ac).sort()}else{ac=[ab]}}this._setupDisabled(ac)},load:function(ad,ah){ad=this._getIndex(ad);var ag=this,ae=this.tabs.eq(ad),ac=ae.find(".ui-tabs-anchor"),ab=this._getPanelForTab(ae),af={tab:ae,panel:ab};if(this._isLocal(ac[0])){return}this.xhr=I.ajax(this._ajaxSettings(ac,ah,af));if(this.xhr&&this.xhr.statusText!=="canceled"){ae.addClass("ui-tabs-loading");ab.attr("aria-busy","true");this.xhr.success(function(ai){setTimeout(function(){ab.html(ai);ag._trigger("load",ah,af)},1)}).complete(function(aj,ai){setTimeout(function(){if(ai==="abort"){ag.panels.stop(false,true)}ae.removeClass("ui-tabs-loading");ab.removeAttr("aria-busy");if(aj===ag.xhr){delete ag.xhr}},1)})}},_ajaxSettings:function(ab,ae,ad){var ac=this;return{url:ab.attr("href"),beforeSend:function(ag,af){return ac._trigger("beforeLoad",ae,I.extend({jqXHR:ag,ajaxSettings:af},ad))}}},_getPanelForTab:function(ab){var ac=I(ab).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+ac))}});
/*!
 * jQuery UI Effects 1.11.3
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/category/effects-core/
 */
var l="ui-effects-",t=I;I.effects={effect:{}};
/*!
 * jQuery Color Animations v2.1.2
 * https://github.com/jquery/jquery-color
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * Date: Wed Jan 16 08:47:09 2013 -0600
 */
(function(ap,ae){var al="backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor",ai=/^([\-+])=\s*(\d+\.?\d*)/,ah=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(aq){return[aq[1],aq[2],aq[3],aq[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(aq){return[aq[1]*2.55,aq[2]*2.55,aq[3]*2.55,aq[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(aq){return[parseInt(aq[1],16),parseInt(aq[2],16),parseInt(aq[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(aq){return[parseInt(aq[1]+aq[1],16),parseInt(aq[2]+aq[2],16),parseInt(aq[3]+aq[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(aq){return[aq[1],aq[2]/100,aq[3]/100,aq[4]]}}],af=ap.Color=function(ar,at,aq,au){return new ap.Color.fn.parse(ar,at,aq,au)},ak={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},ao={"byte":{floor:true,max:255},percent:{max:1},degrees:{mod:360,floor:true}},an=af.support={},ac=ap("<p>")[0],ab,am=ap.each;ac.style.cssText="background-color:rgba(1,1,1,.5)";an.rgba=ac.style.backgroundColor.indexOf("rgba")>-1;am(ak,function(aq,ar){ar.cache="_"+aq;ar.props.alpha={idx:3,type:"percent",def:1}});function aj(ar,au,at){var aq=ao[au.type]||{};if(ar==null){return(at||!au.def)?null:au.def}ar=aq.floor?~~ar:parseFloat(ar);if(isNaN(ar)){return au.def}if(aq.mod){return(ar+aq.mod)%aq.mod}return 0>ar?0:aq.max<ar?aq.max:ar}function ag(aq){var at=af(),ar=at._rgba=[];aq=aq.toLowerCase();am(ah,function(ay,az){var aw,ax=az.re.exec(aq),av=ax&&az.parse(ax),au=az.space||"rgba";if(av){aw=at[au](av);at[ak[au].cache]=aw[ak[au].cache];ar=at._rgba=aw._rgba;return false}});if(ar.length){if(ar.join()==="0,0,0,0"){ap.extend(ar,ab.transparent)}return at}return ab[aq]}af.fn=ap.extend(af.prototype,{parse:function(ax,av,aq,aw){if(ax===ae){this._rgba=[null,null,null,null];return this}if(ax.jquery||ax.nodeType){ax=ap(ax).css(av);av=ae}var au=this,at=ap.type(ax),ar=this._rgba=[];if(av!==ae){ax=[ax,av,aq,aw];at="array"}if(at==="string"){return this.parse(ag(ax)||ab._default)}if(at==="array"){am(ak.rgba.props,function(ay,az){ar[az.idx]=aj(ax[az.idx],az)});return this}if(at==="object"){if(ax instanceof af){am(ak,function(ay,az){if(ax[az.cache]){au[az.cache]=ax[az.cache].slice()}})}else{am(ak,function(az,aA){var ay=aA.cache;am(aA.props,function(aB,aC){if(!au[ay]&&aA.to){if(aB==="alpha"||ax[aB]==null){return}au[ay]=aA.to(au._rgba)}au[ay][aC.idx]=aj(ax[aB],aC,true)});if(au[ay]&&ap.inArray(null,au[ay].slice(0,3))<0){au[ay][3]=1;if(aA.from){au._rgba=aA.from(au[ay])}}})}return this}},is:function(at){var aq=af(at),au=true,ar=this;am(ak,function(av,ax){var ay,aw=aq[ax.cache];if(aw){ay=ar[ax.cache]||ax.to&&ax.to(ar._rgba)||[];am(ax.props,function(az,aA){if(aw[aA.idx]!=null){au=(aw[aA.idx]===ay[aA.idx]);return au}})}return au});return au},_space:function(){var aq=[],ar=this;am(ak,function(at,au){if(ar[au.cache]){aq.push(at)}});return aq.pop()},transition:function(ar,ay){var at=af(ar),au=at._space(),av=ak[au],aw=this.alpha()===0?af("transparent"):this,ax=aw[av.cache]||av.to(aw._rgba),aq=ax.slice();at=at[av.cache];am(av.props,function(aC,aE){var aB=aE.idx,aA=ax[aB],az=at[aB],aD=ao[aE.type]||{};if(az===null){return}if(aA===null){aq[aB]=az}else{if(aD.mod){if(az-aA>aD.mod/2){aA+=aD.mod}else{if(aA-az>aD.mod/2){aA-=aD.mod}}}aq[aB]=aj((az-aA)*ay+aA,aE)}});return this[au](aq)},blend:function(au){if(this._rgba[3]===1){return this}var at=this._rgba.slice(),ar=at.pop(),aq=af(au)._rgba;return af(ap.map(at,function(av,aw){return(1-ar)*aq[aw]+ar*av}))},toRgbaString:function(){var ar="rgba(",aq=ap.map(this._rgba,function(at,au){return at==null?(au>2?1:0):at});if(aq[3]===1){aq.pop();ar="rgb("}return ar+aq.join()+")"},toHslaString:function(){var ar="hsla(",aq=ap.map(this.hsla(),function(at,au){if(at==null){at=au>2?1:0}if(au&&au<3){at=Math.round(at*100)+"%"}return at});if(aq[3]===1){aq.pop();ar="hsl("}return ar+aq.join()+")"},toHexString:function(aq){var ar=this._rgba.slice(),at=ar.pop();if(aq){ar.push(~~(at*255))}return"#"+ap.map(ar,function(au){au=(au||0).toString(16);return au.length===1?"0"+au:au}).join("")},toString:function(){return this._rgba[3]===0?"transparent":this.toRgbaString()}});af.fn.parse.prototype=af.fn;function ad(at,ar,aq){aq=(aq+1)%1;if(aq*6<1){return at+(ar-at)*aq*6}if(aq*2<1){return ar}if(aq*3<2){return at+(ar-at)*((2/3)-aq)*6}return at}ak.hsla.to=function(at){if(at[0]==null||at[1]==null||at[2]==null){return[null,null,null,at[3]]}var aq=at[0]/255,aw=at[1]/255,ax=at[2]/255,az=at[3],ay=Math.max(aq,aw,ax),au=Math.min(aq,aw,ax),aA=ay-au,aB=ay+au,ar=aB*0.5,av,aC;if(au===ay){av=0}else{if(aq===ay){av=(60*(aw-ax)/aA)+360}else{if(aw===ay){av=(60*(ax-aq)/aA)+120}else{av=(60*(aq-aw)/aA)+240}}}if(aA===0){aC=0}else{if(ar<=0.5){aC=aA/aB}else{aC=aA/(2-aB)}}return[Math.round(av)%360,aC,ar,az==null?1:az]};ak.hsla.from=function(av){if(av[0]==null||av[1]==null||av[2]==null){return[null,null,null,av[3]]}var au=av[0]/360,at=av[1],ar=av[2],aq=av[3],aw=ar<=0.5?ar*(1+at):ar+at-ar*at,ax=2*ar-aw;return[Math.round(ad(ax,aw,au+(1/3))*255),Math.round(ad(ax,aw,au)*255),Math.round(ad(ax,aw,au-(1/3))*255),aq]};am(ak,function(ar,au){var at=au.props,aq=au.cache,aw=au.to,av=au.from;af.fn[ar]=function(aB){if(aw&&!this[aq]){this[aq]=aw(this._rgba)}if(aB===ae){return this[aq].slice()}var ay,aA=ap.type(aB),ax=(aA==="array"||aA==="object")?aB:arguments,az=this[aq].slice();am(at,function(aC,aE){var aD=ax[aA==="object"?aC:aE.idx];if(aD==null){aD=az[aE.idx]}az[aE.idx]=aj(aD,aE)});if(av){ay=af(av(az));ay[aq]=az;return ay}else{return af(az)}};am(at,function(ax,ay){if(af.fn[ax]){return}af.fn[ax]=function(aC){var aE=ap.type(aC),aB=(ax==="alpha"?(this._hsla?"hsla":"rgba"):ar),aA=this[aB](),aD=aA[ay.idx],az;if(aE==="undefined"){return aD}if(aE==="function"){aC=aC.call(this,aD);aE=ap.type(aC)}if(aC==null&&ay.empty){return this}if(aE==="string"){az=ai.exec(aC);if(az){aC=aD+parseFloat(az[2])*(az[1]==="+"?1:-1)}}aA[ay.idx]=aC;return this[aB](aA)}})});af.hook=function(ar){var aq=ar.split(" ");am(aq,function(at,au){ap.cssHooks[au]={set:function(ay,az){var aw,ax,av="";if(az!=="transparent"&&(ap.type(az)!=="string"||(aw=ag(az)))){az=af(aw||az);if(!an.rgba&&az._rgba[3]!==1){ax=au==="backgroundColor"?ay.parentNode:ay;while((av===""||av==="transparent")&&ax&&ax.style){try{av=ap.css(ax,"backgroundColor");ax=ax.parentNode}catch(aA){}}az=az.blend(av&&av!=="transparent"?av:"_default")}az=az.toRgbaString()}try{ay.style[au]=az}catch(aA){}}};ap.fx.step[au]=function(av){if(!av.colorInit){av.start=af(av.elem,au);av.end=af(av.end);av.colorInit=true}ap.cssHooks[au].set(av.elem,av.start.transition(av.end,av.pos))}})};af.hook(al);ap.cssHooks.borderColor={expand:function(ar){var aq={};am(["Top","Right","Bottom","Left"],function(au,at){aq["border"+at+"Color"]=ar});return aq}};ab=ap.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}})(t);(function(){var ac=["add","remove","toggle"],ad={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};I.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(af,ag){I.fx.step[ag]=function(ah){if(ah.end!=="none"&&!ah.setAttr||ah.pos===1&&!ah.setAttr){t.style(ah.elem,ag,ah.end);ah.setAttr=true}}});function ae(aj){var ag,af,ah=aj.ownerDocument.defaultView?aj.ownerDocument.defaultView.getComputedStyle(aj,null):aj.currentStyle,ai={};if(ah&&ah.length&&ah[0]&&ah[ah[0]]){af=ah.length;while(af--){ag=ah[af];if(typeof ah[ag]==="string"){ai[I.camelCase(ag)]=ah[ag]}}}else{for(ag in ah){if(typeof ah[ag]==="string"){ai[ag]=ah[ag]}}}return ai}function ab(af,ah){var aj={},ag,ai;for(ag in ah){ai=ah[ag];if(af[ag]!==ai){if(!ad[ag]){if(I.fx.step[ag]||!isNaN(parseFloat(ai))){aj[ag]=ai}}}}return aj}if(!I.fn.addBack){I.fn.addBack=function(af){return this.add(af==null?this.prevObject:this.prevObject.filter(af))}}I.effects.animateClass=function(af,ag,aj,ai){var ah=I.speed(ag,aj,ai);return this.queue(function(){var am=I(this),ak=am.attr("class")||"",al,an=ah.children?am.find("*").addBack():am;an=an.map(function(){var ao=I(this);return{el:ao,start:ae(this)}});al=function(){I.each(ac,function(ao,ap){if(af[ap]){am[ap+"Class"](af[ap])}})};al();an=an.map(function(){this.end=ae(this.el[0]);this.diff=ab(this.start,this.end);return this});am.attr("class",ak);an=an.map(function(){var aq=this,ao=I.Deferred(),ap=I.extend({},ah,{queue:false,complete:function(){ao.resolve(aq)}});this.el.animate(this.diff,ap);return ao.promise()});I.when.apply(I,an.get()).done(function(){al();I.each(arguments,function(){var ao=this.el;I.each(this.diff,function(ap){ao.css(ap,"")})});ah.complete.call(am[0])})})};I.fn.extend({addClass:(function(af){return function(ah,ag,aj,ai){return ag?I.effects.animateClass.call(this,{add:ah},ag,aj,ai):af.apply(this,arguments)}})(I.fn.addClass),removeClass:(function(af){return function(ah,ag,aj,ai){return arguments.length>1?I.effects.animateClass.call(this,{remove:ah},ag,aj,ai):af.apply(this,arguments)}})(I.fn.removeClass),toggleClass:(function(af){return function(ai,ah,ag,ak,aj){if(typeof ah==="boolean"||ah===undefined){if(!ag){return af.apply(this,arguments)}else{return I.effects.animateClass.call(this,(ah?{add:ai}:{remove:ai}),ag,ak,aj)}}else{return I.effects.animateClass.call(this,{toggle:ai},ah,ag,ak)}}})(I.fn.toggleClass),switchClass:function(af,ah,ag,aj,ai){return I.effects.animateClass.call(this,{add:ah,remove:af},ag,aj,ai)}})})();(function(){I.extend(I.effects,{version:"1.11.3",save:function(ae,af){for(var ad=0;ad<af.length;ad++){if(af[ad]!==null){ae.data(l+af[ad],ae[0].style[af[ad]])}}},restore:function(ae,ag){var af,ad;for(ad=0;ad<ag.length;ad++){if(ag[ad]!==null){af=ae.data(l+ag[ad]);if(af===undefined){af=""}ae.css(ag[ad],af)}}},setMode:function(ad,ae){if(ae==="toggle"){ae=ad.is(":hidden")?"show":"hide"}return ae},getBaseline:function(ae,af){var ag,ad;switch(ae[0]){case"top":ag=0;break;case"middle":ag=0.5;break;case"bottom":ag=1;break;default:ag=ae[0]/af.height}switch(ae[1]){case"left":ad=0;break;case"center":ad=0.5;break;case"right":ad=1;break;default:ad=ae[1]/af.width}return{x:ad,y:ag}},createWrapper:function(ae){if(ae.parent().is(".ui-effects-wrapper")){return ae.parent()}var af={width:ae.outerWidth(true),height:ae.outerHeight(true),"float":ae.css("float")},ai=I("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),ad={width:ae.width(),height:ae.height()},ah=document.activeElement;try{ah.id}catch(ag){ah=document.body}ae.wrap(ai);if(ae[0]===ah||I.contains(ae[0],ah)){I(ah).focus()}ai=ae.parent();if(ae.css("position")==="static"){ai.css({position:"relative"});ae.css({position:"relative"})}else{I.extend(af,{position:ae.css("position"),zIndex:ae.css("z-index")});I.each(["top","left","bottom","right"],function(aj,ak){af[ak]=ae.css(ak);if(isNaN(parseInt(af[ak],10))){af[ak]="auto"}});ae.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})}ae.css(ad);return ai.css(af).show()},removeWrapper:function(ad){var ae=document.activeElement;if(ad.parent().is(".ui-effects-wrapper")){ad.parent().replaceWith(ad);if(ad[0]===ae||I.contains(ad[0],ae)){I(ae).focus()}}return ad},setTransition:function(ae,ag,ad,af){af=af||{};I.each(ag,function(ai,ah){var aj=ae.cssUnit(ah);if(aj[0]>0){af[ah]=aj[0]*ad+aj[1]}});return af}});function ab(ae,ad,af,ag){if(I.isPlainObject(ae)){ad=ae;ae=ae.effect}ae={effect:ae};if(ad==null){ad={}}if(I.isFunction(ad)){ag=ad;af=null;ad={}}if(typeof ad==="number"||I.fx.speeds[ad]){ag=af;af=ad;ad={}}if(I.isFunction(af)){ag=af;af=null}if(ad){I.extend(ae,ad)}af=af||ad.duration;ae.duration=I.fx.off?0:typeof af==="number"?af:af in I.fx.speeds?I.fx.speeds[af]:I.fx.speeds._default;ae.complete=ag||ad.complete;return ae}function ac(ad){if(!ad||typeof ad==="number"||I.fx.speeds[ad]){return true}if(typeof ad==="string"&&!I.effects.effect[ad]){return true}if(I.isFunction(ad)){return true}if(typeof ad==="object"&&!ad.effect){return true}return false}I.fn.extend({effect:function(){var af=ab.apply(this,arguments),ah=af.mode,ad=af.queue,ae=I.effects.effect[af.effect];if(I.fx.off||!ae){if(ah){return this[ah](af.duration,af.complete)}else{return this.each(function(){if(af.complete){af.complete.call(this)}})}}function ag(ak){var al=I(this),aj=af.complete,am=af.mode;function ai(){if(I.isFunction(aj)){aj.call(al[0])}if(I.isFunction(ak)){ak()}}if(al.is(":hidden")?am==="hide":am==="show"){al[am]();ai()}else{ae.call(al[0],af,ai)}}return ad===false?this.each(ag):this.queue(ad||"fx",ag)},show:(function(ad){return function(af){if(ac(af)){return ad.apply(this,arguments)}else{var ae=ab.apply(this,arguments);ae.mode="show";return this.effect.call(this,ae)}}})(I.fn.show),hide:(function(ad){return function(af){if(ac(af)){return ad.apply(this,arguments)}else{var ae=ab.apply(this,arguments);ae.mode="hide";return this.effect.call(this,ae)}}})(I.fn.hide),toggle:(function(ad){return function(af){if(ac(af)||typeof af==="boolean"){return ad.apply(this,arguments)}else{var ae=ab.apply(this,arguments);ae.mode="toggle";return this.effect.call(this,ae)}}})(I.fn.toggle),cssUnit:function(ad){var ae=this.css(ad),af=[];I.each(["em","px","%","pt"],function(ag,ah){if(ae.indexOf(ah)>0){af=[parseFloat(ae),ah]}});return af}})})();(function(){var ab={};I.each(["Quad","Cubic","Quart","Quint","Expo"],function(ad,ac){ab[ac]=function(ae){return Math.pow(ae,ad+2)}});I.extend(ab,{Sine:function(ac){return 1-Math.cos(ac*Math.PI/2)},Circ:function(ac){return 1-Math.sqrt(1-ac*ac)},Elastic:function(ac){return ac===0||ac===1?ac:-Math.pow(2,8*(ac-1))*Math.sin(((ac-1)*80-7.5)*Math.PI/15)},Back:function(ac){return ac*ac*(3*ac-2)},Bounce:function(ae){var ac,ad=4;while(ae<((ac=Math.pow(2,--ad))-1)/11){}return 1/Math.pow(4,3-ad)-7.5625*Math.pow((ac*3-2)/22-ae,2)}});I.each(ab,function(ad,ac){I.easing["easeIn"+ad]=ac;I.easing["easeOut"+ad]=function(ae){return 1-ac(1-ae)};I.easing["easeInOut"+ad]=function(ae){return ae<0.5?ac(ae*2)/2:1-ac(ae*-2+2)/2}})})();var R=I.effects;
/*!
 * jQuery UI Effects Blind 1.11.3
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/blind-effect/
 */
var V=I.effects.effect.blind=function(ad,aj){var ae=I(this),an=/up|down|vertical/,am=/up|left|vertical|horizontal/,ao=["position","top","bottom","left","right","height","width"],ak=I.effects.setMode(ae,ad.mode||"hide"),ap=ad.direction||"up",ag=an.test(ap),af=ag?"height":"width",al=ag?"top":"left",ar=am.test(ap),ai={},aq=ak==="show",ac,ab,ah;if(ae.parent().is(".ui-effects-wrapper")){I.effects.save(ae.parent(),ao)}else{I.effects.save(ae,ao)}ae.show();ac=I.effects.createWrapper(ae).css({overflow:"hidden"});ab=ac[af]();ah=parseFloat(ac.css(al))||0;ai[af]=aq?ab:0;if(!ar){ae.css(ag?"bottom":"right",0).css(ag?"top":"left","auto").css({position:"absolute"});ai[al]=aq?ah:ab+ah}if(aq){ac.css(af,0);if(!ar){ac.css(al,ah+ab)}}ac.animate(ai,{duration:ad.duration,easing:ad.easing,queue:false,complete:function(){if(ak==="hide"){ae.hide()}I.effects.restore(ae,ao);I.effects.removeWrapper(ae);aj()}})};
/*!
 * jQuery UI Effects Bounce 1.11.3
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/bounce-effect/
 */
var Q=I.effects.effect.bounce=function(ak,aj){var ab=I(this),ac=["position","top","bottom","left","right","height","width"],ai=I.effects.setMode(ab,ak.mode||"effect"),ah=ai==="hide",at=ai==="show",au=ak.direction||"up",ad=ak.distance,ag=ak.times||5,av=ag*2+(at||ah?1:0),ar=ak.duration/av,am=ak.easing,ae=(au==="up"||au==="down")?"top":"left",al=(au==="up"||au==="left"),aq,af,ap,an=ab.queue(),ao=an.length;if(at||ah){ac.push("opacity")}I.effects.save(ab,ac);ab.show();I.effects.createWrapper(ab);if(!ad){ad=ab[ae==="top"?"outerHeight":"outerWidth"]()/3}if(at){ap={opacity:1};ap[ae]=0;ab.css("opacity",0).css(ae,al?-ad*2:ad*2).animate(ap,ar,am)}if(ah){ad=ad/Math.pow(2,ag-1)}ap={};ap[ae]=0;for(aq=0;aq<ag;aq++){af={};af[ae]=(al?"-=":"+=")+ad;ab.animate(af,ar,am).animate(ap,ar,am);ad=ah?ad*2:ad/2}if(ah){af={opacity:0};af[ae]=(al?"-=":"+=")+ad;ab.animate(af,ar,am)}ab.queue(function(){if(ah){ab.hide()}I.effects.restore(ab,ac);I.effects.removeWrapper(ab);aj()});if(ao>1){an.splice.apply(an,[1,0].concat(an.splice(ao,av+1)))}ab.dequeue()};
/*!
 * jQuery UI Effects Clip 1.11.3
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/clip-effect/
 */
var D=I.effects.effect.clip=function(ae,ah){var af=I(this),al=["position","top","bottom","left","right","height","width"],ak=I.effects.setMode(af,ae.mode||"hide"),an=ak==="show",am=ae.direction||"vertical",aj=am==="vertical",ao=aj?"height":"width",ai=aj?"top":"left",ag={},ac,ad,ab;I.effects.save(af,al);af.show();ac=I.effects.createWrapper(af).css({overflow:"hidden"});ad=(af[0].tagName==="IMG")?ac:af;ab=ad[ao]();if(an){ad.css(ao,0);ad.css(ai,ab/2)}ag[ao]=an?ab:0;ag[ai]=an?0:ab/2;ad.animate(ag,{queue:false,duration:ae.duration,easing:ae.easing,complete:function(){if(!an){af.hide()}I.effects.restore(af,al);I.effects.removeWrapper(af);ah()}})};
/*!
 * jQuery UI Effects Drop 1.11.3
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/drop-effect/
 */
var p=I.effects.effect.drop=function(ac,ag){var ad=I(this),ai=["position","top","bottom","left","right","opacity","height","width"],ah=I.effects.setMode(ad,ac.mode||"hide"),ak=ah==="show",aj=ac.direction||"left",ae=(aj==="up"||aj==="down")?"top":"left",al=(aj==="up"||aj==="left")?"pos":"neg",af={opacity:ak?1:0},ab;I.effects.save(ad,ai);ad.show();I.effects.createWrapper(ad);ab=ac.distance||ad[ae==="top"?"outerHeight":"outerWidth"](true)/2;if(ak){ad.css("opacity",0).css(ae,al==="pos"?-ab:ab)}af[ae]=(ak?(al==="pos"?"+=":"-="):(al==="pos"?"-=":"+="))+ab;ad.animate(af,{queue:false,duration:ac.duration,easing:ac.easing,complete:function(){if(ah==="hide"){ad.hide()}I.effects.restore(ad,ai);I.effects.removeWrapper(ad);ag()}})};
/*!
 * jQuery UI Effects Explode 1.11.3
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/explode-effect/
 */
var O=I.effects.effect.explode=function(ao,an){var ah=ao.pieces?Math.round(Math.sqrt(ao.pieces)):3,ac=ah,ab=I(this),aj=I.effects.setMode(ab,ao.mode||"hide"),at=aj==="show",af=ab.show().css("visibility","hidden").offset(),ap=Math.ceil(ab.outerWidth()/ac),am=Math.ceil(ab.outerHeight()/ah),ag=[],ar,aq,ad,al,ak,ai;function au(){ag.push(this);if(ag.length===ah*ac){ae()}}for(ar=0;ar<ah;ar++){al=af.top+ar*am;ai=ar-(ah-1)/2;for(aq=0;aq<ac;aq++){ad=af.left+aq*ap;ak=aq-(ac-1)/2;ab.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-aq*ap,top:-ar*am}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:ap,height:am,left:ad+(at?ak*ap:0),top:al+(at?ai*am:0),opacity:at?0:1}).animate({left:ad+(at?0:ak*ap),top:al+(at?0:ai*am),opacity:at?1:0},ao.duration||500,ao.easing,au)}}function ae(){ab.css({visibility:"visible"});I(ag).remove();if(!at){ab.hide()}an()}};
/*!
 * jQuery UI Effects Fade 1.11.3
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/fade-effect/
 */
var P=I.effects.effect.fade=function(ae,ab){var ac=I(this),ad=I.effects.setMode(ac,ae.mode||"toggle");ac.animate({opacity:ad},{queue:false,duration:ae.duration,easing:ae.easing,complete:ab})};
/*!
 * jQuery UI Effects Fold 1.11.3
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/fold-effect/
 */
var F=I.effects.effect.fold=function(ad,ah){var ae=I(this),am=["position","top","bottom","left","right","height","width"],aj=I.effects.setMode(ae,ad.mode||"hide"),ap=aj==="show",ak=aj==="hide",ar=ad.size||15,al=/([0-9]+)%/.exec(ar),aq=!!ad.horizFirst,ai=ap!==aq,af=ai?["width","height"]:["height","width"],ag=ad.duration/2,ac,ab,ao={},an={};I.effects.save(ae,am);ae.show();ac=I.effects.createWrapper(ae).css({overflow:"hidden"});ab=ai?[ac.width(),ac.height()]:[ac.height(),ac.width()];if(al){ar=parseInt(al[1],10)/100*ab[ak?0:1]}if(ap){ac.css(aq?{height:0,width:ar}:{height:ar,width:0})}ao[af[0]]=ap?ab[0]:ar;an[af[1]]=ap?ab[1]:0;ac.animate(ao,ag,ad.easing).animate(an,ag,ad.easing,function(){if(ak){ae.hide()}I.effects.restore(ae,am);I.effects.removeWrapper(ae);ah()})};
/*!
 * jQuery UI Effects Highlight 1.11.3
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/highlight-effect/
 */
var K=I.effects.effect.highlight=function(ag,ab){var ad=I(this),ac=["backgroundImage","backgroundColor","opacity"],af=I.effects.setMode(ad,ag.mode||"show"),ae={backgroundColor:ad.css("backgroundColor")};if(af==="hide"){ae.opacity=0}I.effects.save(ad,ac);ad.show().css({backgroundImage:"none",backgroundColor:ag.color||"#ffff99"}).animate(ae,{queue:false,duration:ag.duration,easing:ag.easing,complete:function(){if(af==="hide"){ad.hide()}I.effects.restore(ad,ac);ab()}})};
/*!
 * jQuery UI Effects Size 1.11.3
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/size-effect/
 */
var a=I.effects.effect.size=function(ak,aj){var ao,ah,ai,ab=I(this),an=["position","top","bottom","left","right","width","height","overflow","opacity"],am=["position","top","bottom","left","right","overflow","opacity"],al=["width","height","overflow"],af=["fontSize"],aq=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],ac=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],ag=I.effects.setMode(ab,ak.mode||"effect"),ap=ak.restore||ag!=="effect",au=ak.scale||"both",ar=ak.origin||["middle","center"],at=ab.css("position"),ad=ap?an:am,ae={height:0,width:0,outerHeight:0,outerWidth:0};if(ag==="show"){ab.show()}ao={height:ab.height(),width:ab.width(),outerHeight:ab.outerHeight(),outerWidth:ab.outerWidth()};if(ak.mode==="toggle"&&ag==="show"){ab.from=ak.to||ae;ab.to=ak.from||ao}else{ab.from=ak.from||(ag==="show"?ae:ao);ab.to=ak.to||(ag==="hide"?ae:ao)}ai={from:{y:ab.from.height/ao.height,x:ab.from.width/ao.width},to:{y:ab.to.height/ao.height,x:ab.to.width/ao.width}};if(au==="box"||au==="both"){if(ai.from.y!==ai.to.y){ad=ad.concat(aq);ab.from=I.effects.setTransition(ab,aq,ai.from.y,ab.from);ab.to=I.effects.setTransition(ab,aq,ai.to.y,ab.to)}if(ai.from.x!==ai.to.x){ad=ad.concat(ac);ab.from=I.effects.setTransition(ab,ac,ai.from.x,ab.from);ab.to=I.effects.setTransition(ab,ac,ai.to.x,ab.to)}}if(au==="content"||au==="both"){if(ai.from.y!==ai.to.y){ad=ad.concat(af).concat(al);ab.from=I.effects.setTransition(ab,af,ai.from.y,ab.from);ab.to=I.effects.setTransition(ab,af,ai.to.y,ab.to)}}I.effects.save(ab,ad);ab.show();I.effects.createWrapper(ab);ab.css("overflow","hidden").css(ab.from);if(ar){ah=I.effects.getBaseline(ar,ao);ab.from.top=(ao.outerHeight-ab.outerHeight())*ah.y;ab.from.left=(ao.outerWidth-ab.outerWidth())*ah.x;ab.to.top=(ao.outerHeight-ab.to.outerHeight)*ah.y;ab.to.left=(ao.outerWidth-ab.to.outerWidth)*ah.x}ab.css(ab.from);if(au==="content"||au==="both"){aq=aq.concat(["marginTop","marginBottom"]).concat(af);ac=ac.concat(["marginLeft","marginRight"]);al=an.concat(aq).concat(ac);ab.find("*[width]").each(function(){var aw=I(this),av={height:aw.height(),width:aw.width(),outerHeight:aw.outerHeight(),outerWidth:aw.outerWidth()};if(ap){I.effects.save(aw,al)}aw.from={height:av.height*ai.from.y,width:av.width*ai.from.x,outerHeight:av.outerHeight*ai.from.y,outerWidth:av.outerWidth*ai.from.x};aw.to={height:av.height*ai.to.y,width:av.width*ai.to.x,outerHeight:av.height*ai.to.y,outerWidth:av.width*ai.to.x};if(ai.from.y!==ai.to.y){aw.from=I.effects.setTransition(aw,aq,ai.from.y,aw.from);aw.to=I.effects.setTransition(aw,aq,ai.to.y,aw.to)}if(ai.from.x!==ai.to.x){aw.from=I.effects.setTransition(aw,ac,ai.from.x,aw.from);aw.to=I.effects.setTransition(aw,ac,ai.to.x,aw.to)}aw.css(aw.from);aw.animate(aw.to,ak.duration,ak.easing,function(){if(ap){I.effects.restore(aw,al)}})})}ab.animate(ab.to,{queue:false,duration:ak.duration,easing:ak.easing,complete:function(){if(ab.to.opacity===0){ab.css("opacity",ab.from.opacity)}if(ag==="hide"){ab.hide()}I.effects.restore(ab,ad);if(!ap){if(at==="static"){ab.css({position:"relative",top:ab.to.top,left:ab.to.left})}else{I.each(["top","left"],function(av,aw){ab.css(aw,function(ay,aA){var az=parseInt(aA,10),ax=av?ab.to.left:ab.to.top;if(aA==="auto"){return ax+"px"}return az+ax+"px"})})}}I.effects.removeWrapper(ab);aj()}})};
/*!
 * jQuery UI Effects Scale 1.11.3
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/scale-effect/
 */
var f=I.effects.effect.scale=function(ab,ae){var ac=I(this),ak=I.extend(true,{},ab),af=I.effects.setMode(ac,ab.mode||"effect"),ag=parseInt(ab.percent,10)||(parseInt(ab.percent,10)===0?0:(af==="hide"?0:100)),ai=ab.direction||"both",aj=ab.origin,ad={height:ac.height(),width:ac.width(),outerHeight:ac.outerHeight(),outerWidth:ac.outerWidth()},ah={y:ai!=="horizontal"?(ag/100):1,x:ai!=="vertical"?(ag/100):1};ak.effect="size";ak.queue=false;ak.complete=ae;if(af!=="effect"){ak.origin=aj||["middle","center"];ak.restore=true}ak.from=ab.from||(af==="show"?{height:0,width:0,outerHeight:0,outerWidth:0}:ad);ak.to={height:ad.height*ah.y,width:ad.width*ah.x,outerHeight:ad.outerHeight*ah.y,outerWidth:ad.outerWidth*ah.x};if(ak.fade){if(af==="show"){ak.from.opacity=0;ak.to.opacity=1}if(af==="hide"){ak.from.opacity=1;ak.to.opacity=0}}ac.effect(ak)};
/*!
 * jQuery UI Effects Puff 1.11.3
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/puff-effect/
 */
var Y=I.effects.effect.puff=function(ai,ab){var ag=I(this),ah=I.effects.setMode(ag,ai.mode||"hide"),ae=ah==="hide",af=parseInt(ai.percent,10)||150,ad=af/100,ac={height:ag.height(),width:ag.width(),outerHeight:ag.outerHeight(),outerWidth:ag.outerWidth()};I.extend(ai,{effect:"scale",queue:false,fade:true,mode:ah,complete:ab,percent:ae?af:100,from:ae?ac:{height:ac.height*ad,width:ac.width*ad,outerHeight:ac.outerHeight*ad,outerWidth:ac.outerWidth*ad}});ag.effect(ai)};
/*!
 * jQuery UI Effects Pulsate 1.11.3
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/pulsate-effect/
 */
var H=I.effects.effect.pulsate=function(ab,af){var ad=I(this),ai=I.effects.setMode(ad,ab.mode||"show"),am=ai==="show",aj=ai==="hide",an=(am||ai==="hide"),ak=((ab.times||5)*2)+(an?1:0),ae=ab.duration/ak,al=0,ah=ad.queue(),ac=ah.length,ag;if(am||!ad.is(":visible")){ad.css("opacity",0).show();al=1}for(ag=1;ag<ak;ag++){ad.animate({opacity:al},ae,ab.easing);al=1-al}ad.animate({opacity:al},ae,ab.easing);ad.queue(function(){if(aj){ad.hide()}af()});if(ac>1){ah.splice.apply(ah,[1,0].concat(ah.splice(ac,ak+1)))}ad.dequeue()};
/*!
 * jQuery UI Effects Shake 1.11.3
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/shake-effect/
 */
var B=I.effects.effect.shake=function(aj,ai){var ab=I(this),ac=["position","top","bottom","left","right","height","width"],ah=I.effects.setMode(ab,aj.mode||"effect"),ar=aj.direction||"left",ad=aj.distance||20,ag=aj.times||3,at=ag*2+1,an=Math.round(aj.duration/at),af=(ar==="up"||ar==="down")?"top":"left",ae=(ar==="up"||ar==="left"),aq={},ap={},ao={},am,ak=ab.queue(),al=ak.length;I.effects.save(ab,ac);ab.show();I.effects.createWrapper(ab);aq[af]=(ae?"-=":"+=")+ad;ap[af]=(ae?"+=":"-=")+ad*2;ao[af]=(ae?"-=":"+=")+ad*2;ab.animate(aq,an,aj.easing);for(am=1;am<ag;am++){ab.animate(ap,an,aj.easing).animate(ao,an,aj.easing)}ab.animate(ap,an,aj.easing).animate(aq,an/2,aj.easing).queue(function(){if(ah==="hide"){ab.hide()}I.effects.restore(ab,ac);I.effects.removeWrapper(ab);ai()});if(al>1){ak.splice.apply(ak,[1,0].concat(ak.splice(al,at+1)))}ab.dequeue()};
/*!
 * jQuery UI Effects Slide 1.11.3
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/slide-effect/
 */
var A=I.effects.effect.slide=function(ad,ah){var ae=I(this),aj=["position","top","bottom","left","right","width","height"],ai=I.effects.setMode(ae,ad.mode||"show"),al=ai==="show",ak=ad.direction||"left",af=(ak==="up"||ak==="down")?"top":"left",ac=(ak==="up"||ak==="left"),ab,ag={};I.effects.save(ae,aj);ae.show();ab=ad.distance||ae[af==="top"?"outerHeight":"outerWidth"](true);I.effects.createWrapper(ae).css({overflow:"hidden"});if(al){ae.css(af,ac?(isNaN(ab)?"-"+ab:-ab):ab)}ag[af]=(al?(ac?"+=":"-="):(ac?"-=":"+="))+ab;ae.animate(ag,{queue:false,duration:ad.duration,easing:ad.easing,complete:function(){if(ai==="hide"){ae.hide()}I.effects.restore(ae,aj);I.effects.removeWrapper(ae);ah()}})};
/*!
 * jQuery UI Effects Transfer 1.11.3
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/transfer-effect/
 */
var n=I.effects.effect.transfer=function(ac,ag){var ae=I(this),aj=I(ac.to),am=aj.css("position")==="fixed",ai=I("body"),ak=am?ai.scrollTop():0,al=am?ai.scrollLeft():0,ab=aj.offset(),af={top:ab.top-ak,left:ab.left-al,height:aj.innerHeight(),width:aj.innerWidth()},ah=ae.offset(),ad=I("<div class='ui-effects-transfer'></div>").appendTo(document.body).addClass(ac.className).css({top:ah.top-ak,left:ah.left-al,height:ae.innerHeight(),width:ae.innerWidth(),position:am?"fixed":"absolute"}).animate(af,ac.duration,ac.easing,function(){ad.remove();ag()})}}));
/*!
 * jQuery UI Touch Punch 0.2.3
 *
 * Copyright 20112014, Dave Furfero
 * Dual licensed under the MIT or GPL Version 2 licenses.
 *
 * Depends:
 *  jquery.ui.widget.js
 *  jquery.ui.mouse.js
 */
!function(h){function j(f,e){if(!(f.originalEvent.touches.length>1)){f.preventDefault();var o=f.originalEvent.changedTouches[0],n=document.createEvent("MouseEvents");n.initMouseEvent(e,!0,!0,window,1,o.screenX,o.screenY,o.clientX,o.clientY,!1,!1,!1,!1,0,null),f.target.dispatchEvent(n)}}if(h.support.touch="ontouchend" in document,h.support.touch){var k,g=h.ui.mouse.prototype,m=g._mouseInit,l=g._mouseDestroy;g._touchStart=function(d){var c=this;!k&&c._mouseCapture(d.originalEvent.changedTouches[0])&&(k=!0,c._touchMoved=!1,j(d,"mouseover"),j(d,"mousemove"),j(d,"mousedown"))},g._touchMove=function(b){k&&(this._touchMoved=!0,j(b,"mousemove"))},g._touchEnd=function(b){k&&(j(b,"mouseup"),j(b,"mouseout"),this._touchMoved||j(b,"click"),k=!1)},g._mouseInit=function(){var a=this;a.element.bind({touchstart:h.proxy(a,"_touchStart"),touchmove:h.proxy(a,"_touchMove"),touchend:h.proxy(a,"_touchEnd")}),m.call(a)},g._mouseDestroy=function(){var a=this;a.element.unbind({touchstart:h.proxy(a,"_touchStart"),touchmove:h.proxy(a,"_touchMove"),touchend:h.proxy(a,"_touchEnd")}),l.call(a)}}}(jQuery);(function(c){c.extend(c.ui,{multiDatesPicker:{version:"1.6.3"}});c.fn.multiDatesPicker=function(e){var n=arguments;var o=this;var l=new Date();var f=new Date(0);var m={};function j(r,t){if(!t){t="picked"}r=p.call(this,r);for(var s=0;s<this.multiDatesPicker.dates[t].length;s++){if(!k.compareDates(this.multiDatesPicker.dates[t][s],r)){return this.multiDatesPicker.dates[t].splice(s,1).pop()}}}function g(r,s){if(!s){s="picked"}return this.multiDatesPicker.dates[s].splice(r,1).pop()}function h(r,t,s){if(!t){t="picked"}r=p.call(this,r);r.setHours(0);r.setMinutes(0);r.setSeconds(0);r.setMilliseconds(0);if(k.gotDate.call(this,r,t)===false){this.multiDatesPicker.dates[t].push(r);if(!s){this.multiDatesPicker.dates[t].sort(k.compareDates)}}}function q(r){if(!r){r="picked"}this.multiDatesPicker.dates[r].sort(k.compareDates)}function p(r,s,t){if(!s){s="object"}return k.dateConvert.call(this,r,s,t)}var k={init:function(s){var v=c(this);this.multiDatesPicker.changed=false;var w={beforeShow:function(x,y){this.multiDatesPicker.changed=false;if(this.multiDatesPicker.originalBeforeShow){this.multiDatesPicker.originalBeforeShow.call(this,x,y)}},onSelect:function(D,B){var C=c(this);this.multiDatesPicker.changed=true;if(D){C.multiDatesPicker("toggleDate",D);this.multiDatesPicker.changed=true}if(this.multiDatesPicker.mode=="normal"&&this.multiDatesPicker.pickableRange){if(this.multiDatesPicker.dates.picked.length>0){var z=this.multiDatesPicker.dates.picked[0],A=new Date(z.getTime());k.sumDays(A,this.multiDatesPicker.pickableRange-1);if(this.multiDatesPicker.adjustRangeToDisabled){var E,y=this.multiDatesPicker.dates.disabled.slice(0);do{E=0;for(var x=0;x<y.length;x++){if(y[x].getTime()<=A.getTime()){if((z.getTime()<=y[x].getTime())&&(y[x].getTime()<=A.getTime())){E++}y.splice(x,1);x--}}A.setDate(A.getDate()+E)}while(E!=0)}if(this.multiDatesPicker.maxDate&&(A>this.multiDatesPicker.maxDate)){A=this.multiDatesPicker.maxDate}C.datepicker("option","minDate",z).datepicker("option","maxDate",A)}else{C.datepicker("option","minDate",this.multiDatesPicker.minDate).datepicker("option","maxDate",this.multiDatesPicker.maxDate)}}if(this.multiDatesPicker.originalOnSelect&&D){this.multiDatesPicker.originalOnSelect.call(this,D,B)}},beforeShowDay:function(y){var C=c(this),z=C.multiDatesPicker("gotDate",y)!==false,A=C.datepicker("option","disabled"),B=C.multiDatesPicker("gotDate",y,"disabled")!==false,x=this.multiDatesPicker.maxPicks<=this.multiDatesPicker.dates.picked.length;var D=[true,"",null];if(this.multiDatesPicker.originalBeforeShowDay){D=this.multiDatesPicker.originalBeforeShowDay.call(this,y)}D[1]=z?"ui-state-highlight":D[1];D[0]=D[0]&&!(A||B||(x&&!D[1]));return D}};if(v.val()){var r=v.val()}this.multiDatesPicker.separator=", ";if(s){if(s.separator){this.multiDatesPicker.separator=s.separator}this.multiDatesPicker.originalBeforeShow=s.beforeShow;this.multiDatesPicker.originalOnSelect=s.onSelect;this.multiDatesPicker.originalBeforeShowDay=s.beforeShowDay;this.multiDatesPicker.originalOnClose=s.onClose;v.datepicker(s);this.multiDatesPicker.minDate=c.datepicker._determineDate(this,s.minDate,null);this.multiDatesPicker.maxDate=c.datepicker._determineDate(this,s.maxDate,null);if(s.addDates){k.addDates.call(this,s.addDates)}if(s.addDisabledDates){k.addDates.call(this,s.addDisabledDates,"disabled")}k.setMode.call(this,s)}else{v.datepicker()}v.datepicker("option",w);if(r){v.multiDatesPicker("value",r)}var u=v.multiDatesPicker("value");if(this.tagName=="INPUT"){v.val(u)}var t=v.datepicker("option","altField");if(t){c(t).val(u)}v.datepicker("refresh")},compareDates:function(t,r){t=p.call(this,t);r=p.call(this,r);var s=t.getFullYear()-r.getFullYear();if(!s){s=t.getMonth()-r.getMonth();if(!s){s=t.getDate()-r.getDate()}}return s},sumDays:function(r,t){var s=typeof r;obj_date=p.call(this,r);obj_date.setDate(obj_date.getDate()+t);return p.call(this,obj_date,s)},dateConvert:function(t,s,r){var x=typeof t;if(x==s){if(x=="object"){try{t.getTime()}catch(w){c.error("Received date is in a non supported format!");return false}}return t}var v=c(this);if(typeof t=="undefined"){t=new Date(0)}if(s!="string"&&s!="object"&&s!="number"){c.error('Date format "'+s+'" not supported!')}if(!r){r=c.datepicker._defaults.dateFormat;var u=v.datepicker("option","dateFormat");if(u){r=u}}switch(x){case"object":break;case"string":t=c.datepicker.parseDate(r,t);break;case"number":t=new Date(t);break;default:c.error('Conversion from "'+s+'" format not allowed on jQuery.multiDatesPicker')}switch(s){case"object":return t;case"string":return c.datepicker.formatDate(r,t);case"number":return t.getTime();default:c.error('Conversion to "'+s+'" format not allowed on jQuery.multiDatesPicker')}return false},gotDate:function(r,t){if(!t){t="picked"}for(var s=0;s<this.multiDatesPicker.dates[t].length;s++){if(k.compareDates.call(this,this.multiDatesPicker.dates[t][s],r)===0){return s}}return false},value:function(r){if(r&&typeof r=="string"){k.addDates.call(this,r.split(this.multiDatesPicker.separator))}else{var s=k.getDates.call(this,"string");return s.length?s.join(this.multiDatesPicker.separator):""}},getDates:function(t,s){if(!t){t="string"}if(!s){s="picked"}switch(t){case"object":return this.multiDatesPicker.dates[s];case"string":case"number":var u=new Array();for(var r in this.multiDatesPicker.dates[s]){u.push(p.call(this,this.multiDatesPicker.dates[s][r],t))}return u;default:c.error('Format "'+t+'" not supported!')}},addDates:function(t,s){if(t.length>0){if(!s){s="picked"}switch(typeof t){case"object":case"array":if(t.length){for(var r=0;r<t.length;r++){h.call(this,t[r],s,true)}q.call(this,s);break}case"string":case"number":h.call(this,t,s);break;default:c.error('Date format "'+typeof t+'" not allowed on jQuery.multiDatesPicker')}}else{c.error("Empty array of dates received.")}},removeDates:function(u,s){if(!s){s="picked"}var t=[];if(Object.prototype.toString.call(u)==="[object Array]"){for(var r in u.sort(function(w,v){return v-w})){t.push(j.call(this,u[r],s))}}else{t.push(j.call(this,u,s))}return t},removeIndexes:function(r,t){if(!t){t="picked"}var u=[];if(Object.prototype.toString.call(r)==="[object Array]"){for(var s in r.sort(function(w,v){return v-w})){u.push(g.call(this,r[s],t))}}else{u.push(g.call(this,r,t))}return u},resetDates:function(r){if(!r){r="picked"}this.multiDatesPicker.dates[r]=[]},toggleDate:function(s,v){if(!v){v="picked"}switch(this.multiDatesPicker.mode){case"daysRange":this.multiDatesPicker.dates[v]=[];var r=this.multiDatesPicker.autoselectRange[1];var u=this.multiDatesPicker.autoselectRange[0];if(r<u){r=this.multiDatesPicker.autoselectRange[0];u=this.multiDatesPicker.autoselectRange[1]}for(var t=u;t<r;t++){k.addDates.call(this,k.sumDays(s,t),v)}break;default:if(k.gotDate.call(this,s)===false){k.addDates.call(this,s,v)}else{k.removeDates.call(this,s,v)}break}},setMode:function(r){var t=c(this);if(r.mode){this.multiDatesPicker.mode=r.mode}switch(this.multiDatesPicker.mode){case"normal":for(option in r){switch(option){case"maxPicks":case"minPicks":case"pickableRange":case"adjustRangeToDisabled":this.multiDatesPicker[option]=r[option];break}}break;case"daysRange":case"weeksRange":var s=1;for(option in r){switch(option){case"autoselectRange":s--;case"pickableRange":case"adjustRangeToDisabled":this.multiDatesPicker[option]=r[option];break}}if(s>0){c.error("Some mandatory options not specified!")}break}if(m.onSelect){m.onSelect()}},destroy:function(){this.multiDatesPicker=null;c(this).datepicker("destroy")}};this.each(function(){var t=c(this);if(!this.multiDatesPicker){this.multiDatesPicker={dates:{picked:[],disabled:[]},mode:"normal",adjustRangeToDisabled:true}}if(k[e]){var r=k[e].apply(this,Array.prototype.slice.call(n,1));switch(e){case"removeDates":case"removeIndexes":case"resetDates":case"toggleDate":case"addDates":var s=t.datepicker("option","altField");var u=k.value.call(this);if(s!==undefined&&s!=""){c(s).val(u)}if(this.tagName=="INPUT"){t.val(u)}c.datepicker._refreshDatepicker(this)}switch(e){case"removeDates":case"getDates":case"gotDate":case"sumDays":case"compareDates":case"dateConvert":case"value":o=r}return r}else{if(typeof e==="object"||!e){return k.init.apply(this,n)}else{c.error("Method "+e+" does not exist on jQuery.multiDatesPicker")}}return false});return o};var d="multiDatesPicker";var b=new Date().getTime();var a;c.multiDatesPicker={version:false};c.multiDatesPicker.initialized=false;c.multiDatesPicker.uuid=new Date().getTime();c.multiDatesPicker.version=c.ui.multiDatesPicker.version;c.multiDatesPicker._hideDatepicker=c.datepicker._hideDatepicker;c.datepicker._hideDatepicker=function(){var f=this._curInst.input[0];var e=f.multiDatesPicker;if(!e||(this._curInst.inline===false&&!e.changed)){return c.multiDatesPicker._hideDatepicker.apply(this,arguments)}else{e.changed=false;c.datepicker._refreshDatepicker(f);return}};window["DP_jQuery_"+b]=c})(jQuery);var $QvJq=jQuery.noConflict();$=$QvJq;function Assert(a){}(function($){var BUILD_NUMBER=20700;var BUILD_NUMBER_STRING="20700";var BUILD_TIMESTAMP="2018-06-19 10:42:48";var BUILD_VERSION="Build: 20700, 2018-06-19 10:42:48";var BUILD_QUALIFIER_STRING="SR6";var MAJOR_VERSION=12;var MAJOR_VERSION_STRING="12";var MINOR_VERSION=20;var MINOR_VERSION_STRING="20";var MINOR_SUB_VERSION=0;var MINOR_SUB_VERSION_STRING="0";var COPYRIGHT_YEAR_STRING="2018";var QV_BUILD_INFO="QV12-20/150";var RELEASE_LABEL_STRING="November 2017 SR6";(function($){$.fn.extend({getPath:function(stopAtBody){stopAtBody=stopAtBody||false;function traverseUp(el){var result=el.tagName+":eq("+$(el).index()+")",pare=$(el).parent()[0];if(pare&&pare.tagName!==undefined&&(!stopAtBody||pare.tagName!=="BODY")){result=[traverseUp(pare),result].join(" ")}return result}return this.length>0?traverseUp(this[0]):""}})})($QvJq);
/*! Build $BuildVersion$ */
if(typeof Qva==="undefined"){Qva={};Qva.Debug={DisableFileCache:false,AllowMouseEventsIfTouch:false,SimulateTouchDevice:false,UseConsolelog:false}}Qva.Debug.IsDebugMode=false,Qva.IS_WORKBENCH=false;Qva.IS_WEBPARTS=false;Qva.LoadedSharedFile=false;Qva.params={};Qva.agent=navigator.userAgent.toLowerCase();Qva.userAgentDetector={options:{android:false,chrome:false,ipad:false,iphone:false,ios:false,ios8orBelow:false,ios9orUp:false,gecko:false,geckoVersion:null,macintosh:false,mobile:false,msie:false,msie64bit:false,msie6o7:false,msie8lte:false,msie10gte:false,msie10:false,msie10mode7:false,msie11emu:false,msie11gte:false,msie11:false,msie11Webview:false,msieDocMode:null,msieJscriptVersion:null,msieVersionString:"",msieVersion:null,opera:false,playbook:false,safari:false,touchEnabled:false,touchAvailable:false,webkit:false,windows:false,pointerSupport:false,isSmallDevices:false,isFullDevices:false,isResponsiveDevices:false,smallDevicesChecked:false,fullDevicesChecked:false,responsiveDevicesChecked:false,webview:false,isWorkbench:Qva.IS_WORKBENCH,isWebparts:Qva.IS_WEBPARTS,maxHeight:null,alert:{}},init:function(){if(typeof String.prototype.trim!=="function"){String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}}this.getOsPlatform(Qva.agent,[this.getRenderingEngine,this.getBasicBrowserType,this.getDetails,this.getTouch,this.getMobile,this.getWebView,this.getMaxHeight],{},this)},getOsPlatform:function(agentString,callbacks,params,binder){if(agentString.indexOf("ipad")!==-1){binder.options.ipad=true;binder.options.ios=true}else{if(agentString.indexOf("playbook")!==-1){binder.options.playbook=true}else{if(agentString.indexOf("iphone")!==-1){binder.options.iphone=true;binder.options.ios=true}else{if(agentString.indexOf("android")!==-1){binder.options.android=true}else{if(agentString.indexOf("macintosh")!==-1){binder.options.macintosh=true}}}}}binder.doCallback(agentString,callbacks,params)},getIosVersion:function(agentString,callbacks,params,binder){if(binder.options.ios===true){var iOS_version=(String(agentString.match(/[0-9]_[0-9]/)).split("_")[0]+"."+String(agentString.match(/[0-9]_[0-9]/)).split("_")[1]);alert(iOS_version);if(iOS_version<=8){binder.options.ios8orBelow=true}else{if(iOS_version>=9){binder.options.ios9orUp=true}}}binder.doCallback(agentString,callbacks,params)},getRenderingEngine:function(agentString,callbacks,params,binder){if(window.webkitURL){binder.options.webkit=true}binder.doCallback(agentString,callbacks,params)},getBasicBrowserType:function(agentString,callbacks,params,binder){if(agentString.indexOf(" edge/")!==-1){binder.options.msedge=true;params="msedge"}else{if(agentString.indexOf("chrome")!==-1&&binder.options.webkit===true){binder.options.chrome=true;params="chrome"}else{if(agentString.indexOf("safari")!==-1||agentString.indexOf("konqueror")!==-1){binder.options.safari=true;params="safari"}else{if(agentString.indexOf("opera")!==-1){binder.options.opera=true;params="opera"}else{if(agentString.indexOf("msie")!==-1||agentString.indexOf("trident")!==-1){binder.options.msie=true;params="msie"}else{if(agentString.indexOf("gecko")!==-1&&agentString.indexOf("like gecko")===-1&&binder.options.webkit===false){binder.options.gecko=true;params="gecko"}}}}}}binder.doCallback(agentString,callbacks,params)},getDetails:function(agentString,callbacks,params,binder){switch(params){case"msie":var trident,pos;trident=-1;pos=agentString.indexOf("trident/");if(pos!==-1){trident=parseInt(agentString.substr(pos+8,agentString.indexOf(".",pos)))}if(trident>5){binder.options.msie10gte=true}if(trident>5&&trident<7){binder.options.msie10=true}if(trident>6){binder.options.msie11gte=true;if(agentString.indexOf("like gecko")===-1){binder.options.msie11Webview=true}}if(trident>6&&trident<8){binder.options.msie11=true}if(agentString.indexOf("wow64")!==-1||agentString.indexOf("x64")!==-1){binder.options.msie64bit=true}if(binder.options.msie11gte===true){binder.options.msieVersionString=agentString.substr(agentString.search("rv:")+3,agentString.substr(agentString.search("rv:")+3).indexOf(";"));binder.options.msieVersion=parseFloat(binder.options.msieVersionString);if(isNaN(binder.options.msieVersion)){binder.options.msieVersionString=agentString.substr(agentString.search("msie")+4,agentString.substr(agentString.search("msie")+4).indexOf(";"));binder.options.msieVersion=parseFloat(binder.options.msieVersionString)}}else{binder.options.msieVersionString=agentString.substr(agentString.search("msie")+4,agentString.substr(agentString.search("msie")+4).indexOf(";"));binder.options.msieVersion=parseFloat(binder.options.msieVersionString)}binder.options.msieVersionString=binder.options.msieVersionString.trim();if(document.documentMode){binder.options.msieDocMode=document.documentMode}else{binder.options.msieDocMode=binder.options.msieVersion}binder.options.msie6o7=(binder.options.msieVersion<8&&binder.options.msieDocMode<8);binder.options.msie8lte=(binder.options.msieVersion<9&&binder.options.msieDocMode<9);eval("/*@cc_on binder.options.msieJscriptVersion = @_jscript_version @*/");if(binder.options.msieJscriptVersion==10&&binder.options.msieVersion==7){binder.options.msie10mode7=true}if(binder.options.msieJscriptVersion==11&&binder.options.msieVersion<11){binder.options.msie11emu=true}break;case"gecko":binder.options.geckoVersion=parseFloat(agentString.substr(agentString.search("firefox")+8,3));break}binder.doCallback(agentString,callbacks,params)},getTouch:function(agentString,callbacks,params,binder){binder.options.touchEnabled="ontouchstart" in window||Qva.Debug.SimulateTouchDevice||(window.navigator.maxTouchPoints&&window.navigator.maxTouchPoints>1)||(window.navigator.msMaxTouchPoints&&window.navigator.msMaxTouchPoints>1);binder.options.touchAvailable=binder.options.touchEnabled;if(typeof binder.options.touchEnabled==="undefined"){binder.options.touchEnabled=false}if(typeof binder.options.touchAvailable==="undefined"){binder.options.touchAvailable=false}if(window.navigator.pointerEnabled||window.navigator.msPointerEnabled){binder.options.pointerSupport=true}binder.doCallback(agentString,callbacks,params)},getMobile:function(agentString,callbacks,params,binder){binder.options.mobile=agentString.indexOf("mobile")!==-1;binder.doCallback(agentString,callbacks,params)},getWebView:function(agentString,callbacks,params,binder){binder.options.webview=document.location.href.toLowerCase().indexOf("openunicorndoc.htm")>-1;binder.doCallback(agentString,callbacks,params)},getMaxHeight:function(agentString,callbacks,params,binder){switch(params){case"msedge":binder.options.maxHeight=1533916;break;case"msie":binder.options.maxHeight=1342177;break;case"gecko":binder.options.maxHeight=17889999;break;default:binder.options.maxHeight=33500000}binder.doCallback(agentString,callbacks,params)},doCallback:function(agentString,callbacks,params){if(callbacks&&callbacks.length>0){var callback=callbacks[0];var newCallbacks=callbacks.slice(1);callback(agentString,newCallbacks,params,this)}},get:function(key){var result=false;if(typeof Qva.userAgentDetector.options[key]==="undefined"&&!Qva.Debug.UseConsolelog&&!Qva.userAgentDetector.options.alert[key]){Qva.ConsoleLog.Log("Browser Detection - Get: Key ["+key+"] not found");Qva.userAgentDetector.options.alert[key]=true;return false}switch(typeof Qva.userAgentDetector.options[key]){case"boolean":if(Qva.userAgentDetector.options[key]===true){result=true}break;case"string":case"number":result=Qva.userAgentDetector.options[key];break}return result},set:function(key,value){if(typeof Qva.userAgentDetector.options[key]==="undefined"){return false}else{Qva.userAgentDetector.options[key]=value;return true}}};Qva.preRequisits=function(){if(!Object.keys){Object.keys=Object.keys||function(o){var result=[];for(var name in o){if(o.hasOwnProperty(name)){result.push(name)}}return result}}delete (Qva.agent);Qva.UrlParams={};Qva.params.SimulatePen=false;Qva.params.transientMenuOpen=false;if(window.location.href.toUpperCase().indexOf("/QMC/")!==-1||window.location.href.toUpperCase().indexOf("/QMCCOMMON/")!==-1){Qva.UrlParams.isQmc="isQmc"}else{delete Qva.UrlParams.isQmc}Qva.mobile={closetrans:0};if(Qva.userAgentDetector&&!Qva.userAgentDetector.get("msie")){HTMLElement.prototype.__defineGetter__("innerText",function(){return this.textContent});HTMLElement.prototype.__defineSetter__("innerText",function($value){this.textContent=$value});Event.prototype.__defineGetter__("srcElement",function(){return(this.target.nodeType==Node.ELEMENT_NODE)?this.target:this.target.parentNode});Event.prototype.__defineGetter__("toElement",function(){return(this.type=="mouseout")?this.relatedTarget:(this.type=="mouseover")?this.srcElement:null})}if(typeof XMLDocument==="undefined"&&typeof Document!=="undefined"){XMLDocument=Document}var bind=Function.bind;var unbind=bind.bind(bind);function instantiate(constructor,args){return new (unbind(constructor,null).apply(null,args))}Date=function(Date){var names=Object.getOwnPropertyNames(Date);for(var i=0;i<names.length;i++){if(names[i] in MyDate){continue}var desc=Object.getOwnPropertyDescriptor(Date,names[i]);Object.defineProperty(MyDate,names[i],desc)}return MyDate;function MyDate(){var date=instantiate(Date,arguments);var args=arguments.length;var arg=arguments[0];if((args===3||args==6)&&arg<100&&arg>=0){date.setFullYear(arg)}return date}}(Date)};Qva.userAgentDetector.init();Qva.preRequisits();function Assert(exprToEval){}function clone(o){var c={};for(var x in o){c[x]=o[x]}return c}function purge(elem){var attributes=elem.attributes,i=0,nodeCount=0,name="";if(attributes){for(i=attributes.length-1;i>=0;i--){name=attributes[i].name;if(typeof elem[name]==="function"){elem[name]=null}}}if(elem.childNodes){for(i=0,nodeCount=elem.childNodes.length;i<nodeCount;++i){purge(elem.childNodes[i])}}}function isExternalDomain(url){var checkDomain=function(url){if(url.indexOf("//")===0){url=location.protocol+url}return url.toLowerCase().replace(/([a-z])?:\/\//,"$1").split("/")[0]};return((url.indexOf(":")>-1||url.indexOf("//")>-1)&&checkDomain(location.href)!==checkDomain(url))}Qva.binders={};Qva.GetBinder=function(id,view){var binder=Qva.binders[id||""];if(!binder&&view){binder=new Qva.PageBinding(id);binder.View=view;if(Qva.Modal&&!Qva.Modal.instance){new Qva.Modal()}var def_binder=Qva.GetBinder();if(def_binder){binder.Autoview=def_binder.Autoview;binder.Remote=def_binder.Remote;binder.JSON=def_binder.JSON}}return binder};Qva.Start=function(){Qva.jQueryOverRides();Qva.DPI=96;debugVal=Qva.ExtractProperty("Debug","false");if(debugVal.toLowerCase()==="true"){for(propName in Qva.Debug){if(Qva.Debug.hasOwnProperty(propName)){debugVal=Qva.ExtractProperty(propName,"","false");if(debugVal!==""){if(debugVal.toLowerCase()==="true"||debugVal.toLowerCase()==="false"){Qva.Debug[propName]=debugVal==="true"}else{Qva.Debug[propName]=debugVal}alert(propName+": "+Qva.Debug[propName])}}}}Qva.IsElementSupportingKeyDownAndUp=function(element){if(element==null||typeof element=="undefined"){return false}return $.grep(element.AvqMgr.Managers,function(mgr){return(typeof mgr.IsSupportingKeyUpAndDown!="undefined")}).length>0};Qva.IsBrowserScrollbarsVisible=function(){var docHeight=$(document).height();var scroll=$(window).height()+$(window).scrollTop();if(docHeight!=scroll){return true}return false};function _Start(){if(Qva.Scanner&&Qva.Scanner.instance){Qva.Scanner.instance.Start()}var loadAuthenticateBinder=false,$win=$(window),$doc=$(document),binders=[];for(var id in Qva.binders){var binder=Qva.binders[id];binders.push(binder);binder.Start();if(!loadAuthenticateBinder){var anonymous=Qva.ExtractProperty("anonymous",binder.Ticket,true)!=null;if(!anonymous&&(binder.Anonymous===true||binder.Anonymous==="true")){anonymous=true}if(!anonymous&&binder.AuthenticateUrl){loadAuthenticateBinder=binder}}}function loadBeginInSequence(index){binders[index].LoadBegin.apply(binders[index]);if(index<(binders.length-1)){binders[index].CallOnceOnUpdateComplete(function(){loadBeginInSequence(++index)})}}function loadBeginAll(){loadBeginInSequence(0)}if(loadAuthenticateBinder){loadAuthenticateBinder.LoadAuthenticate(function(ok,text){if(ok){loadBeginAll()}else{loadBeginAll()}})}else{loadBeginAll()}$(document).bind("keydown",function(e){if(e.keyCode!==40&&e.keyCode!==38){return true}if(Qva.IsBrowserScrollbarsVisible()===true){if(Qva.ActiveObjects&&Qva.ActiveObjects.length>0){if(Qva.IsElementSupportingKeyDownAndUp(document.getElementById(Qva.ActiveObjects[0]))===true){e.preventDefault();return false}}}return true});if(document.addEventListener){document.addEventListener("keyup",function(event){Qva.OnKeyUp(event)},false);document.addEventListener("keypress",function(event){Qva.OnKeyPress(event)},false);try{if(window.parent&&window.parent!=window){window.parent.addEventListener("keyup",function(event){if(Qva){Qva.OnKeyUp(event)}},false);window.parent.addEventListener("keypress",function(event){if(Qva){Qva.OnKeyPress(event)}},false)}}catch(Err){}}else{document.attachEvent("onkeyup",function(event){Qva.OnKeyUp(event)});document.attachEvent("onkeypress",function(event){Qva.OnKeyPress(event)})}Qva.Events.AddClickEvent(document,Qva.OnDocumentClick,{preventDefault:false});if($("body").hasClass("QvPageBody")){$(window).on("resize orientationchange",function(){Qva.ResizeBody({adjustscroll:true})});$(window).on("scroll",function(){if(Qva.userAgentDetector.get("ipad")||Qva.userAgentDetector.get("iphone")){if(Qva.GetScrollLeft()<0||Qva.GetScrollLeft()+Qva.GetViewportWidth()>$("body")[0].scrollWidth){return}}Qva.ResizeBody({adjustscroll:false})})}}var userid=Qva.ExtractProperty("userid",null,true);var password=Qva.ExtractProperty("password",null,true);if(userid===""||password===""){Qva.RemainingRetries=parseInt(Qva.ExtractProperty("retry","3"));if(isNaN(Qva.RemainingRetries)){Qva.RemainingRetries=3}var first=true;var fakePagebinder={LabelClick:false,Refresh:function(){if(!first){return}first=false;_Start()}};Qva.Modal.instance.Show(fakePagebinder,Qva.Remote+(Qva.Remote.indexOf("?")>=0?"&":"?")+"public=only&name=login.htm&userid="+Qva.EncodeComponent(userid))}else{_Start()}if(typeof(Qva.dropDialog)!=="undefined"){Qva.dropDialog.create(true)}if(Qva.userAgentDetector.get("msie8lte")&&!Qva.UrlParams.isQmc){Qva.ReplacePngUrlsInStyleSheetsWithGif()}if(Qva.QvAjaxZfcPath.toLowerCase().indexOf("proxy.aspx")>0){setTimeout(Qva.AddProxyToUrlsInStyleSheets,40)}if(Qva.BodyOnLoadFunctionNames.length>0){window.setTimeout(Qva.ExecuteBodyOnLoadFunctionNames,40)}if(window.self!==window.top){window.focus()}};Qva.OnDocumentClick=function(event){if(Qva.userAgentDetector.get("gecko")){if(event.button==2){return}}var target=Qva.Events.getTarget(event);if($(target).closest(".ui-widget").length>0){return}Qva.HideContextMenu();Qva.ClosePopupInput();Qva.CloseMessagePopup();if(!Qva.LabelClick){return}if(!Qva.DocumentClick){return}if(document.activeElement&&document.activeElement.onchange){try{document.activeElement.onchange();document.activeElement.blur()}catch(err){}}for(var id in Qva.binders){var binder=Qva.binders[id];if(!binder.Enabled){continue}binder.Set("Document","click","",true)}};Qva.PopupInput=null;Qva.ContextMenu=null;Qva.ContextMenuMgr=null;Qva.ContextDropDown=null;Qva.ContextDialog=null;Qva.ActiveObjects=null;Qva.ActiveObjectsCloak=false;Qva.SearchableObject=null;Qva.StandardActions=null;Qva.ActiveElement=null;Qva.LabelClick=true;Qva.QvAjaxZfcPath="/QvAjaxZfc/";Qva.Remote="/QvAjaxZfc/QvsViewClient.aspx";Qva.BodyOnLoadFunctionNames=[];Qva.Proxy=null;Qva.CSS=[];Qva.DocumentClick=true;Qva.flags={};try{if(window.parent&&window.parent!=window&&window.parent.Qva){Qva.Remote=window.parent.Qva.Remote;if(!isExternalDomain(window.parent.Qva.QvAjaxZfcPath)){Qva.QvAjaxZfcPath=window.parent.Qva.QvAjaxZfcPath}}}catch(e){}Qva.ElementAttributes=new Array();Qva.DocStamps=new Array();Qva.ElementCache=new Array();Qva.MobileCache=new Array();Qva.Detached=new Array();Qva.traditional=false;Qva.UseTraditional=function(element){var objType="";if(Qva.traditional||!element){return true}if(!$(element).attr("objType")){if(element.className.indexOf("_LB")>-1){objType="Listbox"}}else{objType=$(element).attr("objType")}if(Qva.IS_WORKBENCH||Qva.IS_WEBPARTS){if($(element).children()["context"].className==="QvListbox"){objType="Listbox"}if($(element).children()[1]&&$(element).children()[1].innerHTML.indexOf('class="QvListbox"')>-1){objType="Listbox"}}switch(objType){case"Listbox":return false;default:return true}};Qva.ElementAttributesHandler=function(path,ele,attributeName,stamp,value,override){var cachedElement=Qva.ElementAttributes[path];if(!cachedElement){if(stamp){cachedElement=[ele,{docstamp:stamp}]}else{cachedElement=[ele,{docstamp:"000000"}]}if(!value){value=ele[attributeName]}}else{if(!cachedElement[1][attributeName]&&!value){value=ele[attributeName]}if(cachedElement[1]["docstamp"]=="000000"&&stamp){cachedElement[1]["docstamp"]=stamp}}if(value&&(!cachedElement[1][attributeName]||override)){cachedElement[1][attributeName]=value;Qva.ElementAttributes[path]=cachedElement;if(!override){Qva.ElementInitialPositioner()}}return cachedElement[1][attributeName]};Qva.ElementInitialPositioner=function(){for(var aix in Qva.ElementAttributes){if(typeof(Qva.ElementAttributes[aix])==="function"||typeof(Qva.ElementAttributes[aix])==="undefined"||typeof(Qva.ElementAttributes[aix][1])=="undefined"){continue}if(Qva.ElementAttributes[aix][1]["docstamp"]=="000000"){var isleft,istop,toleft,totop,iswidth,isheight,towidth,toheight,element,ele;element=Qva.ElementAttributes[aix][0];if(!element.rect){isleft=$(element).css("left");istop=$(element).css("top");iswidth=$(element).css("width");toleft=parseInt(Qva.ElementAttributes[aix][1]["left"]);totop=parseInt(Qva.ElementAttributes[aix][1]["top"]);towidth=parseInt(Qva.ElementAttributes[aix][1]["initwidth"]);toheight=parseInt(Qva.ElementAttributes[aix][1]["initheight"]);if(isleft!=(toleft+"px")&&isleft!=toleft&&!isNaN(toleft)){$(element).css("left",toleft)}if(istop!=(totop+"px")&&istop!=totop&&!isNaN(totop)){$(element).css("top",totop)}if(iswidth!=(towidth+"px")&&iswidth!=towidth&&!isNaN(towidth)){$(element).css("width",towidth)}if(iswidth!=(toheight+"px")&&iswidth!=toheight&&!isNaN(toheight)){$(element).css("height",toheight)}}}}};Qva.ElementCacheHandler=function(complete,element,stamp,path,root){var pele=Qva.ElementCache,cpele=[],cached=false,i=0,completed="";if(element){if((pele.length>0&&pele[0][2]!=stamp)||complete){Qva.ElementCache=[]}cached=Qva.CheckElementCache(path);if(!cached){if(complete){completed="complete"}Qva.ElementCache.push([path,element,stamp,root,completed])}}return Qva.ElementCache};Qva.CheckElementCache=function(path){var pele=Qva.ElementCache,cached=false,i=0;while(i<pele.length&&!cached){if(pele[i][0]==path){cached=true}i++}return cached};Qva.ElementAttributesSync=function(){for(var aix in Qva.ElementAttributes){if(typeof(Qva.ElementAttributes[aix])==="function"||typeof(Qva.ElementAttributes[aix])==="undefined"||typeof(Qva.ElementAttributes[aix][1])=="undefined"){continue}if(!("indexOf" in Array.prototype)){if($.find(Qva.ElementAttributes[aix][1]["docstamp"],Qva.DocStamps)==-1){delete (Qva.ElementAttributes[aix])}}else{if(Qva.DocStamps.indexOf(Qva.ElementAttributes[aix][1]["docstamp"])==-1){delete (Qva.ElementAttributes[aix])}}}};Qva.GetStamp=function(caller){var stamp=false,i=40;if(!caller){return null}else{while((!caller.PageBinder||!caller.PageBinder.Stamp)&&i>0){caller=caller.PageBinder;i--}if(caller.PageBinder.Stamp){stamp=caller.PageBinder.Stamp}return stamp}};Qva.StampHandler=function(stamp,limit,flush){if(!limit||typeof limit!="number"){limit=300}if(typeof flush=="boolean"&&flush){Qva.DocStamps=[]}var found=false;for(var i=0;i<limit;i++){if(Qva.DocStamps[i]==stamp){found=true}}if(!found){if(Qva.DocStamps.length<limit){Qva.DocStamps.push(stamp)}else{Qva.DocStamps.splice(0,1);Qva.DocStamps.push(stamp)}Qva.ElementAttributesSync()}};Qva.GetChildByClassName=function(ele,className){var children=$(ele).find("*"),i=children.length,found=false,child="";while(!found&&i>0){if(children[i]){if(children[i]&&children[i].className==className){found=true;child=children[i]}}i--}return child};Qva.SetMaxWidths=function(zoom){if(!Qva.guiHelper){return}var $toolbar=$("#QvAjaxToolbar"),$tabs=$("#Tabrow"),$win=$(window),w0=$win.width(),oldWidth=$tabs.width(),lpos=Math.max(0,Qva.GetScrollLeft());if(zoom){if($toolbar.length>0){$toolbar.css("width",w0+"px")}if($tabs.length>0){$tabs.css("width",w0+"px")}}var vpW=Qva.guiHelper.getViewPortWidthWithoutScroll();if($toolbar.length>0){$toolbar.css("width",vpW+"px");$toolbar.css({left:lpos})}if($tabs.length>0){$tabs.css("width",vpW+"px");$tabs.css({left:lpos});if(vpW!=oldWidth){$win.trigger("tabrowchange")}}if($toolbar.length>0&&(Qva.userAgentDetector.get("ipad")||Qva.userAgentDetector.get("iphone"))){var $lastTool=$("#QvAjaxToolbar-left").children("li.cf").last();if($lastTool.length>0){$lastTool.css("margin-right",$lastTool.offset().top>0?"60px":"")}}};Qva.PageBinding=function(id){var impl=false;this.ID=id||"";this.binderid=this.ID;if(Qva.binders[this.ID]){alert("Need unique binderid");return}Qva.binders[this.ID]=this;this.Translations={};this.ColorDepth=0;this.OnUpdateBegin=null;this.IsUpdating=false;this.HasPendingLoad=false;this.IsPartialLoad=false;this.CurrentLoadIsPartial=false;this.Enabled=false;this.First=true;this.Managers=new Array();this.Members={};this.UsePost=true;this.JSON=false;this.Body="";this.InitialSets="";this.Mark="";this.Stamp="";this.Slot="";this.RecursiveReadyLevel=0;this.ShowMessage=Qva.DefaultShowMessage;this.OnSessionLost=Qva.DefaultOnSessionLost;this.OnUpdateComplete=Qva.NoAction;this.OnCreateContextMenu=Qva.DefaultOnCreateContextMenu;this.AllowComAgent=true;this.InlineStyle=true;this.TableLimit=5000;this.Ident=null;this.GlobalSearchObject="";this.PendingSearchName="";this.PendingSearchKeyName="";this.DelaySet=false;this.DefaultScope="Document";this.CustomIcons={};this.BookmarksMgr=new Qva.Mgr.bookmarks(this,".Bookmarks");this.SelectionStyleMgr=new Qva.Mgr.selectionsstyle(this,".SelectionStyle");this.AggregationMgr=new Qva.Mgr.Documentdata(this,".PropertyData.Aggregation");this.FunctionMgr=new Qva.Mgr.Documentdata(this,".PropertyData.Function");this.VariableMgr=new Qva.Mgr.Documentdata(this,".PropertyData.Variable");this.FieldMgr=new Qva.Mgr.Documentdata(this,".PropertyData.Field");this.CurrentSelectionMgr=new Qva.Mgr.CurrentSelection(this);this.TranslationsMgr=new Qva.Mgr.translations(this,".StandardActions");this.BookmarksSubscribers=[];this.UpdateBookMarks=function(){for(var iSub=0;iSub<this.BookmarksSubscribers.length;iSub++){this.BookmarksSubscribers[iSub].Paint(this.BookmarksMgr)}};this.VisibilitySubscriberList={};this.SubscribeToVisibility=function(name,callback){this.VisibilitySubscriberList[name]=callback};this.SignalVisibility=function(name,visible){if(this.VisibilitySubscriberList[name]){this.VisibilitySubscriberList[name](visible)}};this.ReportsMgr=new Qva.Mgr.reports(this,".Reports");this.ReportsSubscribers=[];this.UpdateReports=function(){for(var iSub=0;iSub<this.ReportsSubscribers.length;iSub++){this.ReportsSubscribers[iSub].Paint(this.ReportsMgr)}};this.AsyncPostPaintMgrQueue=[];this.AsyncPostPaintMgrQueuePrio=[];this.postPaintTimeout=null;this.ToolWindowZLevel={SetZLevel:function(name,delta){var elem=this.dialogs[name];if(this.dialogs[name]){if(delta<=0){return}this.dialogs[name].style.zIndex+=delta*this.Step;this.TopDialog=Math.max(this.dialogs[name].style.zIndex,this.TopDialog)}else{this.TopDialog+=this.Step;elem=window.document.getElementById(name);elem.style.zIndex=this.TopDialog;this.dialogs[name]=elem}},SetObjectCount:function(objcount,propcount){var deltaobjectcount=0;if(this.TopObject!=null){deltaobjectcount=objcount-this.TopObject}this.TopObject=objcount;this.AnnotationIcons=(objcount+1)*this.Step+this.Start;this.MaximizedObject=this.AnnotationIcons+1;this.TopDialog=Math.max((objcount+2+propcount)*this.Step+this.Start,this.TopDialog);return deltaobjectcount},Remove:function(name){this.dialogs[name]=null},PromoteDialog:function(name){var elem=this.dialogs[name];var oldzindex=elem.style.zIndex;if(this.TopDialog==oldzindex){return}this.TopDialog+=this.Step;elem.style.zIndex=this.TopDialog},dialogs:{},TopObject:null,TopDialog:null,RemoveTopDialog:function(){this.TopDialog=null},Step:1,Start:10};try{if(!Qva.userAgentDetector.get("msie11Webview")){impl=window.document.implementation}if(impl&&impl.createDocument&&(!Qva.userAgentDetector.get("msie")||Qva.userAgentDetector.get("msieVersion")>=9)){var doc=impl.createDocument("","",null);if(doc.readyState==null){doc.readyState=1;doc.addEventListener("load",function(){doc.readyState=4;if(typeof doc.onreadystatechange=="function"){doc.onreadystatechange()}},false)}this.Doc=doc;this.LeftButton=0}else{if(!Qva.userAgentDetector.get("msie11Webview")&&window.ActiveXObject){this.Doc=new ActiveXObject("Microsoft.XMLDOM");this.LeftButton=Qva.userAgentDetector.get("msieDocMode")>=9?0:1}else{if(("ActiveXObject") in window){this.Doc=new ActiveXObject("Msxml2.DOMDocument.3.0");this.LeftButton=Qva.userAgentDetector.get("msieDocMode")>=9?0:1}}}}catch(e){}if(this.Doc==null){throw new Error("Your browser does not support XmlDocument objects")}};Qva.PageBinding.prototype.CallOnceOnUpdateComplete=function(f_after){var binder=this.GetDocumentMgr();var old=binder.OnUpdateComplete;binder.OnUpdateComplete=function(){binder.OnUpdateComplete=old;binder.OnUpdateComplete();f_after()}};Qva.PageBinding.prototype.Start=function(){if(Qva.Mgr.search){var searchdiv=document.createElement("div");searchdiv.style.display="none";new Qva.Mgr.search(this,searchdiv,"Document.Search");document.body.insertBefore(searchdiv,document.body.firstChild)}this.delay_Send=true;this.IsRemote=true;this.IsHosted=false;try{if(this.View==null&&parent.qva!=null){this.View=parent.qva.View}}catch(e){}if(this.JSON){this.Session=Qva.ExtractProperty("session",this.Session)}this.Ident=Qva.ExtractProperty("ident",this.Ident);this.Userid=Qva.ExtractProperty("userid",this.Userid);this.Xuserid=Qva.ExtractProperty("xuserid",this.Xuserid);this.Password=Qva.ExtractProperty("password",this.Password);this.Xpassword=Qva.ExtractProperty("xpassword",this.Xpassword);this.Bookmark=Qva.ExtractProperty("bookmark",this.Bookmark);this.AlternateUser=Qva.ExtractProperty("user",this.AlternateUser);this.View=Qva.ExtractProperty("application",this.View);var cd=parseInt(Qva.ExtractProperty("color_depth",""));if(!isNaN(cd)&&0<cd&&cd<=32){this.ColorDepth=cd}this.InitialSelections=Qva.ExtractPropertyArray("select",this.InitialSelections);this.InitialSearch=Qva.ExtractPropertyArray("search",this.InitialSearch);this.Sheet=Qva.ExtractProperty("sheet",this.Sheet);var defaultRemote=Qva.Remote;try{if(!this.Remote){this.Remote=(parent.qva&&parent.qva.Remote)||defaultRemote}}catch(Error){this.Remote=defaultRemote}this.Host=Qva.ExtractProperty("host",this.Host);if(Qva.Benchmark){this.Benchmark=new Qva.Benchmark()}this.Url=this.Remote;this.Url+=(this.Url.indexOf("?")==-1)?"?mark=":"&mark=";if(("ActiveXObject") in window&&(this.Unicorn||window.location.protocol=="file:")){this.TryAltAgent()}else{if(window.ActiveXObject&&(this.Unicorn||window.location.protocol=="file:")){this.TryAltAgent()}}var useragent=""+window.window.navigator.userAgent;var version=parseInt(useragent.substr(useragent.indexOf("MSIE")+5,3));this.AutoViewAppend(null,this.DefaultScope,"ie6"+(useragent.indexOf("MSIE")!=-1&&version<7));this.Ticket=Qva.ExtractPropertyForDocument("ticket",this.View,this.Ticket);this.Invite=Qva.ExtractProperty("invite",this.Invite,true);this.Slot=Qva.ExtractProperty("slot",this.Slot,true);var fetch=Qva.ExtractProperty("fetch",this.FetchOffline,true);if(fetch!=null){this.OfflineRecorder={OfflineBookmarks:fetch!=""?fetch.split(","):[],CurrentBookmarkIndex:-1,CurrentSheetIndex:0,InitialSheetIndex:null,ContainerTabs:[],CurrentTabIndex:0,DocumentBinder:this,SetSheets:function(sheets,basename){this.Sheets=sheets;this.SheetsBaseName=basename},SetInitialSheet:function(index){if(this.InitialSheetIndex==null){this.InitialSheetIndex=index}},AddContainer:function(container){for(var i=0;i<this.ContainerTabs.length;i++){if(this.ContainerTabs[i].Object.Name==container.Name){return}}for(var i=0;i<container.NavigatorItems.length;i++){if(container.NavigatorItems[i].itemId==container.NavigatorElement.SelectedVal){continue}this.ContainerTabs.push({Object:container,itemId:container.NavigatorItems[i].itemId})}},Step:function(){if(this.InitialSheetIndex==null){this.InitialSheetIndex=this.LastSheetIndex}if(this.CurrentSheetIndex==this.InitialSheetIndex){this.CurrentSheetIndex++}if(this.CurrentTabIndex<this.ContainerTabs.length){var current=this.ContainerTabs[this.CurrentTabIndex++];current.Object.NavigatorChange(current.itemId);return}this.ContainerTabs=[];this.CurrentTabIndex=0;if(this.CurrentSheetIndex<this.Sheets.length){var params={};params.action="";this.DocumentBinder.Set(this.SheetsBaseName+"."+this.Sheets[this.CurrentSheetIndex].name,params);this.LastSheetIndex=this.CurrentSheetIndex;this.CurrentSheetIndex++}else{this.CurrentBookmarkIndex++;if(this.CurrentBookmarkIndex<this.OfflineBookmarks.length){this.CurrentSheetIndex=0;this.InitialSheetIndex=null;var params={};params.value=this.OfflineBookmarks[this.CurrentBookmarkIndex];this.DocumentBinder.Set("Document.Bookmarks",params)}else{var params={};params.done="";this.DocumentBinder.Set(this.DocumentBinder.View,params);this.DocumentBinder.OfflineRecorder=null}}}}}};Qva.PageBinding.prototype.LoadAuthenticate=function(callback){var xmlhttp=Qva.GetXHRObject();xmlhttp.onerror=function(){callback(false,"Failed to authenticate")};xmlhttp.onreadystatechange=function(){if(xmlhttp.readyState==4){if(xmlhttp.status==200){callback(true)}else{callback(false,"Failed to authenticate")}}};var url=Qva.FixUrl(this.AuthenticateUrl,"keep","");url=Qva.AddProxyIfAny(url);xmlhttp.open("GET",url,true);if((Qva.userAgentDetector.get("ipad")||Qva.userAgentDetector.get("iphone"))&&window.sessionStorage){var aut=window.sessionStorage.getItem("qvAuthorization");if(aut){xmlhttp.setRequestHeader("Authorization",aut)}}try{xmlhttp.send(null)}catch(e){callback(false,"Error sending")}};Qva.PageBinding.prototype.QueuePostPaintMessage=function(mgr,prio){if(prio){for(var ix=0;ix<this.AsyncPostPaintMgrQueuePrio.length;++ix){if(this.AsyncPostPaintMgrQueuePrio[ix]==mgr){return}}this.AsyncPostPaintMgrQueuePrio.push(mgr)}else{for(var ix=0;ix<this.AsyncPostPaintMgrQueue.length;++ix){if(this.AsyncPostPaintMgrQueue[ix]==mgr){return}}this.AsyncPostPaintMgrQueue.push(mgr)}var _this=this;if(!this.postPaintTimeout){this.postPaintTimeout=window.setTimeout(function(){_this.avqAsyncPostPaint()},0)}};Qva.PageBinding.prototype.MayBeUpdateComplete=function(){if(!this.StillUpdating){this.OnUpdateComplete(true);if(this.OfflineRecorder){this.OfflineRecorder.Step()}this.OnUpdateCompleteTriggered=false;if(typeof(window.Object)=="undefined"){return}$(Qva.EventServer).trigger("OnUpdateComplete");Qva.ResizeBody({adjustscroll:true});if(Qva.userAgentDetector.get("msie")&&$("#MainContainer")){$("#MainContainer").attr("unselectable","on")}var path=Object.keys(Qva.ElementAttributes)[Object.keys(Qva.ElementAttributes).length-1];if(typeof(path)=="undefined"){return}if(!Qva.traditional&&Qva.ElementAttributes[path]&&!Qva.UseTraditional(Qva.ElementAttributes[path][0])){var pb=Qva.ElementAttributes[path][0];var manager=Qva.GetMgr(pb);if(manager.SetObjectHeight){manager.SetObjectHeight(0,path)}}}else{var _this=this;window.setTimeout(function(){_this.MayBeUpdateComplete()},0)}};Qva.PageBinding.prototype.avqAsyncPostPaint=function(){var self=this;function exit(){self.postPainting=false;if(self.sendAfterPostPaint){self.sendAfterPostPaint=false;self.delay_Send=setTimeout(function(){self.Send()},10)}}this.postPainting=true;this.postPaintTimeout=null;if(this.AsyncPostPaintMgrQueuePrio.length>0){var mgrs=this.AsyncPostPaintMgrQueuePrio;this.AsyncPostPaintMgrQueuePrio=[];for(var i=0;i<mgrs.length;++i){mgrs[i].PostPaint()}if(this.AsyncPostPaintMgrQueuePrio.length>0){var _this=this;this.postPaintTimeout=window.setTimeout(function(){_this.avqAsyncPostPaint()},0);return}}if(this.AsyncPostPaintMgrQueue.length==0){exit();return}var mgrs=this.AsyncPostPaintMgrQueue;this.AsyncPostPaintMgrQueue=[];for(var i=0;i<mgrs.length;++i){mgrs[i].PostPaint()}if(!this.HasInvalidObjects&&this.AsyncPostPaintMgrQueue.length==0&&!this.OnUpdateCompleteTriggered){this.OnUpdateCompleteTriggered=true;var _this=this;window.setTimeout(function(){_this.MayBeUpdateComplete()},0)}exit()};Qva.MgrGetName=function(elem){while(elem){if(elem.AvqMgr!=null){return elem.AvqMgr.Name}elem=elem.parentNode}return""};Qva.GetMgr=function(elem){while(elem){if(elem.AvqMgr!=null){return elem.AvqMgr}elem=elem.parentNode}return""};function ctrlKeyPressed(event){return event.ctrlKey||event.metaKey}Qva.OnKeyPress=function(event){if(!event){event=window.event}if(Qva.userAgentDetector.get("macintosh")&&Qva.ContextMenu!=null&&Qva.ContextMenu.style.display==""){return}Qva.HideContextMenu(Qva.ActiveObjectsCloak);if(Qva.PopupInput!=null){return}if(!Qva.LabelClick){return}var srcelement=event.target;if(!srcelement){srcelement=event.srcElement}if(srcelement.tagName=="INPUT"&&srcelement.type=="text"){return}if(srcelement.tagName=="TEXTAREA"){return}if(srcelement.tagName=="SELECT"){return}if(Qva.SearchableObject){var element=document.getElementById(Qva.SearchableObject);if(element&&element.AvqMgr&&element.AvqMgr.Searchable){var binder=element.AvqMgr.PageBinder;var character=String.fromCharCode(event.charCode||event.keyCode);if(/[\x00-\x1F]/.test(character)||event.altKey||event.ctrlKey||event.metaKey){return}Qva.InitSearch=(Qva.InitSearch||"")+character;binder.Set(Qva.SearchableObject+".SEARCH","action","",true)}}};Qva.OnKeyUp=function(event){if(Qva.userAgentDetector.get("macintosh")&&Qva.ContextMenu!=null&&Qva.ContextMenu.style.display==""){return}Qva.HideContextMenu(Qva.ActiveObjectsCloak);if(Qva.PopupInput!=null){return}if(!Qva.LabelClick){return}if(!event){event=window.event}var srcelement=event.target;if(!srcelement){srcelement=event.srcElement}if(srcelement.tagName=="INPUT"&&srcelement.type=="text"){return}if(srcelement.tagName=="TEXTAREA"){return}if(srcelement.tagName=="SELECT"){return}if(!Qva.ActiveObjectsCloak&&Qva.ActiveObjects&&Qva.ActiveObjects.length==1){var element=document.getElementById(Qva.ActiveObjects[0]);if(element&&element.AvqMgr){if(element.AvqMgr.HandleKeyUp(event)){return}}}if(Qva.SearchableObject){var element=document.getElementById(Qva.SearchableObject);if(element&&element.AvqMgr&&element.AvqMgr.Searchable){if(event.keyCode>=32&&!ctrlKeyPressed(event)){var key=event.keyCode;if(key>=33&&key<=40){if(key!=37&&key!=39){var currentkey;switch(key){case 33:currentkey="pgup";break;case 34:currentkey="pgdn";break;case 35:currentkey="end";break;case 36:currentkey="home";break;case 38:currentkey="up";break;case 40:currentkey="down";break}element.AvqMgr.PageBinder.Set(Qva.SearchableObject,"key",currentkey,true)}}}}}};Qva.SetContextMenu=function(element,f){if(!window.SmallDevices){Qva.Events.AddContextmenu(element,f)}};Qva.Search=function(mgr,elem,key){if(mgr.SearchName!=""){var binder=mgr.PageBinder||Qva.GetBinder(mgr.binderid);if(binder.GetEnabled()){binder.Set(mgr.SearchName,"search",elem.value,true)}else{binder=binder.GetDocumentMgr();binder.PendingSearchName=mgr.SearchName;binder.PendingSearchValue=elem.value}}};Qva.OpenPopupInput=function(elem,inputbox){Qva.params.openPupupInput=true;Qva.ClosePopupInput();var parent=elem;if(!inputbox){parent=elem.parentNode.parentNode}Qva.PopupInput=document.createElement("textarea");if(Qva.userAgentDetector.get("msie")){Qva.PopupInput.style.fontFamily=parent.currentStyle.fontFamily;Qva.PopupInput.style.fontSize=parent.currentStyle.fontSize}else{var gs=document.defaultView.getComputedStyle(parent,"");Qva.PopupInput.style.fontFamily=gs.getPropertyValue("font-family");Qva.PopupInput.style.fontSize=gs.getPropertyValue("font-size")}Qva.PopupInput.style.top=parent.offsetTop+"px";Qva.PopupInput.style.left=parent.offsetLeft+"px";Qva.PopupInput.style.width=parent.clientWidth+"px";Qva.PopupInput.style.height=parent.clientHeight+"px";Qva.PopupInput.style.zIndex=666;Qva.PopupInput.style.position="absolute";Qva.PopupInput.style.border="none";Qva.PopupInput.style.padding="0px 0px 0px 0px";Qva.PopupInput.style.overflow="hidden";if(inputbox){if(elem.value){Qva.PopupInput.value=elem.value}Qva.PopupInput.inputname=elem.inputname;$(Qva.PopupInput).on("focusout",function(){if(Qva.params.openPupupInput===false){var event=$QvJq.Event("keydown");event.keyCode=13;$(Qva.PopupInput).trigger(event)}})}else{Qva.PopupInput.value=parent.parentNode.title}Qva.Events.AddCancelBubble(Qva.PopupInput);$(Qva.PopupInput).on("keydown",function(e){AvqAction_Input_KeyDown(e,elem,Qva.PopupInput)});Qva.PopupInput.binderid=elem.binderid;Qva.PopupInput.val=elem.pos;Qva.PopupInput.ObjectId=elem.ObjectId;parent.offsetParent.appendChild(Qva.PopupInput);if(Qva.userAgentDetector.get("msie")){$(Qva.PopupInput).enableSelection().attr("unselectable","off");var par=$(Qva.PopupInput).closest(".QvFrame").parent();$(Qva.PopupInput).parentsUntil(par).enableSelection().attr({unselectable:"off",revertselect:"on"})}Qva.PopupInput.focus();Qva.SetCursor(Qva.PopupInput,true);Qva.params.openPupupInput=false};Qva.ClosePopupInput=function(){if(Qva.PopupInput==null){return}if(Qva.userAgentDetector.get("msie")){$(Qva.PopupInput).parents().each(function(){if($(this).attr("revertselect")==="on"){$(this).disableSelection().attr({unselectable:"on",revertselect:"off"})}else{return false}})}$(Qva.PopupInput).remove();Qva.PopupInput=null};Qva.AddRule=function(ss,name,style){try{if(ss.addRule){ss.addRule(name,style)}else{ss.insertRule(name+" { "+style+" }",ss.cssRules.length)}}catch(e){}};Qva.BlurActiveElement=function(){try{if(document.activeElement.tagName!="BODY"){document.activeElement.blur()}}catch(err){}};Qva.PageBinding.prototype.Refresh=function(){this.Body+=" ";if(!this.Enabled){return}this.LoadBegin()};Qva.PageBinding.prototype.LoadBegin=function(){Qva.CloseMessagePopup();Qva.Events.RemoveAllQueuedLongpressEvents("LoadBegin");if(this.OnUpdateBegin!=null){this.OnUpdateBegin()}this.IsUpdating=true;Qva.ActiveElement=null;try{document.body.style.cursor="wait"}catch(e){}if(!this.IsPartialLoad){Qva.ClosePopupInput()}this.Enabled=false;if(!this.First){for(var mix=0;mix<this.Managers.length;++mix){var mgr=this.Managers[mix];if(this.IsRemote&&mgr.Lock){mgr.Lock()}mgr.Touched=false}}if(this.Benchmark!=null){this.Benchmark.Load.Start()}if(this.View==null&&this.Kind==null){this.Ready()}else{if(this.AutoviewDictionary!=null){this.SetAutoviewAddCommands()}this.Load()}};Qva.PageBinding.prototype.Load=function(ignore_empty){this.HasPendingLoad=false;this.CurrentLoadIsPartial=this.IsPartialLoad;this.IsPartialLoad=false;if(this.First&&this.Bookmark!=null){this.Set("bookmark-apply","docaction",this.Bookmark,false)}var doInitialSearch=function(binder,searchItems,exactMatch){for(var sel=0;sel<searchItems.length;sel++){var selection=searchItems[sel].split(",");var objectpart=selection[0].split(".");var dataok=true;if(objectpart.length==2){if(objectpart[objectpart.length-2]!=binder.View&&objectpart[objectpart.length-2]!=binder.ID){dataok=false}}else{if(objectpart.length==0){dataok=false}}if(dataok){if(objectpart[objectpart.length-1].indexOf("\\")==-1){var name=binder.DefaultScope+".Document\\"+objectpart[objectpart.length-1]}else{var name=binder.DefaultScope+"."+objectpart[objectpart.length-1]}var values="";for(var value=1;value<selection.length;value++){if(value==1){values=selection[value]}else{values+=" "+selection[value]}}binder.Search(name,values,false,false)}}};if(this.First){if(this.InitialSelections!=null){doInitialSearch(this,this.InitialSelections,true)}if(this.InitialSearch!=null){doInitialSearch(this,this.InitialSearch,false)}if(this.Sheet!=null){var sheetId=this.Sheet;if(sheetId.indexOf("\\")==-1){sheetId="Document\\"+sheetId}this.Set("Document.TabRow."+sheetId,"action","",false)}}if(this.PendingSearchName!=""){this.Set(this.PendingSearchName,"search",this.PendingSearchValue,false);this.PendingSearchName="";this.PendingSearchValue=""}if(this.PendingSearchKeyName!=""){this.Set(this.PendingSearchKeyName,"closesearch",this.PendingSearchKey,false);this.PendingSearchKeyName=""}if(this.delay_Send){if(this.delay_Send!==true){clearTimeout(this.delay_Send)}this.Send(ignore_empty)}if(navigator.userAgent.indexOf("Firefox")!==-1){var allDivs=document.getElementsByTagName("div"),allDivsLength=allDivs.length,i=0;for(;i<allDivsLength;i++){var elm=allDivs[i],classes=elm.getAttribute("class");if(classes!==null&&typeof classes!=="undefined"&&classes.indexOf("QvFrame")!==-1){var styles=elm.style.boxShadow||"";if(styles&&styles.indexOf("0px 0px 0px")!==-1){elm.style.boxShadow="none"}}}}};Qva.PageBinding.prototype.GetUpdates=function(polls){for(var mix=0;mix<this.Managers.length;++mix){var mgr=this.Managers[mix];if(mgr.GetUpdates){mgr.GetUpdates(polls)}}if(polls.length==0&&this.Poll){polls.push({})}this.Poll=false};Qva.PageBinding.prototype.Send=function(ignore_empty){this.delay_Send=null;if(Qva.Modal&&Qva.Modal.instance.IsOpen()&&this.LabelClick){this.delay_Send=true;return}if(this.postPainting){this.sendAfterPostPaint=true;return}var cmds=this.Body;this.Body="";if(!this.HasAutoviewAddCommands()){cmds+=this.InitialSets;this.InitialSets=""}if(cmds.length==0){var objs=[];this.GetUpdates(objs);this.StillUpdating=objs.length>0;if(objs.length==0&&ignore_empty){if(this.IdlePollInterval){var self=this;this.delay_Send=setTimeout(function(){self.Send()},this.IdlePollInterval)}else{this.delay_Send=true}this.StillUpdating=false;return}for(var i=0;i<objs.length;++i){cmds+="<poll ";for(var n in objs[i]){cmds+=n+'="'+Qva.XmlEncode(objs[i][n])+'" '}cmds+="/>"}if(cmds.length==0){cmds="<poll />"}}var cmd='<update mark="'+this.Mark+'" stamp="'+this.Stamp+'"';if(window.navigator&&window.navigator.cookieEnabled){cmd+=' cookie="true"'}else{cmd+=' cookie="false"'}if(!Qva.LoadedSharedFile){cmd+=' sharedfile="true"';Qva.LoadedSharedFile=true}if(this.DefaultScope!=null){cmd+=' scope="'+this.DefaultScope+'"'}if(this.JSON&&this.Session!=null){cmd+=' session="'+this.Session+'"'}if(this.View!=null){cmd+=' view="'+Qva.XmlEncode(this.View)+'"'}if(this.Autoview!=null&&this.Autoview!=""){cmd+=' autoview="'+Qva.XmlEncode(this.Autoview)+'"'}cmd+=' ident="'+Qva.XmlEncode(this.Ident)+'"';if(this.Userid!=null){cmd+=' userid="'+this.Userid+'"'}if(this.Xuserid!=null){cmd+=' xuserid="'+this.Xuserid+'"'}if(this.Password!=null){cmd+=' password="'+this.Password+'"'}if(this.Xpassword!=null){cmd+=' xpassword="'+this.Xpassword+'"'}if(this.Kind!=null){cmd+=' kind="'+this.Kind+'"'}if(this.Bookmark){cmd+=' start="document"'}cmd+=">";cmd+=cmds;cmd+="</update>";if(this.Trace!=null&&this.Trace.Request!=null){this.Trace.Request.innerText=cmd}var pb=this;if(this.Agent==null){var url=this.Url+this.Mark;if(this.Host!=null){url+="&host="+Qva.EncodeComponent(this.Host)}if(this.Ticket!=null){url+="&ticket="+Qva.EncodeComponent(this.Ticket)}if(this.Invite!=null){url+="&invite="+Qva.EncodeComponent(this.Invite)}if(this.View!=null){url+="&view="+Qva.EncodeComponent(this.View)}if(this.Slot!=null){url+="&slot="+Qva.EncodeComponent(this.Slot)}if(!this.Platform){var userAgent=navigator.userAgent;var platform="browser.";if(Qva.userAgentDetector.get("playbook")){platform+="playbook"}else{if(Qva.userAgentDetector.get("android")){platform+="android"}else{if(Qva.userAgentDetector.get("chrome")){platform+="chrome"}else{if(Qva.userAgentDetector.get("gecko")){platform+="gecko "+Qva.userAgentDetector.get("geckoVersion")}else{if(Qva.userAgentDetector.get("safari")){platform+="safari"}else{if(Qva.userAgentDetector.get("opera")){platform+="opera"}else{if(Qva.userAgentDetector.get("msie")){platform+="msie "+Qva.userAgentDetector.get("msieVersionString")}else{platform+="unknown"}}}}}}}if(Qva.userAgentDetector.get("mobile")){platform+=".mobile"}this.Platform=platform}url+="&platform="+Qva.EncodeComponent(this.Platform);url+="&dpi="+Qva.DPI;if(this.ColorDepth>0){url+="&color_depth="+this.ColorDepth}if(this.AlternateUser!=null){url+="&user="+this.AlternateUser}if(this.JSON){if(this.Session!=null){url+="&session="+Qva.EncodeComponent(this.Session)}url+="&json="+Qva.EncodeComponent(this.ID);url+="&cmd="+Qva.EncodeComponent(cmd);var scriptTag=document.createElement("script");scriptTag.setAttribute("type","text/javascript");scriptTag.setAttribute("src",url);var head=document.getElementsByTagName("head").item(0);if(this.ScriptTag){head.replaceChild(scriptTag,this.ScriptTag)}else{head.appendChild(scriptTag)}this.ScriptTag=scriptTag}else{if(this.UsePost){Qva.DoAjax(pb,url,cmd)}else{url+="&cmd="+Qva.EncodeComponent(cmd);this.Doc.onreadystatechange=function(){if(pb.Doc.readyState==4){pb.Ready()}};if(!this.Doc.load(url)){alert("Communication error (get)");this.Enabled=true}}}}else{var data;try{data=this.UseExecute?this.Agent.Execute(cmd):this.Agent.XmlUpdate(cmd)}catch(e){data='<result><message text="Server not responding" /></result>'}if(!this.Doc.loadXML(data)){alert(data);data='<result><message text="Unexpected error loading" /></result>';this.Doc.loadXML(data)}window.setTimeout(function(){pb.Ready()},0)}};Qva.PageBinding.prototype.SendClose=function(){var url=this.Url+this.Mark;url+="&close=true";if(this.Host!=null){url+="&host="+Qva.EncodeComponent(this.Host)}if(this.Ticket!=null){url+="&ticket="+Qva.EncodeComponent(this.Ticket)}if(this.Invite!=null){url+="&invite="+Qva.EncodeComponent(this.Invite)}if(this.View!=null){url+="&view="+Qva.EncodeComponent(this.View)}if(this.Slot!=null){url+="&slot="+Qva.EncodeComponent(this.Slot)}var xmlhttp=Qva.GetXHRObject();url=Qva.AddProxyIfAny(url);url=Qva.XrfSecure(url);xmlhttp.open("POST",url,true);try{xmlhttp.send()}catch(e){alert("Communication error (post): "+e.message)}};Qva.PageBinding.prototype.AddManager=function(mgr){mgr.PageBinder=this;mgr.Touched=false;if(mgr.SelectedClassName==null){mgr.SelectedClassName="QvSelected";mgr.DeselectedClassName="QvDeselected";mgr.EnabledClassName="QvOptional";mgr.DisabledClassName="QvExcluded";mgr.LockedClassName="QvLocked";mgr.SelectedExcludedClassName="QvSelectedExcluded";mgr.LockedExcludedClassName="QvLockedExcluded";mgr.AlternativeClassName="QvAlternative";mgr.ModeIfNotEnabled="n"}this.Managers[this.Managers.length]=mgr;this.Append(mgr,mgr.Name,mgr.Attr)};Qva.PageBinding.prototype.Append=function(mgr,name,attr,noautoview){if(name==null||name.substr(0,1)=="."){Assert(false)}if(name==null||name==""){return}var list=this.Members[name];if(list==null){list=new Array();this.Members[name]=list}for(var i=0;i<list.length;i++){if(list[i]==mgr){break}}if(i==list.length){list[list.length]=mgr}if(this.Autoview!=null&&!noautoview){var nameattr=name.split("@");var autoviewname=nameattr[0];var autoviewattr=nameattr.length>1?nameattr[1]:attr}};Qva.PageBinding.prototype.HasAutoviewAddCommands=function(){if(this.AutoviewDictionary==null){return false}for(var name in this.AutoviewDictionary){var item=this.AutoviewDictionary[name];if(item.dirty){return true}}return false};Qva.PageBinding.prototype.AutoViewAppend=function(mgr,name,attr){if(attr==null){attr="text"}if(this.AutoviewDictionary==null){this.AutoviewDictionary={}}var item=this.AutoviewDictionary[name];if(item==null){item={};item.dirty=true;item.attrs="mode";this.AutoviewDictionary[name]=item}if(item.attrs.indexOf(attr)==-1){item.dirty=true;item.attrs+=";"+attr}};Qva.PageBinding.prototype.SetAutoviewAddCommands=function(){for(var name in this.AutoviewDictionary){var item=this.AutoviewDictionary[name];if(!item.dirty){continue}item.dirty=false;this.Set(name,"add",item.attrs,false);if(this.First&&this.Body.length>900&&!this.UsePost){return}}};Qva.PageBinding.prototype.loadXML=function(xmltext){if(this.Doc&&typeof this.Doc.loadXML!=="undefined"){return this.Doc.loadXML(xmltext)}else{if(typeof DOMParser!=="undefined"){this.Doc=new DOMParser().parseFromString(xmltext,"text/xml");return this.Doc!=null}}return false};function HtmlifyARGB(color,rgba){var a,r,g,b;if(color&&color.length==9){if(color.substr(1,2)=="00"){return"Transparent"}if(rgba){a=rgba[0]/255;r=rgba[1];g=rgba[2];b=rgba[3];color="rgba("+r+","+g+","+b+","+a+")"}else{color="#"+color.substr(3)}}return color}function IsValidIEARGB(color){if(color&&color.length==9){if(color.substr(1,2)=="00"||color.substr(1,2)=="ff"){return true}return false}return true}Qva.ApplyColorDataToElement=function(node,element,createGradient,useFallbackForGradient){if(typeof(node.nodeType)!=="undefined"){var color=node.getAttribute("color"),bkgColor=node.getAttribute("bkgcolor"),fillDirection=node.getAttribute("FillDirection"),fillPattern=node.getAttribute("FillPattern"),primaryCol=node.getAttribute("PrimaryColor"),secondaryCol=node.getAttribute("SecondaryColor"),colorMode=node.getAttribute("ColorMode"),retVal=false}else{var color=node.color,bkgColor=node.bkgcolor,fillDirection=node.FillDirection,fillPattern=node.FillPattern,primaryCol=node.PrimaryColor,secondaryCol=node.SecondaryColor,colorMode=node.ColorMode,retVal=false}if(typeof colorMode!="undefined"){if(Qva.userAgentDetector.get("msie")&&Qva.userAgentDetector.get("msieDocMode")<=8){if((IsValidIEARGB(primaryCol)&&colorMode==="0")||useFallbackForGradient){element.style.backgroundColor=HtmlifyARGB(primaryCol);retVal=true}}else{if(colorMode=="0"||colorMode=="1"){element.style.backgroundImage="";element.style.backgroundColor=Qva.Hex2RGBA(primaryCol);retVal=true}else{if(colorMode=="2"&&createGradient){retVal=Qva.ApplyGradientToElement(fillDirection,fillPattern,primaryCol,secondaryCol,element,useFallbackForGradient)}}if(!createGradient){element.style.backgroundColor=Qva.Hex2RGBA(primaryCol)}}}else{if(bkgColor){element.style.backgroundImage="";if(Qva.userAgentDetector.get("msie")&&Qva.userAgentDetector.get("msieDocMode")<=8){element.style.backgroundColor=HtmlifyARGB(bkgColor)}else{element.style.backgroundColor=Qva.Hex2RGBA(bkgColor)}}}if(color){if(Qva.userAgentDetector.get("msie")){element.style.color=HtmlifyARGB(color)}else{try{element.style.color=Qva.Hex2RGBA(color)}catch(e){element.style.color=HtmlifyARGB(color)}}}return retVal};function SetSearchableAndActives(newsearchable,newactives){if(newsearchable){Qva.SearchableObject=newsearchable}Qva.ActiveObjectsCloak=false;if(newactives){if(Qva.ActiveObjects){for(var oldix=0;oldix<Qva.ActiveObjects.length;++oldix){var oldelem=window.document.getElementById(Qva.ActiveObjects[oldix]);if(oldelem&&oldelem.AvqMgr.IsActive){if(newactives.indexOf&&newactives.indexOf(Qva.ActiveObjects[oldix])!=-1){continue}oldelem.AvqMgr.SetActiveStyle(false)}}}Qva.ActiveObjects=[];for(var ix=0;ix<newactives.length;++ix){var elem=window.document.getElementById(newactives[ix]);if(elem){if(!elem.AvqMgr.IsActive){elem.AvqMgr.SetActiveStyle(elem.AvqMgr,true)}Qva.ActiveObjects.push(newactives[ix])}}}}Qva.ReplaceOpenDoc=function(url){var loc=window.location.protocol+"//"+window.location.host+window.location.pathname;var re=/\[opendoc\]/g;return url.replace(re,loc)};Qva.PageBinding.prototype.Ready=function(){var root,openUrlWindow,iosfix,metaTag,metaContentWidth,tmpMetaContentWidth;if(!Qva.UrlParams.isQmc){if(this.First){$("#InitialLoader").hide();$("#QvAjaxToolbar-right").show()}}if(this.RecursiveReadyLevel>0){return}try{document.body.style.cursor="auto"}catch(e){Assert(false)}this.Enabled=true;this.loggingIn=false;openUrlWindow=null;for(;;){if(this.Doc==null){Assert(false);return}root=this.Doc.documentElement;if(root&&root.getElementsByTagName("calendar")&&root.getElementsByTagName("calendar")[0]){Qva.params.showCalendarWeek=root.getElementsByTagName("calendar")[0].attributes[0].value}if(root&&root.getElementsByTagName("iosfix")&&root.getElementsByTagName("iosfix")[0]){iosfix=root.getElementsByTagName("iosfix")[0].attributes[0].value;if(iosfix===true||iosfix===1||iosfix==="1"){Qva.params.fixios=true}}if(Qva.params.fixios&&Qva.params.fixios===true&&!window.document.querySelector("meta[name=viewport]")){metaContentWidth=0;if(root.childNodes.length>0&&root.childNodes[0].childNodes.length>0){$(root.childNodes[0].childNodes).each(function(ix,ele){if($(ele).attr("name")==="ActiveSheet"){$(ele.childNodes).each(function(ix,val){tmpMetaContentWidth=parseFloat($(val).attr("left"))+parseFloat($(val).attr("width"));if(tmpMetaContentWidth>metaContentWidth){metaContentWidth=tmpMetaContentWidth}});if(metaContentWidth!==0){metaTag=window.document.createElement("meta");metaTag.name="viewport";metaTag.content="width="+metaContentWidth;window.document.getElementsByTagName("head")[0].appendChild(metaTag)}}})}}if(this.View!=null||this.Kind!=null){if(root==null){var error_string="";var parseError=this.Doc.parseError;if(parseError!=null){error_string+="Line: "+parseError.line+"\r\n\r\nChar: "+parseError.filepos+"\r\n\r\nReason: "+parseError.reason+"\r\n\r\n"}error_string+="Failed to load:\r\n\r\nURL: "+this.Doc.url;Assert(false,error_string);return}var dialog=Qva.GetDialogNode(root);if(dialog){switch(dialog.getAttribute("type")){case"Close":Qva.HideMessage();break;case"Wait":var title=Qva.localization.getStringFromKey(dialog.getAttribute("titleId")||dialog.getAttribute("title")),message=Qva.localization.getStringFromKey(dialog.getAttribute("messageId")||dialog.getAttribute("text"));this.WaitMessage(title,message);this.Poll=true;return;case"OK":var title=Qva.localization.getStringFromKey(dialog.getAttribute("titleId")||dialog.getAttribute("title")),message=Qva.localization.getStringFromKey(dialog.getAttribute("messageId")||dialog.getAttribute("text"));this.OKMessage(title,message);this.Poll=true;return;case"Updating":if(!this.First){Qva.ModalMessage("",Qva.localization.getStringFromKey(dialog.getAttribute("text")),true);this.CallOnceOnUpdateComplete(function(){setTimeout(Qva.HideMessage,1000)})}break;default:Assert(false);break}}switch(Qva.GetMessageCode(root)||Qva.GetMessage(root)){case"19":case"Failed to open document, You don't have access to this document.":if(Qva.NavigateToLoginPageIfAny()){return}break;case"15":case"Failed to open document, you don't have access to the server.":if(isNaN(Qva.RemainingRetries)){Qva.RemainingRetries=3}if(Qva.RemainingRetries<=0){break}if(!Qva.Modal.instance.IsOpenEx("name=login.htm")){this.loggingIn=true;function showSectionAccessLogin(){Qva.Modal.instance.Show(this,Qva.Remote+(Qva.Remote.indexOf("?")>=0?"&":"?")+"public=only&name=login.htm")}Qva.localization.init(Qva.GetMessageLang(root),showSectionAccessLogin)}return;case"1":case"3":case"Server error":alert("Unexpected exception occurred!");return}var cmd_nodes=root.getElementsByTagName("command");if(cmd_nodes.length>=1){for(var iCmd=0;iCmd<cmd_nodes.length;iCmd++){var cmd_node=cmd_nodes[iCmd];if(cmd_node.getAttribute("close")=="true"){CloseSession();this.IsUpdating=false;return}}}if(!this.IsHosted){if(root.getAttribute("unicorn")=="3"){Qva.Unicorn=true}var session=root.getAttribute("session");if(session==="ignore"){}else{if(this.Session==null){this.Session=session}else{if(this.Session!=session){var message=Qva.GetMessage(root);if(message==null){message="Session timed out"}this.OnSessionLost(message);return}}}this.IdlePollInterval=parseInt(root.getAttribute("idlepollinterval"))}var currentobjects=root.getElementsByTagName("object");var newactives=null;var newsearchable=null;if(currentobjects.length>=1){if(currentobjects[0].getAttribute("activeobject")!=null){newactives=currentobjects[0].getAttribute("activeobject").split(" ");newsearchable=currentobjects[0].getAttribute("searchableobject")}if(this.ShowDocumentTitle&&currentobjects[0].getAttribute("title")){window.document.title=currentobjects[0].getAttribute("title")}this.oldstylenavigationarea=(currentobjects[0].getAttribute("oldstylenavigationarea")=="1")}SetSearchableAndActives(newsearchable,newactives);var open_nodes=root.getElementsByTagName("open");if(open_nodes.length>=1){for(var iUrl=0;iUrl<open_nodes.length;iUrl++){var open_node=open_nodes[iUrl];var url=open_node.getAttribute("url");if(url){if(url.substr(0,10)=="?document="){url=Qva.FixUrl(url,"lang",Qva.localization.lang)}var redirect=open_node.getAttribute("redirect")=="true";var qvInternalUrl=false;try{if(url.substr(0,2)=="$/"){var filename=url.substr(2);url=this.Remote;url+=(url.indexOf("?")>=0)?"&public=only":"?public=only";url+="&size=long";if(this.Host!=null){url+="&host="+Qva.EncodeComponent(this.Host)}url+="&name=Temp/"+Qva.EncodeComponent(filename);qvInternalUrl=true}if(url.substr(0,10)=="?document="&&this.Host!=null&&url.indexOf("&host=")<0){if(!Qva.userAgentDetector.get("msie")){var toEnc="",andPos=url.indexOf("&"),params="";if(andPos===-1){toEnc=url.substr(10)}else{toEnc=url.substr(10,url.indexOf("&")-10);params=url.substr(url.indexOf("&"))}url=url.substr(0,10)+encodeURIComponent(toEnc)+params}qvInternalUrl=true;url+="&host="+Qva.EncodeComponent(this.Host)}if(url){if(redirect){window.location=url}else{if(url.substr(0,7)=="mailto:"){url=Qva.ReplaceOpenDoc(url).replace(/%20/g,"%2520")}else{if(!qvInternalUrl&&url.substr(0,2)!=="\\\\"){url=encodeURI(url).replace(/%25/g,"%").replace(/%5B/g,"[").replace(/%5D/g,"]").replace(/%5C/g,"\\")}}openUrlWindow=window.open(url);Qva.ShowOpenUrlMsg(open_node.getAttribute("title"),url)}}}catch(e){this.ShowMessage("Can't open '"+url+"' due to error: "+e.message)}open_node.setAttribute("url","")}}}var ident=root.getAttribute("ident");if(ident!=null){this.Ident=ident}var kind=root.getAttribute("kind");if(kind!=null){this.Kind=kind}var mark=root.getAttribute("mark");var stamp=root.getAttribute("stamp");if(mark!=null&&stamp!=null){this.Mark=mark;this.Stamp=stamp;Qva.StampHandler(this.Stamp)}var partial=this.CurrentLoadIsPartial;this.CurrentLoadIsPartial=false;if(this.Benchmark!=null){this.Benchmark.Load.Stop()}if(this.Benchmark!=null){this.Benchmark.Paint.Start()}this.PaintTree(root,"",partial);if(this.Benchmark!=null){this.Benchmark.Paint.Stop()}var MoreAutoviewsToAdd=this.First&&(this.HasAutoviewAddCommands()||this.InitialSets!="");if(this.PendingSearchName!=""||this.PendingSearchKeyName!=""||MoreAutoviewsToAdd||this.HasPendingLoad){this.Enabled=false;if(MoreAutoviewsToAdd){this.SetAutoviewAddCommands()}if(this.Benchmark!=null){this.Benchmark.Load.Start()}this.Load();return}this.IsUpdating=false;break}}var invalid=false;for(var i=0;i<this.Managers.length;++i){if(this.Managers[i].Mode=="invalid"){invalid=true;break}}this.HasInvalidObjects=invalid;if(!this.HasInvalidObjects&&this.AsyncPostPaintMgrQueue.length==0&&!this.First&&this.Body==""&&!this.OnUpdateCompleteTriggered){this.OnUpdateCompleteTriggered=true;var _this=this;window.setTimeout(function(){_this.MayBeUpdateComplete()},0)}this.PaintDone(true,root);if((this.View!=null||this.Kind!=null)&&!this.OfflineRecorder){var msg=Qva.GetErrorMessage(root);if(msg!=null){if(msg.indexOf("Error Message: Object expected")!=-1||msg.indexOf("Error Message: Failed to connect")!=-1){Qva.ErrorMessage("Could not connect to server!")}else{Qva.ErrorMessage(msg)}}else{var msg=Qva.GetMessage(root);if(msg!=null){this.ShowMessage(msg)}}if(this.Trace!=null&&this.Trace.Response!=null){this.Trace.Response.innerText=this.Doc.xml}}if(this.First&&this.DeveloperMode){var errmsg=this.OnceAfterLoad();if(errmsg!=null){this.ShowMessage(errmsg)}}if(this.IsHosted&&this.first){window.focus()}if(this.IsRemote){try{if(document.selection&&document.selection.type!="None"){var y=document.selection.createRange();if(y!=null){y.select()}}}catch(e){Assert(false)}}this.First=false;if(openUrlWindow!=null){openUrlWindow.focus()}if(!Qva.userAgentDetector.get("ipad")&&!Qva.UrlParams.isQmc){Qva.SetMaxWidths(true)}};var old_Ready=Qva.PageBinding.prototype.Ready;Qva.PageBinding.prototype.Ready=function(){if(!Qva.localization.isInitialized()){var root=this.Doc.documentElement,self=this,serverLang="";if(root!==null){var objects=root.getElementsByTagName("object");if(objects.length>=1){serverLang=objects[0].getAttribute("lang")||""}}Qva.localization.init(serverLang,function(){self.Ready.apply(self)});return}old_Ready.apply(this,arguments);if(this.Body.length>0||this.HasAutoviewAddCommands()){this.count_Send=0;this.Send(true)}else{this.count_Send=(this.count_Send||0)+1;var self=this;this.delay_Send=setTimeout(function(){self.Send(true)},this.count_Send<5?10:100)}$(Qva.EventServer).trigger("AfterBinderReady")};Qva.PageBinding.prototype.RestoreScrollPosition=function(){try{if(this.ScrollLeftToRemember!=null){if(Qva.ActiveElement&&document.activeElement!=Qva.ActiveElement){Qva.ActiveElement.focus()}var diffTop=this.ScrollTopToRemember-Qva.GetScrollTop();var diffLeft=this.ScrollLeftToRemember-Qva.GetScrollLeft();if(diffTop==0&&diffLeft==0){return}setTimeout(function(){try{window.scrollBy(diffLeft,diffTop)}catch(e){}},10);this.ScrollLeftToRemember=null;this.ScrollTopToRemember=null;Qva.ActiveElement=null}}catch(e){}};Qva.OpenUrlMsg=null;Qva.ShowOpenUrlMsg=function(labelId,url){var title=Qva.localization.getStringFromKey(labelId);var bodyHTML=Qva.XmlEncode(Qva.localization.getStringFromKey("OpenUrlInfo")||"The requested content has been opened in another window.")+"<br /><br />"+Qva.XmlEncode(Qva.localization.getStringFromKey("OpenUrlIfNot")||"If you know that this is not the case,")+' <a href="'+url+'" target="_blank">'+Qva.XmlEncode(Qva.localization.getStringFromKey("PressHere")||"press here")+"</a>";var button={text:(Qva.localization.getStringFromKey("OK")||"OK"),action:Qva.HideMessage};Qva.Registry.set("Parameters","ModalDialogs","currentDialog",{title:title.replace(/ /g,"")});Qva.ModalMessage(title,bodyHTML,false,button);setTimeout(Qva.HideMessage,10000)};Qva.CloseUrlMsgDiv=function(){if(!Qva.OpenUrlMsg){Assert(false)}else{Qva.OpenUrlMsg.style.display="none"}};Qva.PageBinding.prototype.OnceAfterLoad=function(){var errors=[];var dix=0;for(var mix=0;mix<this.Managers.length;++mix){var mgr=this.Managers[mix];if(mgr.Name==""||mgr.Name=="#edit#"||mgr.Touched){if(dix!=mix){this.Managers[dix]=this.Managers[mix]}++dix}else{if(mgr.Name!=""){try{mgr.Element.style.display="none"}catch(e){Assert(false)}errors[errors.length]="Not found: "+mgr.Name}}}this.Managers.length=dix;if(errors.length==0){return null}var msg="Errors:\n"+errors.join("\n");return msg};Qva.PageBinding.prototype.PaintTree=function(rootnode,prefix,partial){for(var node=rootnode.firstChild;node!=null;node=node.nextSibling){if(node.nodeName!="value"&&node.nodeName!="action"&&node.nodeName!="group"&&node.nodeName!="list"){continue}var name=prefix+node.getAttribute("name");var list=this.Members[name];if(list!=null){var mode="d";switch(node.getAttribute("mode")){case"not-applicable":mode="n";break;case"hidden":mode="h";break;case"enabled":mode="e";break}var xlen=list.length;for(var ixx=0;ixx<xlen;++ixx){var mgr=list[ixx];var mgrmode=mode;if(mode!="n"&&mgr.HideIf&&mgr.HideIf(node.getAttribute("value"),node.getAttribute("text"))){mgrmode="n"}mgr.Paint(mgrmode,node,name,partial)}}}for(var group=rootnode.firstChild;group!=null;group=group.nextSibling){if(group.nodeName!="value"&&group.nodeName!="object"&&group.nodeName!="group"&&group.nodeName!="list"){continue}var grpprefix=prefix+group.getAttribute("name")+".";this.PaintTree(group,grpprefix,partial)}};Qva.PageBinding.prototype.PaintDone=function(remote,root){if(this.Benchmark!=null){this.Benchmark.Unlock.Start()}for(var mix=0;mix<this.Managers.length;++mix){var mgr=this.Managers[mix];if(this.IsRemote&&!mgr.Touched&&mgr.Unlock){mgr.Unlock()}}if(this.Benchmark!=null){this.Benchmark.Unlock.Stop()}if(this.Benchmark!=null){this.Benchmark.Display()}};Qva.PageBinding.prototype._Send=function(cmd,name,_final,extra){name=Qva.MgrMakeName(name,this.DefaultScope);if(Qva.IS_WORKBENCH||Qva.IS_WEBPARTS){if(name.indexOf("__")>-1){name=name.substr(0,name.indexOf("__"))}}this.Body+="<"+cmd+' name="'+name+'" ';var sendlist=false;var select=false;if(extra){for(var n in extra){if(typeof(extra[n])==="object"&&extra[n].length>0){if(n=="selecttexts"||n=="select"){select=true}else{sendlist=true}continue}this.Body+=n+'="'+Qva.XmlEncode(extra[n])+'" '}}if(cmd==="set"&&this.isSmallDevices&&name==="Document.DS"){this.Body+='scrollbar="true" '}if(select){var values="";for(var n in extra){if(typeof(extra[n])==="object"&&extra[n].length>0){if(n=="selecttexts"||n=="select"){for(var iElem=0;iElem<extra[n].length;iElem++){if(iElem==0){values+=Qva.XmlEncode(extra[n][iElem])}else{values+=","+Qva.XmlEncode(extra[n][iElem])}}this.Body+=n+'="'+values+'" '}}}}if(sendlist){this.Body+=">";for(var n in extra){if(typeof(extra[n])==="object"&&extra[n].length>0){for(var iElem=0;iElem<extra[n].length;iElem++){this.Body+="<element "+n+'="'+Qva.XmlEncode(extra[n][iElem])+'" />'}}}this.Body+="</"+cmd+">"}else{this.Body+="/>"}if(_final){if(this.LoadBegin_Timeout){clearTimeout(this.LoadBegin_Timeout)}if(this.DelaySet){var self=this;this.LoadBegin_Timeout=setTimeout(function(){self.LoadBegin()},200)}else{this.LoadBegin()}}};Qva.PageBinding.prototype.Set=function(name,type,value,_final){if(type==="closetransient"){Qva.mobile.closetrans=1}else{Qva.mobile.closetrans=0}if(this.GlobalSearchObject!=""){if(this.GlobalSearchObject!=name.substr(0,this.GlobalSearchObject.length)&&(Qva.ContextMenuMgr==null||name!=Qva.ContextMenuMgr.Name)){this.Set(this.GlobalSearchObject,"closesearch","abort",true);this.GlobalSearchObject=""}}if(typeof(type)=="object"){this._Send("set",name,value!==false,type)}else{var e={};e[type]=value;this._Send("set",name,_final,e)}};Qva.PageBinding.prototype.SetInitial=function(name,type,value){this.InitialSets+='<set name="'+name+'" '+type+'="'+Qva.XmlEncode(value)+'"/>'};Qva.SelectChild=function(root,names,ix){for(var node=root.firstChild;node;node=node.nextSibling){switch(node.nodeName){case"object":if(node.getAttribute("name")!=names[ix]){break}return(ix==0)?node:null;case"group":case"list":if(node.getAttribute("name")!=names[ix]){break}return node;case"value":case"action":if(node.getAttribute("name")!=names[ix]){break}return(ix==names.length-1)?node:null}}return null};Qva.PageBinding.prototype.Select=function(path){if(path==null){return null}path=Qva.MgrMakeName(path,this.DefaultScope);var parts=path.split(".");var node=this.Doc.documentElement;for(var ix=0;node!=null&&ix<parts.length;++ix){node=Qva.SelectChild(node,parts,ix)}return node};Qva.SelectNode=function(root,path){if(root==null||path==null){return null}var parts=path.split(".");var node=root;for(var ix=0;node!=null&&ix<parts.length;++ix){node=this.SelectChild(node,parts,ix)}return node};Qva.PageBinding.prototype.SetClick=function(event,name,elem){if(!this.Enabled){return}if(document.activeElement&&document.activeElement.onchange){try{document.activeElement.onchange();document.activeElement.blur()}catch(err){}}Qva.MgrWithMouseDown=null;var verb="click";var clickstring="";if(elem){if(elem.index){clickstring=elem.index}else{var offsetX=0;var offsetY=0;if(!event){offsetX=window.event.offsetX;offsetY=window.event.offsetY}else{var evtOffsets=Qva.GetOffsets(event);offsetX=evtOffsets.offsetX;offsetY=evtOffsets.offsetY}clickstring+=""+offsetX+":"+offsetY;var objectbinder=Qva.GetObjectBinder(elem);var graphsize=objectbinder.GetImageSize(elem);clickstring+=":"+graphsize.width+":"+graphsize.height}}else{if(!event){event=window.event}if(event.shiftKey||ctrlKeyPressed(event)){verb="ctrl-click";event.cancelBubble=true}}var LeftButton=Qva.userAgentDetector.get("msieDocMode")<9?1:0;if(verb=="ctrl-click"&&event.button==LeftButton){return}this.Set(name,verb,clickstring,true)};Qva.GetContainingModal=function(){return window.parent.Qva.Modal.instance};Qva.CloseModal=function(){if(window.IS_QVCLIENT){Qva.ModalDialogs.closeCurrent();return}if(window.parent.Qva&&window.parent.Qva.Modal){var modal=window.parent.Qva.Modal.instance;if(modal!=null){modal.Close()}}};Qva.SetModalTitle=function(text){if(window.parent.Qva.Modal){var modal=window.parent.Qva.Modal.instance;if(modal!=null){modal.SetTitle(text)}}};Qva.MessagePopup=null;Qva.ShowMessagePopup=function(msg,binder){if(!Qva.MessagePopup){Qva.MessagePopup=document.createElement("div");Qva.MessagePopup.className="QvMessagePopup";document.body.appendChild(Qva.MessagePopup)}else{Qva.CloseMessagePopup()}Qva.MessagePopup.style.display="";var img=document.createElement("img");img.style.cssText="float:right;";img.src=binder.BuildBinaryUrl(null,null,"CX");Qva.MessagePopup.appendChild(img);var br=document.createElement("br");Qva.MessagePopup.appendChild(br);var table=document.createElement("table");var row=table.insertRow(-1);var td=row.insertCell(-1);td.style.verticalAlign="top";var img=document.createElement("img");img.src=binder.BuildBinaryUrl(null,null,"web:helpicon");td.appendChild(img);var td=row.insertCell(-1);td.innerHTML=msg.replace(/</g,"&lt;").replace(/\n/g,"<br>");Qva.MessagePopup.appendChild(table);var width=Math.min(Qva.GetViewportWidth()-100,table.offsetWidth+60);var top=parseInt(((Qva.GetViewportHeight({includePageScroll:true})-Qva.MessagePopup.offsetHeight/2)));var left=parseInt((Qva.GetViewportWidth()-width)/2);Qva.MessagePopup.style.width=width+"px";Qva.MessagePopup.style.top=top+"px";Qva.MessagePopup.style.left=left+"px"};Qva.CloseMessagePopup=function(){if(Qva.MessagePopup){Qva.MessagePopup.innerHTML="";Qva.MessagePopup.style.display="none";Qva.MessagePopup.style.width="";Qva.MessagePopup.style.top="";Qva.MessagePopup.style.left=""}};Qva.PageBinding.prototype.ContextClientAction=function(event,elem){if(event&&event.stopPropagation){event.stopPropagation()}else{if(!event){event=window.event}event.cancelBubble=true}if(elem.clientaction=="modal"&&Qva.Modal.instance!=null){var modals=elem.param.split(":");Qva.Modal.instance.Show(this,Qva.Remote+(Qva.Remote.indexOf("?")>=0?"&":"?")+"public=only&name="+modals[0]+".htm&target="+Qva.EncodeComponent(elem.Name||elem.AvqMgr.Name)+Qva.XrfSecure(""),parseInt(modals[1]),parseInt(modals[2]))}else{if(elem.clientaction=="inputfield"){Qva.OpenPopupInput(elem)}else{if(elem.clientaction=="confirm"){var parts=elem.param.split(":");var name=(elem.Name||elem.AvqMgr.Name)+"."+parts[0];var msg=parts.slice(1).join(":");if(window.confirm(msg)){this.Set(name,"action","",true)}}else{if(elem.clientaction=="url"){window.open(elem.param)}else{if(elem.clientaction=="bundledurl"){var url=this.BuildBinaryUrl(null,"",elem.param);window.open(url)}else{if(elem.clientaction=="popup"){Qva.ShowMessagePopup(elem.param,this)}else{if(elem.clientaction=="xed"){QvaExpressionEditor.Insert(elem.param,QvaExpressionEditor.Element);Qva.HideContextMenu(true);return false}else{if(elem.clientaction=="menu"){var srcelement=event.target;if(!srcelement){srcelement=event.srcElement}this.OnContextMenu(event,srcelement.ObjectId);return}else{alert("Not supported clientside action: "+elem.clientaction)}}}}}}}}Qva.HideContextMenu();return false};Qva.PageBinding.prototype.OnContextMenu=function(event,name,position,contextmenutarget){if(!event){event=window.event}var srcelement=(contextmenutarget==undefined)?Qva.Events.getTarget(event):contextmenutarget;if((event.shiftKey||Qva.userAgentDetector.get("macintosh"))&&ctrlKeyPressed(event)){return}Qva.HideContextMenu();var fullname;var outerdiv=srcelement;while(outerdiv.parentNode&&!outerdiv.position){outerdiv=outerdiv.parentNode}if(outerdiv.position!=null){position=outerdiv.position;fullname=outerdiv.ObjectId||position}else{if(name){fullname=name;if(srcelement.tagName=="IMG"&&srcelement.isgraph){var pos=Qva.GetPageCoords(srcelement);position=(event.clientX-pos.x)+":"+(event.clientY-pos.y)}else{if(srcelement.index){position=srcelement.index}else{position=position||""}}}else{if(Qva.LabelClick){fullname=this.DefaultScope+".StandardActions"}else{return}}}var res=this.OnCreateContextMenu(this,event,fullname,position);Qva.ResizeBody({adjustscroll:true});return res};Qva.IsContextOpen=function(){if(Qva.ContextMenu!=null&&Qva.ContextMenu.style.display!="none"){return true}if(Qva.ContextDialog!=null&&Qva.ContextDialog.style.display!="none"){return true}if(Qva.ContextDropDown!=null&&Qva.ContextDropDown.style.display!="none"){return true}return false};Qva.HideContextDialog=function(){if(Qva.ContextDialogMgr!=null){Qva.ContextDialogMgr.Close(true);Qva.ContextDialogMgr.PageBinder.RemoveFromManagers(Qva.ContextDialogMgr);Qva.ContextDialogMgr=null}if(Qva.ContextDialogBtn!=null){if(Qva.ContextDialogBtn.style){Qva.ContextDialogBtn.style.backgroundColor=""}Qva.ContextDialogBtn=null}if(Qva.ContextDialog!=null){Qva.ContextDialog.style.display="none";Qva.ContextDialog=null}};Qva.CloseContextDialog=function(){if(Qva.ContextDialogMgr!=null){Qva.ContextDialogMgr.Close(false)}Qva.HideContextDialog()};Qva.AbortContextDialog=function(){if(Qva.ContextDialogMgr!=null){Qva.ContextDialogMgr.Abort()}Qva.HideContextDialog()};Qva.HideContextMenu=function(ignoreDialog){if(Qva.ContextMenu!=null){if(Qva.ContextMenuMgr.SubMenuRow&&Qva.ContextMenuMgr.SubMenuRow.SubMenu){document.body.removeChild(Qva.ContextMenuMgr.SubMenuRow.SubMenu);Qva.ContextMenuMgr.SubMenuRow.SubMenu=null}while(Qva.ContextMenu.firstChild.rows.length>0){Qva.ContextMenu.firstChild.deleteRow(Qva.ContextMenu.firstChild.rows.length-1)}Qva.ContextMenu.style.display="none"}if(Qva.ContextDropDown!=null){Qva.ContextDropDown.style.display="none"}if(!ignoreDialog){Qva.HideContextDialog();if(typeof(Qva.contextDialog)!=="undefined"){Qva.dropDialog.hide()}}};Qva.PageBinding.prototype.TryAltAgent=function(){try{if(external&&typeof(external.AvqView)=="string"){var _this=this;if(!this.IsModal){external.AvqInitServer(this.View,function(){if(_this.Enabled){_this.LoadBegin()}})}if(this.HostedTitle==null){external.AvqTitle(document.title)}else{if(this.HostedTitle!=""){external.AvqTitle(this.HostedTitle)}}this.IsRemote=false;this.IsHosted=true;this.View=external.AvqView;this.Agent=external}else{if(this.AllowComAgent){try{var segm=/[\?\&]admin=/.exec(this.Remote);this.Agent=new ActiveXObject("QvsRemote.Client");this.UseExecute=true;if(segm==null){this.Agent.Connect("localhost",true)}else{this.Agent.AdminConnect("localhost")}this.IsRemote=false}catch(e){}}}}catch(e){Assert(false)}};Qva.Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(e){var t="";var n,r,i,s,o,u,a;var f=0;e=Qva.Base64._utf8_encode(e);while(f<e.length){n=e.charCodeAt(f++);r=e.charCodeAt(f++);i=e.charCodeAt(f++);s=n>>2;o=(n&3)<<4|r>>4;u=(r&15)<<2|i>>6;a=i&63;if(isNaN(r)){u=a=64}else{if(isNaN(i)){a=64}}t=t+this._keyStr.charAt(s)+this._keyStr.charAt(o)+this._keyStr.charAt(u)+this._keyStr.charAt(a)}return t},decode:function(e){var t="";var n,r,i;var s,o,u,a;var f=0;e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(f<e.length){s=this._keyStr.indexOf(e.charAt(f++));o=this._keyStr.indexOf(e.charAt(f++));u=this._keyStr.indexOf(e.charAt(f++));a=this._keyStr.indexOf(e.charAt(f++));n=s<<2|o>>4;r=(o&15)<<4|u>>2;i=(u&3)<<6|a;t=t+String.fromCharCode(n);if(u!=64){t=t+String.fromCharCode(r)}if(a!=64){t=t+String.fromCharCode(i)}}t=Qva.Base64._utf8_decode(t);return t},_utf8_encode:function(e){e=e.replace(/\r\n/g,"\n");var t="";for(var n=0;n<e.length;n++){var r=e.charCodeAt(n);if(r<128){t+=String.fromCharCode(r)}else{if(r>127&&r<2048){t+=String.fromCharCode(r>>6|192);t+=String.fromCharCode(r&63|128)}else{t+=String.fromCharCode(r>>12|224);t+=String.fromCharCode(r>>6&63|128);t+=String.fromCharCode(r&63|128)}}}return t},_utf8_decode:function(e){var t="";var n=0;var r=c1=c2=0;while(n<e.length){r=e.charCodeAt(n);if(r<128){t+=String.fromCharCode(r);n++}else{if(r>191&&r<224){c2=e.charCodeAt(n+1);t+=String.fromCharCode((r&31)<<6|c2&63);n+=2}else{c2=e.charCodeAt(n+1);c3=e.charCodeAt(n+2);t+=String.fromCharCode((r&15)<<12|(c2&63)<<6|c3&63);n+=3}}}return t}};Qva.PageBinding.prototype.BuildBinaryUrl=function(dummy,stamp,name,color){if(name!=null&&stamp==null&&this.CustomIcons[name]){return this.CustomIcons[name]}var url=this.Url;url=url.replace("mark=","datamode=binary");if(name!=null){var qmem="qmem:";if(name.indexOf(qmem)===0&&!Qva.userAgentDetector.get("webview")){var rest=name.substring(qmem.length);url+="&name="+qmem+Qva.Base64.encode(rest)}else{url+="&name="+Qva.EncodeComponent(name)}}if(this.Host!=null){url+="&host="+Qva.EncodeComponent(this.Host)}if(this.Slot!=null){url+="&slot="+Qva.EncodeComponent(this.Slot)}if(stamp!=null){url+="&stamp="+Qva.EncodeComponent(stamp);if(this.Ticket!=null){url+="&ticket="+Qva.EncodeComponent(this.Ticket)}if(this.Invite!=null){url+="&invite="+Qva.EncodeComponent(this.Invite)}if(this.View!=null){url+="&view="+Qva.EncodeComponent(this.View)}if(this.Kind!=null){url+="&kind="+Qva.EncodeComponent(this.Kind)}}else{url+="&public=only"}if(this.Session!=null&&this.JSON){url+="&session="+Qva.EncodeComponent(this.Session)}if(color){url+="&color="+Qva.EncodeComponent(color)}url=Qva.AddProxyIfAny(url);url=Qva.XrfSecure(url);return url};Qva.PageBinding.prototype.RemoveFromManagers=function(mgr){var mix=-1;for(var ix=0;ix<this.Managers.length;++ix){if(this.Managers[ix]==mgr){mix=ix;if(this.Managers[mix].Element!=null){if(this.Managers[mix].Element.AvqMgr!=null){if(this.Managers[mix].Element.AvqMgr.Detach!=null){this.Managers[mix].Element.AvqMgr.Detach()}this.Managers[mix].Element.AvqMgr=null}this.Managers[mix].Element=null}this.Managers.splice(mix,1);break}}if(mix==-1){Assert(false)}};Qva.PageBinding.prototype.RemoveFromMembers=function(mgr){var name=mgr.Name;if(name==null){Assert(false)}if(name==null||name==""){return}var oldlist=this.Members[name];if(oldlist==null){Assert(false);return}var newlist=new Array();for(var i=0;i<oldlist.length;i++){if(oldlist[i]!=mgr){newlist[newlist.length]=oldlist[i]}}if(oldlist.length==newlist.length){Assert(false)}if(newlist.length==0){delete this.Members[name]}else{this.Members[name]=newlist}};function AvqAction_Input_KeyDown(event,that,input){if(!event){event=window.event}var key=event.keyCode;switch(key){case 9:if(event.PreventDefault){event.preventDefault()}else{if(event.originalEvent){event.originalEvent.returnValue=false}else{event.returnValue=false}}if(input.inputname){var oldinputname=input.inputname;var openNextInputObject=function(){var inputs=$("body").find(".QvInput");if(inputs.length>1){for(var i=0;i<inputs.length;i++){if(inputs[i].inputname==oldinputname){break}}if(event.shiftKey){i--;if(i<0){i=inputs.length-1}}else{i++;if(i>=inputs.length){i=0}}Qva.OpenPopupInput(inputs[i],true)}};$(Qva.EventServer).one("OnUpdateComplete",openNextInputObject)}else{var tObj=$(input).closest(".QvFrame");var oldpos=input.val;var openNextInputField=function(){var inputs=$(tObj).find("img.Qv_CellIcon.Qv_IC");if(inputs.length>1){for(var i=0;i<inputs.length;i++){if(inputs[i].pos==oldpos){break}}if(event.shiftKey){i--;if(i<0){i=inputs.length-1}}else{i++;if(i>=inputs.length){i=0}}Qva.OpenPopupInput(inputs[i])}};$(Qva.EventServer).one("OnUpdateComplete",openNextInputField)}case 13:if(input.inputname){var $this=$(input);if($("#"+input.ObjectId).length>0&&$("#"+input.ObjectId)[0].className.indexOf("_IB")!==-1){$.each($this.parent().find(".QvInput"),function(ix,ele){if(ele.inputname===input.inputname&&ele.innerText!==input.value){$(ele).find(".QvInputText").text(input.value)}})}Qva.GetBinder(input.binderid).Set(input.inputname,"text",input.value,true)}else{Qva.GetBinder(input.binderid).Set(that.ObjectId,{inputvalue:input.value,inputelement:input.val},true)}case 27:break}}Qva.NoAction=function(event){if(!event){event=window.event}if(!event){return}if(event.preventDefault){event.preventDefault()}else{event.returnValue=false}};Qva.CancelAction=function(event){if(!event){event=window.event}event.cancelBubble=true;this.pressed=true};Qva.DefaultShowMessage=function(msg){var $inputs=$(".QvInputText");$.each($inputs,function(i,e){if($(e).html!==e.title){$(e).html(e.title)}});alert(msg)};Qva.DefaultOnSessionLost=function(msg){this.RetryMessage(Qva.localization.getStringFromKey("ConnectionLost")||"Lost connection to server.",Qva.localization.getStringFromKey("Reconnecting")||"Reconnecting...",Qva.localization.getStringFromKey("UserCanceled")||"Action canceled by user")};Qva.PageBinding.prototype.GetMenu=function(name,position){this._Send("menu",name,true,{position:(position||"")})};Qva.PageBinding.prototype.Search=function(name,text,toggle,_final){this._Send("search",name,_final,{text:text,toggle:(toggle?"true":"false")})};Qva.PageBinding.prototype.Hover=function(name,pos){this.SimpleCall("hover",name,null,{pos:pos})};Qva.ShowContextDialog=function(elem,body,text){var currentBtn=Qva.ContextDialogBtn;Qva.HideContextDialog();if(Qva.ContextDialog==null){Qva.ContextDialog=document.createElement("div");Qva.ContextDialog.style.position="absolute";Qva.ContextDialog.style.zIndex=666;Qva.ContextDialog.className="contextdialog";Qva.ContextDialog.onclick=Qva.CancelBubble;document.body.appendChild(Qva.ContextDialog)}Qva.ContextDialog.innerHTML=body;var binder=Qva.GetBinder(elem.binderid);var parts=elem.Name.split(".");var name=parts[0]+"."+parts[1]+"."+parts[2];Qva.ContextDialogMgr=new Qva.Mgr.toolwindowbody(binder,Qva.ContextDialog,name);Qva.ContextDialogMgr.Scan(elem.Name);Qva.ContextDialogBtn=elem;if(Qva.ContextDialogBtn.SetActiveUIState){Qva.ContextDialogBtn.SetActiveUIState()}var coords=Qva.GetPageCoords(Qva.ContextDialogBtn);Qva.ContextDialog.style.left=coords.x+24+"px";Qva.ContextDialog.style.top=coords.y-2+"px";Qva.ContextDialog.style.display="";try{Qva.ContextDialog.focus()}catch(err){}if(typeof(text)=="string"){Qva.ContextDialogMgr.SetSingleMode(elem.Name,text)}else{binder.LoadBegin()}};Qva.XmlEncode=function(value){var val=""+value;val=val.replace(/&/g,"&amp;");val=val.replace(/</g,"&lt;");val=val.replace(/>/g,"&gt;");val=val.replace(/"/g,"&quot;");return val};Qva.GetDialogNode=function(root){var dialog_nodes=root.getElementsByTagName("dialog");return(dialog_nodes.length>=1)?dialog_nodes[0]:null};Qva.GetMessage=function(root){var msg_nodes=root.getElementsByTagName("message");if(msg_nodes.length>=1){var msg=msg_nodes[0].getAttribute("text");if(msg&&msg!=""){return msg}}return null};Qva.GetMessageCode=function(root){var msg_nodes=root.getElementsByTagName("message");if(msg_nodes.length>=1){var msg=msg_nodes[0].getAttribute("code");if(msg&&msg!=""){return msg}}return null};Qva.GetMessageLang=function(root){var msg_nodes=root.getElementsByTagName("message");if(msg_nodes.length>=1){var msg=msg_nodes[0].getAttribute("lang");if(msg&&msg!=""){return msg}}return null};Qva.GetErrorMessage=function(root){var error_nodes=root.getElementsByTagName("Error");if(error_nodes.length>=1){var msg_nodes=root.getElementsByTagName("message");if(msg_nodes.length>=1){var msg=msg_nodes[0].getAttribute("text");if(msg&&msg!=""){return msg}}}return null};Qva.GetDocHeight=function(){return Math.max(Math.max(document.body.scrollHeight,document.documentElement.scrollHeight),Math.max(document.body.offsetHeight,document.documentElement.offsetHeight),Math.max(document.body.clientHeight,document.documentElement.clientHeight))};Qva.GetViewportHeight=function(params){var ret=false;if(ret===false&&$(window)&&!Qva.userAgentDetector.get("ipad")&&!Qva.userAgentDetector.get("android")){ret=$(window).height()}if(ret===false&&window.innerHeight!=window.undefined&&(Qva.userAgentDetector.get("ipad")||Qva.userAgentDetector.get("android"))){ret=window.innerHeight}if(ret===false&&document.compatMode=="CSS1Compat"){ret=document.documentElement.clientHeight}if(ret===false&&document.body){ret=document.body.clientHeight}if(params&&params.includePageScroll&&params.includePageScroll===true){ret=ret/2+$(window).scrollTop()}return ret};Qva.GetViewportWidth=function(){if($(window)&&!Qva.userAgentDetector.get("ipad")&&!Qva.userAgentDetector.get("android")){return $(window).width()}if(window.innerWidth!=window.undefined&&(Qva.userAgentDetector.get("ipad")||Qva.userAgentDetector.get("android"))){return window.innerWidth}if(document.compatMode=="CSS1Compat"){return document.documentElement.clientWidth}if(document.body){return document.body.clientWidth}};Qva.GetScrollTop=function(){if(typeof GetCachedElement=="function"){var elmWorkspace=GetCachedElement("s4-workspace");if(elmWorkspace){if(elmWorkspace.scrollTop){return elmWorkspace.scrollTop}}}if(self.pageYOffset){return self.pageYOffset}if(document.documentElement&&document.documentElement.scrollTop){return document.documentElement.scrollTop}return document.body.scrollTop};Qva.GetScrollLeft=function(){if(typeof GetCachedElement=="function"){var elmWorkspace=GetCachedElement("s4-workspace");if(elmWorkspace){if(elmWorkspace.scrollLeft){return elmWorkspace.scrollLeft}}}if(self.pageXOffset){return self.pageXOffset}if(document.documentElement&&document.documentElement.scrollLeft){return document.documentElement.scrollLeft}return document.body.scrollLeft};Qva.MgrSplit=function(mgr,name,namePrefix){if(name==null){return false}var segm=name.split("@");switch(segm.length){case 1:mgr.Attr="text";break;case 2:mgr.Attr=segm[1];break;case 3:mgr.Attr=(segm[1]!="")?segm[1]:"text";mgr.Dec=parseInt(segm[2]);break;default:return false}mgr.Name=Qva.MgrMakeName(segm[0],namePrefix);return true};Qva.MgrMakeName=function(name,namePrefix){if(name==null){Assert(false)}if(name.substr(0,1)=="."){if(namePrefix==null){Assert(false)}if(name.length==1){return namePrefix}return namePrefix+name}else{if(name.substr(0,1)=="~"){if(namePrefix==null){Assert(false)}name=name.substr(1);var parts=name.split(".");var index=namePrefix.indexOf(parts[0]);if(index!=-1){name=namePrefix.substring(0,index)+name}}}return name};Qva.MgrGetDisplayFromMode=function(mgr,mode){if(mgr.Element.disabled&&mgr.ModeIfNotEnabled=="h"){return"none"}else{if(mode=="d"||mode=="e"||mgr.ModeIfNotEnabled=="d"){return""}else{return"none"}}};Qva.Trunc=function(txt,ndec){var dot=txt.indexOf(".");if(dot<0){return txt}var adec=txt.length-dot-1;if(adec<=ndec){return txt}var f=parseFloat(txt);if(isNaN(f)){return txt}var fact=Math.pow(10,ndec);f=Math.round(f*fact)/fact;return f.toString()};Qva.LockDisabled=function(){if(this.Locked===undefined){this.Locked=this.Element.disabled}this.Element.disabled=true};Qva.UnlockDisabled=function(){this.Element.disabled=this.Locked};Qva.LockReadOnly=function(){if(this.Locked===undefined){this.Locked=this.Element.readOnly}this.Element.readOnly=true};Qva.UnlockReadOnly=function(){this.Element.readOnly=this.Locked};Qva.FixUrl=function(url,parameter,value){var re=new RegExp("[?&]"+parameter+"=[^&]*","i");url=url.replace(re,"");if(value!=null){url+="&"+parameter+"="+Qva.EncodeComponent(value)}if(url.indexOf("?")==-1){url=url.replace(/&/,"?")}return url};Qva.ExtractProperty=function(name,defprop,allowEmpty,url){if(allowEmpty){var re=new RegExp("[?&]"+name+"=([^&]*)","i")}else{var re=new RegExp("[?&]"+name+"=([^&]+)","i")}var segm=re.exec(url||window.location);try{if(segm==null){segm=re.exec(top.location)}}catch(e){}return segm!=null?Qva.DecodeComponent(segm[1]):defprop};Qva.ExtractPropertyArray=function(name,defprop,allowEmpty,url){if(allowEmpty){var re=new RegExp("[?&]"+name+"=([^&]*)","gi")}else{var re=new RegExp("[?&]"+name+"=([^&]+)","gi")}var selections=[];var usedurl="";try{if(re.test(url)){usedurl=url}else{if(re.test(window.location)){usedurl=window.location}else{if(re.test(top.location)){usedurl=top.location}}}}catch(e){}if(usedurl!=""){re.lastIndex=0;do{var segm=re.exec(usedurl);if(segm!=null){selections.push(Qva.DecodeComponent(segm[1]))}}while(segm!=null)}if(selections.length>0){return selections}else{return defprop}};Qva.ExtractPropertyForDocument=function(name,document,defprop,allowEmpty,url){var ticket=null;var singelTicket=null;var properties=Qva.ExtractPropertyArray(name,defprop,allowEmpty,url);if(properties){if(!$.isArray(properties)){return properties}for(var row=0;row<properties.length;row++){var items=properties[row].split(":");if(items.length==2){if(items[0].toLowerCase()==document.toLowerCase()){ticket=items[1]}}else{singelTicket=properties[row]}}}if(ticket==null&&singelTicket!=null){return singelTicket}else{return ticket}};Qva.GetAbsolutePageCoords=function(element){var offset=$(element).offset();return{x:offset.left,y:offset.top}};Qva.GetPageCoords=function(element){var coords=Qva.GetAbsolutePageCoords(element);coords.x-=Qva.GetScrollLeft();coords.y-=Qva.GetScrollTop();return coords};Qva.GetOffsets=function(event,target){if(!target){target=event.target||event.srcElement}if(typeof target.offsetLeft=="undefined"){target=target.parentNode}var pageCoords=Qva.GetAbsolutePageCoords(target);var eventCoords={x:Qva.Events.getX(event),y:Qva.Events.getY(event)};var offsets={offsetX:eventCoords.x-pageCoords.x,offsetY:eventCoords.y-pageCoords.y};return offsets};Qva.SetCursor=function(elem,input){var cursorpos=0;if(elem.value.length>0){cursorpos=elem.value.charAt(0)=="*"?elem.value.length-1:elem.value.length}if(typeof elem.selectionStart!=="undefined"){if(input){elem.selectionStart=0;elem.selectionEnd=elem.value.length}else{elem.selectionStart=Math.max(1,cursorpos);elem.selectionEnd=Math.max(1,cursorpos)}}else{if(window.document.selection){if(input){var inputRange=elem.createTextRange();inputRange.moveStart("character",0);inputRange.collapse();inputRange.moveEnd("character",elem.value.length);inputRange.select()}else{var inputRange=elem.createTextRange();inputRange.moveStart("character",cursorpos);inputRange.collapse();inputRange.select()}}}};Qva.CancelBubble=function(event){if(!event||!event.stopPropagation){window.event.cancelBubble=true}else{event.stopPropagation()}};function getClientWidth(elem){if(Qva.userAgentDetector.get("gecko")||Qva.userAgentDetector.get("opera")||Qva.userAgentDetector.get("webkit")){var clientWidth=elem.offsetWidth;var gs=document.defaultView.getComputedStyle(elem,"");var pad=parseInt(gs.getPropertyValue("padding-left")||"0")+parseInt(gs.getPropertyValue("padding-right")||"0");var bor=parseInt(gs.getPropertyValue("border-left-width")||"0")+parseInt(gs.getPropertyValue("border-right-width")||"0");clientWidth-=pad;clientWidth-=bor;return clientWidth}else{return elem.clientWidth}}function getClientHeight(elem){if(Qva.userAgentDetector.get("msie")){return elem.clientHeight}else{var clientHeight=elem.offsetHeight;var gs=document.defaultView.getComputedStyle(elem,"");var pad=parseInt(gs.getPropertyValue("padding-top"))+parseInt(gs.getPropertyValue("padding-bottom"));var bor=parseInt(gs.getPropertyValue("border-top-width"))+parseInt(gs.getPropertyValue("border-bottom-width"));if(Qva.userAgentDetector.get("mobile")){if(!Qva.MobileCache[elem]){clientHeight-=pad;clientHeight-=bor;Qva.MobileCache[elem]=[];Qva.MobileCache[elem]["pad"]=pad;Qva.MobileCache[elem]["bor"]=bor}}return clientHeight}}Qva.ExpressionDialog=function(elem,text){if(elem.disabled){return}var binder=Qva.GetBinder(elem.binderid);if(!binder.Enabled){return}if(binder.IsHosted){var text=external.AvqExpressionDialog(elem.Value,elem.ExpressionType=="always");if(text!=elem.Value){binder.Set(elem.Name,"value",text,true)}}else{if(Qva.ContextDialogBtn==elem){Qva.HideContextDialog()}else{binder.LoadHtml("Expression.Qvpp",function(body){Qva.ShowContextDialog(elem,body,text)})}}};Qva.Hover=null;Qva.PageBinding.prototype.GetHoverDiv=function(){if(!Qva.Hover){Qva.Hover=document.createElement("div");Qva.Hover.className="QvHover";Qva.Hover.style.display="none";document.body.appendChild(Qva.Hover);new Qva.Mgr.hover(this,Qva.Hover,this.DefaultScope+".Hover")}return Qva.Hover};Qva.PenHover=null;Qva.GetPenHoverDiv=function(){if(!Qva.PenHover){Qva.PenHover=document.createElement("div");Qva.PenHover.className="QvPenHover";$(Qva.PenHover).css({display:"none",position:"absolute",left:"-100px",top:"-100px",backgroundImage:"url('"+Qva.QvAjaxZfcPath+"htc/Images/Pen/pen_iconset.png')",backgroundPosition:"0px 0px",backgroundRepeat:"no-repeat",width:"24px",height:"24px",zIndex:999999});document.body.appendChild(Qva.PenHover)}return Qva.PenHover};Qva.PageBinding.prototype.LoadHtml=function(name,callback){var xmlhttp=Qva.GetXHRObject();xmlhttp.onerror=function(){callback(Qva.GetNetworkErrorMsg())};xmlhttp.onreadystatechange=function(){if(xmlhttp.readyState==4){if(xmlhttp.status==200){callback(Qva.localization.localize(xmlhttp.responseText))}else{if(xmlhttp.status==0&&xmlhttp.responseText){callback(Qva.localization.localize(xmlhttp.responseText))}else{callback("No such page")}}}};var url=this.Url;if(name!=null){url+="&name="+Qva.EncodeComponent(name)}if(this.Host!=null){url+="&host="+Qva.EncodeComponent(this.Host)}url+="&public=only";url=Qva.AddProxyIfAny(url);url=Qva.XrfSecure(url);xmlhttp.open("GET",url,true);try{xmlhttp.send(null)}catch(e){callback("Error sending")}};Qva.PageBinding.prototype.GetEnabled=function(){return this.Enabled};Qva.PageBinding.prototype.GetDocumentMgr=function(){return this};Qva.PageBinding.prototype.GetMaxClientWidth=function(elem){return getClientWidth(elem)};Qva.GetObjectBinder=function(elem){var element=elem;while(element&&!element.AvqMgr){element=element.parentNode;if(!element){continue}if(element.AvqMgr){return element.AvqMgr}}return Qva.GetBinder(elem.binderid)};Qva._Create_ModalMessage=function(){var msgmask=Qva.ModalMessage.msgmask=document.createElement("div");msgmask.className="popupMask";msgmask.style.display="none";msgmask.onclick=Qva.CancelBubble;var msgdiv=Qva.ModalMessage.msgdiv=document.createElement("div");msgdiv.className="ModalDialog";msgdiv.style.display="none";msgdiv.onclick=Qva.CancelBubble;msgdiv.innerHTML='<div class="ModalDialog_Header">                             <img src="/qlikview/images/logo_main.png">               <span></span>                                        </div>                                                   <div class="ModalDialog_Body">                               <div class="ModalDialog_Text"></div>                     <img src="/QvAJAXZfc/mobile/img/loader-object.gif" />    <button class="ModalDialog_Button"></div>            </div>                                                   ';$(msgdiv).find(":button").button();document.body.appendChild(msgmask);document.body.appendChild(msgdiv)};Qva.ModalMessage=function(title,bodyHTML,progres_indicator,button){if(!Qva.ModalMessage.msgdiv){Qva._Create_ModalMessage()}var topZIndex=Qva.generalHelper.getHighestZIndex();Qva.ModalMessage.msgmask.style.zIndex=topZIndex+10;Qva.ModalMessage.msgdiv.style.zIndex=topZIndex+11;var $elem=$(Qva.ModalMessage.msgdiv);$elem.find(".ModalDialog_Header span").text(title);$elem.find(".ModalDialog_Text").html(bodyHTML);$(Qva.EventServer).trigger("translate",{target:Qva.ModalMessage.msgdiv,segment:"ModalDialogs",feature:Qva.Registry.get("Parameters","ModalDialogs","currentDialog","title")});var $body=$elem.children(".ModalDialog_Body");$body.find("img")[progres_indicator?"show":"hide"]();var $button=$body.find(".ModalDialog_Button");$button[button?"show":"hide"]();if(button){$button.text(button.text);$button[0].onclick=button.action}else{$button[0].onclick=null}Qva.ModalMessage.msgmask.style.display="block";Qva.ModalMessage.msgdiv.style.display=""};Qva.HideMessage=function(){if(!Qva.ModalMessage.msgdiv){return}Qva.ModalMessage.msgmask.style.display="none";Qva.ModalMessage.msgdiv.style.display="none"};Qva.PageBinding.prototype.WaitMessage=function(title,msg,onCancel){var self=this;var button={text:(Qva.localization.getStringFromKey("Cancel")||"Cancel"),action:function(){Qva.Registry.set("Parameters","ModalDialogs","currentDialog",{title:title.replace(/ /g,"")+"WaitingCancelled"});Qva.ModalMessage(title,Qva.XmlEncode(Qva.localization.getStringFromKey("Canceling")||"Canceling, please wait..."),true,false);self._Send("abort","",true)}};Qva.Registry.set("Parameters","ModalDialogs","currentDialog",{title:title.replace(/ /g,"")+"Waiting"});Qva.ModalMessage(title,Qva.XmlEncode(msg),true,button)};Qva.PageBinding.prototype.OKMessage=function(title,msg,onOK){var self=this;var button={text:(Qva.localization.getStringFromKey("OK")||"OK"),action:function(){Qva.Registry.set("Parameters","ModalDialogs","currentDialog",{title:title.replace(/ /g,"")+"WaitingCancelled"});Qva.ModalMessage(title,Qva.XmlEncode(Qva.localization.getStringFromKey("Canceling")||"Canceling, please wait..."),true,false);self._Send("abort","",true)}};Qva.Registry.set("Parameters","ModalDialogs","currentDialog",{title:title.replace(/ /g,"")+"Waiting"});Qva.ModalMessage(title,Qva.XmlEncode(msg),true,button);$(".ModalDialog_Body").children("img").hide(true)};Qva.PageBinding.prototype.RetryMessage=function(title,msg,canceled){if(Qva.CanceledByUser){return}function reconnect(){var l=window.location+"";var i=l.lastIndexOf("#");if(i!=-1){l=l.substr(0,i)}window.location=Qva.FixUrl(l,"session")}var to=setTimeout(reconnect,5000);var reconnect_button={text:Qva.localization.getStringFromKey("Reconnect")||"Reconnect",action:reconnect};var cancel_button={text:(Qva.localization.getStringFromKey("Cancel")||"Cancel"),action:function(){clearTimeout(to);Qva.CanceledByUser=true;Qva.Registry.set("Parameters","ModalDialogs","currentDialog",{title:title.replace(/ /g,"")+"Cancelled"});Qva.ModalMessage(title,Qva.XmlEncode(canceled),false,reconnect_button)}};Qva.Registry.set("Parameters","ModalDialogs","currentDialog",{title:title.replace(/ /g,"")});Qva.ModalMessage(title,Qva.XmlEncode(msg),true,cancel_button)};Qva.ErrorMessage=function(msg){var msgdiv=document.createElement("DIV");msgdiv.className="HTMLMessage";var textdiv=document.createElement("DIV");textdiv.style.width="100%";textdiv.style.height="100%";textdiv.innerHTML=msg;textdiv.style.overflow="auto";msgdiv.appendChild(textdiv);document.body.appendChild(msgdiv)};Qva.addEvent=function(el,evname,func){$(el).on(evname,func)};Qva.removeEvent=function(el,evname,func){$(el).off(evname,func)};Qva.cancelSelectEvent_md=function(event){if(!Qva.MouseDown){return}event=event||window.event;var target=event.target||event.srcElement;if(Qva.DragDrop.curDrag||(target.nodeName!="INPUT"&&target.nodeName!="SELECT")){Qva.cancelSelectEvent=true}if(Qva.cancelSelectEvent&&event.preventDefault){event.preventDefault()}};Qva.cancelSelectEvent_mm=function(event){if(Qva.cancelSelectEvent){return false}};Qva.GetToolbarElement=function(){return document.getElementById("QvAjaxToolbar")};Qva.ResizeBody=function(params){if(Qva.IS_WORKBENCH||Qva.IS_WEBPARTS){return}if(!params){params={}}if(params.adjustscroll===undefined){params.adjustscroll=true}var $body=$("body"),measuredBodySize={},measuredDocSize={};var resizeBody=function(){var $document=$(document),$container=$(document.getElementById("MainContainer")),$tbr=$(Qva.GetToolbarElement()),$tabs=$(document.getElementById("Tabrow")),width=document.body.scrollWidth,backgroundPos="",backgroundPosX=0;if(params.adjustscroll){measuredBodySize=Qva.guiHelper.measureBodySize();$("body").css("width",measuredBodySize.width).css("height",measuredBodySize.height)}if($tbr[0]||$tabs[0]){Qva.SetMaxWidths(params.adjustscroll)}if(Qva.GetBinder()&&Qva.GetBinder().BackgroundMgr){Qva.GetBinder().BackgroundMgr.SetBackgroundPosition()}if(params.adjustscroll&&$body.css("background-image").length>0&&$body.css("background-image")!=="none"){if($body.css("background-image").substr(0,3)!=="url"){measuredDocSize=Qva.guiHelper.measureDocSize();backgroundPos=$body.css("background-position");if(!backgroundPos){backgroundPos="0px 0px"}backgroundPosX=backgroundPos.substr(0,backgroundPos.indexOf(" "));$("body").css({"background-size":measuredDocSize.width+"px "+measuredDocSize.height+"px","background-position":backgroundPosX+" "+measuredDocSize.top+"px"})}else{$("body").css({"background-size":"auto auto"})}}};resizeBody()};Qva.LoadScript=function(url,callback,doc){if(doc==undefined){doc=document}var script=doc.createElement("script");script.type="text/javascript";script.src=url;var QvJqObjFn=function(){if(url.indexOf("jquery.js")>-1&&typeof $QvJq=="undefined"){$QvJq=jQuery.noConflict();$=$QvJq}};if(script.readyState){script.onreadystatechange=function(){if(script.readyState=="loaded"||script.readyState=="complete"){script.onreadystatechange=null;QvJqObjFn();if(callback&&typeof(callback)==="function"){callback()}}}}else{script.onload=function(){QvJqObjFn();if(callback&&typeof(callback)==="function"){callback()}}}doc.getElementsByTagName("head")[0].appendChild(script)};Qva.LoadScriptArray=function(filesArray,callbackFn,doc){if(filesArray.length===0){if(callbackFn&&typeof(callbackFn)==="function"){callbackFn();return}else{return}}var files=filesArray;var loadCallback=function(){if(files.length>0){var file=files.shift();Qva.LoadScript(Qva.AddProxyIfAny(file),loadCallback,doc)}else{if(callbackFn&&typeof(callbackFn)==="function"){callbackFn()}}};Qva.LoadScript(Qva.AddProxyIfAny(files.shift()),loadCallback,doc)};Qva.LoadCSS=function(url,doc){Qva.AddLink("stylesheet","text/css",url,doc)};Qva.AddLink=function(rel,type,href,doc,media,sizes){if(doc==undefined){doc=document}var link=doc.createElement("link");if(rel){link.setAttribute("rel",rel)}if(media){link.setAttribute("media",media)}if(sizes){link.setAttribute("sizes",sizes)}if(type){link.setAttribute("type",type)}if(href){link.setAttribute("href",href)}doc.getElementsByTagName("head")[0].appendChild(link)};Qva.GetFileListJson=function(json,what){var exclude=["QvBegin.js","QvEnd.js","smalldevices.js","QvAjax.js","Version.js","default.css"],files=json.concat[what],ret=[],src=[],path;for(var x in files){if(files[x]["src"]){src=files[x]["src"];path=json.paths[(x.indexOf(".")>-1)?x.substr(0,x.indexOf(".")):x];for(var i in src){if(exclude.indexOf(src[i])===-1){ret.push(Qva.QvAjaxZfcPath+(path+src[i]).replace(/[\\]/g,"/")+Qva.params.refreshParam)}}}}return ret};Qva.GetDebugFiles=function(callbackFn,isSmallDevices){Qva.Debug.IsDebugMode=true;Qva.params.refreshParam=Qva.Debug.DisableFileCache?(Qva.QvAjaxZfcPath.indexOf("?")>=0?"&":"?")+"n="+Qva.GetRefreshParam():"";var xhr=Qva.GetXHRObject();xhr.onreadystatechange=function(){if(xhr.readyState==4){if(xhr.status==200){Qva.LoadDebugFiles(callbackFn,isSmallDevices,JSON.parse(this.responseText))}}};xhr.open("GET",Qva.QvAjaxZfcPath+"build.json",true);xhr.send()};Qva.LoadDebugFiles=function(callbackFn,isSmallDevices,json){var JsFiles=isSmallDevices?Qva.GetFileListJson(json,"smalldevices",isSmallDevices):Qva.GetFileListJson(json,"qvajax",isSmallDevices);var CSSFiles=Qva.GetFileListJson(json,"css",isSmallDevices);for(var x in CSSFiles){Qva.LoadCSS(CSSFiles[x])}Qva.LoadScriptArray(JsFiles,callbackFn)};Qva.AddExtension=function(name,extensionPaint,debug){if(debug){Qva.Mgr[name].prototype.Debug=true}Qva.Mgr[name].prototype.PostPaint=function(){if(typeof(this.QvaPublic.Paint)==="undefined"){this.QvaPublic.Paint=extensionPaint}try{this.QvaPublic.Paint()}catch(e){if(debug){Assert(false,"An error occurred in the postpaint-function in the extension object: \n"+e.description)}else{Qva.Mgr[name].prototype.PostPaint=null}}}};Qva.AddExtensionBase=function(name,owner){if(!Qva.Mgr[name]){Qva.Mgr[name]=function(owner,elem,name,prefix){if(!Qva.MgrSplit(this,name,prefix)){return}this.Element=elem;$(elem).attr("extension","on");this.Touched=false;elem.ObjectId=owner.Element.id;elem.binderid=owner.binderid;owner.AddManager(this)}}new Qva.Mgr[name](owner,owner.ContentElement,owner.Name)};Qva.ExtensionCreator={};Qva.WaitingForRequest=function(){};Qva.LoadWhenReady=function(documentbinder){if(documentbinder.IsUpdating){window.setTimeout(function(){Qva.LoadWhenReady(documentbinder)},10)}else{window.setTimeout(function(){documentbinder.LoadBegin()},10)}};Qva.CheckForRequestedScript=function(extension,documentbinder){if(Qva.ExtensionCreator[extension]==Qva.WaitingForRequest){window.setTimeout(function(){Qva.CheckForRequestedScript(extension,documentbinder)},10)}};Qva.RequestScript=function(extension,documentbinder,type){var head=document.getElementsByTagName("head")[0];var script=document.createElement("script");script.id=extension;var scriptSrc=Qva.Remote+(Qva.Remote.indexOf("?")>=0?"&":"?")+"public=only";if(type){scriptSrc+="&type="+type}scriptSrc+="&name=Extensions/"+extension+"/script.js";scriptSrc=Qva.XrfSecure(scriptSrc);script.src=scriptSrc;script.type="text/javascript";head.appendChild(script);window.setTimeout(function(){Qva.CheckForRequestedScript(extension,documentbinder)},10)};Qva.getFrameObjForElement=function(elem){while(typeof(elem.AvqMgr)==="undefined"&&elem.parentNode!==null){elem=elem.parentNode}return typeof(elem.AvqMgr)!=="undefined"?elem.AvqMgr:null};Qva.PageBinding.prototype.GetQvObject=function(name,onUpdate,caller){if(!this.isSmallDevices){if(name.indexOf("Document\\")==-1&&name.indexOf("Server\\")==-1){name="Document\\"+name}}if(name.indexOf("Document.")==-1){name="Document."+name}var object=new Qva.Mgr.QvObject(this,name,null);if(!caller){caller=this}object.PostPaint=function(){if(this.QvaPublic.Data.IsDataFetched()){if(!this.QvaPublic.callbackFn){this.QvaPublic.callbackFn=onUpdate}this.QvaPublic.callbackFn(caller)}};this.Send(false);return object};Qva.PageBinding.prototype.Action=function(action){if(!this.Enabled){return}var params={};if(this.Position!=null){params.position=this.Position}params.action="";params.clientsizeWH=Qva.GetViewportWidth()+":"+Qva.GetViewportHeight();this.Set("Document.StandardActions."+action,params)};Qva.PageBinding.prototype.Clear=function(){this.Action("CLEARSTATE")};Qva.PageBinding.prototype.Back=function(){this.Action("BCK")};Qva.PageBinding.prototype.Forward=function(){this.Action("FWD")};Qva.PageBinding.prototype.Undo=function(){this.Action("UNDO")};Qva.PageBinding.prototype.Redo=function(){this.Action("REDO")};Qva.PageBinding.prototype.LockSelections=function(){this.Action("LS")};Qva.PageBinding.prototype.UnlockSelections=function(){this.Action("US")};Qva.PageBinding.prototype.CloseSession=function(){this.Enabled=false;this.Ready=function(){};this.OnContextMenu=function(){};this.SendClose()};Qva.PageBinding.prototype.GetAggregations=function(){return this.AggregationMgr.Items};Qva.PageBinding.prototype.GetFunctions=function(){return this.FunctionMgr.Items};Qva.PageBinding.prototype.GetFields=function(){return this.FieldMgr.Items};Qva.PageBinding.prototype.GetVariables=function(){return this.VariableMgr.Items};Qva.Public={Data:function(parent){this.CellStyles=new Array();this.CellBorderStyles=new Array();this.HeaderRows=new Array();this.Rows=new Array();this.Super=parent;this.NewOffset=new Object({x:0,y:0});this.PageOffset=new Object({x:0,y:0});this.PageSize=new Object({x:0,y:0});this.TotalSize=new Object({x:0,y:0});this.IsDataFetched=function(){if(this.Super.ObjectMgr.Mode==="invalid"||this.PageSize.x===0||this.TotalSize.x===0||this.TotalSize.y===0){return true}var newOffset=this.NewOffset;var y0=this.PageSize.y*Math.floor(newOffset.y/this.PageSize.y);var x0=this.PageSize.x*Math.floor(newOffset.x/this.PageSize.x);var y1=y0+this.PageSize.y;var x1=x0+this.PageSize.x;var stepY=(this.Page===undefined)?this.PageSize.y:this.Page._size;var stepX=(this.Page===undefined)?this.PageSize.x:this.Page._size;var pageOffsetToRequest={};if(this.Rows[newOffset.y]===undefined&&newOffset.y<=this.TotalSize.y){pageOffsetToRequest.y=y0;pageOffsetToRequest.x=x0}else{if(this.Rows[newOffset.y+stepY-1]===undefined&&newOffset.y+stepY<=this.TotalSize.y){pageOffsetToRequest.y=y1;pageOffsetToRequest.x=x0}else{if(this.Rows[newOffset.y][newOffset.x]===undefined&&newOffset.x<=this.TotalSize.x){pageOffsetToRequest.x=x0;pageOffsetToRequest.y=y0}else{if(this.Rows[newOffset.y][newOffset.x+stepX-1]===undefined&&newOffset.x+stepX<=this.TotalSize.x){pageOffsetToRequest.x=x1;pageOffsetToRequest.y=y0}else{if(newOffset.y+stepY<=this.TotalSize.y){if(this.Rows[newOffset.y+stepY-1][newOffset.x+stepX-1]===undefined&&newOffset.x+stepX<=this.TotalSize.x){pageOffsetToRequest.y=y1;pageOffsetToRequest.x=x1}}}}}}if(pageOffsetToRequest.x!==undefined){if(pageOffsetToRequest.y==y1){for(;!this.Rows[pageOffsetToRequest.y-1]&&pageOffsetToRequest.y>y0;--pageOffsetToRequest.y){}}if(pageOffsetToRequest.x==x1){for(;!this.Rows[pageOffsetToRequest.x-1]&&pageOffsetToRequest.x>x0;--pageOffsetToRequest.x){}}this.Super.ObjectMgr.PartialLoad(this.Super.Name,pageOffsetToRequest);return false}else{return true}}},Layout:function(parent){this.ObjectId="";this.Super=parent;this.SetProperty=function(name,value,isfinal){this.Super.DocumentMgr.Set(this.Super.Name,{property:name,value:value},isfinal)}},Wrapper:function(binder){this.Element=binder.Element;if(typeof(binder.PageBinder)!=="undefined"&&typeof(binder.PageBinder.GetMaxClientHeight)!=="undefined"){this.GetHeight=binder.PageBinder.GetMaxClientHeight}else{this.GetHeight=function(){return 0}}if(typeof(binder.PageBinder)!=="undefined"&&typeof(binder.PageBinder.GetMaxClientWidth)!=="undefined"){this.GetWidth=binder.PageBinder.GetMaxClientWidth}else{this.GetWidth=function(){return 0}}this.PageBinder=binder;this.DocumentMgr=typeof(binder.PageBinder.PageBinder)!=="undefined"?binder.PageBinder.PageBinder:binder.PageBinder;this.ObjectMgr=typeof(binder.PageBinder.PageBinder)!=="undefined"?binder.PageBinder:binder;this.Name=this.ObjectMgr.Name;this.Type=this.ObjectMgr.Type;this.Data=new Qva.Public.Data(this);this.Layout=new Qva.Public.Layout(this);this.GetQvObject=function(objectName,callbackFn){var obj=this.DocumentMgr.GetQvObject(objectName,callbackFn,this);if(obj.IsInvalid()){this.DocumentMgr.Load(true)}return obj};this.IsInvalid=function(){var retval=true;if(typeof(this.ObjectMgr.IsInvalid)!=="undefined"){retval=this.ObjectMgr.IsInvalid()}return retval};this.SetOnUpdateComplete=function(onUpdateComplete){this.callbackFn=onUpdateComplete};this.QvaPublic=this},__namespace:true};Qva.Public.Wrapper.__class=true;Qva.Help={Show:function(base){var topic="Toolbar";var context=this.Context[""+Qva.ActiveObjects[0]];if(context&&context.Topic){var frame=window.document.getElementById(context.Name);if(frame&&frame.AvqMgr){topic=context.Topic}}var url=base.replace("{topic}",topic).replace("{language}",Qva.localization.lang);window.open(url,"MCWebHelp")}};Qva.Hex2RGBA=function(hexVal){if(hexVal.length===7){return hexVal}Assert(hexVal.length===9);var rgb=hexVal.substr(3).match(/(.{2})/g),alpha=(parseInt(hexVal.substr(1,2),16)/255).toFixed(2);rgb[0]=parseInt(rgb[0],16);rgb[1]=parseInt(rgb[1],16);rgb[2]=parseInt(rgb[2],16);return"rgba("+rgb.join(", ")+", "+alpha+")"};Qva.Hex2CSSExpression=function(hexColor){var retVal=null;if(hexColor&&hexColor.indexOf("#")===0){try{if(!Qva.userAgentDetector.get("msie")||Qva.userAgentDetector.get("msieDocMode")>=9){retVal=Qva.Hex2RGBA(hexColor)}}catch(e){Assert(false);retVal=null}}return retVal};Qva.RGBAIgnoreTranparancy=function(rgba){if(!rgba){return rgba}if(!rgba.substring(0,5)==="rgba("){return rgba}var rgb=rgba.substring(5,rgba.length-1).replace(/ /g,"").split(",");if(rgb.length>=3){return"rgba("+rgb[0]+","+rgb[1]+","+rgb[2]+",1.00)"}return rgba};Qva.ApplyGradientToElement=function(fillDirection,fillPattern,primaryCol,secondaryCol,element,useFallback){fillDirection=parseInt(fillDirection);fillPattern=parseInt(fillPattern);var primColorRGBA=Qva.Hex2RGBA(primaryCol),secColorRGBA=Qva.Hex2RGBA(secondaryCol),retVal=false;try{element.style.backgroundColor="";if(fillDirection===0){switch(fillPattern){case 3:element.style.background="linear-gradient(to top,"+secColorRGBA+","+primColorRGBA+" 50%, "+secColorRGBA+")";retVal=true;break;case 2:element.style.background="linear-gradient(to top,"+primColorRGBA+","+secColorRGBA+" 50%, "+primColorRGBA+")";retVal=true;break;case 1:element.style.background="linear-gradient(to top,"+primColorRGBA+", "+secColorRGBA+")";retVal=true;break;case 0:default:element.style.background="linear-gradient(to bottom,"+primColorRGBA+", "+secColorRGBA+")";retVal=true;break}}else{if(fillDirection===1){switch(fillPattern){case 3:element.style.background="linear-gradient(to left, "+secColorRGBA+", "+primColorRGBA+" 50%, "+secColorRGBA+")";retVal=true;break;case 2:element.style.background="linear-gradient(to left, "+primColorRGBA+", "+secColorRGBA+" 50%, "+primColorRGBA+")";retVal=true;break;case 1:element.style.background="linear-gradient(to right,"+secColorRGBA+", "+primColorRGBA+")";retVal=true;break;case 0:default:element.style.background="linear-gradient(to left,"+secColorRGBA+", "+primColorRGBA+")";retVal=true;break}}else{if(fillDirection===2){switch(fillPattern){case 3:element.style.background="linear-gradient(to left bottom,"+secColorRGBA+","+primColorRGBA+" 50%, "+secColorRGBA+")";retVal=true;break;case 2:element.style.background="linear-gradient(to left bottom,"+primColorRGBA+","+secColorRGBA+" 50%, "+primColorRGBA+")";retVal=true;break;case 1:element.style.background="linear-gradient(to right top,"+primColorRGBA+", "+secColorRGBA+")";retVal=true;break;case 0:default:element.style.background="linear-gradient(to left bottom,"+primColorRGBA+", "+secColorRGBA+")";retVal=true;break}}else{if(fillDirection===3){switch(fillPattern){case 3:element.style.background="linear-gradient(to right bottom, "+secColorRGBA+", "+primColorRGBA+" 50%, "+secColorRGBA+")";retVal=true;break;case 2:element.style.background="linear-gradient(to right bottom, "+primColorRGBA+", "+secColorRGBA+" 50%, "+primColorRGBA+")";retVal=true;break;case 1:element.style.background="linear-gradient(to left top,"+primColorRGBA+", "+secColorRGBA+")";retVal=true;break;case 0:default:element.style.background="linear-gradient(to right bottom,"+primColorRGBA+", "+secColorRGBA+")";retVal=true;break}}else{if(fillDirection===4){switch(fillPattern){case 3:element.style.background="radial-gradient(ellipse at right bottom, "+secColorRGBA+", "+primColorRGBA+")";retVal=true;break;case 2:element.style.background="radial-gradient(ellipse at left bottom, "+secColorRGBA+", "+primColorRGBA+")";retVal=true;break;case 1:element.style.background="radial-gradient(ellipse at right top,"+secColorRGBA+", "+primColorRGBA+")";retVal=true;break;case 0:default:element.style.background="radial-gradient(ellipse at left top,"+secColorRGBA+", "+primColorRGBA+")";retVal=true;break}}else{if(fillDirection===5){switch(fillPattern){case 3:element.style.background="radial-gradient(ellipse at center, "+secColorRGBA+",  "+primColorRGBA+", "+secColorRGBA+")";retVal=true;break;case 2:element.style.background="radial-gradient(ellipse at center, "+primColorRGBA+",  "+secColorRGBA+", "+primColorRGBA+")";retVal=true;break;case 1:element.style.background="radial-gradient(ellipse at center, "+primColorRGBA+", "+secColorRGBA+")";retVal=true;break;case 0:default:element.style.background="radial-gradient(ellipse at center, "+secColorRGBA+", "+primColorRGBA+")";retVal=true;break}}}}}}}}catch(e){Assert(false);retVal=false}if(!retVal&&useFallback){retVal=Qva.ApplyGradientToElement("0","0",primaryCol,secondaryCol,element,false)}return retVal};Qva.JsToXml=function(item,indent){switch(typeof item){case"object":var txt="";if(item.length==undefined){for(var name in item){if(name=="Super"){continue}var child=item[name];if(typeof child=="function"){continue}if(indent){txt+=" "}txt+="<"+name+">"+Qva.JsToXml(child,indent)+"</"+name+">"}}else{for(var ix=0;ix<item.length;++ix){if(indent){txt+=" "}txt+="<e>"+Qva.JsToXml(item[ix],indent)+"</e>"}}return txt;default:return Qva.XmlEncode(""+item)}};Qva.JsEncode=function(value){var val=""+value;val=val.replace(/\\/g,"\\\\");val=val.replace(/'/g,"\\'");return val};Qva.JsToText=function(item,indent){switch(typeof item){case"object":if(item.length==undefined){var txt="{";for(var name in item){if(name=="Super"){continue}var child=item[name];if(typeof child=="function"){continue}if(txt.length>1){txt+=","}if(indent){txt+="\n"}txt+=name+":"+Qva.JsToText(child,indent)}return txt+"}"}else{var txt="[";for(var ix=0;ix<item.length;++ix){if(txt.length>1){txt+=","}if(indent){txt+="\n"}txt+=Qva.JsToText(item[ix],indent)}return txt+"]"}default:return Qva.JsEncode(""+item)}};Qva.AddProxyIfAny=function(url){if(!this.Proxy){return url}var proxyPrefix=this.Proxy+"?u=";if(url.indexOf(proxyPrefix)==0){url=url.substring(proxyPrefix.length);url=Qva.DecodeComponent(url)}var urlencodedUrl=Qva.EncodeComponent(url);return proxyPrefix+urlencodedUrl};Qva.AddProxyToUrlsInStyleSheets=function(){var defaultcssloaded=false;if(Qva.AddProxyToUrlsInStyleSheetsTries==undefined){Qva.AddProxyToUrlsInStyleSheetsTries=0}else{Qva.AddProxyToUrlsInStyleSheetsTries+=1}try{for(var i=0;i<document.styleSheets.length;i++){var href=document.styleSheets[i].href;if(href==null){continue}if(href.indexOf(Qva.QvAjaxZfcPath)==-1){continue}if(href.toLowerCase().indexOf("default.css")>-1){defaultcssloaded=true}var rules;try{rules=document.styleSheets[i].rules?document.styleSheets[i].rules:document.styleSheets[i].cssRules}catch(Error){if(Qva.AddProxyToUrlsInStyleSheetsTries<100){setTimeout(Qva.AddProxyToUrlsInStyleSheets,40);return}else{continue}}if(!rules){continue}for(var is=0;is<rules.length;is++){var cssText;try{cssText=rules[is].style.cssText?rules[is].style.cssText:rules[is].cssText}catch(Error){continue}if(!cssText){continue}var end=0;while(cssText.indexOf("url(",end)!=-1){var start=cssText.indexOf("url(");end=cssText.indexOf(")",start);var url=cssText.substring(start+4,end);if(url.indexOf('"data:')==0){continue}if(url.indexOf('"http:')==0){continue}if(url.indexOf('"https:')==0){continue}url=url.replace(new RegExp("(\"|')","g"),"");var lastslash=href.lastIndexOf("%2f")+3>href.lastIndexOf("/")+1?href.lastIndexOf("%2f")+3:href.lastIndexOf("/")+1;var path=href.substring(0,lastslash);var sitepath=path.substring(0,path.indexOf("?"));if(sitepath!=""){sitepath=sitepath.substring(0,sitepath.lastIndexOf("/")+1)}if(sitepath!=""){url=url.replace(sitepath,"")}url=path+url;var newurl=url;newurl='"'+newurl+'"';cssText=cssText.substring(0,start+4)+newurl+cssText.substring(end);if(rules[is].style.cssText){rules[is].style.cssText=cssText}else{rules[is].cssText=cssText}}}}}catch(Error){return}if(!defaultcssloaded){setTimeout(Qva.AddProxyToUrlsInStyleSheets,40)}};Qva.ConsoleLog={SeverityTypes:{None:0,Normal:1,Verbose:2},Severity:0,LogExists:typeof(console)!=="undefined"&&console.log,Log:function(logText,severityType){if(typeof(severityType)==="undefined"){severityType=Qva.ConsoleLog.Severity}if(severityType<=Qva.ConsoleLog.Severity){if(Qva.ConsoleLog.LogExists){console.log(logText)}else{if(!this.Console){var DebugConsole=window.document.getElementById("DebugConsole");if(DebugConsole){this.Console=$(DebugConsole);this.Console.css("display","")}}if(this.Console){this.Console[0].innerText+=logText+"\n"}}}},LogAllObjectProperties:function(obj){for(props in obj){this.Log(props+": "+obj[props])}}};Qva.PageBinding.prototype.SimpleCall=function(cmd,name,callback,extra){tempMgr=function(owner,cmd,name,callback,extra){this.Paint=function(mode,node,name){var returnData={};Qva.ObjectifyXML(returnData,node);if(this.Callback&&typeof(this.Callback)==="function"){this.Callback(returnData);this.Remove()}};this.Remove=function(){var binder=Qva.GetBinder(this.binderid);binder.RemoveFromManagers(this);binder.RemoveFromMembers(this)};if(!Qva.MgrSplit(this,"."+cmd,"Document")){return}this.binderid=owner.binderid;this.Callback=callback;owner.AddManager(this);this.Data=[];Qva.GetBinder(this.binderid)._Send(cmd,name,true,extra)};new tempMgr(this,cmd,name,callback,extra)};Qva.MakeRequest=function(url,callback,postdata){var xmlhttp=Qva.GetXHRObject();xmlhttp.onerror=function(){callback(false,xmlhttp.responseText)};xmlhttp.onreadystatechange=function(){if(xmlhttp.readyState==4){if(xmlhttp.status==200){callback(true,xmlhttp.responseXML)}else{callback(false,xmlhttp.responseText)}}};url=Qva.AddProxyIfAny(url);url=Qva.XrfSecure(url);if(postdata){xmlhttp.open("POST",url,true)}else{xmlhttp.open("GET",url,true)}try{xmlhttp.send(postdata)}catch(e){callback(false,"Error sending")}};Qva.ExecuteBodyOnLoadFunctionNames=function(){for(var id in Qva.binders){if(!Qva.binders[id].Enabled||Qva.binders[id].loggingIn){window.setTimeout(Qva.ExecuteBodyOnLoadFunctionNames,40);return}}for(var i=0;i<Qva.BodyOnLoadFunctionNames.length;i++){if(typeof Qva.BodyOnLoadFunctionNames[i]==="string"){var func=window[Qva.BodyOnLoadFunctionNames[i]];if(typeof func=="function"){func()}}else{if(typeof Qva.BodyOnLoadFunctionNames[i]==="function"){Qva.BodyOnLoadFunctionNames[i]()}}}Qva.BodyOnLoadFunctionNames=[]};Qva.Init=function(qvaConfig){if(typeof(qvaConfig.View)=="undefined"){alert("Configuration property 'View' is missing");return}if(Qva.Docs){for(var i=0;i<Qva.Docs.length;i++){if(qvaConfig.View==Qva.Docs[i]["View"]){return}}}var ValidQvaProperties=["QvAjaxZfcPath","BodyOnLoadFunctionNames","CSS","Remote"];var ValidBinderProperties=["Platform","View","Host","CustomIcons","AuthenticateUrl","Ticket","InitialSelections","InlineStyle","InitialSearch","Bookmark","Userid","Xuserid","Password","Xpassword","AlternateUser","Anonymous","isSmallDevices"];_isValid=function(array,property){for(i=0;i<array.length;i++){if(array[i]==property){return true}}return false};if(!this.Initialized){Qva.Docs=new Array();Qva.DocumentClick=false}var docobj={};for(var propertyName in qvaConfig){if(_isValid(ValidQvaProperties,propertyName)){if((propertyName=="BodyOnLoadFunctionNames"||propertyName=="CSS")){if(typeof(qvaConfig[propertyName])=="object"){Qva[propertyName]=Qva[propertyName].concat(qvaConfig[propertyName])}else{Qva[propertyName].push(qvaConfig[propertyName])}}else{Qva[propertyName]=qvaConfig[propertyName]}}else{if(_isValid(ValidBinderProperties,propertyName)){docobj[propertyName]=qvaConfig[propertyName]}else{alert("Unsupported configuration property: "+propertyName)}}}if(docobj.View!="<select document>"){Qva.Docs.push(docobj)}if(!this.Initialized){Qva.AddLink("shortcut icon","image/x-icon",Qva.QvAjaxZfcPath+"htc/Images/favicon.ico");if(!qvaConfig.isSmallDevices){Qva.LoadCSS(Qva.QvAjaxZfcPath+"htc/default.css")}for(var i=0;i<Qva.CSS.length;i++){Qva.LoadCSS(Qva.CSS[i])}if(typeof(Qva.Mgr)==="undefined"){Qva.GetDebugFiles(Qva.Init2,qvaConfig.isSmallDevices)}else{$(document).ready(Qva.Init2)}}this.Initialized=true};Qva.Init2=function(){for(var i=0;i<Qva.Docs.length;i++){var id=Qva.Docs[i]["View"];var qvaDoc=new Qva.PageBinding(id);var mainContainer=$("#main")[0];qvaDoc.Autoview=window.document.uniqueID;qvaDoc.AuthenticateUrl=Qva.QvAjaxZfcPath+"Authenticate.aspx";if(!Qva.Docs[i].isSmallDevices){qvaDoc.Host="Local"}for(var propertyName in Qva.Docs[i]){qvaDoc[propertyName]=Qva.Docs[i][propertyName]}if(!mainContainer){mainContainer=document.createElement("div");mainContainer.setAttribute("id","mainContainer_"+id);document.body.appendChild(mainContainer)}qvaDoc.CollaborationObject=new Qva.Collaboration(qvaDoc,mainContainer);qvaDoc._Send("add","Document.Objectlist",false)}new Qva.Modal();new Qva.Scanner();Qva.Start()};Qva.InitWebParts=function(config){Qva.IS_WEBPARTS=true;config.Platform="WEBPARTS";Qva.Init(config)};Qv={};Qv.InitWorkBench=function(config){Qva.IS_WORKBENCH=true;config.Platform="WORKBENCH";Qva.Init(config)};Qv.GetDocument=function(documentName){return new Qv.Document(documentName)};Qv.GetCurrentDocument=function(){return new Qv.Document()};Qv.GetAllDocuments=function(callback){newCallback=function(statusOK,text){if(!statusOK){alert("Error")}else{var returnData=[];var docs=text.getElementsByTagName("document");for(var i=0;i<docs.length;++i){var data={};ObjectifyXmlAttributes(data,docs[i]);returnData[returnData.length]=data}returnData.sort(function(a,b){return(a.title.toUpperCase()>b.title.toUpperCase())?1:((b.title.toUpperCase()>a.title.toUpperCase())?-1:0)});callback(returnData)}};Qva.MakeRequest(Qva.QvAjaxZfcPath+"DocList.aspx",newCallback)};Qv.GetDocObjects=function(host,documentName,callback){newCallback=function(statusOK,text){if(!statusOK){alert("Error")}else{var returnData=[];var nodes=text.getElementsByTagName("object");for(var i=0;i<nodes.length;i++){var data={};ObjectifyXmlAttributes(data,nodes[i]);if(data.id){returnData[returnData.length]=data}}callback(returnData)}};var url="?mark=&host="+Qva.EncodeComponent(host)+"&view="+Qva.EncodeComponent(documentName);var post='<update mark="" stamp="" scope="Document" view="'+documentName+'" ident="null">';post+='<info name="Document.SheetObjects" />';post+="</update>";Qva.MakeRequest(Qva.Remote+url,newCallback,post)};Qv.LoadExtensionScripts=function(filesArray,callbackFn){for(var i=0;i<filesArray.length;i++){var filename=filesArray[i].toLowerCase();if(filename.indexOf("extensions")===0){filesArray[i]=Qva.Remote+(Qva.Remote.indexOf("?")>=0?"&":"?")+"public=only&name="+filesArray[i]}}return Qva.LoadScriptArray(filesArray,callbackFn)};Qv.AddExtension=function(name,extensionPaint,debug){return Qva.AddExtension(name,extensionPaint,debug)};Qv.Document=function(documentName){if(documentName==undefined){this.binder=Qva.GetBinder(Qva.Docs&&Qva.Docs[0]["View"]||"")}else{this.binder=Qva.GetBinder(documentName)}if(this.binder==undefined){alert("Document '"+documentName+"' must first be initialized by the function 'Qv.InitWorkBench' before it can be used")}};Qv.Document.prototype.Back=function(){return this.binder.Back()};Qv.Document.prototype.Clear=function(){return this.binder.Clear()};Qv.Document.prototype.CloseSession=function(){return this.binder.CloseSession()};Qv.Document.prototype.Forward=function(){return this.binder.Forward()};Qv.Document.prototype.LockSelections=function(){return this.binder.LockSelections()};Qv.Document.prototype.Redo=function(){return this.binder.Redo()};Qv.Document.prototype.Undo=function(){return this.binder.Undo()};Qv.Document.prototype.UnlockSelections=function(){return this.binder.UnlockSelections()};Qv.Document.prototype.GetAllObjects=function(callback){this.binder.SimpleCall("info","Document.SheetObjects",function(returnData){callback.call(this,returnData.object)})};Qv.Document.prototype.GetAllSheetsAndObjects=function(callback){this.binder.SimpleCall("info","Document.SheetsAndObjects",function(returnData){callback.call(this,returnData.sheet)})};Qv.Document.prototype.SetVariable=function(name,value){this.binder.Set("Document.Variable\\"+name,"value",value,true)};Qv.Document.prototype.GetAllVariables=function(callback){this.binder.SimpleCall("info","Document.Variables",function(returnData){callback.call(this,returnData.variable)})};Qv.Document.prototype.Bookmarks=function(){return this.binder.BookmarksMgr};Qv.Document.prototype.SetOnUpdateComplete=function(onupdatecomplete){this.binder.OnUpdateComplete=onupdatecomplete};Qv.Document.Object=function(doc,objectId){this._doc=doc;this._object=this._doc.binder.GetQvObject(objectId,function(){},this);this.QvaPublic=this._object.QvaPublic};Qv.Document.Object.prototype.SetOnUpdateComplete=function(onUpdateComplete){this._object.QvaPublic.callbackFn=onUpdateComplete};Qv.Document.prototype.GetObject=function(name,func){func=typeof func==="function"?func:function(){};var obj=this.binder.GetQvObject(name,func);return obj.QvaPublic};Qv.Document.prototype.SetTabrowPaint=function(func){this.binder.PaintTabrow=func};Qv.Document.prototype.SetToolbarPaint=function(func){this.binder.PaintToolbar=func};Qv.Document.prototype.SetBackgroundPaint=function(func){this.binder.PaintBackground=func};Qv.Document.prototype.AddBookmarkPaint=function(object){this.binder.BookmarksSubscribers.push(object);object.Paint(this.binder.BookmarksMgr)};Qv.Document.prototype.GetCurrentSelections=function(options){var defaults={onChange:function(){},fields:[],enabled:true};var fieldDefaults={name:undefined,state:"selected",onDataLoaded:function(){}};if(options.fields){for(var i=0;i<options.fields.length;++i){defaults.fields.push(fieldDefaults)}}var settings=$.extend(true,{},defaults,options);this.binder.CurrentSelectionMgr.GetData(settings)};Qv.Document.prototype.GetField=function(options){if(!options.name||!options.onDataLoaded){return}var field=this.binder.GetField(options,true);field.GetData(true,options.offset)};Qv.Document.prototype.ResizeObject=function(name,width,height){if(name.indexOf("\\")===-1){name="Document\\"+name}var elem=$(document.getElementById(name));if(elem[0]){var parentelement=elem.parent();$(parentelement).height(height).width(width);var objname="Document."+name;var objmgr=this.binder.Members[objname];if(objmgr){objmgr=objmgr[0]}if(objmgr){objmgr.Size({mode:"enabled",left:0,top:0,width:width,height:height});this.binder.Send()}}};Qva.GetMatrix=function($e){var value,i,l=["transform","-webkit-transform","-moz-transform","-ms-transform","-o-transform"],len=l.length;for(i=0;i<len;++i){value=$e.css(l[i]);if(value){return value}}};Qva.GetTranslation=function($e){var re=/matrix\(1, 0, 0, 1, (-?\d+)(?:px)?, (-?\d+)(?:px)?\)/,matrix=Qva.GetMatrix($e),matches=matrix&&matrix.match(re);return matches&&{x:+matches[1],y:+matches[2]}};Qva.GetRefreshParam=function(){return Math.floor(Math.random()*100001)};Qva.XrfSecure=function(url){if(url.indexOf("xrfkey")<0&&url.indexOf(Qva.QvAjaxZfcPath)!=-1){var xrfkey,xrfcookie;xrfcookie=Qva.readCookie("xrfkey");if(Qva.Registry.validate("Config","Security","EnhancedXRF")===true){xrfcookie=false}else{xrfcookie=Qva.readCookie("xrfkey")}if(xrfcookie){xrfkey=xrfcookie}else{xrfkey=Qva.getRandomString(16);var cookie="xrfkey="+xrfkey+";path=/";if(window.location.protocol==="https:"){cookie+=";secure"}document.cookie=cookie}url=Qva.FixUrl(url,"xrfkey",xrfkey)}return url};Qva.getRandomString=function(keyLength){var result="",i,j;for(i=0;i<keyLength;i++){j=Qva.ajaxHelper.getRandomValues();if(j<10){result+=j}else{if(j>9&&j<36){result+=String.fromCharCode(j+55)}else{result+=String.fromCharCode(j+61)}}}return result};Qva.readCookie=function(name){var i,c,nameEq=name+"=",ca=document.cookie.split(";");for(i=0;i<ca.length;i++){c=ca[i];while(c.charAt(0)===" "){c=c.substring(1,c.length)}if(c.indexOf(nameEq)===0){return c.substring(nameEq.length,c.length)}}return null};Qva.ReplacePngUrlsInStyleSheetsWithGif=function(){var defaultcssloaded=false;try{for(var i=0;i<document.styleSheets.length;i++){var href=document.styleSheets[i].href;if(href==null){continue}if(href.toLowerCase().indexOf("qmccommon")>-1){return}if(href.indexOf(Qva.QvAjaxZfcPath)==-1){continue}if(href.toLowerCase().indexOf("default.css")>-1){defaultcssloaded=true}document.styleSheets[i].cssText=document.styleSheets[i].cssText.replace(/property_sprite.png/g,"property_sprite.gif")}}catch(Error){return}if(!defaultcssloaded){setTimeout(Qva.ReplacePngUrlsInStyleSheetsWithGif,40)}};Qva.GetzIndex=function(el){var zIndex=666;for(;el!=null&&(el.style==undefined||el.style.zIndex=="");el=el.parentNode){}if(el&&el.style&&el.style.zIndex){zIndex=el.style.zIndex+10}return zIndex};Qva.ConvertToBr=function(text){if(text&&typeof text=="string"){text=Qva.XmlEncode(text);var br="<br />";text=text.replace(/\r?\n|\r|\&#xA;|\&#xD;/g,br);if(Qva.userAgentDetector.get("msie8lte")){text=text.replace(/  /g,"&nbsp;&nbsp;")}var parts=text.split(br);if(parts.length>0){var newText="";for(var i=0;i<parts.length;i++){if(parts[i].match(/\S/)){newText+=parts[i]}if(i<parts.length-1){newText+=br}}return newText}}return text};Qva.RemoveHtml=function(element){var $ele=$(element);$ele.find("*").each(function(){$(this).unbind()});Qva.RemoveElement(element)};Qva.RemoveElement=function(ele){var $ele=$(ele);if($ele.attr("extension")==="on"){$ele.remove()}else{$ele.find("div").remove();$ele.html("").remove()}};Qva.NavigateToLoginPageIfAny=function(){var url=Qva.QvAjaxZfcPath+"GetLoginpageUrl.aspx";var xmlhttp=Qva.GetXHRObject();xmlhttp.open("Get",url,false);try{xmlhttp.send(null)}catch(e){}var ok=(200<=xmlhttp.status&&xmlhttp.status<300)||xmlhttp.status==1223;if(ok){if(xmlhttp.responseText.toLowerCase().indexOf("qlikview/login.htm")<0&&(!isExternalDomain(xmlhttp.responseText))){var lang=Qva.localization.lang||Qva.ExtractProperty("lang",null,true);window.location=xmlhttp.responseText+"?lang="+lang+"&opendocqs="+Qva.EncodeComponent(window.location.search);return true}}return false};Qva.SetEllipsisOnMultiLineElement=function(element){$(element).find(".Qv_multiline").each(function(){var el=$(this);var par=el.parent();var ellipsis=false;while(par&&!par[0].style.height){par=par.parent()}if(par){var h=parseInt(par[0].style.height);var breakchar="<br />";if(el.data("text")){var text=el.data("text")}else{var text=$("<div/>").text(el[0].innerText).html().replace(/\r?\n/g,breakchar)}var halfing=true;while(text.length>0&&el.height()>h+1){if(halfing){var text2=text.substr(0,text.length/2);if(el.html(text2+"...").height()>h+1){text=text2}else{halfing=false}}if(!halfing){var charsToDelete=text.substr(text.length-breakchar.length,breakchar.length)===breakchar?breakchar.length:1;text=text.substr(0,text.length-charsToDelete);el.html(text+"...");ellipsis=true}}if(!ellipsis){var top=0;if(el.hasClass("Qv_middle")){top=(h-el.height())/2}else{if(el.hasClass("Qv_bottom")){top=h-el.height()}}el.parent().css("padding-top",top+"px")}}})};Qva.EncodeComponent=function(string){return encodeURIComponent(string)};Qva.DecodeComponent=function(string){return decodeURIComponent(string)};Qva.GetUniqueID=function(id){var newId=id;var i=2;while(document.getElementById(newId)){newId=id.toString()+"__"+i++}return newId};Qva.GetNetworkErrorMsg=function(){return"Network error, please try again"};Qva.GetXHRObject=function(){if(window.XMLHttpRequest){return new XMLHttpRequest()}else{if(!Qva.userAgentDetector.get("msie11Webview")){return new ActiveXObject("MSXML2.XMLHTTP")}else{return new ActiveXObject("MSXML2.XMLHTTP.3.0")}}};Qva.DoAjax=function(binder,url,cmd){var attempts=0;var retrypause=10;var getResend=function(errorMsg){attempts++;if(attempts>3){window.alert(errorMsg);binder.Ready()}else{window.setTimeout(attemptRequest,retrypause)}};var retryForLostConnection=function(){attempts++;if(attempts>3){return false}else{window.setTimeout(attemptRequest,500)}return true};var noConnection=function(xml){return(Qva.GetMessage(xml)==="No connection")};var attemptRequest=function(){var xmlhttp=Qva.GetXHRObject();xmlhttp.onerror=function(){getResend(Qva.GetNetworkErrorMsg())};xmlhttp.onreadystatechange=function(){if(xmlhttp===null){return}if(xmlhttp.readyState==4&&(xmlhttp.status==200||xmlhttp.status==0)){if(xmlhttp.responseXML){if(noConnection(xmlhttp.responseXML)&&retryForLostConnection()){delete xmlhttp.onreadystatechange;xmlhttp=null;return}binder.Doc=xmlhttp.responseXML}else{if(xmlhttp.responseText){Assert(false);binder.loadXML(xmlhttp.responseText)}}binder.Ready()}if(xmlhttp.readyState==4){if(xmlhttp.status>12000){getResend(Qva.GetNetworkErrorMsg())}else{if(xmlhttp.status===500){window.alert(xmlhttp.statusText);binder.Ready()}}delete xmlhttp.onreadystatechange;xmlhttp=null}};url=Qva.AddProxyIfAny(url);url=Qva.XrfSecure(url);xmlhttp.open("POST",url,true);try{xmlhttp.send(cmd)}catch(e){if(this.CommunicationError){this.CommunicationError(e)}else{window.alert("Communication error: "+e.message)}this.Enabled=true}};attemptRequest()};Qva.ApplyTransparentImageToElement=function(element){element.style.backgroundImage="url(data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7)";element.style.backgroundRepeat="no-repeat"};Qva.CreateRulesForSelectionColors=function(binder){var selectedBackgroundColor=Qva.Hex2CSSExpression(binder.SelectionStyleMgr.GetSelectionStyle("Selected").backgroundcolor);var lockedBackgroundColor=Qva.Hex2CSSExpression(binder.SelectionStyleMgr.GetSelectionStyle("Locked").backgroundcolor);$("<style>#ui-datepicker-div td.ui-state-highlight { background-color: "+selectedBackgroundColor+"; }\r\n#ui-datepicker-div .ui-state-highlight a { background-color: "+selectedBackgroundColor+"; }#ui-datepicker-div td.ui-state-highlight-locked { background-color: "+lockedBackgroundColor+"; }\r\n#ui-datepicker-div .ui-state-highlight-locked a { background-color: "+lockedBackgroundColor+"; }</style>").appendTo("head")};(function(){var scripts=document.getElementsByTagName("script");for(var i=0;i<scripts.length;i++){var src=scripts[i].src;var pos=src.toLowerCase().lastIndexOf("QvAjax.js".toLowerCase());if(pos>-1){var qstr=Qva.ExtractProperty("u",null,true,src);if(qstr!=null){Qva.Proxy=src.substr(0,src.indexOf("u=")-1);src=Qva.DecodeComponent(qstr);pos=src.toLowerCase().lastIndexOf("QvAjax.js".toLowerCase())}Qva.QvAjaxZfcPath=src.substr(0,pos-4);Qva.Remote=Qva.QvAjaxZfcPath+"QvsViewClient.aspx";break}}})();window.clone=clone;window.purge=purge;window.HtmlifyARGB=HtmlifyARGB;window.Assert=Assert;window.getClientWidth=getClientWidth;window.getClientHeight=getClientHeight;window.ctrlKeyPressed=ctrlKeyPressed;window.SetSearchableAndActives=SetSearchableAndActives;Qva.localization={languageInitialized:false,init:function(serverlang,callback){var lang=/[\?\&]lang=([^\&]+)/.exec(window.location.search),langFull;this.localizationData=[];switch(serverlang){case"Chinese":serverlang="zh-CN";break;case"ChineseTraditional":serverlang="zh-TW";break;case"Dutch":serverlang="nl-NL";break;case"French":serverlang="fr-FR";break;case"German":serverlang="de-DE";break;case"Italian":serverlang="it-IT";break;case"Japanese":serverlang="ja-JP";break;case"Korean":serverlang="ko-KR";break;case"Polish":serverlang="pl-PL";break;case"Portuguese":serverlang="pt-BR";break;case"Russian":serverlang="ru-RU";break;case"Spanish":serverlang="es-ES";break;case"Swedish":serverlang="sv-SE";break;case"Turkish":serverlang="tr-TR";break;default:serverlang="en-US"}langFull=lang!==null?lang[1]:serverlang;$.getJSON(Qva.QvAjaxZfcPath+"htc/lang/qvajax-"+langFull+".json",function(data){Qva.localization.localizationData=data;Qva.localization.lang=langFull;Qva.localization.languageInitialized=true;callback()})},getStringFromNode:function(node,prefix){var data={};Qva.ObjectifyXML(data,node);return this.getStringFromObject(data,prefix)},getStringFromObject:function(obj,prefix){if(prefix===undefined){prefix=""}else{prefix+="_"}if(!obj[prefix+"labelId"]){return undefined}var valuesObj={};if(obj[prefix+"d"]!==undefined){valuesObj["%d"]=obj[prefix+"d"].toString().split(";")}if(obj[prefix+"s"]!==undefined){valuesObj["%s"]=obj[prefix+"s"].toString().split(";")}if(obj[prefix+"o"]!==undefined){valuesObj["%o"]=[this.getStringFromKey("objectType"+obj[prefix+"o"])]}return this.getStringFromKey(obj[prefix+"labelId"],valuesObj)},getStringFromKey:function(strKey,values){if(strKey===null){return null}if(strKey===""){return""}try{var localizationData=this.localizationData||window.parent.Qva.localization.localizationData,text=localizationData[strKey],property}catch(err){}if(localizationData===undefined){console.log("no localization data");return}if(!text){console.log("undefined string: "+strKey);return""}for(property in values){if(values.hasOwnProperty(property)){values[property].forEach(function(item){text=text.replace(property,item)})}}return text},getTooltipText:function(node){var tooltip="",labelId=node.getAttribute("labelId"),value=node.getAttribute("value");if(labelId){tooltip+=this.getStringFromKey(labelId)+": ";if(labelId==="objectType"||value==="IDYes"||value==="IDNo"){tooltip+=this.getStringFromKey(value)}else{tooltip+=value}}else{tooltip=node.getAttribute("text")}return tooltip},localize:function(html){if(!this.isInitialized()){console.log("no localization data");return html}if(html.documentElement){}else{if(html.indexOf("<?xml")>-1){return html}}var $html=$(html),self=this;var count=0;$html.find("[data-localize]").each(function(index,item){count++;var elem=$(item);elem.text(self.getStringFromKey(elem.attr("data-localize")))});if(count===0){console.log("Warning! No strings to localize")}return $html[0].outerHTML},isInitialized:function(){try{return this.languageInitialized||window.parent.Qva.localization.languageInitialized}catch(err){return false}}};(function($,undefined){$.widget("ui.dynamicdropdown",$.ui.autocomplete,{_renderItem:function(ul,item){var wrappedTerm=$.ui.dynamicdropdown.highlightTerm(item.label||item.value||item||"",this.term),retItem=$("<li/>").data("item.autocomplete",item),termAnchor=$('<a class="prop-dyn-dynamic-dropdown-item"/>'),tooltip=item.tooltip||item.param||"",containsIcons=this.element[0].parentNode.dynamicDropdownContent.containsIcons;if(containsIcons){var icon=item.iconType&&item.iconType.length>0&&'<span class="caption-icon-16x16 prop-dropdown-icon prop-dropdown-'+item.iconType+'-icon"></span>'||"";wrappedTerm=icon+wrappedTerm;termAnchor.addClass("prop-dyn-dynamic-dropdown-item-padded")}if(item.category){wrappedTerm+='<span class="prop-dyn-dynamic-dropdown-category">'+$.ui.dynamicdropdown.highlightTerm(item.category,this.term)+"</span>"}return retItem.append(termAnchor.prop("title",tooltip).append(wrappedTerm)).appendTo(ul)},_initSource:function(){this.source=function(request,response){response($.ui.dynamicdropdown.filter(this.options.source,request.term))}}});$.extend($.ui.dynamicdropdown,{filter:function(array,term){term=term.split(" ");return $.grep(array,function(value){var match=true,str=(value.category||"")+(value.label||value.value||value||"");$.each(term,function(){match=match&&new RegExp($.ui.autocomplete.escapeRegex(this),"i").test(str)});return match})},highlightTerm:function(str,term){if(!term||term==""){return str}term=(term||"").split(" ");$.each(term,function(){str=str.replace(new RegExp($.ui.autocomplete.escapeRegex(this)+"(?!([^<]+)?>)","ig"),function(matchedTerm){return"<span class='prop-dyn-dynamic-dropdown-highlight'>"+matchedTerm+"</span>"})});return str}});$.extend($.ui.sortable.prototype,{_clear:function(event,noPropagation){this.reverting=false;var delayedTriggers=[],self=this;if(!this._noFinalSort&&this.currentItem[0].parentNode){this.placeholder.before(this.currentItem)}this._noFinalSort=null;if(this.helper[0]==this.currentItem[0]){for(var i in this._storedCSS){if(this._storedCSS[i]=="auto"||this._storedCSS[i]=="static"){this._storedCSS[i]=""}}this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else{this.currentItem.show()}if(this.fromOutside&&!noPropagation){delayedTriggers.push(function(event){this._trigger("receive",event,this._uiHash(this.fromOutside))})}if((this.fromOutside||this.domPosition.prev!=this.currentItem.prev().not(".ui-sortable-helper")[0]||this.domPosition.parent!=this.currentItem.parent()[0])&&!noPropagation){delayedTriggers.push(function(event){this._trigger("update",event,this._uiHash())})}if(!$.contains(this.element[0],this.currentItem[0])){if(!noPropagation){delayedTriggers.push(function(event){this._trigger("remove",event,this._uiHash())})}for(var i=this.containers.length-1;i>=0;i--){if($.ui.contains(this.containers[i].element[0],this.currentItem[0])&&!noPropagation){delayedTriggers.push((function(c){return function(event){c._trigger("receive",event,this._uiHash(this))}}).call(this,this.containers[i]));delayedTriggers.push((function(c){return function(event){c._trigger("update",event,this._uiHash(this))}}).call(this,this.containers[i]))}}}for(var i=this.containers.length-1;i>=0;i--){if(!noPropagation){delayedTriggers.push((function(c){return function(event){c._trigger("deactivate",event,this._uiHash(this))}}).call(this,this.containers[i]))}if(this.containers[i].containerCache.over){delayedTriggers.push((function(c){return function(event){c._trigger("out",event,this._uiHash(this))}}).call(this,this.containers[i]));this.containers[i].containerCache.over=0}}if(this._storedCursor){$("body").css("cursor",this._storedCursor)}if(this._storedOpacity){this.helper.css("opacity",this._storedOpacity)}if(this._storedZIndex){this.helper.css("zIndex",this._storedZIndex=="auto"?"":this._storedZIndex)}this.dragging=false;if(this.cancelHelperRemoval){if(!noPropagation){this._trigger("beforeStop",event,this._uiHash());for(var i=0;i<delayedTriggers.length;i++){delayedTriggers[i].call(this,event)}this._trigger("stop",event,this._uiHash())}return false}if(!noPropagation){this._trigger("beforeStop",event,this._uiHash())}if(this.placeholder[0].parentNode){this.placeholder[0].parentNode.removeChild(this.placeholder[0])}if(this.helper[0]!=this.currentItem[0]){this.helper.remove()}this.helper=null;if(!noPropagation){for(var i=0;i<delayedTriggers.length;i++){delayedTriggers[i].call(this,event)}this._trigger("stop",event,this._uiHash())}this.fromOutside=false;return true}});$.widget("ui.menu",$.ui.menu,{_isDivider:function(item){this.mouseHandled=false;return !/[^\-\u2014\u2013\s]/.test(item.text())}});if($.event.props&&$.event.props[0]!=="attrChange"){$.event.props.unshift("attrChange","attrName","relatedNode","srcElement")}Qva.jQueryOverRides=function(){var originalMethod=$.fn.offset;$.fn.offset=function(){var rect=originalMethod.apply(this,arguments);if(arguments.length===0&&rect!=undefined&&this[0]!=document.body){var bodyOffset=originalMethod.apply($("body"),arguments);if(bodyOffset){rect.top-=bodyOffset.top;rect.left-=bodyOffset.left}}return rect}}})($QvJq);(function($,undefined){if(!Qva.Mgr){Qva.Mgr={}}QvDragRect=function(){this.$Element=$("<div>");this.$Element.addClass("QvDragRect").css({position:"absolute","z-index":10000});this.$Element.insertBefore(document.body.firstChild);this.DragRect={left:0,top:0,width:0,height:0}};QvDragRect.prototype.Open=function(x,y){this.DragStartX=x;this.DragStartY=y};QvDragRect.prototype.Size=function(x,y){this.DragRect.left=Math.min(this.DragStartX,x);this.DragRect.top=Math.min(this.DragStartY,y);this.DragRect.width=Math.abs(x-this.DragStartX);this.DragRect.height=Math.abs(y-this.DragStartY);this.$Element.css(this.DragRect)};QvDragRect.prototype.Close=function(){this.$Element.remove()};Qva.DragRect={Rects:[],CurrentMgr:null,CurrentIndex:0,Open:function(X,Y,mgr){if((this.CurrentMgr&&this.CurrentMgr!=mgr)){this.Close()}this.CurrentMgr=mgr;if(this.Rects.length<=this.CurrentIndex){this.Rects[this.CurrentIndex]=new QvDragRect()}this.Rects[this.CurrentIndex].Open(X,Y)},Size:function(X,Y){this.Rects[this.CurrentIndex].Size(X,Y)},End:function(X,Y,mgr,ctrlpressed){this.Size(X,Y);if(ctrlpressed){this.CurrentIndex++}else{if(this.CurrentMgr.HandleSelection){this.MakeSelection()}this.Close()}},SendSelection:function(keyCode){if(this.CurrentMgr&&(keyCode==17||keyCode==224||keyCode==91)){if(this.CurrentMgr.HandleSelection){this.MakeSelection()}this.Close()}},MakeSelection:function(){var array=[];var ElemCoords=$(this.CurrentMgr.Element).offset();for(var i=0;i<this.Rects.length;i++){array[array.length]={left:this.Rects[i].DragRect.left-ElemCoords.left,top:this.Rects[i].DragRect.top-ElemCoords.top,width:this.Rects[i].DragRect.width,height:this.Rects[i].DragRect.height}}this.CurrentMgr.HandleSelection(array)},Close:function(){while(this.Rects.length){var rect=this.Rects.pop();rect.Close()}this.CurrentMgr=null;this.CurrentIndex=0}};Qva.Clicks={List:[],CurrentMgr:null,Click:function(event,mgr,ctrlpressed){if(this.CurrentMgr&&this.CurrentMgr!=mgr){this.Close()}this.CurrentMgr=mgr;if(this.CurrentMgr&&this.CurrentMgr.HandleClick){var ElemCoords=$(this.CurrentMgr.Element).offset();var click={offsetX:Qva.Events.getX(event)-ElemCoords.left,offsetY:Qva.Events.getY(event)-ElemCoords.top};if(ctrlpressed){this.List[this.List.length]=click}else{this.List[0]=click;this.CurrentMgr.HandleClick(this.List);this.Close()}}},SendSelection:function(keyCode){if(this.CurrentMgr&&this.CurrentMgr.HandleClick&&(keyCode==17||keyCode==224||keyCode==91)){this.CurrentMgr.HandleClick(this.List);this.Close()}},Close:function(){this.List.length=0;this.CurrentMgr=null}};Qva.SelectionRectManager=function(mgr){var _this=this;var Clicking=true;var $document=$(document);var StartoffsetX;var StartoffsetY;var ElemCoords;var $elem=$(mgr.Element);this.SendSelection=function(event){Qva.DragRect.SendSelection(event.keyCode);Qva.Clicks.SendSelection(event.keyCode)};this.WaitForCtrlToRelease=function(fn){if(!_this.ctrlKeyUpEventDefined){_this.ctrlKeyUpEventDefined=true;$(document).on("keyup.ctrlselect",function(event){var ctrl=ctrlKeyPressed(event);if(!ctrl){fn(event);$(document).off("keyup.ctrlselect")}_this.ctrlKeyUpEventDefined=false})}};Qva.Events.AddClickEvent(mgr.Element,function(event){if(!mgr.IsSelectable){return}var ctrlpressed=ctrlKeyPressed(event);Qva.Clicks.Click(event,mgr,ctrlpressed);if(ctrlpressed){_this.WaitForCtrlToRelease(function(event){Qva.Clicks.SendSelection(event.keyCode)})}},{xns:".clickselect",nostop:true});Qva.Events.AddDragSelectEvent(mgr.Element,function(event){if(!mgr.IsSelectable){return false}var elemoffset=$elem.offset();ElemCoords={top:elemoffset.top,left:elemoffset.left,right:(elemoffset.left+$elem.width()),bottom:(elemoffset.top+$elem.height())};StartoffsetX=Qva.Events.getX(event);StartoffsetY=Qva.Events.getY(event);Qva.BlurActiveElement();Qva.DragRect.Open(StartoffsetX,StartoffsetY,mgr)},function(event){var x=Math.min(Math.max(Qva.Events.getX(event),ElemCoords.left),ElemCoords.right);var y=Math.min(Math.max(Qva.Events.getY(event),ElemCoords.top),ElemCoords.bottom);Qva.DragRect.Size(x,y)},function(event){var ctrlpressed=ctrlKeyPressed(event);Qva.DragRect.End(Qva.Events.getX(event),Qva.Events.getY(event),mgr,ctrlpressed);if(ctrlKeyPressed){_this.WaitForCtrlToRelease(function(event){_this.SendSelection(event)})}},{useDocumentForMoveEvent:true})};Qva.enableSelectionRect=function(mgr){if(Qva.userAgentDetector.get("touchEnabled")){Qva.Touch.Chart.AddTouchSupport(mgr)}return new Qva.SelectionRectManager(mgr)}})(window.$QvJq);(function($,undefined){if(!Qva.Mgr){Qva.Mgr={}}Qva.Mgr.menu=function(owner,elem,name,prefix){$.extend(this,{Name:Qva.MgrMakeName((name!=null)?name:"",prefix),Element:elem,binderid:owner.binderid});$(elem).data("qvManager",this);Qva.Events.AddContextmenu(elem,function(){return false});owner.AddManager(this);owner.Append(this,this.Name,"menu")};Qva.Mgr.menu.doAction=function(e){if(e.handled){return}e.handled=true;var li=$(Qva.Events.getTarget(e)).closest("li"),parent=li.closest("ul"),liData=li.data("qvData"),mgr=parent.data("qvManager"),binder=mgr&&Qva.GetBinder(mgr.binderid),cursor=Qva.ContextMenu?Qva.ContextMenu.X+":"+Qva.ContextMenu.Y:e.pageX+":"+e.pageY,specialFn;if(!binder||!liData||!liData.action&&!liData.clientAction||li.is(".ctx-menu-disabled, .ctx-menu-action-Bookmarks, .ctx-menu-action-Reports, .ctx-menu-has-submenu")||(e&&e.which==3)){return}specialFn=Qva.Mgr.menu.specialActions[liData.action];if(specialFn){liData.binder=binder;liData.item=li;if(specialFn(liData)===false){return}}if(liData.clientAction){Qva.ContextClientAction({clientAction:liData.clientAction,param:liData.param,name:liData.action,binder:binder,event:e,cursor:cursor})}else{if(liData.action){var obj={action:"",clientsizeWH:Qva.GetViewportWidth()+":"+Qva.GetViewportHeight(),position:liData.index||mgr.Position||"",cursor:cursor};if(liData.param&&liData.param.title){obj.title=liData.param.title}binder.Set(mgr.Context+"."+liData.action||mgr.ObjectId,obj)}}Qva.HideContextMenu();Qva.Mgr.menu.closeSubMenu(e)};Qva.Mgr.menu.createIcon=function(name){return $("<span/>").addClass("cell-icon cell-"+name.replace(/\./g,"_")+"-icon")};Qva.Mgr.menu.createOptions=function($elem,objects,mgr){var self=this,opts=[];if(Qva.menuHelper){Qva.menuHelper.limitContextmenu({elem:$elem,objects:objects,mgr:mgr})}$.each(objects,function(){if((Qva.params.transientMenuOpen&&this.name==="DELETE")===false){opts.push(self.createOption($elem,this,mgr))}});$elem.append(opts);$elem.removeClass("ctx-menu-no-icons ctx-menu-contains-submenus");if(!$elem.find("> li:not(.ctx-menu-has-submenu) > a > .cell-icon").length){$elem.addClass("ctx-menu-no-icons")}if($elem.find("> .ctx-menu-has-submenu").length){$elem.addClass("ctx-menu-contains-submenus")}};Qva.Mgr.menu.createOption=function($elem,obj,mgr){var name=obj.name||"",text=(obj.text||"").toString().split(/\n/)[0],index=(obj.index||"").toString().split(":")[0],shortcut=Qva.SpecialActions.GetShortcutText(name),hasIcon=!!obj.icon,hasSubMenu=!!obj.submenu,inSubMenu=$elem.parent().is("li"),forToolbar=Qva.Mgr.toolbar?mgr instanceof Qva.Mgr.toolbar:false,isToggled=!!obj.showpane,isSessionEnabled=obj.sharing&&obj.sharing=="true",isDisabled=obj.mode&&obj.mode!=="enabled",$oldOpt=$elem.find(".ctx-menu-action-"+name),$opt=$('<li class="cf"><a href="javascript:;"></a></li>').addClass("ctx-menu-action-"+name),ul,doc=$(document);$opt.data("qvData",{action:name,param:obj.param,index:obj.index,clientAction:obj.clientaction,obj:obj,mgr:mgr});if(!obj.mode){$.extend($opt.data("qvData"),{isSpecial:true,obj:obj})}if(isDisabled){$opt.addClass("ctx-menu-disabled")}if(name==="Bookmarks"||name==="Reports"){new Qva.Mgr[name.toLowerCase()+"select"](mgr.PageBinder,$("<select/>").appendTo($opt.find("a").remove().end())[0],"Document."+name);if($oldOpt.length){return null}return $opt[0]}if(name==="ADDSHEET"){$opt.data("qvData").param=$.extend($opt.data("qvData").param,{title:Qva.localization.getStringFromKey("SHEETPROPS")})}if(text){if(text===" "||text===""){text="&nbsp;"}if(typeof obj.text==="number"&&name==="CYCLEDIM"&&index!==""){text=text+": "+index}else{if(name==="COLLABORATION"){text=Qva.localization.getStringFromObject(obj)}else{if(name!=="CYCLEDIM"&&name!=="CYCLEEXP"){text=Qva.localization.getStringFromKey(hasSubMenu&&obj.label?obj.label:name)}}}if(forToolbar&&hasIcon&&!inSubMenu&&(name!=="CLEARSTATE"&&name!=="COLLABORATION"&&name!=="FOLDOUTDOWN"&&name!=="HELP")){!isDisabled&&$opt.addClass("ctx-menu-icon-only").attr("title",text)}else{$('<span class="ctx-menu-text"/>').html(text).appendTo($opt.find("a"))}}if(!forToolbar&&shortcut){$opt.find("a").append('<span class="ctx-menu-shortcut">'+shortcut+"</span>")}if(hasSubMenu){ul=$('<ul class="ctx-menu ctx-menu-submenu popup-shadow"/>').data("qvManager",mgr).appendTo($opt.addClass("ctx-menu-has-submenu"));if(!hasIcon){$opt.append(Qva.Mgr.menu.createIcon("FOLDOUT"))}Qva.Mgr.menu.createOptions(ul,obj.action||[],mgr)}if(hasIcon&&name){$opt.find(">a").prepend(Qva.Mgr.menu.createIcon(obj.name))}if(obj.type==="divider"){$opt.addClass("ctx-menu-divider").find("a").remove()}$opt[isSessionEnabled?"addClass":"removeClass"]("sharing-active");if(obj.sharing){doc.unbind(".toolbarshare");if(obj.showpane){doc.bind("click.toolbarshare",function _unclick(e){if(!$(e.target).closest(".Qv_SessionCollaboration, .ctx-menu-action-COLLABORATION").length){Qva.Mgr.menu.specialActions.COLLABORATION({binder:Qva.GetBinder(mgr.binderid)});doc.unbind(".toolbarshare")}})}}if(isToggled||mgr.ToggleStates&&mgr.ToggleStates[name]){$opt.addClass("active").find(".cell-icon").addClass("cell-invert")}if($oldOpt.length){$elem.find(".ctx-menu-action-"+name).replaceWith($opt);return null}return $opt[0]};Qva.Mgr.menu.doHighlight=function(){var cl="toggleClass",target=$(this).closest("li");if(target.is(".ctx-menu-disabled")){return}target[cl]("active").find("> .cell-icon, > a > .cell-icon")[cl]("cell-invert")};Qva.Mgr.menu.doSubMenu=function(e){var cl="toggleClass",vis="toggle",body=$(document.body),target=$(Qva.Events.getTarget(e)).closest(".ctx-menu-has-submenu");target[cl]("active").find("> .cell-icon, > a > .cell-icon")[cl]("cell-invert").end().find("> ul")[vis]()};Qva.Mgr.menu.closeSubMenu=function(e){var cl="removeClass",vis="hide",target=e?$(Qva.Events.getTarget(e)).closest(".ctx-menu-has-submenu"):$(".ctx-menu-has-submenu");setTimeout(function(){target[cl]("active").find("> .cell-icon, > a > .cell-icon")[cl]("cell-invert").end().find("> ul")[vis]()},0)};Qva.Mgr.menu.prototype.Paint=function(mode,node){var self=this,$elem=$(self.Element),$node=$(node),ctx=$node.attr("context");$.extend(self,{Touched:true,Context:self.PageBinder.DefaultScope+"."+ctx,ObjectId:ctx,Position:$node.attr("position")});this.MenuData={};Qva.ObjectifyXML(this.MenuData,node);if(!this.MenuData.action){$elem.hide();return}var elemFrame=$('.QvFrame[id="'+this.ObjectId+'"]');if(elemFrame.length){for(var itemIndex=0,len=this.MenuData.action.length;itemIndex<len;itemIndex++){if(this.MenuData.action[itemIndex].name==="COPY"){if(elemFrame.find(".QvSelected").length>0&&elemFrame.attr("objsubtype")==="LB"){this.MenuData.action.splice(itemIndex+1,0,{enabled:true,mode:"enabled",name:"CopySelectionsToClipboard",text:"Copy selections to clipboard",objId:this.ObjectId})}if(elemFrame.attr("objtype")==="Grid"||elemFrame.attr("objsubtype")==="LB"){if(Qva.ContextMenuMgr.targetElem.nodeName!=="IMG"&&!(elemFrame.attr("objsubtype")==="MB"&&Qva.ContextMenuMgr.targetElem.parentElement.getAttribute("title")==="")){this.MenuData.action.splice(itemIndex+1,0,{enabled:true,mode:"enabled",name:"CopyCellValueToClipboard",text:"Copy cell value to clipboard",objId:this.ObjectId})}}break}}}Qva.Mgr.menu.createOptions($elem,this.MenuData.action,this);if($elem[0].children.length>0){$elem.show()}else{$elem.hide()}$(Qva.ContextMenu).css({width:"auto"});if(Qva.ContextMenu){var top=Qva.ContextMenu.Y;left=Qva.ContextMenu.X;var nW=Qva.Mgr.menu.fixContextMenuWidth($elem);if(top+$elem.height()-$(window).scrollTop()>Qva.GetViewportHeight()){top=Math.max(0,top-$elem.height())}if(left+nW-$(window).scrollLeft()>Qva.GetViewportWidth()){left=Math.max(0,left-nW)}if(top!=Qva.ContextMenu.Y||left!=Qva.ContextMenu.X){var ctxMenu=$(Qva.ContextMenu);ctxMenu.css({left:left,top:top,width:((nW==0)?"auto":nW)})}}};Qva.Mgr.menu.fixContextMenuWidth=function(elem){var w,wt=0,sP=0,sh=elem.find("span.ctx-menu-shortcut");sh.each(function(){var ob=$(this).parent();w=0,wt;ob.find("span").each(function(){w+=parseFloat($(this).outerWidth())});if(wt<w){wt=w}});sh.parentsUntil("ul").each(function(){sP+=parseFloat($(this).css("padding-left"));sP+=parseFloat($(this).css("padding-right"))});wt+=sP;return wt};Qva.Mgr.menu.addEvents=function(elem){Qva.Events.AddClickEvent(elem,Qva.Mgr.menu.doAction,{xns:".menu",startEffect:Qva.Mgr.menu.doHighlight,endEffect:Qva.Mgr.menu.doHighlight,preventDefault:true,stopPropagation:true});Qva.Events.AddClickEvent(elem,Qva.Mgr.menu.doSubMenu,{xns:".menu",preventDefault:true,stopPropagation:true})};Qva.Mgr.menu.specialActions={HELP:function(data){Qva.Help.Show(data.obj.url)},CopySelectionsToClipboard:function(){var selectedCells=$('.QvFrame[id="'+Qva.ContextMenuMgr.ObjectId+'"]').find(".QvSelected");if(selectedCells.length){var tmpElem=$("<textarea>").css({position:"absolute",left:"-9000px",});selectedCells.each(function(index,item){var textToCopy="",textNodes=$(item).find(":not(iframe)").contents().filter(function(i,item){return item.nodeType===3});textNodes.each(function(index,node){if(index>0){textToCopy+="\t"}textToCopy+=$(node).text()});if(tmpElem.val().length){tmpElem.val(tmpElem.val()+"\n"+textToCopy)}else{tmpElem.val(textToCopy)}});$("body").append(tmpElem);tmpElem.select();tmpElem[0].setSelectionRange(0,tmpElem.val().length);try{document.execCommand("copy")}catch(err){console.log("Copy selections failed:",err)}}},CopyCellValueToClipboard:function(){var value=Qva.ContextMenuMgr.targetElem.parentElement.getAttribute("title");if(value&&value.length){var tmpElem=$("<textarea>").css({position:"absolute",left:"-9000px",});tmpElem.val(value);$("body").append(tmpElem);tmpElem.select();tmpElem[0].setSelectionRange(0,value.length);try{document.execCommand("copy")}catch(err){console.log("Copy cell value failed:",err)}}},ACTIVATEMOVE:function(data){var action=data.action;data.mgr.ToggleStates[action]=!data.mgr.ToggleStates[action];$(data.item[0]).closest("li").toggleClass("active");Qva.Events.moveActiveForTouch=data.mgr.ToggleStates[action];$(".TouchOnlyMoveZone").each(function(i,obj){obj.style.display=Qva.Events.moveActiveForTouch?"":"none"})},ACTIVATERESIZE:function(data){var action=data.action;data.mgr.ToggleStates[action]=!data.mgr.ToggleStates[action];$(data.item[0]).closest("li").toggleClass("active");Qva.Events.resizeActiveForTouch=data.mgr.ToggleStates[action];if(Qva.Events.resizeActiveForTouch){if(Qva.ActiveObjects&&Qva.ActiveObjects.length>0){var elem=document.getElementById(Qva.ActiveObjects[0]);if(elem&&elem.AvqMgr){elem.touchResize=true;elem.AvqMgr.UpdateMoveAndResizeHandles(elem);Qva.oldTouchActiveElement=elem}}}else{if(Qva.oldTouchActiveElement&&Qva.oldTouchActiveElement.AvqMgr){Qva.oldTouchActiveElement.touchResize=false;var oldborderwidth=isNaN(Qva.oldTouchActiveElement.AvqMgr.BorderWidth)?0:Qva.oldTouchActiveElement.AvqMgr.BorderWidth;Qva.Mgr.CreateAndUpdateResizeHandles(Qva.oldTouchActiveElement,Qva.oldTouchActiveElement.AvqMgr.BorderAroundContent?0:oldborderwidth)}}},ACTIVATEMOVECOLUMN:function(data){var action=data.action;data.mgr.ToggleStates[action]=!data.mgr.ToggleStates[action];$(data.item[0]).closest("li").toggleClass("active");Qva.Events.moveColumnsActiveForTouch=data.mgr.ToggleStates[action]},ACTIVATERESIZECOLUMN:function(data){var action=data.action;data.mgr.ToggleStates[action]=!data.mgr.ToggleStates[action];$(data.item[0]).closest("li").toggleClass("active");Qva.Events.resizeColumnsActiveForTouch=data.mgr.ToggleStates[action]}};Qva.ContextClientAction=function(options){var parts=options.param&&options.param.split(":")||[],url,name,msg;if(options.clientAction=="modal"&&Qva.Modal.instance!=null){url=Qva.Remote+(Qva.Remote.indexOf("?")>=0?"&":"?");url+="public=only&name="+parts[0]+".htm&target="+Qva.EncodeComponent(options.name),parseInt(parts[1]),parseInt(parts[2]);if(window.IS_QVCLIENT){Qva.ModalDialogs.open(options.binder,parts[0],url)}else{Qva.Modal.instance.Show(options.binder,url)}}else{if(options.clientAction=="inputfield"){Qva.OpenPopupInput(options.element)}else{if(options.clientAction=="confirm"){name=options.name+"."+parts[0];msg=parts.slice(1).join(":");if(window.confirm(msg)){options.binder.Set(name,"action","",true)}}else{if(options.clientAction=="url"){window.open(options.param)}else{if(options.clientAction=="bundledurl"){var url=options.binder.BuildBinaryUrl(null,"",options.param);window.open(url)}else{if(options.clientAction=="popup"){Qva.ShowMessagePopup(elem.param,options.binder)}else{if(options.clientAction=="menu"){options.binder.OnContextMenu(options.event,(event.target||event.srcElement).ObjectId);return}else{alert("Not supported clientside action: "+options.clientAction)}}}}}}}Qva.HideContextMenu()};Qva.DefaultOnCreateContextMenu=function(binder,event,fullname,position,coords){var ctxMenu=$(Qva.ContextMenu),srcObjId=$(event.currentTarget).attr("owner"),objtype="";objtype=($("#"+srcObjId).attr("objtype"))||$(event.currentTarget).attr("objtype");if(objtype&&objtype!=""){ctxMenu.attr("objtype",objtype)}if(Qva.ContextMenu==null){Qva.ContextMenuBackground=$("<div/>").css({position:"absolute",left:"0px",top:"0px",height:"100%",width:"100%","z-index":"9999"}).appendTo("body")[0];Qva.ContextMenu=$('<ul class="ctx-menu popup-shadow"/>').hide().appendTo("body")[0];Qva.Events.AddClickEvent(Qva.ContextMenuBackground,Qva.OnDocumentClick,{xns:".documentClick"});Qva.Events.AddContextmenu(Qva.ContextMenuBackground,Qva.OnDocumentClick);Qva.ContextMenuMgr=new Qva.Mgr.menu(binder,Qva.ContextMenu,binder.DefaultScope+".Menu");ctxMenu=$(Qva.ContextMenu);Qva.Mgr.menu.addEvents(Qva.ContextMenu)}else{if(Qva.ContextMenuMgr.binderid!=binder.binderid){Qva.ContextMenuMgr.PageBinder.RemoveFromManagers(Qva.ContextMenuMgr);Qva.ContextMenuMgr.PageBinder.RemoveFromMembers(Qva.ContextMenuMgr);Qva.ContextMenuMgr=new Qva.Mgr.menu(binder,Qva.ContextMenu,binder.DefaultScope+".Menu")}$(Qva.ContextMenuBackground).show();ctxMenu.show().empty()}coords=coords||{x:Qva.Events.getX(event),y:Qva.Events.getY(event)};var viewportWidth=Qva.GetViewportWidth()+Qva.GetScrollLeft();if(coords.x>(viewportWidth-140)){coords.x=viewportWidth<140?0:(viewportWidth-140)}Qva.ContextMenu.X=coords.x;Qva.ContextMenu.Y=coords.y;Qva.ContextMenuMgr.targetElem=event.target;ctxMenu.css({left:coords.x,top:coords.y});binder.GetMenu(fullname,position);return false};Qva.HideContextMenu=function(ignoreDialog){Qva.Mgr.menu.closeSubMenu();if(Qva.ContextMenu){$(Qva.ContextMenu).hide();$(Qva.ContextMenuBackground).hide()}}})($QvJq);(function($,undefined){if(!Qva.Mgr){Qva.Mgr={}}Qva.Mgr.toolbar=function(owner,elem,name,prefix){var $elem=$(elem),self=this;name=Qva.MgrMakeName((name!=null)?name:"",prefix);self.ToggleStates={};Qva.StandardActions=self;$.extend(self,{Name:name,Element:elem,binderid:owner.binderid,Context:"Document.StandardActions"});$.each([{name:"Annotations",internal:"TOGGLENOTES"},{name:"CurrentSelection",internal:"CS"},{name:"TOOLS\\REPOSITORY",internal:"REPOSITORY"},{name:"TOOLS\\NEWSHEETOBJ",internal:"NEWSHEETOBJ"},{name:"TOOLS\\SHOWFIELDS",internal:"SHOWFIELDS"}],function(){var obj=this;owner.SubscribeToVisibility(obj.name,function(isVisible){var cl=isVisible?"addClass":"removeClass";$elem.find(".cell-"+obj.internal+"-icon")[cl]("cell-invert").closest("li")[cl]("active");self.ToggleStates[obj.internal]=isVisible})});owner.Append(this,name,"toolbar");owner.AddManager(this);Qva.Mgr.menu.addEvents(elem)};Qva.Mgr.toolbar.getModifiedObjects=function(a,b){var ret;ret=$.map(a,function(o,i){for(var k in o){if(!b.hasOwnProperty(i)||(o.hasOwnProperty(k)&&o[k]!==b[i][k])){return o}}return null});return ret};Qva.Mgr.toolbar.prototype.createOptions=function(objects){this.listElement=this.listElement||$('<ul id="QvAjaxToolbar-left" class="ctx-menu ui-helper-clearfix"/>').data("qvManager",this).appendTo(this.Element);Qva.Mgr.menu.createOptions(this.listElement,objects,this)};Qva.Mgr.toolbar.prototype.Paint=function(mode,node){if(mode=="h"){this.Element.style.display="none";return}var elem=$(this.Element),close,objects=[];this.Touched=true;this.oldLayout=this.Layout;this.Layout={};Qva.ObjectifyXML(this.Layout,node);$("#Close").find(".ctx-menu-text").text(Qva.localization.getStringFromKey("Close")).end()[0].RestoreText=Qva.localization.getStringFromKey("Restore");this.PageBinder.QueuePostPaintMessage(this)};Qva.Mgr.toolbar.prototype.PostPaint=function(){if(this.PageBinder.PaintToolbar){this.PostPaintCustom=this.PageBinder.PaintToolbar;this.PostPaintCustom()}else{this.PostPaintDefault()}};Qva.Mgr.toolbar.prototype.PostPaintDefault=function(){var self=this,layout=self.Layout,elem=$(self.Element),more={action:self.Layout.help||[],name:"FOLDOUTDOWN",text:this.PageBinder.Translations.More,icon:"true",submenu:"true"},$toolbar=$("#QvAjaxToolbar"),vpW=Qva.GetViewportWidth(),$win=$(window);if(self.oldLayout){$.each(["action","select","collaboration"],function(){objects=objects.concat(Qva.Mgr.toolbar.getModifiedObjects(layout[this]||[],self.oldLayout[this]||[]))})}else{objects=layout.action.concat(layout.select||[]).concat(layout.collaboration||[])}var moreActionArray=["DBGINFO","MAILASLINK","SUPPORTINFO"];if(Qva.userAgentDetector.get("touchEnabled")){more.action.push({icon:"true",name:"SMALLDEVICES",text:this.PageBinder.Translations.SwitchToSmallDevices});moreActionArray=moreActionArray.concat(["CS","REPOSITORY","NEWSHEETOBJ","SHOWFIELDS"])}objects=$.map(objects,function(o){if($.inArray(o.name,moreActionArray)>=0){more.action.push(o);return null}return o});if(Qva.userAgentDetector.get("touchEnabled")){var actionArray=[];actionArray.push({name:"ACTIVATEMOVE",text:this.PageBinder.Translations.ToggleTouchMove||"Move objects"});actionArray.push({name:"ACTIVATERESIZE",text:this.PageBinder.Translations.ToggleTouchResize||"Resize objects"});actionArray.push({name:"ACTIVATEMOVECOLUMN",text:this.PageBinder.Translations.ToggleTouchMoveColumn||"Move columns"});var pos=6;$.each(actionArray,function(){more.action.splice(pos++,0,this)})}self.createOptions(objects);self.moreMenu=$(self.moreMenu||Qva.Mgr.menu.createOption(self.listElement,more,self)).find("ul").addClass("ctx-menu-shadow").end();self.listElement.append(self.moreMenu);if(layout.collaboration){self.PostPaintSharedSession();$(self.SharedSessionDiv).css({top:$toolbar.height(),left:$(".cell-COLLABORATION-icon").offset().left-7})}elem.find(".ctx-menu-divider").remove();elem.find("> ul > li").after('<li class="ctx-menu-divider"/>');$toolbar.css({width:vpW+"px"})};Qva.Mgr.toolbar.prototype.PostPaintSharedSession=function(){if(!this.Layout.collaboration){if(this.SharedSessionDiv){$(this.SharedSessionDiv).hide()}return}var div=this.SharedSessionDiv;if(!div){div=this.SharedSessionDiv=document.createElement("div");div.onclick=Qva.CancelAction;Qva.SetContextMenu(div,Qva.CancelAction);div.className="Qv_SessionCollaboration ctx-menu-shadow";div.style.display="none";document.body.appendChild(div);var that=this;this.PageBinder.LoadHtml("SessionCollaboration.qvpp",function(body){div.innerHTML=body;$(div).find("*[data-action]").each(function(){var name=this.getAttribute("data-action");Qva.Events.AddClickEvent(this,onclick_action);this.Action="Document.SessionCollaboration."+name;this.binderid=that.binderid});$(div).children().children().hide();that.PageBinder.QueuePostPaintMessage(that)})}var collaboration=this.Layout.collaboration[0];var parts=$(div).children().children();if(collaboration.showpane){$(div).show()}if(!collaboration.showpane&&(parts.length==0||parts.length==6)){$(div).hide()}if(parts.length>0){if(collaboration.timeout){$(div).find('*[data-value="timeout"]').text(collaboration.timeout+" "+Qva.localization.getStringFromKey("minutes"))}if(collaboration.participants){$(div).find('*[data-value="participants"]').html(collaboration.participants)}if(collaboration.inviteurl){var inviteurl=Qva.ReplaceOpenDoc(collaboration.inviteurl);inviteurl=Qva.FixUrl(inviteurl,"lang",Qva.localization.lang);var $textarea=$(div).find("textarea");$textarea.click(function(){$(this).focus().select()});if($textarea.val()!==inviteurl){$textarea.val(inviteurl)}var mailto="mailto:?subject="+Qva.EncodeComponent(inviteurl)+"&body="+Qva.EncodeComponent(inviteurl);$(div).find('a[data-value="mail"]').attr("href",mailto)}var l=collaboration.parts.split(",");var add_hr=false;for(var i=0;i<l.length;++i){var fn=l[i]?"show":"hide";$(parts[i])[fn]()}$(div).find('*[data-action="LeaveSession"]').click(function(){$(div).hide()});if(collaboration.participant){var list=$(div).find('*[data-list="Participants"]');var i=collaboration.participant.length-1;var lis=list.children("li");for(var j=lis.length-1;j>=0;--j){var id=lis[j].s_id;if(i>=0&&collaboration.participant[i].id===id){--i}else{$(lis[j]).slideUp(function(){$(this).remove()})}}for(;i>=0;--i){var li=$("<li></li>").hide().prependTo(list);var a=$('<a class="prop-sortable-list-close-button-position" style="float: right;"></a>').append('<span class="prop-icon-24x24 prop-sortable-list-close-button"></span>').appendTo(li)[0];$("<span></span>").text(collaboration.participant[i].name).appendTo(li);li[0].s_id=collaboration.participant[i].id;a.Action="Document.SessionCollaboration.Participants.Remove";a.Position=collaboration.participant[i].id;a.binderid=this.PageBinder.ID;Qva.Events.AddClickEvent(a,onclick_action);li.slideDown()}}if(collaboration.indication){for(var i=0;i<collaboration.indication.length;++i){$(div).show();var j=$('<div><b></b><br /><span style="font-size: 7pt; color: gray;"></span></div>');j.find("b").text(collaboration.indication[i].name);j.find("span").text(collaboration.indication[i].action);j.appendTo(div);j.slideDown(200).delay(1000).slideUp(300,function(){$(this).remove();if($(div).children().children(":visible").length==0){$(div).hide()}})}}}};Qva.Mgr.menu.specialActions.COLLABORATION=function(data){data.binder.Set("Document.SessionCollaboration.TogglePane",{action:"",clientsizeWH:Qva.GetViewportWidth()+":"+Qva.GetViewportHeight()})};Qva.Mgr.menu.specialActions.SMALLDEVICES=function(){location.href=location.href.replace("opendoc.htm","mobile/opendoc.htm");return false};$.each(["REPOSITORY","NEWSHEETOBJ","SHOWFIELDS"],function(i,o){var str=o;Qva.Mgr.menu.specialActions[str]=function(data){if(data.mgr.ToggleStates&&data.mgr.ToggleStates[str]){data.binder.SimpleCall("set","Document.TOOLS\\"+str+".CX",null,{action:""});return false}}})})($QvJq);(function($,undefined){if(!Qva.Mgr){Qva.Mgr={}}Qva.Mgr.graph=function(owner,elem,name,prefix){elem.Name=this.Name=Qva.MgrMakeName(name,prefix);elem.binderid=owner.binderid;elem.ObjectId=owner.Element.ObjectId;elem.isgraph=true;this.AutoSize=elem.style.width=="auto"&&elem.style.height=="auto";owner.AddManager(this);this.Element=elem;this.ScrollBars=[];this.HotSpots=[];this.IsSelectable=true;this.SelectionMgr=Qva.enableSelectionRect(this);var ownerShow=owner.oldShow=owner.Show;owner.Show=function(){};this.Show=function(){ownerShow.call(owner)};var hover=Qva.GetBinder(elem.binderid).GetHoverDiv();hover.style.display="none";elem.style.display="none";elem.LastHoverPos={};Qva.Events.AddOverEvent(elem,function(event){if(!this.hover){return}var binder=Qva.GetBinder(this.binderid);if(!binder){return}var name=this.Name;var hoverPos={x:Qva.Events.getX(event),y:Qva.Events.getY(event)};if(hoverPos.x===this.LastHoverPos.x&&hoverPos.y===this.LastHoverPos.y){return}this.LastHoverPos=hoverPos;hover.style.left=hoverPos.x+10+"px";hover.style.top=hoverPos.y+5+"px";hover.style.display="none";var pos=Qva.GetPageCoords(this);var click=(Qva.Events.getClientX(event)-pos.x)+":"+(Qva.Events.getClientY(event)-pos.y);if(this.hoverTimout){this.hoverTimout=clearTimeout(this.hoverTimout)}this.hoverTimout=setTimeout(function(){if(Qva.IsContextOpen()){return}if(!binder.GetEnabled()){return}binder.Hover(name,click)},500)},function(event){if(this.hoverTimout){this.hoverTimout=clearTimeout(this.hoverTimout)}},{xns:".graphhover"});elem.style.cursor="crosshair"};Qva.Mgr.graph.prototype.Remove=function(){if(Qva.Touch.SelectionPopup&&Qva.Touch.SelectionPopup.ChartElement==this.Element){Qva.Touch.SelectionPopup.Hide()}$(this.Element).html("").remove()};Qva.Mgr.graph.prototype.IsSliding=function(){var retvalue=false;if(!this.ScrollBars){return retvalue}else{for(var iScroll=0;iScroll<this.ScrollBars.length;iScroll++){retvalue=this.ScrollBars[iScroll].isSliding;if(retvalue){break}}}return retvalue};Qva.Mgr.graph.prototype.Unlock=function(){this.Touched=true;if(this.Element.style.display!="none"){this.PostPaint()}};GraphScrollBar.prototype.Step=function(pos){var binder=this.PageBinder;if(!this.PageBinder.IsValid()){return}if(this.ScrollId==null&&pos==this.Pos){return}var name=this.Name;var params={};if(this.ScrollId!=null){params.id=this.ScrollId;params.scrollpos=pos}else{var step=pos-this.Pos;params.scrollstep=step}binder.Set(name,params)};GraphScrollBar.prototype.createScrollEnd=function(top,left,height,width,color,firstbutton){var div=document.createElement("div");if(this.IsXScroll){div.style.top=(top+1)+"px";left++;if(!firstbutton){left+=(width-height)}div.style.left=left+"px";height-=2;div.style.height=height+"px";div.style.width=height+"px"}else{div.style.left=(left+1)+"px";top++;if(!firstbutton){top+=(height-width)}div.style.top=top+"px";width-=2;div.style.height=width+"px";div.style.width=width+"px"}div.style.cursor="pointer";div.style.position="absolute";div.firstbutton=firstbutton;var position,points;if(this.IsXScroll){position=[parseInt(height/2)-1,parseInt(height/2)-3];points=firstbutton?[[2,0],[0,3],[2,6]]:[[0,0],[2,3],[0,6]]}else{position=[parseInt(width/2)-3,parseInt(width/2)];points=firstbutton?[[0,2],[3,0],[6,2]]:[[0,0],[3,2],[6,0]]}var size=[9,9];var _this=this;Qva.Events.AddClickEvent(div,function(event){var pos=this.firstbutton?_this.Pos-1:_this.Pos+1;if(pos>=0){_this.Step(pos)}});return div};function GraphScrollBar(mgr,parent,top,left,width,height,color,bkgcolor,max,page,pos,isxscroll,id){var o_scroll=document.createElement("div");o_scroll.style.backgroundColor=bkgcolor;o_scroll.style.opacity="0.001";o_scroll.style.filter="alpha(opacity=0.001)";o_scroll.style.cursor="pointer";o_scroll.style.position="absolute";this.binderid=mgr.Element.binderid;this.PageBinder=mgr.PageBinder;this.Name=mgr.Name;this.IsXScroll=isxscroll;this.ScrollId=id;var _this=this;var stepTimer;_this.isSliding=false;this.G=SelectInitGraphics();mgr.actions={step:function(step){if(stepTimer){clearTimeout(stepTimer);stepTimer=null}_this.isSliding=true;_this.Step(_this.Pos+(step>0?-_this.Page:_this.Page));stepTimer=setTimeout(function(){_this.isSliding=false},300)}};Qva.AddMouseScroll(mgr);Qva.Events.AddClickEvent(o_scroll,function(event){var relpos=Qva.GetPageCoords(this);var px;var scrollpos;if(_this.IsXScroll){px=_this.ScrollStart+Qva.Events.getX(event)-relpos.x;scrollpos=parseInt(_this.Pos*_this.ScrollLength/_this.Page)+_this.ScrollStart+parseInt(_this.firstbutton.style.width)}else{px=_this.ScrollStart+Qva.Events.getY(event)-relpos.y;scrollpos=parseInt(_this.Pos*_this.ScrollLength/_this.Page)+_this.ScrollStart+parseInt(_this.firstbutton.style.height)}var pos=px<(scrollpos)?(_this.Pos-_this.Page)>0?_this.Pos-_this.Page:0:Math.min(_this.Pos+_this.Page,(_this.Max-_this.Page));if(pos>=0){_this.UpdateSliderPos(pos);_this.Step(pos)}});var i_scroll=document.createElement("div");i_scroll.style.cursor="pointer";i_scroll.style.position="absolute";var Update=function(event,mouseup){var px,pos;if(_this.IsXScroll){px=i_scroll.scrollZero+Qva.Events.getX(event)-i_scroll.mouseZero}else{px=i_scroll.scrollZero+Qva.Events.getY(event)-i_scroll.mouseZero}if(px<_this.ScrollStart){px=_this.ScrollStart;pos=0}else{if(px>_this.ScrollStop){px=_this.ScrollStop;pos=_this.Max-_this.Page}else{pos=Math.round((px-_this.ScrollStart)*_this.Page/_this.ScrollLength)}}if(_this.IsXScroll){i_scroll.style.left=px+"px"}else{i_scroll.style.top=px+"px"}var synchronizeScroll=function(currentpos){if(_this.PageBinder.IsValid()&&!_this.PageBinder.GetDocumentMgr().IsUpdating){_this.Step(currentpos)}else{setTimeout(function(){synchronizeScroll(currentpos)},100)}};if(_this.Pos!=pos){if(_this.thread){clearTimeout(_this.thread)}_this.thread=setTimeout(function(){synchronizeScroll(pos)},100)}if(mouseup){_this.isSliding=false}};Qva.Events.AddDragEvent(i_scroll,function(event){if(_this.IsXScroll){i_scroll.mouseZero=Qva.Events.getX(event);i_scroll.scrollZero=i_scroll.offsetLeft}else{i_scroll.mouseZero=Qva.Events.getY(event);i_scroll.scrollZero=i_scroll.offsetTop}},function(event){Update(event,false);_this.isSliding=true},function(event){Update(event,true);_this.i_Scroll.mouseZero=null});Qva.Events.AddClickEvent(i_scroll,function(event){if(_this.IsXScroll){i_scroll.mouseZero=Qva.Events.getX(event);i_scroll.scrollZero=i_scroll.offsetLeft}else{i_scroll.mouseZero=Qva.Events.getY(event);i_scroll.scrollZero=i_scroll.offsetTop}Update(event,true)});this.o_Scroll=o_scroll;this.i_Scroll=i_scroll;parent.appendChild(o_scroll);parent.appendChild(i_scroll);this.UpdateScrollSize(top,left,width,height,max,page,pos,color,bkgcolor)}GraphScrollBar.prototype.UpdateScrollPos=function(pos){if(!isNaN(pos)){this.Pos=pos}if(!this.isSliding){this.UpdateSliderPos(pos)}};GraphScrollBar.prototype.UpdateSliderPos=function(pos){var newstart=parseInt(pos*this.ScrollLength/this.Page)+this.ScrollStart;if(newstart>this.ScrollStop){newstart=this.ScrollStop}if(this.IsXScroll){this.i_Scroll.style.left=newstart+"px"}else{this.i_Scroll.style.top=newstart+"px"}};GraphScrollBar.prototype.UpdateScrollSize=function(top,left,width,height,max,page,pos,color,bgColor){if(this.Top!=top||this.Left!=left||this.Height!=height||this.Width!=width){this.Height=height;this.Top=top;this.Left=left;this.Width=width;this.o_Scroll.style.height=height+"px";this.o_Scroll.style.top=top+"px";this.o_Scroll.style.left=left+"px";this.o_Scroll.style.width=Math.max(0,width)+"px";if(this.IsXScroll){this.i_Scroll.style.height=Math.max(1,height-4)+"px";this.i_Scroll.style.top=top+1+"px";this.i_Scroll.style.left=(height+left)+"px"}else{this.i_Scroll.style.top=(width+top)+"px";this.i_Scroll.style.left=(left+1)+"px";this.i_Scroll.style.width=Math.max(1,width-4)+"px"}var parent=this.o_Scroll.parentNode;if(this.firstbutton){parent.removeChild(this.firstbutton);parent.removeChild(this.lastbutton)}var firstbutton=this.createScrollEnd(top,left,height,width,color,true);var lastbutton=this.createScrollEnd(top,left,height,width,color,false);this.firstbutton=firstbutton;this.lastbutton=lastbutton;parent.appendChild(firstbutton);parent.appendChild(lastbutton)}this.Page=page;this.Max=max;var maxpos=this.Max-this.Page;if(this.IsXScroll){this.ScrollStart=this.o_Scroll.offsetLeft+parseInt(this.Height);this.ScrollLength=parseFloat((this.Width-2*(this.Height))*this.Page/this.Max);this.ScrollLengthVisible=(this.ScrollLength>5)?parseInt(this.ScrollLength):5;this.ScrollStop=parseInt(maxpos*this.ScrollLength/this.Page)+this.ScrollStart-(this.ScrollLengthVisible-parseInt(this.ScrollLength));this.i_Scroll.style.width=this.ScrollLengthVisible+"px"}else{this.ScrollStart=this.o_Scroll.offsetTop+parseInt(this.Width);this.ScrollLength=parseFloat((this.Height-2*(this.Width))*this.Page/this.Max);this.ScrollLengthVisible=(this.ScrollLength>5)?parseInt(this.ScrollLength):5;this.ScrollStop=parseInt(maxpos*this.ScrollLength/this.Page)+this.ScrollStart-(this.ScrollLengthVisible-parseInt(this.ScrollLength));this.i_Scroll.style.height=this.ScrollLengthVisible+"px"}this.UpdateScrollPos(pos)};GraphScrollBar.prototype.GetOffset=function(px){var totlength;if(this.IsXScroll){totlength=this.o_Scroll.offsetWidth-2*this.Height}else{totlength=this.o_Scroll.offsetHeight-2*this.Width}return Math.round(this.Page*px/totlength)};Qva.Mgr.graph.prototype.RemoveScrollBars=function(){for(var iScroll=0;iScroll<this.ScrollBars.length;iScroll++){this.Element.parentNode.removeChild(this.ScrollBars[iScroll].o_Scroll);this.Element.parentNode.removeChild(this.ScrollBars[iScroll].i_Scroll);this.Element.parentNode.removeChild(this.ScrollBars[iScroll].firstbutton);this.Element.parentNode.removeChild(this.ScrollBars[iScroll].lastbutton)}this.ScrollBars.length=0};Qva.Mgr.graph.prototype.Paint=function(mode,node){this.Touched=true;var element=this.Element,that=this;element.style.display=Qva.MgrGetDisplayFromMode(this,mode);if(element.style.display=="none"){return}var disabled=(mode!="e");element.disabled=disabled;var IsSelectable=node.getAttribute("selectable")!=="false";if(this.IsSelectable!=IsSelectable){if(IsSelectable){element.style.cursor="crosshair"}else{element.style.cursor=""}}this.IsSelectable=IsSelectable;element.hover=node.getAttribute("hover")==="true";var scrollnodes=node.getElementsByTagName("scroll");if(scrollnodes.length>0){var update=false;for(var iScroll=0;iScroll<scrollnodes.length;iScroll++){var scrollnode=scrollnodes[iScroll];var id=scrollnode.getAttribute("id");var isxscroll=scrollnode.getAttribute("horizontal")=="true";if(this.ScrollBars[iScroll]){if(this.ScrollBars[iScroll].ScrollId!=id||this.ScrollBars[iScroll].IsXScroll!=isxscroll){update=false;break}else{update=true}}else{update=false;break}}if(!update&&this.ScrollBars.length>0){this.RemoveScrollBars()}for(var iScroll=0;iScroll<scrollnodes.length;iScroll++){var scrollnode=scrollnodes[iScroll];var max=parseInt(scrollnode.getAttribute("max"));var page=parseInt(scrollnode.getAttribute("page"));var pos=parseInt(scrollnode.getAttribute("pos"));var top=parseInt(scrollnode.getAttribute("top"));var left=parseInt(scrollnode.getAttribute("left"));var height=parseInt(scrollnode.getAttribute("height"));var width=parseInt(scrollnode.getAttribute("width"));var color=HtmlifyARGB(scrollnode.getAttribute("color"));var bkgcolor=HtmlifyARGB(scrollnode.getAttribute("bkgcolor"));if(this.ScrollBars[iScroll]){if(!this.ScrollBars[iScroll].i_Scroll.mouseZero){this.ScrollBars[iScroll].UpdateScrollSize(top,left,width,height,max,page,pos,color,bkgcolor)}else{this.ScrollBars[iScroll].UpdateScrollPos(pos)}}else{if(width>2&&height>2){var id=scrollnode.getAttribute("id");var isxscroll=scrollnode.getAttribute("horizontal")=="true";this.ScrollBars[iScroll]=new GraphScrollBar(this,element.parentNode,top,left,width,height,color,bkgcolor,max,page,pos,isxscroll,scrollnode.getAttribute("id"))}}}}else{this.RemoveScrollBars()}for(var iHS=0;iHS<this.HotSpots.length;iHS++){this.Element.parentNode.removeChild(this.HotSpots[iHS])}this.HotSpots.length=0;var hotspotnodes=node.getElementsByTagName("hotspot");if(hotspotnodes.length>0){for(var iHS=0;iHS<hotspotnodes.length;iHS++){var hotspotnode=hotspotnodes[iHS];var top=parseInt(hotspotnode.getAttribute("top"));var left=parseInt(hotspotnode.getAttribute("left"));var height=parseInt(hotspotnode.getAttribute("height"));var width=parseInt(hotspotnode.getAttribute("width"));var hotspot=document.createElement("div");hotspot.className="Qv_Hotspot";hotspot.style.cursor="pointer";hotspot.style.position="absolute";hotspot.style.top=top+"px";hotspot.style.left=left+"px";hotspot.style.height=height+"px";hotspot.style.width=width+"px";hotspot.index=hotspotnode.getAttribute("index");hotspot.Name=element.Name;hotspot.binderid=element.binderid;Qva.Events.AddClickEvent(hotspot,function(event){Qva.GetBinder(this.binderid).SetClick(Qva.Events.getOriginalEvent(event),this.Name,this)},{xns:".hotspot"});element.parentNode.appendChild(hotspot);this.HotSpots[iHS]=hotspot}}var stamp=node.getAttribute("stamp");if(stamp!="0"){var name=stamp?this.Name:node.getAttribute("name");if(element.disabled){name+=".DISABLED"}var url=this.PageBinder.BuildBinaryUrl(node.getAttribute("path"),stamp,name);this.avq_url=url}this.PageBinder.QueuePostPaintMessage(this)};Qva.Mgr.graph.prototype.PostPaint=function(){var self=this,elem=this.Element,state="valid";if(elem.style.display=="none"){return}var $elem=$(elem);if(this.AutoSize){this.PageBinder.SetObjectWidth(0);this.PageBinder.SetObjectHeight(0)}var url=this.avq_url;var sizeupdated=false;if(elem.style.width!=""&&elem.style.height!=""){var objectbinder=Qva.GetObjectBinder(elem);var graphsize=objectbinder.GetImageSize(elem);if(this.GraphWidth!=graphsize.width||this.GraphHeight!=graphsize.height){this.GraphWidth=graphsize.width;this.GraphHeight=graphsize.height;sizeupdated=true;if(this.avq_url){elem.style.visibility="hidden"}}url+="&width="+Qva.EncodeComponent(graphsize.width)+"&height="+Qva.EncodeComponent(graphsize.height)}if(objectbinder.Element.ObjectId&&Qva.params.objects){state=Qva.params.objects[objectbinder.Element.ObjectId]}if(this.avq_url&&state!=="invalid"){var img=new Image();if(!this.IsSliding()){img.onload=function(){if(location.port!=21544){if(!(img.width==graphsize.width&&img.height==graphsize.height)){return}}$elem.attr("src",img.src);elem.style.visibility="visible";img=null;self.Show();Qva.flags.hotspotClicked=false}}else{elem.style.visibility="visible";img=elem;self.Show()}url=Qva.AddProxyIfAny(url);url=Qva.XrfSecure(url);img.src=url}else{self.Show()}if(sizeupdated){this.PageBinder.SetSize(this.Name,this.GraphWidth+":"+this.GraphHeight)}elem.style.display="block"};Qva.Mgr.graph.prototype.HandleSelection=function(rects){var params={};params.rects="";params.rect=[];for(var i=0;i<rects.length;i++){params.rect[params.rect.length]=""+rects[i].left+":"+rects[i].top+":"+rects[i].width+":"+rects[i].height}this.PageBinder.Set(this.Name,params)};Qva.Mgr.graph.prototype.HandleClick=function(clicks){var objectbinder=Qva.GetObjectBinder(this.Element);var graphsize=objectbinder.GetImageSize(this.Element);var params={};params.clicks="";params.click=[];for(var i=0;i<clicks.length;i++){params.click[params.click.length]=""+clicks[i].offsetX+":"+clicks[i].offsetY+":"+graphsize.width+":"+graphsize.height}this.PageBinder.Set(this.Name,params)}})(window.$QvJq);(function($,undefined){if(!Qva.Mgr){Qva.Mgr={}}window.onclick_action=function(event){if(this.disabled){return}if(this.disableAction){return}var binder=Qva.GetBinder(this.binderid);var current_focus=document.activeElement;if(current_focus){if(current_focus.onchange){current_focus.onchange()}else{$(current_focus).trigger("change")}current_focus.blur()}var params={};if(this.Position!=null){params.position=this.Position}params.action="";params.clientsizeWH=Qva.GetViewportWidth()+":"+Qva.GetViewportHeight();if(this.NeedCursor){if(Qva.ContextMenu){params.cursor=Qva.ContextMenu.X+":"+Qva.ContextMenu.Y}else{if(!event){event=window.event}params.cursor=(event.clientX+Qva.GetScrollLeft())+":"+(event.clientY+Qva.GetScrollTop())}}if(this.sheettitle){params.title=this.sheettitle}binder.Set(this.Action||this.ObjectId,params);Qva.HideContextMenu()};window.onclick_ContextClientAction=function(event){Qva.GetBinder(this.binderid).ContextClientAction(event,this)};Qva.Mgr.show=function(owner,elem,name,prefix,condition){if(!Qva.MgrSplit(this,name,prefix)){return}this.Condition=condition;this.Conditions=condition.split(",");owner.AddManager(this);this.Element=elem;owner.Append(this,this.Name,"value");this.Element.style.display="none"};Qva.Mgr.show.prototype.Paint=function(mode,node){this.Touched=true;var show=false,padBot="0px",margTop="0px";if(mode=="n"){show=(this.ModeIfNotEnabled=="d")}else{var attr=node.getAttribute("value");if(!attr){attr=node.getAttribute("text")}if(this.Conditions.length){for(var i=0;i<this.Conditions.length;i++){if(attr==this.Conditions[i]){show=true;break}}}else{show=(attr==this.Condition)}}this.Element.style.display=show?"":"none";if(Qva.UrlParams.isQmc&&window.frameElement&&window.frameElement.id!=="popupFrame2"&&($(this.Element).parents("#TriggerExpire").length>0||$(this.Element).parents("#TriggerConstraints").length>0)){if($(this.Element).parents("#TriggerExpire")[0]){$(this.Element).parents("#TriggerExpire")[0].style.display=show?"":"none";if(!show){padBot="135px"}else{margTop="10px"}$("#AllTriggers").css("padding-bottom",padBot);$(this.Element).parents("#TriggerExpire").css("marginTop",margTop);$("body").find(".PageFooter").css({position:"relative","float":"right"})}if($(this.Element).parents("#TriggerConstraints")[0]){$(this.Element).parents("#TriggerConstraints")[0].style.display=show?"":"none";$("#AllTriggers").css("padding-bottom",show?"0px":"135px")}}};Qva.Mgr.hide=function(owner,elem,name,prefix,condition){if(!Qva.MgrSplit(this,name,prefix)){return}this.Condition=condition;this.Element=elem;owner.AddManager(this);owner.Append(this,this.Name,"value")};Qva.Mgr.hide.prototype.Paint=function(mode,node){this.Touched=true;var hide;if(mode=="n"){if(this.Condition==null){hide=(this.ModeIfNotEnabled!="d")}else{hide=false}}else{var attr=node.getAttribute("value");if(!attr){attr=node.getAttribute("text")}hide=(attr==this.Condition)}this.Element.style.display=hide?"none":""};Qva.Mgr.disable=function(owner,elem,name,prefix){this.Name=Qva.MgrMakeName(name,prefix);this.Element=elem;owner.AddManager(this)};Qva.Mgr.disable.prototype.Lock=Qva.LockDisabled;Qva.Mgr.disable.prototype.Unlock=Qva.UnlockDisabled;Qva.Mgr.disable.prototype.Paint=function(mode,node){this.Touched=true;var element=this.Element;element.disabled=(mode!="e");element.style.display=Qva.MgrGetDisplayFromMode(this,mode)};Qva.Mgr.background=function(owner,elem,name,prefix){if(!Qva.MgrSplit(this,name,prefix)){return}owner.AddManager(this);this.Element=elem;elem.binderid=owner.binderid;this.AutoSize=elem.tagName=="DIV";owner.BackgroundMgr=this};Qva.Mgr.background.prototype.SetBackgroundPosition=function(){if(!this.HasBkgImage){return}var element=this.Element;var isBody=element===document.body;var offset=isBody?Qva.GetAbsolutePageCoords(document.getElementById("PageContainer")).y:0;if(isBody){var toolbar=Qva.GetToolbarElement();if(toolbar){offset-=Qva.GetAbsolutePageCoords(toolbar).y}}this.backgroundPosition=this.Layout.bkgposition||"left top";if(this.backgroundPosition.search("top")!=-1){if(Qva.userAgentDetector.get("chrome")){element.style.backgroundPosition="0px "+offset+"px"}else{element.style.backgroundPosition=this.backgroundPosition.replace("top",offset+"px")}}else{element.style.backgroundPosition=this.backgroundPosition}};Qva.Mgr.background.prototype.PostPaint2=function(){if(this.HasBkgImage){var element=this.Element;var isBody=element===document.body;if(isBody){if(!this.BodyPaintPostponed){var binder=this.PageBinder;var _this=this;$(Qva.EventServer).one("OnUpdateComplete",function(){binder.QueuePostPaintMessage(_this)});this.BodyPaintPostponed=true;return}else{this.BodyPaintPostponed=false}}var offset=isBody?Qva.GetAbsolutePageCoords(document.getElementById("PageContainer")).y:0;var url=this.avq_url,eleHeight=0;if(this.AutoSize){var width=getClientWidth(element);if(width===0&&!isBody){width=$(element).width()}var height=isBody?Qva.GetDocHeight():getClientHeight(element);if(isNaN(width)||isNaN(height)){if(isBody){width=parseInt(Qva.GetViewportWidth());height=parseInt(Qva.GetViewportHeight())}else{Assert(false)}}height-=offset;if(this.PageBinder.IsHosted&&this.PageBinder.SetSize){if(this.Height!=height||this.Width!=width){this.Height=height;this.Width=width;this.PageBinder.SetSize(this.PageBinder.Name||this.Name,this.Width+":"+this.Height)}}url+="&width="+Qva.EncodeComponent(width);if(element.firstChild&&element.firstChild.className==="QvListbox"){var $pEle=$(element.parentNode);eleHeight=$pEle.height()-$pEle.children(".QvCaption").height()-(!isNaN($pEle.css("bottomBorderWidth"))?$pEle.css("bottomBorderWidth")*2:parseFloat($pEle[0].style.borderWidth)*2)}else{if($(element).closest(".QvFrame")[0]){var $pEle=$(element).closest(".QvFrame"),cHeight=0,cEle=$pEle.find(".QvCaption");if(typeof cEle.height()!=="undefined"){cHeight=cEle.height()}eleHeight=parseFloat($pEle.height())-cHeight}else{eleHeight=parseFloat($(element).height())}}url+="&height="+(isBody?height:eleHeight);url=Qva.AddProxyIfAny(url);url=Qva.XrfSecure(url)}if(this.HasBkgImage){this.appliedurl=url;url=url.replace("'","%27");if(isBody&&element.style.backgroundImage.length){element.style.backgroundImage="url('"+url+"'), "+element.style.backgroundImage}else{element.style.backgroundImage="url('"+url+"')"}}else{this.appliedurl="";element.style.backgroundImage=""}this.SetBackgroundPosition();if(element!=document.body){element.style.backgroundRepeat="no-repeat"}}};Qva.Mgr.background.prototype.Paint=function(mode,node,name){this.Touched=true;this.Layout={};Qva.ObjectifyXML(this.Layout,node);this.PageBinder.QueuePostPaintMessage(this)};Qva.Mgr.background.prototype.PostPaint=function(){if(this.PageBinder.PaintBackground){this.PostPaintCustom=this.PageBinder.PaintBackground;this.PostPaintCustom()}else{if(this.PageBinder.PageBinder&&this.PageBinder.PageBinder.PaintBackground){this.PostPaintCustom=this.PageBinder.PageBinder.PaintBackground;this.PostPaintCustom()}else{this.PostPaintDefault()}}};Qva.Mgr.background.prototype.PostPaintDefault=function(){if(!this.Layout){this.PostPaint2();return}var element=this.Element,stamp=this.Layout.stamp?this.Layout.stamp:null,gradientOK=Qva.userAgentDetector.get("webkit")||(Qva.userAgentDetector.get("gecko")&&Qva.userAgentDetector.get("geckoVersion")>=3.6)||Qva.userAgentDetector.get("msieDocMode")>8,bkgApplied=false;this.HasBkgImage=this.Layout.image!=null;this.avq_url=null;if(!this.HasBkgImage){this.appliedurl="";element.style.backgroundImage="";element.style.backgroundColor="";if(Qva.userAgentDetector.get("msie")&&Qva.userAgentDetector.get("msieDocMode")<=8){Qva.ApplyTransparentImageToElement(element)}}if(Qva.userAgentDetector.get("msie")&&Qva.userAgentDetector.get("msieDocMode")>8){element.style.filter=""}var isBody=element===document.body;if(isBody&&this.HasBkgImage){gradientOK=false}if(!this.HasBkgImage||isBody){var useFallbackForGradient=(!gradientOK&&stamp===null)||isBody;bkgApplied=Qva.ApplyColorDataToElement(this.Layout,element,true,false);if(!bkgApplied){this.HasBkgImage=this.HasBkgImage||(stamp&&stamp!="0")}}if(this.HasBkgImage){this.avq_url=this.PageBinder.BuildBinaryUrl(this.Layout.path,stamp,this.Name)}if(element===document.body){if(this.Layout.bkgcolor){element.style.backgroundColor=HtmlifyARGB(this.Layout.bkgcolor)}this.backgroundPosition=this.Layout.bkgposition||"left top";if(this.Layout.bkgrepeat){element.style.backgroundRepeat=this.Layout.bkgrepeat}if(this.Layout.opacity){if(Qva.userAgentDetector.get("webkit")||Qva.userAgentDetector.get("opera")){element.style.opacity=parseFloat(this.Layout.opacity)}else{if(Qva.userAgentDetector.get("gecko")){element.style.MozOpacity=parseFloat(this.Layout.opacity)}else{element.style.filter="alpha(opacity:"+parseFloat(this.Layout.opacity)*100+")"}}}if(!this.Layout.bkgposition&&this.Layout.bkgrepeat!="repeat"){this.AutoSize=true}}if(this.HasBkgImage){this.PostPaint2()}};Qva.Mgr.background.prototype.Remove=function(){this.Element.style.backgroundImage="";this.Element.style.background=""};Qva.Mgr.fullsize=function(owner,elem,name,prefix){if(!Qva.MgrSplit(this,name,prefix)){return}owner.AddManager(this);this.Element=elem;this.AutoSize=elem.style.width=="auto"&&elem.style.height=="auto"&&this.PageBinder.Element;if(!this.AutoSize){this.PostPaint=null}};Qva.Mgr.fullsize.prototype.PostPaint=function(){var element=this.Element;if(element.style.display=="none"){return}if(this.AutoSize){this.PageBinder.SetObjectWidth(0);this.PageBinder.SetObjectHeight(0);if(element.tagName=="DIV"){if(!$(element).parent().hasClass("lockedheight")){var newheight=this.PageBinder.GetContentMaxHeight(element);if(!isNaN(newheight)){element.style.height=newheight+"px"}}if(Qva.userAgentDetector.get("chrome")&&element.style.width=="auto"){element.style.width="100%"}}}else{Assert(false)}};Qva.Mgr.fullsize.prototype.Paint=function(){this.Touched=true};Qva.Mgr.fullsize.prototype.Remove=function(){Qva.RemoveElement(this.Element)};Qva.Mgr.visibility=function(owner,elem,name,prefix){if(!Qva.MgrSplit(this,name,prefix)){return}owner.AddManager(this);this.Element=elem};Qva.Mgr.visibility.prototype.Paint=function(mode){this.Touched=true;this.Element.style.display=Qva.MgrGetDisplayFromMode(this,mode)};Qva.Mgr.visibility.prototype.Remove=function(){$(this.Element).find("div").remove();$(this.Element).html("").remove()};Qva.Mgr.label=function(owner,elem,name,prefix){if(!Qva.MgrSplit(this,name,prefix)){return}owner.AddManager(this);this.Element=elem;this.AutoSize=elem.style.width=="auto"&&elem.style.height=="auto"&&this.PageBinder.Element;if(!this.AutoSize){this.PostPaint=null}};Qva.Mgr.label.prototype.PostPaint=function(){var element=this.Element;if(element.style.display=="none"){return}if(this.AutoSize){this.PageBinder.SetObjectWidth(0);this.PageBinder.SetObjectHeight(0);if(element.tagName=="DIV"){var newheight=this.PageBinder.GetContentHeight();if(!isNaN(newheight)){element.style.height=newheight+"px"}}}};Qva.Mgr.label.prototype.Paint=function(mode,node){this.Touched=true;var element=this.Element;element.style.display=Qva.MgrGetDisplayFromMode(this,mode);if(this.AutoSize&&element.style.display!="none"){this.PageBinder.QueuePostPaintMessage(this)}};Qva.Mgr.inline=function(owner,elem,name,prefix){if(!Qva.MgrSplit(this,name,prefix)){return}owner.AddManager(this);this.Element=elem};Qva.Mgr.inline.prototype.Paint=function(mode,node){this.Touched=true;var element=this.Element;element.style.display=Qva.MgrGetDisplayFromMode(this,mode);if(element.style.display=="none"){return}element.innerHTML="";var svg=node.removeChild(node.firstChild);element.appendChild(svg)};Qva.Mgr.edit=function(owner,elem,name,prefix){if(!Qva.MgrSplit(this,name,prefix)){return}owner.AddManager(this);this.Element=elem;owner.Append(this,this.Name,"choice")};Qva.Mgr.edit.prototype.Paint=function(mode,node,name){this.Touched=true;var element=this.Element,text;text=node.getAttribute("text");if(name==this.ToolTip&&text){element.title=text;return}if(node.getAttribute("title")!=null){element.title=node.getAttribute("title")}else{if(this.Name===this.ToolTip&&text){element.title=text}}var attrValue="";if(mode!="n"){attrValue=node.getAttribute(this.Attr);switch(this.Attr){case"value":if(node.getAttribute("text")==""){attrValue=""}break;case"color":if(node.getAttribute("color")&&node.getAttribute("bkgcolor")){element.style.color=node.getAttribute("color");element.style.backgroundColor=node.getAttribute("bkgcolor");return}}}if(attrValue==""&&this.TextIfNull){attrValue=this.TextIfNull}var text,localized=false;if(this.Dec!=null){text=Qva.Trunc(attrValue,this.Dec)}else{if(this.Name.indexOf("NEWSHEETOBJ")>-1&&attrValue.indexOf("objectType")===0){text=Qva.localization.getStringFromKey(attrValue);localized=true}else{if(this.Name==="Document.ContextDialog.Title"){text=Qva.localization.getStringFromKey(attrValue);localized=true}else{text=attrValue}}}if(name==="Chart.ChartType"){text=Qva.localization.getStringFromKey(name+"."+node.getAttribute("value"));localized=true}else{if(node.getAttribute("name").indexOf("Type")>=0){text=Qva.localization.getStringFromKey("Type."+node.getAttribute("value"));localized=true}else{var labelId=node.getAttribute("labelId");if(labelId){text=Qva.localization.getStringFromNode(node);localized=true}}}var defaultTextId=node.getAttribute("defaulttextid");if(defaultTextId&&defaultTextId==="bookmarkobjectaddbutton.defaultstring"){text=Qva.localization.getStringFromKey("ADDBM");localized=true}else{if(defaultTextId&&defaultTextId==="bookmarkobjectremovebutton.defaultstring"){text=Qva.localization.getStringFromKey("REMBM");localized=true}}if(localized&&element.title===node.getAttribute("text")){element.title=text}if(element.tagName=="INPUT"||element.tagName=="TEXTAREA"){element.value=text}else{element.innerHTML=Qva.ConvertToBr(text)}element.style.display=Qva.MgrGetDisplayFromMode(this,mode)};Qva.Mgr.dsi=function(owner,elem,name,prefix){if(!Qva.MgrSplit(this,name,prefix)){return}owner.AddManager(this);this.Element=elem};Qva.Mgr.dsi.prototype.Paint=function(mode,node,name){this.Touched=true;var element=this.Element;var lines=node.getAttribute("text").split(";");element.value=lines.join("\n");element.style.display="block"};Qva.Mgr.inputcheckbox=function(owner,elem,name,prefix,condition){if(!Qva.MgrSplit(this,name,prefix)){return}this.Element=elem;owner.AddManager(this);if(condition!=null){var sep=condition.substr(1,1);var parts=condition.split(sep);this.Conditional=(parts[0]=="-")?-1:1;var alt1=(parts.length>1)?parts[1]:"";var alt2=(parts.length>2)?parts[2]:null;elem.True=(this.Conditional>0)?alt1:alt2;elem.False=(this.Conditional<0)?alt1:alt2}else{this.Conditional=0;elem.True="1";elem.False="0";this.Attr="value"}elem.Name=this.Name;elem.Attr=this.Attr;elem.binderid=owner.binderid;Qva.Events.AddChangeEvent(elem,Qva.Mgr.inputcheckbox.OnClick);owner.Append(this,this.Name,"choice")};Qva.Mgr.inputcheckbox.prototype.Lock=Qva.LockDisabled;Qva.Mgr.inputcheckbox.prototype.Unlock=Qva.UnlockDisabled;Qva.Mgr.inputcheckbox.prototype.Paint=function(mode,node){this.Touched=true;var element=this.Element;var val=node.getAttribute(this.Attr);if(this.Conditional<0){element.checked=(val!=element.False)}else{element.checked=(val==element.True)}var choices=node.getElementsByTagName("choice");if(choices.length==0){element.disabled=(mode!="e")}else{choices=choices[0].getElementsByTagName("element");var range=choices.length;if(range>1){element.disabled=(mode!="e")}else{element.disabled=true}}this.Locked=element.disabled;element.style.display=Qva.MgrGetDisplayFromMode(this,mode)};Qva.Mgr.inputcheckbox.OnClick=function(){var binder=Qva.GetBinder(this.binderid);if(!binder.Enabled){return}var newval=this.checked?this.True:this.False;if(newval!=null){binder.Set(this.Name,this.Attr,newval,true)}else{newval=this.checked?this.False:this.True;binder.Set(this.Name,"count","-"+newval,true)}};Qva.Mgr.inputradio=function(owner,elem,name,prefix){if(!Qva.MgrSplit(this,name,prefix)){return}this.Element=elem;elem.Name=this.Name;elem.name=this.Name;elem.Attr=this.Attr;elem.binderid=owner.binderid;owner.AddManager(this);Qva.Events.AddClickEvent(elem,function(){var binder=Qva.GetBinder(this.binderid);if(!binder.Enabled){return}binder.Set(this.Name,this.Attr,this.getAttribute("value"),true)},{stopPropagation:true});owner.Append(this,this.Name,"choice")};Qva.Mgr.inputradio.prototype.PostScan=function(scanner){var CheckIf=this.Element.getAttribute(scanner.Prefix+"checkif");if(CheckIf){this.CheckIf=new Function("value","return "+CheckIf)}};Qva.Mgr.inputradio.prototype.Lock=Qva.LockDisabled;Qva.Mgr.inputradio.prototype.Unlock=Qva.UnlockDisabled;Qva.Mgr.inputradio.prototype.Paint=function(mode,node){this.Touched=true;var element=this.Element;var value=node.getAttribute(this.Attr);if(value==null){value=node.getAttribute("value")}if(this.CheckIf){element.checked=this.CheckIf(value)}else{element.checked=(element.getAttribute("value")==value)}element.disabled=(mode!="e");if(mode=="e"&&!element.checked){var choices=node.getElementsByTagName("choice");if(choices.length>=1){element.disabled=true;choices=choices[0].getElementsByTagName("element");var cholen=choices.length;for(var ix=0;ix<cholen;++ix){if(choices[ix].getAttribute(this.Attr)==element.getAttribute("value")){element.disabled=false;break}}}}this.Locked=element.disabled;element.style.display=Qva.MgrGetDisplayFromMode(this,mode)};Qva.Mgr.inputtext=function(owner,elem,name,prefix,condition){if(!Qva.MgrSplit(this,name,prefix)){return}this.Element=elem;this.Condition=condition;elem.Name=this.Name;elem.binderid=owner.binderid;elem.Attr=this.Attr;var _this=this,$ele=$(elem),click="";owner.AddManager(this);click=function(event){Qva.ActiveObjectsCloak=true;if(!event){event=window.event}event.cancelBubble=true};Qva.Events.AddClickEvent(elem,click,{preventDefault:false});Qva.Events.AddChangeEvent(elem,function(){var binder=Qva.GetBinder(this.binderid);if(_this.Value==this.value){return}if(this.value==""){binder.Set(this.Name,"text","",true)}else{binder.Set(this.Name,this.Attr,this.value,true)}});elem.onfocus=function(){Qva.ActiveObjectsCloak=true;if(!this.EmptyText){return}if(!$(this).hasClass("EmptyText")){return}$(this).val("");$(this).removeClass("EmptyText")};elem.onblur=function(){if(this===Qva.ActiveElement){Qva.ActiveElement=null}if(!this.EmptyText){return}if($(this).val()){return}if($(this).hasClass("EmptyText")){return}$(this).addClass("EmptyText");$(this).val(elem.EmptyText)};elem.onkeyup=function(event){Qva.ActiveObjectsCloak=true;return false};$ele.keydown(function(event){if(event.target.tagName&&(event.target.tagName.toLowerCase()=="textarea")){return true}var code=event.keyCode||event.which;if(code===13){if(elem.onchange){elem.onchange()}else{$ele.trigger("change")}event.preventDefault();return false}})};Qva.Mgr.inputtext.prototype.Lock=Qva.LockReadOnly;Qva.Mgr.inputtext.prototype.Unlock=Qva.UnlockReadOnly;Qva.Mgr.inputtext.prototype.Paint=function(mode,node){this.Touched=true;var element=this.Element;element.readOnly=(mode!="e");element.style.color=element.readOnly?"graytext":"";element.disabled=false;var attrValue="";if(this.Name.indexOf("Document.Annotations.Body.EditNote.Access.")===0&&node.getAttribute("text")==="Domain\\UserID"){var domainUserText=Qva.localization.getStringFromKey("domainUserId");node.setAttribute("text",domainUserText);node.setAttribute("value",domainUserText)}if(mode!="n"){attrValue=node.getAttribute(this.Attr);if(this.Attr=="value"&&node.getAttribute("text")==""){attrValue=""}}if(mode!="n"&&this.Condition!=null){var cval=node.getAttribute("value");if(cval==this.Condition){element.disabled=true;attrValue=""}}if(attrValue==""&&this.TextIfNull){attrValue=this.TextIfNull}var value=attrValue;if(this.Dec!=null){value=Qva.Trunc(attrValue,this.Dec)}var hasFocus=element===document.activeElement;element.EmptyText=Qva.localization.getStringFromKey(node.getAttribute("emptytext"));var useEmptyText=!hasFocus&&!value&&element.EmptyText;element.value=useEmptyText?element.EmptyText:value;if(element.EmptyText){$(element)[useEmptyText?"addClass":"removeClass"]("EmptyText")}this.Value=element.value;this.Locked=element.disabled;element.style.display=Qva.MgrGetDisplayFromMode(this,mode)};Qva.Mgr.inputtext.prototype.Remove=function(){$(this.Element).find("div").remove();Qva.RemoveElement(this.Element)};Qva.Mgr.textarea=Qva.Mgr.inputtext;Qva.Mgr.inputpassword=Qva.Mgr.inputtext;Qva.Mgr.text=function(owner,elem,name,prefix,tooltip){if(!Qva.MgrSplit(this,name,prefix)){return}if(tooltip!=null){this.ToolTip=Qva.MgrMakeName(tooltip,prefix);owner.Append(this,this.ToolTip)}if(elem.tagName=="SELECT"){Assert(false)}owner.AddManager(this);this.Element=elem};Qva.Mgr.text.prototype.Paint=Qva.Mgr.edit.prototype.Paint;Qva.Mgr.text.prototype.Remove=function(){Qva.RemoveElement(this.Element)};Qva.Mgr.step=function(owner,elem,name,prefix,step){switch(step){case"next":this.Next=true;break;case"prev":this.Next=false;break;default:elem.Step=parseFloat(step);if(isNaN(elem.Step)){return}break}if(!Qva.MgrSplit(this,name,prefix)){return}if(elem.Step==null){elem.Choice=new Array()}owner.AddManager(this);this.Element=elem;elem.Name=this.Name;elem.binderid=owner.binderid;elem.Attr=this.Attr;elem.onclick=Qva.Mgr.step.OnClick;owner.Append(this,this.Name,"choice")};Qva.Mgr.step.prototype.Lock=Qva.LockDisabled;Qva.Mgr.step.prototype.Unlock=Qva.UnlockDisabled;Qva.Mgr.step.prototype.Paint=function(mode,node){this.Touched=true;var element=this.Element;element.disabled=(mode!="e");if(mode=="n"){}else{if(element.Step!=null){element.Last=parseFloat(node.getAttribute(this.Attr))}else{var value=node.getAttribute(this.Attr);var choiceNodes=node.getElementsByTagName("choice");element.Pending=-1;if(choiceNodes.length>=1){var choices=choiceNodes[0].getElementsByTagName("element");var height=choices.length;for(var rix=0;rix<height;++rix){element.Choice[rix]=choices[rix].getAttribute(this.Attr);if(choices[rix].getAttribute("selected")=="yes"){if(this.Next){element.Pending=rix+1}else{element.Pending=rix-1}}}element.Choice.length=height}if(element.Pending<0||element.Pending>=element.Choice.length){element.disabled=true}}}element.style.display=Qva.MgrGetDisplayFromMode(this,mode)};Qva.Mgr.step.OnClick=function(){var binder=Qva.GetBinder(this.binderid);if(!binder.Enabled){return}var newval;if(this.Step!=null){newval=this.Last+this.Step}else{if(this.Pending<0||this.Pending>=this.Choice.length){return}newval=this.Choice[this.Pending]}binder.Set(this.Name,this.Attr,""+newval,true)};Qva.Mgr.actions=function(owner,elem,name,prefix){if(!Qva.MgrSplit(this,name,prefix)){return}this.Attr="mode";owner.AddManager(this);this.Element=elem;elem.Action=this.Name;elem.binderid=owner.binderid;Qva.Events.AddClickEvent(elem,onclick_action,{xns:".action",nostop:true})};Qva.Mgr.actions.prototype.Remove=function(){Qva.RemoveHtml(this.Element)};Qva.Mgr.actions.prototype.Lock=Qva.LockDisabled;Qva.Mgr.actions.prototype.Unlock=Qva.UnlockDisabled;Qva.Mgr.actions.prototype.Paint=function(mode,node){this.Touched=true;var element=this.Element;var disabled=(mode!="e");element.style.display=Qva.MgrGetDisplayFromMode(this,mode);if(node.getAttribute("actions")=="true"&&!disabled){element.disableAction=false;element.style.cursor="pointer"}else{element.disableAction=true;if(element.style.cursor=="pointer"){element.style.cursor="auto"}}};Qva.Mgr.qvscroll=function(owner,elem,name,prefix){if(!Qva.MgrSplit(this,name,prefix)){return}owner.AddManager(this);this.Element=elem;this.Owner=owner;this.qvscroll=new QvScroll({startAttached:false,attachElement:$(elem)[0],cancelEvents:true,indicators:{enabled:true}})};Qva.Mgr.qvscroll.prototype.Paint=function(mode,node){this.Touched=true;var doScrollX=node.getAttribute("overflowx")&&node.getAttribute("overflowx")!=="hidden";var doScrollY=node.getAttribute("overflowy")&&node.getAttribute("overflowy")!=="hidden";if(this.doScrollX!==doScrollX||this.doScrollY!==doScrollY){this.doScrollX=doScrollX;this.doScrollY=doScrollY;this.PageBinder.QueuePostPaintMessage(this)}};Qva.Mgr.qvscroll.prototype.PostPaint=function(){var $element=$(this.Element),props=this.ScrollProperties,alignment;$element.parent().css("overflow","visible");$element.find("table").css("table-layout","auto");if(this.doScrollX){$element.find("td").css("white-space","pre")}else{$element.find("td").css("white-space","")}$element.parent().css("overflow","hidden");this.qvscroll.setOptions({horizontal:this.doScrollX?"auto":"disabled",vertical:this.doScrollY?"auto":"disabled"}).attach()};Qva.Mgr.scroll=function(owner,elem,name,prefix){if(!Qva.MgrSplit(this,name,prefix)){return}owner.AddManager(this);this.Element=elem;this.Owner=owner;return this};Qva.Mgr.scroll.prototype.GetScrollDimensions=function(w,forVertical){var elem=this.Element,retObj={visibleWidth:elem.clientWidth,visibleHeight:elem.clientHeight,overflowWidth:this.TableCellElement.scrollWidth-elem.clientWidth,overflowHeight:this.TableCellElement.scrollHeight-elem.clientHeight,bothEnabled:false};if(forVertical){retObj.leftOffset=elem.clientWidth-w;retObj.topOffset=0}else{retObj.leftOffset=0;retObj.topOffset=elem.clientHeight-w}var browserScrolls=retObj.overflowWidth>0&&retObj.overflowHeight+w>0||retObj.overflowWidth+w>0&&retObj.overflowHeight>0,nodeScrolls=this.doScrollY&&this.doScrollX;if(browserScrolls&&nodeScrolls){retObj.visibleWidth-=w;retObj.visibleHeight-=w;retObj.overflowWidth+=w;retObj.overflowHeight+=w;retObj.bothEnabled=true}return retObj};Qva.Mgr.scroll.prototype.CalculateBarPosition=function(vertical,mgr,percent){var barSize=parseFloat(mgr.bar.style[vertical?"height":"width"]),bgSize=parseFloat(mgr.background.style[vertical?"height":"width"])-barSize-this.ScrollProperties.width*2;if(percent<0){percent=0}else{if(percent>1){percent=1}}return bgSize*percent};Qva.Mgr.scroll.prototype.CalculateContentPosition=function(vertical,mgr,percent){var totalSize=vertical?mgr.Alignments.overflowHeight:mgr.Alignments.overflowWidth;if(percent<0){percent=0}else{if(percent>1){percent=1}}return percent*totalSize};Qva.Mgr.scroll.prototype.GetScrollPercent=function(vertical,mgr,step,overrideScroll){var lineHeight=parseFloat(mgr.Element.firstChild.style.fontSize)||16,contentScrollOffset=typeof overrideScroll!=="undefined"?overrideScroll:parseFloat(this.Element.firstChild.style[vertical?"marginTop":"marginLeft"]),contentSize=vertical?mgr.Alignments.visibleHeight:mgr.Alignments.visibleWidth,totalSize=vertical?mgr.Alignments.overflowHeight:mgr.Alignments.overflowWidth;contentScrollOffset=isNaN(contentScrollOffset)?0:contentScrollOffset;contentScrollOffset=((contentScrollOffset/lineHeight)+step)*lineHeight;return -contentScrollOffset/totalSize};Qva.Mgr.scroll.prototype.SetScrollPosition=function(vertical,mgr,step,overrideScroll){var percent=this.GetScrollPercent(vertical,mgr,step,overrideScroll),barPos=this.CalculateBarPosition(vertical,mgr,percent);mgr.bar.style[vertical?"marginTop":"marginLeft"]=barPos+"px";this.Element.firstChild.style[vertical?"marginTop":"marginLeft"]=-this.CalculateContentPosition(vertical,mgr,percent)+"px";mgr.bar_pos=barPos};Qva.Mgr.scroll.prototype.CreateScrollBarManager=function(isVertical,alignment,oldMgr){var that=this,scrollMgr=!!oldMgr?oldMgr:new Qva.ScrollBarMgr(this,isVertical,true);scrollMgr.background.style.backgroundColor=this.Owner.ContentElement.style.backgroundColor;scrollMgr.setProperties(this.ScrollProperties);if(isVertical){scrollMgr.Set(alignment.leftOffset,alignment.topOffset,alignment.visibleHeight,alignment.overflowHeight+alignment.visibleHeight,alignment.visibleHeight,alignment.leftOffset,alignment.topOffset)}else{scrollMgr.Set(alignment.leftOffset,alignment.topOffset,alignment.visibleWidth,alignment.overflowWidth+alignment.visibleWidth,alignment.visibleWidth,alignment.leftOffset,alignment.topOffset)}scrollMgr.Alignments=alignment;scrollMgr.Element=this.Element;scrollMgr.bar_pos=0;scrollMgr.actions={step:function(dx){setDuration(scrollMgr.Element.children[0],"500ms");that.SetScrollPosition(isVertical,scrollMgr,dx)},scroll_end:function(dx){this.scroll(dx);this.isScrolling=false},scroll:function(dx){setDuration(scrollMgr.Element.children[0],"0ms");var localOriginScrollOffset=parseFloat(that.Element.firstChild.style[isVertical?"marginTop":"marginLeft"])||0;if(!this.isScrolling){this.isScrolling=true;this.originScrollOffset=localOriginScrollOffset}that.SetScrollPosition(isVertical,scrollMgr,0,this.originScrollOffset+dx)},page:function(dx){setDuration(scrollMgr.Element.children[0],"500ms");that.SetScrollPosition(isVertical,scrollMgr,dx)}};if(!oldMgr){scrollMgr.addEvents(oldMgr)}Qva.AddMouseScroll(scrollMgr);return scrollMgr};Qva.Mgr.scroll.prototype.Hide=function(){this.background.style.display="none";this.bar.style.display="none";this.start.style.display="none";this.end.style.display="none";if(this.scrollMgrY&&this.scrollMgrY.paddingelement){this.scrollMgrY.paddingelement.style.display="none"}};Qva.Mgr.scroll.prototype.IsVisible=function(){return this.bar.style.display==""};Qva.Mgr.scroll.prototype.Paint=function(mode,node){this.Touched=true;this.ScrollProperties=Qva.GetScrollBarProperties(this.PageBinder.ScrollWidth);this.TableCellElement=this.Element.firstChild.getElementsByTagName("td")[0];this.doScrollX=node.getAttribute("overflowx")&&node.getAttribute("overflowx")!=="hidden";this.doScrollY=node.getAttribute("overflowy")&&node.getAttribute("overflowy")!=="hidden";this.PageBinder.QueuePostPaintMessage(this)};Qva.Mgr.scroll.prototype.PostPaint=function(){var element=this.Element,props=this.ScrollProperties,alignment;element.style.overflow="visible";if(this.doScrollX){element.firstChild.style.tableLayout="auto";this.TableCellElement.style.whiteSpace="pre";alignment=this.GetScrollDimensions(props.width,false);if(alignment.overflowWidth>0){this.scrollMgrX=this.CreateScrollBarManager(false,alignment,this.scrollMgrX)}else{if(this.scrollMgrX){this.scrollMgrX.Hide()}}}else{element.firstChild.style.tableLayout="fixed";this.TableCellElement.style.whiteSpace="";if(this.scrollMgrX){this.scrollMgrX.Hide()}}if(this.doScrollY){alignment=this.GetScrollDimensions(props.width,true);if(alignment.overflowHeight>0){this.scrollMgrY=this.CreateScrollBarManager(true,alignment,this.scrollMgrY)}else{if(this.scrollMgrY){this.scrollMgrY.Hide()}}}else{if(this.scrollMgrY){this.scrollMgrY.Hide()}}var $table=$(this.TableCellElement).closest("table");if(this.scrollMgrY&&this.scrollMgrX){this.scrollMgrY.EnablePaddingElement()}else{if(this.scrollMgrY&&!this.scrollMgrX){var w=$(element).outerWidth();$($table).width(w-this.scrollMgrY.props.width);alignment=this.GetScrollDimensions(props.width,true);if(alignment.overflowHeight>0){this.scrollMgrY=this.CreateScrollBarManager(true,alignment,this.scrollMgrY)}}else{if(!this.scrollMgrY&&this.scrollMgrX){var w=$(element).outerHeight();$table.height(w-this.scrollMgrX.props.width);alignment=this.GetScrollDimensions(props.width,false);if(alignment.overflowWidth>0){this.scrollMgrX=this.CreateScrollBarManager(false,alignment,this.scrollMgrX)}}}}element.style.overflow="hidden";Qva.Events.SetTouchAction(element,this.scrollMgrX&&this.scrollMgrX.IsVisible(),this.scrollMgrY&&this.scrollMgrY.IsVisible())};Qva.Mgr.action=function(owner,elem,name,prefix){if(!Qva.MgrSplit(this,name,prefix)){return}this.Attr="mode";owner.AddManager(this);this.Element=elem;elem.Action=this.Name;elem.binderid=owner.binderid;Qva.Events.AddClickEvent(elem,function(event){var origevent=Qva.Events.getOriginalEvent(event);if(this.clientaction){window.onclick_ContextClientAction.apply(this,[origevent])}else{window.onclick_action.apply(this,[origevent])}},{preventDefault:true});owner.Append(this,this.Name,"action")};Qva.Mgr.action.prototype.Lock=Qva.LockDisabled;Qva.Mgr.action.prototype.Unlock=Qva.UnlockDisabled;Qva.Mgr.action.prototype.Paint=function(mode,node){this.Touched=true;var element=this.Element;element[(mode!="e")?"setAttribute":"removeAttribute"]("disabled","");element.disabled=(mode!="e");this.Locked=element.disabled;var label=node.getAttribute("label")||element.alt;if(label){if(node.getAttribute("name")){label=Qva.localization.getStringFromKey(node.getAttribute("name"))}element.title=label}element.style.display=Qva.MgrGetDisplayFromMode(this,mode);if(node.getAttribute("clientaction")){element.Name=this.Name;element.AvqMgr=this;element.clientaction=node.getAttribute("clientaction");element.param=node.getAttribute("param")}element.Position=node.getAttribute("value");var icon=element.getAttribute("icon");if(icon){var binder=Qva.GetBinder(element.binderid);if(element.disabled){icon+=".DISABLED"}var url=binder.BuildBinaryUrl(node.getAttribute("path"),null,icon);element.src=url;element.onmouseover=function(){this.className=this.disabled?"":"prop-dyn-sortable-item-highlighted"};element.onmouseout=function(){this.className=""}}};Qva.Mgr.hr=function(owner,elem,name,prefix){if(!Qva.MgrSplit(this,name,prefix)){return}owner.AddManager(this);var actor=elem.nextSibling;while(actor&&actor.tagName!="BUTTON"){actor=actor.nextSibling}if(actor){this.Element=actor;actor.binderid=owner.binderid;actor.Name=this.Name;actor.moveObj="*";actor.xOnly=true;actor.xMin=0;actor.xMax=100;actor.disabled=true;actor.style.cursor=actor.disabled?"":"pointer";Qva.Events.AddDragEvent(actor,Qva.Move.mouseDown,Qva.Move.mouseMove,Qva.Move.mouseUp)}};Qva.Mgr.hr.prototype.Paint=function(mode,node){this.Touched=true;var element=this.Element;element.disabled=mode!="e";var pos=parseInt(node.getAttribute("text"));pos=isNaN(pos)?0:(pos/2.55);element.style.left=pos+"px";element.style.cursor=element.disabled?"":"pointer"};Qva.Mgr.select=function(owner,elem,name,prefix,condition){if(elem.multiple){Assert(false);return}if(!Qva.MgrSplit(this,name,prefix)){return}owner.AddManager(this);this.Element=elem;this.Condition=condition;this.Texts=new Array();this.Values=new Array();this.Disabled=new Array();this.Locked=new Array();elem.binderid=owner.binderid;elem.Name=this.Name;elem.onchange=Qva.Mgr.select.OnChange;Qva.Events.AddCancelBubble(this.Element)};Qva.Mgr.select.prototype.Paint=function(mode,node){this.Touched=true;var element=this.Element;var layout={};if(typeof(node.nodeType)!=="undefined"){Qva.ObjectifyXML(layout,node)}else{layout=node}if(layout.mode!="hidden"){element.ByValue=layout.value!=null}var doTranslate=this.Name!=="RemoveBookmark.Name"&&typeof layout.value!=="undefined"&&(element.className.indexOf("prop-select")>=0||(element.tagName==="SELECT"&&element.hasAttribute("avq")===true));if(doTranslate){if(layout.choice[0].element){var locKey,tmpElem,selVal;if(layout.name.indexOf(".Sort.")===1){layout.name=layout.name.slice(2)}for(var i=0,len=layout.choice[0].element.length;i<len;i++){if(layout.choice[0].element[i].labelId){break}locKey=layout.name+"."+layout.choice[0].element[i].value;if(layout.name.indexOf("Sort.PrimarySortOrder")>=0){tmpElem=$(element).parents('div[avq*=".PrimarySort"]').siblings('div[avq*=".PrimarySort"]').find("select");if(tmpElem.length){locKey=layout.name+"."+tmpElem.first().val()+"."+layout.choice[0].element[i].value}}else{if(layout.name.indexOf("SecondarySortOrder")>=0){tmpElem=$(element).parents('div[avq*=".SecondarySort"]').siblings('div[avq*=".SecondarySort"]').find("select");if(tmpElem.length){locKey=layout.name+"."+tmpElem.first().val()+"."+layout.choice[0].element[i].value}}else{if(["SelectionType","LayoutType","BookmarkType","PrintType","ExternalType"].indexOf(layout.name)>-1){locKey="Type."+layout.choice[0].element[i].value}else{if(layout.name.indexOf("Stretch")>=0){locKey="Stretch."+layout.choice[0].element[i].value}else{if(layout.name.indexOf("FillDirection")>=0){locKey="FillDirection."+layout.choice[0].element[i].value}else{if(layout.name.indexOf("FillPattern")>=0){locKey="FillPattern."+layout.choice[0].element[i].value}else{if(layout.name.slice(-24)===".NumberFormat.FormatType"){locKey="NumberFormat.FormatType."+layout.choice[0].element[i].value}else{if(layout.name==="Chart.Gauge.IndicatorStyle"){tmpElem=$(element).closest(".QvContent").find('div[avq*=".Chart.Gauge.ChartMode"]').find("select");if(tmpElem.length){locKey=layout.name+"."+tmpElem.first().val()+"."+layout.choice[0].element[i].value}}else{if(layout.name.indexOf("TotalMode")>=0){locKey="TotalMode."+layout.choice[0].element[i].value}else{if(layout.name.indexOf("AggregationMode")>=0){locKey="AggregationMode."+layout.choice[0].element[i].value}}}}}}}}}}layout.choice[0].element[i].text=Qva.localization.getStringFromKey(locKey)||layout.choice[0].element[i].text;if(layout.value===layout.choice[0].element[i].value){layout.text=layout.choice[0].element[i].text}}}else{if(layout.text!==undefined){layout.text=Qva.localization.getStringFromKey(layout.name+"."+layout.value)}}}var currentValue=layout.text;if(this.Dec!=null){currentValue=Qva.Trunc(currentValue,this.Dec)}if(currentValue==null){currentValue=""}if(this.TextIfNull&&currentValue==""){currentValue=this.TextIfNull}var optlen=element.options.length;if(layout.mode=="enabled"&&(this.Condition==null||currentValue!="")){var choices=layout.choice;if(!choices){choices=[]}if(choices.length>=1){if(choices[0].element){choices=choices[0].element}else{choices.length=0}}var first=(this.Condition==null)?0:1;var cholen=choices.length-first;element.options.length=cholen;if(cholen>=1){this.SelectedIndex=-1;for(var ix=0;ix<cholen;++ix){var cho=choices[ix+first];var optval=cho.labelId===undefined?cho.text:Qva.localization.getStringFromObject(cho);if(this.TextIfNull&&optval==""){optval=this.TextIfNull}if(this.Dec!=null){optval=Qva.Trunc(optval,this.Dec)}var text,value;if(isNaN(optval)){text=optval.replace(/\t/g," ")}else{text=""+optval}value=element.ByValue?cho.value:optval;var selected=false;if(element.ByValue){if(value==layout.value){this.SelectedIndex=ix;selected=true}}else{if(optval==currentValue){this.SelectedIndex=ix;selected=true}}var opt=element.options[ix]=new Option(text,value);if(selected){opt.selected=true}}if(this.SelectedIndex==-1){element.options[cholen-1].selected=true}}element.disabled=false}else{element.disabled=true;if(optlen<1||this.Condition!=null){element.options.length=1;var text,value;if(isNaN(currentValue)){text=(currentValue!=null)?currentValue.replace(/\t/g," "):""}else{text=""+currentValue}value=element.ByValue?node.getAttribute("value"):currentValue;var opt0=element.options[0]=new Option(text,value);opt0.selected=true}}this.Locked=element.disabled;element.style.display=layout.mode=="hidden"?"none":""};Qva.Mgr.select.OnChange=function(){var binder=Qva.GetBinder(this.binderid);if(this.selectedIndex<0){return}var opt=this.options[this.selectedIndex];if(this.ByValue===true){binder.Set(this.Name,"value",opt.value,true)}else{binder.Set(this.Name,"text",opt.text,true)}};Qva.Mgr.textSelect=function(owner,elem,name,prefix){if(!Qva.MgrSplit(this,name,prefix)){return}owner.AddManager(this);this.Element=elem;this.ByValue=true;elem.binderid=owner.binderid;elem.Name=this.Name;elem.onchange=Qva.Mgr.textSelect.OnChange;elem.onclick=Qva.CancelBubble};Qva.Mgr.textSelect.OnChange=function(){var binder=Qva.GetBinder(this.binderid);if(!binder.Enabled){return}if(this.selectedIndex<0){return}var opt=this.options[this.selectedIndex];binder.Set(this.Name,"text",opt.value,true)};Qva.Mgr.textSelect.prototype.Paint=function(mode,node){this.Touched=true;var element=this.Element;var currentValue=node.getAttribute("value");if(currentValue==null){currentValue=""}var optlen=element.options.length;element.disabled=mode!="e";for(var ix=0;ix<optlen;++ix){if(element.options[ix].value===currentValue){element.selectedIndex=ix}}element.style.display=Qva.MgrGetDisplayFromMode(this,mode)};Qva.Mgr.binary=function(owner,elem,name,prefix){elem.Name=this.Name=Qva.MgrMakeName(name,prefix);elem.binderid=owner.binderid;elem.ObjectId=owner.Element.ObjectId;owner.AddManager(this);this.Element=elem};Qva.Mgr.binary.prototype.Paint=function(mode,node){this.Touched=true;var element=this.Element;element.style.display=Qva.MgrGetDisplayFromMode(this,mode);if(element.style.display=="none"){return}if(!this.PageBinder.BuildBinaryUrl){return}var disabled=(mode!="e");var stamp=node.getAttribute("stamp");if(stamp!="0"&&this.PageBinder.BuildBinaryUrl){var name=stamp?this.Name:node.getAttribute("name");if(disabled){name+=".DISABLED"}var url=this.PageBinder.BuildBinaryUrl(node.getAttribute("path"),stamp,name);this.avq_url=url}if(node.getAttribute("helptext")!=="-"&&node.getAttribute("helptext")!==""){element.title=node.getAttribute("helptext")}this.PageBinder.QueuePostPaintMessage(this)};Qva.Mgr.binary.prototype.PostPaint=function(){var elem=this.Element;if(elem.style.display=="none"){return}var url=this.avq_url;if(this.avq_url){elem.src=url}elem.style.display="block"};Qva.Mgr.button=function(owner,elem,name,prefix){elem.Name=this.Name=Qva.MgrMakeName(name,prefix);elem.binderid=owner.binderid;elem.ObjectId=owner.Element.ObjectId;owner.AddManager(this);this.Element=elem};Qva.Mgr.button.prototype.Paint=Qva.Mgr.binary.prototype.Paint;Qva.Mgr.button.prototype.PostPaint=function(){var elem=this.Element;if(elem.style.display=="none"){return}var imageelem=null;if(elem.tagName!="BUTTON"){Assert(false)}for(var i=0;i<elem.childNodes.length;i++){if(elem.childNodes[i].tagName=="IMG"){imageelem=elem.childNodes[i];break}}if(imageelem){var url=this.avq_url;var sizeupdated=false;var sendsizetoserver=this.PageBinder.IsHosted;if(elem.style.width!=""&&elem.style.height!=""){var objectbinder=Qva.GetObjectBinder(elem);var graphsize=objectbinder.GetImageSize(elem);if((Qva.userAgentDetector.get("gecko")||Qva.userAgentDetector.get("chrome"))){graphsize.width-=3;graphsize.height-=1}if(sendsizetoserver&&(this.GraphWidth!=graphsize.width||this.GraphHeight!=graphsize.height)){this.GraphWidth=graphsize.width;this.GraphHeight=graphsize.height;sizeupdated=true}url+="&width="+Qva.EncodeComponent(graphsize.width);url+="&height="+Qva.EncodeComponent(graphsize.height)}if(this.avq_url){url=Qva.AddProxyIfAny(url);url=Qva.XrfSecure(url);imageelem.src=url}if(sizeupdated){this.PageBinder.SetSize(this.Name,this.GraphWidth+":"+this.GraphHeight)}imageelem.style.display="block"}else{Assert(false)}};Qva.SpecialActions={};Qva.SpecialActions.list=[];Qva.SpecialActions.AddAction=function(id,keycode,document,ctrl,shift){this[id]={keycode:keycode,document:document,ctrl:ctrl,shift:shift};this.list[this.list.length]={id:id,keycode:keycode,document:document,ctrl:ctrl,shift:shift}};Qva.SpecialActions.AddAction("REDO",89,true,true,false);Qva.SpecialActions.AddAction("UNDO",90,true,true,false);Qva.SpecialActions.AddAction("LS",76,true,true,true);Qva.SpecialActions.AddAction("US",85,true,true,true);Qva.SpecialActions.AddAction("CLEARSTATE",68,true,true,true);Qva.SpecialActions.AddAction("BCK",37,true,false,true);Qva.SpecialActions.AddAction("FWD",39,true,false,true);Qva.SpecialActions.GetAction=function(event){for(var i=0;i<this.list.length;i++){var item=this.list[i];if(item.keycode==event.keyCode){if(item.ctrl==ctrlKeyPressed(event)&&item.shift==event.shiftKey){return item}return null}}return null};Qva.SpecialActions.GetShortcutText=function(id){var action=this[id];if(action){var text="\t";if(action.ctrl){text+="Ctrl+ "}if(action.shift){text+="Shift+ "}if(action.keycode==37){text+="Left Arrow"}else{if(action.keycode==39){text+="Right Arrow"}else{text+=String.fromCharCode(action.keycode)}}return text}return""};Qva.MgrLinkScan=function(mgr,owner,lnkname,namePrefix){mgr.LinkParts=lnkname.split("$");var plen=mgr.LinkParts.length;mgr.LinkArgs=lnkname.split("$");if(plen>=2){for(var lix=1;lix<plen;lix+=2){var name=namePrefix+mgr.LinkParts[lix];owner.Append(mgr,name);mgr.LinkParts[lix]=name}}};function onclick_link(){window.open(this.link)}Qva.Mgr.link=function(owner,elem,name,prefix,path){if(!Qva.MgrSplit(this,name,prefix)){return}Qva.MgrLinkScan(this,owner,path,prefix);owner.AddManager(this);this.Element=elem;elem.Name=this.Name;elem.binderid=owner.binderid;elem.onclick=onclick_link};Qva.Mgr.link.prototype.Paint=function(mode,node,name){this.Touched=true;var element=this.Element;if(element.Name==name){element.style.display=Qva.MgrGetDisplayFromMode(this,mode)}for(var lix=1;lix<this.LinkParts.length;lix+=2){if(this.LinkParts[lix]==name){this.LinkArgs[lix]=node.getAttribute("text")}}element.link="";for(var lix=0;lix<this.LinkArgs.length;lix++){element.link+=this.LinkArgs[lix]}};Qva.Mgr.hover=function(owner,elem,name,prefix){if(!Qva.MgrSplit(this,name,prefix)){return}owner.AddManager(this);this.Element=elem};Qva.Mgr.hover.prototype.Paint=function(mode,node,name){var element=this.Element,posX=parseInt(element.style.left),posY=parseInt(element.style.top),vpW=Qva.GetViewportWidth(),vpH=Qva.GetViewportHeight(),scrollX=Qva.GetScrollLeft(),scrollY=Qva.GetScrollTop();element.innerHTML="";var lines=node.getElementsByTagName("line");for(var i=0;i<lines.length;i++){var p=document.createElement("span");p.innerText=lines[i].getAttribute("text");element.appendChild(p);var br=document.createElement("br");element.appendChild(br)}if(vpW<posX-scrollX+10+$(element).outerWidth()){element.style.left="0px";element.style.left=(vpW-$(element).outerWidth()+scrollX-10)+"px"}if(vpH<posY-scrollY+10+$(element).outerHeight()){element.style.top="0px";element.style.top=(vpH-$(element).outerHeight()+scrollY-10)+"px"}element.style.display=Qva.MgrGetDisplayFromMode(this,mode)};Qva.Mgr.dlg=function(owner,elem,name,prefix,dlgname){if(!Qva.MgrSplit(this,name,prefix)){return}owner.AddManager(this);this.Element=elem;if(dlgname.toUpperCase()=="EXPRESSION.QVPP"){this.IsExpression=true}elem.binderid=owner.binderid;elem.Name=this.Name;elem.AvqDialog=dlgname;elem.onclick=Qva.Mgr.dlg.OnClick;elem.style.borderColor="gainsboro";elem.onmouseover=function(){if(!this.disabled){this.style.borderColor="darkgray"}};elem.onmouseout=function(){this.style.borderColor="gainsboro"}};Qva.Mgr.dlg.prototype.Paint=function(mode,node){this.Touched=true;var element=this.Element;element.disabled=(mode!="e");if(this.IsExpression){element.ExpressionType=node.getAttribute("expression");element.Value=node.getAttribute("text");this.Value=element.Value;this.ExpressionType=element.ExpressionType}if(node.getAttribute("label")){element.title=node.getAttribute("label")}if(element.tagName=="IMG"){var icon=element.getAttribute("icon");if(icon){if(element.disabled){icon+=".DISABLED"}var binder=Qva.GetBinder(element.binderid);var url=binder.BuildBinaryUrl(null,null,icon);element.src=url}}element.style.display=Qva.MgrGetDisplayFromMode(this,mode)};Qva.Mgr.dlg.OnClick=function(){if(this.disabled){return}var pageBinder=Qva.GetBinder(this.binderid);if(this.ExpressionType){Qva.ExpressionDialog(this,this.Value)}else{if(Qva.ContextDialogBtn==this){Qva.HideContextDialog()}else{var elem=this;pageBinder.LoadHtml(this.AvqDialog,function(body){Qva.ShowContextDialog(elem,body);pageBinder.Refresh()})}}};Qva.Mgr.panel=function(owner,elem,name,prefix,dlgname){if(!Qva.MgrSplit(this,name,prefix)){return}owner.AddManager(this);this.Element=elem;elem.SelfScanning=true;var pageBinder=owner.PageBinder;while(pageBinder&&!pageBinder.LoadHtml){pageBinder=PageBinder.PageBinder}var Name=this.Name;if(elem.tagName=="TR"){elem.cells[0].onclick=function(){Qva.SelectToolPane(this,false)};elem.cells[1].onclick=function(){Qva.SelectToolPane(this,true)};var icon=document.createElement("img");icon.src=pageBinder.BuildBinaryUrl("",null,"web:unpinned");elem.cells[1].appendChild(icon);var tcell=elem.parentNode.parentNode.rows[elem.rowIndex+1].cells[0];pageBinder.LoadHtml(dlgname,function(body){tcell.innerHTML=body;owner.Scan(Name,tcell)})}else{pageBinder.LoadHtml(dlgname,function(body){elem.innerHTML=body;if(owner.ScanAndPaint){owner.ScanAndPaint(Name,elem.firstChild)}else{owner.Scan(Name,elem.firstChild);owner.Paint()}})}};Qva.Mgr.panel.prototype.Paint=function(mode,node){this.Touched=true};Qva.Mgr.style=function(owner,elem,name,prefix){if(!Qva.MgrSplit(this,name,prefix)){return}owner.AddManager(this);this.Element=elem;this.InlineStyle=owner.InlineStyle};Qva.Mgr.style.prototype.Remove=function(){Qva.RemoveElement(this.Element)};Qva.Mgr.style.prototype.Paint=function(mode,node){this.Touched=true;var isSmallDevices=this.PageBinder.PageBinder.isSmallDevices,smallDevicesFontSize=14;if(this.InlineStyle){if(isSmallDevices){this.PageBinder.FontAspectRatio=smallDevicesFontSize/(parseFloat(node.getAttribute("fontsize"))||9);node.setAttribute("fontsize",smallDevicesFontSize)}SetElementStyle(this.Element,"fontWeight",node.getAttribute("fontweight"));SetElementStyle(this.Element,"textAlign",node.getAttribute("textalign"));SetElementStyle(this.Element,"verticalAlign",node.getAttribute("verticalalign"));SetElementStyle(this.Element,"fontFamily",node.getAttribute("fontfamily"));SetElementStyle(this.Element,"fontSize",node.getAttribute("fontsize"),"pt");SetElementStyle(this.Element,"fontStyle",node.getAttribute("fontstyle"));SetElementStyle(this.Element,"textDecoration",node.getAttribute("textdecoration"));SetElementStyle(this.Element,"paddingTop",node.getAttribute("paddingTop"),"px");SetElementStyle(this.Element,"paddingLeft",node.getAttribute("paddingLeft"),"px");SetElementStyle(this.Element,"paddingRight",node.getAttribute("paddingRight"),"px");SetElementStyle(this.Element,"paddingBottom",node.getAttribute("paddingBottom"),"px");if(node.getAttribute("color")&&!isSmallDevices){SetElementColorStyle(this.Element,"color",node.getAttribute("color"))}}};Qva.Mgr.bookmarksselect=function(owner,elem,name,readOnly){if(owner.BookmarksSubscribers){owner.BookmarksSubscribers[owner.BookmarksSubscribers.length]=this}this.Element=elem;elem.binderid=owner.binderid;elem.Name=name;if(!readOnly){elem.onchange=Qva.Mgr.bookmarksselect.OnChange}Qva.Events.AddCancelBubble(this.Element);if(owner.BookmarksMgr){this.Paint(owner.BookmarksMgr)}};Qva.Mgr.bookmarksselect.prototype.Paint2=function(Options,CurrentValue,Mode){var element=this.Element;var optlen=element.options.length;var cholen=Options.length;element.options.length=cholen;if(cholen>=1){this.SelectedIndex=-1;for(var ix=0;ix<cholen;++ix){var cho=Options[ix];var optval=""+cho.text;var opt=element.options[ix];opt.text=optval.replace(/\t/g," ");if(cho.value===""){if(this.Element.Name==="Document.Bookmarks"){opt.text=Qva.localization.getStringFromKey("Select.Bookmark")}else{if(this.Element.Name==="Document.Reports"){opt.text=Qva.localization.getStringFromKey("Select.Report")}}}opt.value=cho.value;var selected=false;$(opt).removeAttr("selected");if(opt.value==CurrentValue){this.SelectedIndex=ix;selected=true;$(opt).prop("selected",true)}if(selected){opt.selected=true}}if(this.SelectedIndex==-1){element.options[cholen-1].selected=true}}element.disabled=Mode=="disabled"};Qva.Mgr.bookmarksselect.prototype.Paint=function(BookMarkObject){if(!BookMarkObject){return}this.Paint2(BookMarkObject.BookMarks,BookMarkObject.CurrentValue,BookMarkObject.Mode)};Qva.Mgr.bookmarksselect.OnChange=function(){var binder=Qva.GetBinder(this.binderid);if(!binder.Enabled){return}if(this.selectedIndex<0){return}var opt=this.options[this.selectedIndex];binder.Set(this.Name,"value",opt.value,true);this.blur()};Qva.Mgr.reportsselect=function(owner,elem,name){if(owner.ReportsSubscribers){owner.ReportsSubscribers[owner.ReportsSubscribers.length]=this}this.Element=elem;elem.binderid=owner.binderid;elem.Name=name;elem.onchange=Qva.Mgr.bookmarksselect.OnChange;if(owner.ReportsMgr){this.Paint(owner.ReportsMgr)}Qva.Events.AddCancelBubble(this.Element)};Qva.Mgr.reportsselect.prototype.Paint=function(ReportsMgr){if(!ReportsMgr){return}this.Paint2(ReportsMgr.Reports,ReportsMgr.CurrentValue,ReportsMgr.Mode)};Qva.Mgr.reportsselect.prototype.Paint2=Qva.Mgr.bookmarksselect.prototype.Paint2;Qva.Mgr.reports=function(owner,name){if(!Qva.MgrSplit(this,name,"Document")){return}owner.AddManager(this);this.Reports=[]};Qva.Mgr.reports.prototype.Paint=function(mode,node,name){this.CurrentText=node.getAttribute("text");this.CurrentValue=node.getAttribute("value");this.Mode=node.getAttribute("mode");var choice=node.firstChild;this.Reports.length=0;if(choice.nodeName=="choice"){for(var chgrp=choice.firstChild;chgrp;chgrp=chgrp.nextSibling){var report={};ObjectifyXmlAttributes(report,chgrp);this.Reports[this.Reports.length]=report}}else{Assert(false)}this.PageBinder.UpdateReports()};Qva.Mgr.bookmarks=function(owner,name){if(!Qva.MgrSplit(this,name,"Document")){return}owner.AddManager(this);this.BookMarks=[]};Qva.Mgr.bookmarks.prototype.Paint=function(mode,node,name){this.CurrentText=node.getAttribute("text");this.CurrentValue=node.getAttribute("value");this.Mode=node.getAttribute("mode");var choice=node.firstChild;this.BookMarks.length=0;var newbookmarkid=null;if(choice.nodeName=="choice"){for(var chgrp=choice.firstChild;chgrp;chgrp=chgrp.nextSibling){var bookmark={};ObjectifyXmlAttributes(bookmark,chgrp);this.BookMarks[this.BookMarks.length]=bookmark;if(this.NewBookmarkName&&this.NewBookmarkCallback){if(bookmark.text==this.NewBookmarkName){newbookmarkid=bookmark.value}}}}else{Assert(false)}if(newbookmarkid){this.NewBookmarkCallback(newbookmarkid);this.NewBookmarkName=null;this.NewBookmarkCallback=null}this.PageBinder.UpdateBookMarks()};Qva.Mgr.bookmarks.prototype.NewBookmark=function(name,additive,share,excludeselections,layoutstate,hide,showpopupinfo,infomsg,inputfieldvaluesflag){var params={};params.bmname=name;if(additive){params.additive="true"}if(share){params.share="true"}if(excludeselections){params.excludeselections="true"}if(layoutstate){params.layoutstate="true"}if(hide){params.hide="true"}if(showpopupinfo){params.showpopupinfo="true"}if(infomsg){params.infomsg=infomsg}if(inputfieldvaluesflag){params.inputfieldvaluesflag="true"}this.PageBinder.Set(this.Name,params)};Qva.Mgr.bookmarks.prototype.NewBookmarkExtended=function(callback,name,additive,share,excludeselections,layoutstate,hide,showpopupinfo,infomsg,inputfieldvaluesflag){this.NewBookmarkName=name;this.NewBookmarkCallback=callback;this.NewBookmark(name,additive,share,excludeselections,layoutstate,hide,showpopupinfo,infomsg,inputfieldvaluesflag)};Qva.Mgr.bookmarks.prototype.SelectBookmark=function(id){this.PageBinder.Set(this.Name,"value",id,true)};Qva.Mgr.bookmarks.prototype.DeleteBookmark=function(id){this.PageBinder.Set(this.Name,"delete",id,true)};Qva.Mgr.selectionsstyle=function(owner,name){if(!Qva.MgrSplit(this,name,"Document")){return}owner.AddManager(this);this.Styles=[]};Qva.Mgr.selectionsstyle.prototype.GetSelectionStyle=function(state){for(var iStyle=0;iStyle<this.Styles.length;iStyle++){if(this.Styles[iStyle].name==state){return this.Styles[iStyle]}}Assert(false);return null};Qva.Mgr.selectionsstyle.prototype.Paint=function(mode,node,name){var styleNode=node.firstChild;this.Styles.length=0;if(styleNode.nodeName=="state"){for(;styleNode;styleNode=styleNode.nextSibling){var style={};style.name=styleNode.getAttribute("name");ObjectifyXmlAttributes(style,styleNode);this.Styles[this.Styles.length]=style}}else{Assert(false)}var stylesheetfound=false;for(var i=0;i<document.styleSheets.length;i++){if(stylesheetfound){break}var rules;try{rules=document.styleSheets[i].rules?document.styleSheets[i].rules:document.styleSheets[i].cssRules}catch(Error){continue}if(!rules){continue}for(var iStyle=0;iStyle<this.Styles.length;iStyle++){for(var is=0;is<rules.length;is++){var style=rules[is];if(style.selectorText==(".Qv"+this.Styles[iStyle].name)){stylesheetfound=true;style.style.color=HtmlifyARGB(this.Styles[iStyle].color);var backgroundcolor=Qva.Hex2CSSExpression(this.Styles[iStyle].backgroundcolor);if(!backgroundcolor){backgroundcolor=HtmlifyARGB(this.Styles[iStyle].backgroundcolor)}style.style.backgroundColor=backgroundcolor}}}}Qva.CreateRulesForSelectionColors(this.PageBinder);Assert(stylesheetfound)};Qva.Mgr.translations=function(owner,name){if(!Qva.MgrSplit(this,name,"Document")){return}owner.AddManager(this)};Qva.Mgr.translations.prototype.Paint=function(mode,node,name){var binder=this.PageBinder;binder.Translations={};$(node).find("translate").each(function(){binder.Translations[this.getAttribute("name")]=this.getAttribute("text")})};Qva.Extensions=function(owner){this.Name=owner.DefaultScope+".Extensions";this.PageBinder=owner;owner.AddManager(this);this.Extensions={};this.Members=[]};Qva.AddDocumentExtensionBase=function(name,document){if(!Qva.Mgr[name]){Qva.Mgr[name]=function(document){this.Document=new Qv.Document(document.ID)}}};Qva.Extensions.prototype.Paint=function(mode,rootnode){var nodes=rootnode.getElementsByTagName("extension");for(var i=0;i<nodes.length;i++){var path=nodes[i].getAttribute("path");if(this.Extensions[path]){continue}this.Extensions[path]=true;Qva.AddDocumentExtensionBase(path,this.PageBinder);this.Members[this.Members.length]={path:path,object:new Qva.Mgr[path](this.PageBinder)};this.PageBinder.QueuePostPaintMessage(this,true)}};Qva.Extensions.prototype.PostPaint=function(){var AllScriptsloaded=true;for(var i=0;i<this.Members.length;i++){if(this.Members[i].object.FirstLoad){continue}var creator=Qva.ExtensionCreator[this.Members[i].path];if(creator==null){Qva.ExtensionCreator[this.Members[i].path]=Qva.WaitingForRequest;Qva.RequestScript(this.Members[i].path,this.PageBinder,"document")}else{if(creator!=Qva.WaitingForRequest){Assert(false)}}AllScriptsloaded=false}if(!AllScriptsloaded){this.PageBinder.QueuePostPaintMessage(this,true);return}for(var i=0;i<this.Members.length;i++){Qva.ExtensionCreator[this.Members[i].path]=null;this.Members[i].object.FirstLoad()}};Qva.AddDocumentExtension=function(name,extensionPaint,debug){if(debug){Qva.Mgr[name].prototype.Debug=true}Qva.Mgr[name].prototype.FirstLoad=function(){if(typeof(this.Paint)==="undefined"){this.Paint=extensionPaint}try{this.Paint()}catch(e){if(debug){Assert(false,"An error occurred in the postpaint-function in the extension object: \n"+e.description)}}}};Qva.Mgr.Documentdata=function(owner,name){if(!Qva.MgrSplit(this,name,"Document")){return}owner.AddManager(this);this.Items=[]};function ObjectifyXmlDocumentDataNode(obj,node){obj.SubItems=[];for(var child=node.firstChild;child;child=child.nextSibling){obj.SubItems[obj.SubItems.length]={};ObjectifyXmlDocumentDataNode(obj.SubItems[obj.SubItems.length-1],child)}ObjectifyXmlAttributes(obj,node)}Qva.Mgr.Documentdata.prototype.Paint=function(mode,node){this.Items=[];for(var chgrp=node.firstChild;chgrp;chgrp=chgrp.nextSibling){this.Items[this.Items.length]={};ObjectifyXmlDocumentDataNode(this.Items[this.Items.length-1],chgrp);var item=this.Items[this.Items.length-1];switch(node.getAttribute("name")){case"Function":if(item.text.length){item.text=Qva.localization.getStringFromKey(item.SubItems[0].param)||item.text}break;case"Variable":case"Field":if(item.labelId){item.text=Qva.localization.getStringFromKey(item.labelId)}break;default:item.text=Qva.localization.getStringFromKey(item.param)||item.text}}};Qva.Mgr.CurrentSelection=function(owner){if(!Qva.MgrSplit(this,".CurrentSelectionData","Document")){return}owner.AddManager(this);this.Settings={};this.Fields={};this.Fields.length=0};Qva.Mgr.CurrentSelection.prototype.PostPaint=function(){};Qva.Mgr.CurrentSelection.prototype.Paint=function(mode,node){var m=this.Mode=node.getAttribute("mode");if(m!="enabled"){if(this.Settings.enabled){this.poll={name:"CurrentSelectionData",clearcache:"false"};this.PageBinder.Send()}}else{if(!this.GenericPaint){this.GenericPaint=Qva.Mgr.object.prototype.GenericPaint}this.GenericPaint(mode,node);if(this.Settings.fields.length==0){return}var fieldsnode=null;for(var i=0;i<node.childNodes.length;++i){if(node.childNodes[i].tagName=="value"&&node.childNodes[i].getAttribute("name")=="C0"){fieldsnode=node.childNodes[i]}}if(fieldsnode){for(var i=0;i<fieldsnode.childNodes.length;++i){if(fieldsnode.childNodes[i].tagName=="element"){var field=fieldsnode.childNodes[i].getAttribute("text");for(var iField=0;iField<this.Settings.fields.length;iField++){if(this.Settings.fields[iField].name==field){if(!this.Fields[field]){this.Fields[field]=new Qva.Mgr.field(this.PageBinder,this.Settings.fields[iField]);this.Fields.length++}}}}}}if(this.Fields.length>0){for(var iField=0;iField<this.Settings.fields.length;iField++){if(this.Fields[this.Settings.fields[iField].name]){this.Fields[this.Settings.fields[iField].name].GetData(false)}}this.PageBinder.Send()}}};Qva.Mgr.CurrentSelection.prototype.Enable=function(){this.Settings.enabled=true};Qva.Mgr.CurrentSelection.prototype.Disable=function(){this.Settings.enabled=false};Qva.Mgr.CurrentSelection.prototype.Init=function(settings){this.Settings=settings;if(this.Settings.onChange){this.PostPaint=function(){this.Settings.onChange.call(this.QvaPublic)}}};Qva.Mgr.CurrentSelection.prototype.GetData=function(settings){if(settings){this.Init(settings)}if(this.Settings.enabled){this.poll={name:"CurrentSelectionData",clearcache:"true"};this.PageBinder.Send()}};Qva.Mgr.CurrentSelection.prototype.IsInvalid=function(){return !this.Mode||this.Mode=="invalid"};Qva.Mgr.CurrentSelection.prototype.GetUpdates=function(polls){if(this.Settings.enabled&&this.IsInvalid()){var poll=clone(this.poll);if(this.poll.clearcache){delete this.poll.clearcache}polls.push(poll);this.Mode="waiting"}};Qva.Mgr.CurrentSelection.prototype.Size=function(){};Qva.Mgr.field=function(owner,fielditem,temp){if(!Qva.MgrSplit(this,".Fields."+fielditem.name,"Document")){return}owner.AddManager(this);this.Type="Field";this.Settings=fielditem;var _this=this;if(this.Settings.onDataLoaded){if(temp==undefined){_this.onDataLoaded=this.Settings.onDataLoaded}else{this.onDataLoaded=function(){_this.Settings.onDataLoaded.call(this);_this.PageBinder.RemoveFromManagers(_this);_this.PageBinder.RemoveFromMembers(_this)}}}};Qva.Mgr.field.prototype.PostPaint=function(){if((!this.Settings.size||this.QvaPublic.Data.Rows.length<this.Settings.size)&&this.QvaPublic.Data.Rows.length<this.QvaPublic.Data.TotalSize.y&&this.QvaPublic.Data.Rows.length==(this.QvaPublic.Data.PageOffset.y+this.QvaPublic.Data.PageSize.y)){this.GetData(true,this.QvaPublic.Data.Rows.length)}else{this.onDataLoaded.call(this.QvaPublic)}};Qva.Mgr.field.prototype.GetData=function(send,offset){this.poll={name:"Fields."+this.Settings.name,clearcache:"false"};if(this.Settings.size&&this.Settings.size<500){this.poll.size="1:"+this.Settings.size}if(offset){this.poll.offset="0:"+offset}if(this.Settings.state){this.poll.options=this.Settings.state}this.Mode="invalid";if(send){this.PageBinder.Send()}};Qva.Mgr.field.prototype.IsInvalid=function(){return !this.Mode||this.Mode=="invalid"};Qva.Mgr.field.prototype.GetUpdates=function(polls){if(this.IsInvalid()&&this.poll){var poll=clone(this.poll);if(this.poll.clearcache){delete this.poll.clearcache}polls.push(poll);this.Mode="waiting"}};Qva.Mgr.field.prototype.Paint=function(mode,node){if(!this.GenericPaint){this.GenericPaint=Qva.Mgr.object.prototype.GenericPaint}this.GenericPaint(mode,node)};Qva.PageBinding.prototype.GetField=function(settings,temp){return new Qva.Mgr.field(this,settings,temp)}})(window.$QvJq);(function($,undefined){if(!Qva.Mgr){Qva.Mgr={}}Qva.Mgr.objectstyle=function(owner,elem,name,prefix){if(!Qva.MgrSplit(this,name,prefix)){return}owner.AddManager(this);this.Element=elem;this.radiustopleft=-1;this.radiustopright=-1;this.radiusbottomleft=-1;this.radiusbottomright=-1;this.shadowintensity=0;this.InlineStyle=owner.InlineStyle};function SetRoundedCorner(elem,child,corner,geckocorner,radius,borderwidth){if(!elem){return}elem.style["border"+corner+"Radius"]=radius+"px";SetRoundedCorner(child,null,corner,geckocorner,Math.max(0,radius-borderwidth))}function CornerMayBeChanged(mgr,corner,cornernode){var radius=parseFloat(cornernode.getAttribute(corner));if(mgr[corner]!=radius){mgr[corner]=radius;return true}return false}Qva.Mgr.objectstyle.prototype.ApplyShadowIntensity=function(intensity){if(intensity!=0){var str=intensity+"px",styleStr=str+" "+str+" "+intensity*2+"px "+(this.PageBinder.BorderColor||"#999"),style=this.Element.style;this.shadowintensity=intensity;style.boxShadow=style.webkitBoxShadow=style.mozBoxShadow=style.oBoxShadow=styleStr}else{$(this.Element).css({boxShadow:""})}};Qva.Mgr.objectstyle.prototype.Paint=function(mode,node,name,partial){if(partial){return}if(node.getAttribute("bordercolor")){if(Qva.userAgentDetector.get("msie")&&Qva.userAgentDetector.get("msieDocMode")<=8){this.PageBinder.BorderColor=HtmlifyARGB(node.getAttribute("bordercolor"));this.PageBinder.ActiveBorderColor=HtmlifyARGB(node.getAttribute("activebordercolor"))}else{this.PageBinder.BorderColor=Qva.Hex2RGBA(node.getAttribute("bordercolor"));if(node.getAttribute("activebordercolor")){this.PageBinder.ActiveBorderColor=Qva.Hex2RGBA(node.getAttribute("activebordercolor"))}}if(node.getAttribute("borderstyle")){this.PageBinder.BorderStyle=node.getAttribute("borderstyle")}}this.PageBinder.BorderAroundContent=node.getAttribute("borderposition")=="content";var borderwidth=parseInt(node.getAttribute("borderwidth"));if(isNaN(borderwidth)){borderwidth=0}var updatemoveandsize=this.PageBinder.BorderWidth!=borderwidth;this.PageBinder.BorderWidth=borderwidth;this.PageBinder.ScrollWidth=parseFloat(node.getAttribute("scrollwidth"))||null;if(node.getAttribute("scrollbuttoncolor")){if(Qva.userAgentDetector.get("msie")&&Qva.userAgentDetector.get("msieDocMode")<=8){this.PageBinder.ScrollButtonColor=HtmlifyARGB(node.getAttribute("scrollbuttoncolor"))}else{this.PageBinder.ScrollButtonColor=Qva.Hex2RGBA(node.getAttribute("scrollbuttoncolor"))}}if(node.getAttribute("scrollbkgcolor")){if(Qva.userAgentDetector.get("msie")&&Qva.userAgentDetector.get("msieDocMode")<=8){this.PageBinder.ScrollBkgColor=HtmlifyARGB(node.getAttribute("scrollbkgcolor"))}else{this.PageBinder.ScrollBkgColor=Qva.Hex2RGBA(node.getAttribute("scrollbkgcolor"))}}this.ApplyShadowIntensity(node.getAttribute("shadowintensity")||0);if(updatemoveandsize){this.PageBinder.UpdateMoveAndResizeHandles(this.Element)}if((!Qva.userAgentDetector.get("msie")||Qva.userAgentDetector.get("msieDocMode")>=9)&&this.InlineStyle){var element=this.Element;var corner=node;var anychanges=CornerMayBeChanged(this,"radiustopleft",corner);anychanges|=CornerMayBeChanged(this,"radiustopright",corner);anychanges|=CornerMayBeChanged(this,"radiusbottomleft",corner);anychanges|=CornerMayBeChanged(this,"radiusbottomright",corner);var firstchild=null;for(var ichild=0;ichild<element.childNodes.length;ichild++){var child=element.childNodes[ichild];if(!child.style){continue}if(child.style.display=="none"){continue}if(child.className=="ResizeFrame"){continue}if($(child).hasClass("QvAnnotation")){continue}firstchild=child;break}if(this.FirstChild!=firstchild){this.FirstChild=firstchild;anychanges=true}var lastchild=null;for(var ichild=element.childNodes.length-1;ichild>=0;ichild--){var child=element.childNodes[ichild];if(!child.style){continue}if(child.style.display=="none"){continue}if(child.className=="MoveZone"){continue}if(child.className=="TouchOnlyMoveZone"){continue}if($(child).hasClass("QvAnnotation")){continue}lastchild=child;break}if(this.LastChild!=lastchild){this.LastChild=lastchild;anychanges=true}if(anychanges==true){SetRoundedCorner(element,this.FirstChild,"TopLeft","Topleft",this.radiustopleft,this.PageBinder.BorderWidth);SetRoundedCorner(element,this.FirstChild,"TopRight","Topright",this.radiustopright,this.PageBinder.BorderWidth);SetRoundedCorner(element,this.LastChild,"BottomRight","Bottomright",this.radiusbottomright,this.PageBinder.BorderWidth);SetRoundedCorner(element,this.LastChild,"BottomLeft","Bottomleft",this.radiusbottomleft,this.PageBinder.BorderWidth)}}this.PageBinder.Resized()};Qva.Mgr.objectstyle.prototype.Remove=function(){Qva.RemoveElement(this.Element);if(Qva.params.penSizeIconEventHandlers&&Qva.params.penSizeIconEventHandlers[this.Element.id]){Qva.params.penSizeIconEventHandlers[this.Element.id]=[]}if(Qva.params.penMoveIconEventHandlers&&Qva.params.penMoveIconEventHandlers[this.Element.id]){Qva.params.penMoveIconEventHandlers[this.Element.id]=[]}if(Qva.params.penColsizeIconEventHandlers&&Qva.params.penColsizeIconEventHandlers[this.Element.id]){Qva.params.penColsizeIconEventHandlers[this.Element.id]=[]}};Qva.PageBinding.prototype.GetMaximizedRect=function(element){var pagecontainer=document.getElementById("PageContainer");var offset=Qva.GetAbsolutePageCoords(pagecontainer).y;var windowtop=Qva.GetScrollTop();var height=Qva.GetViewportHeight();var width=Qva.GetViewportWidth();var left=Qva.GetScrollLeft();var top=Math.max(windowtop-offset,0);if(windowtop<offset){height-=(offset-windowtop)}var rect={};rect.height=""+height;rect.width=""+width;rect.left=""+left;rect.top=""+top;return rect};Qva.Mgr.SizeElement=function(element,rect){var sizechanged=false;var width=parseInt(rect.width);var height=parseInt(rect.height);if(isNaN(height)){return false}if(element.rect==null){var path=$(element).getPath();$(element).css("top",parseFloat(rect.top)+"px");$(element).css("left",parseFloat(rect.left)+"px");Qva.ElementAttributesHandler(path,element,"left",null,rect.left);Qva.ElementAttributesHandler(path,element,"top",null,rect.top);if(!isNaN(width)){Qva.ElementAttributesHandler(path,element,"initwidth",null,rect.width);Qva.ElementAttributesHandler(path,element,"initheight",null,rect.height)}sizechanged=true}else{if(parseFloat(rect.height)!==parseFloat($(element).css("height"))+parseFloat($(element).css("borderTopWidth"))+parseFloat($(element).css("borderBottomWidth"))||parseFloat(rect.width)!==parseFloat($(element).css("width"))+parseFloat($(element).css("borderLeftWidth"))+parseFloat($(element).css("borderRightWidth"))||parseFloat(rect.top)!==parseFloat($(element).css("top"))||parseFloat(rect.left)!==$(element).css("left")){if(rect.left!=element.rect.left){$(element).css("left",parseFloat(rect.left)+"px")}if(rect.top!=element.rect.top){$(element).css("top",parseFloat(rect.top)+"px")}if(rect.width!==element.rect.width||rect.height!==element.rect.height){if(!isNaN(width)){if(element.className.indexOf("_SO")===-1){sizechanged=true}if(element.className.indexOf("_LB")==-1){element.style.width=width+"px";element.style.height=height+"px";sizechanged=true}if(element.className.indexOf("_SO")>-1){var iconwidth=parseInt($(element).find("span").width());var sborder=parseInt($(element).css("border-left-width"))+parseInt($(element).css("border-right-width"));var inputwidth=width-iconwidth-sborder-6;$(element).find("input").css("width",inputwidth+"px")}}}}}if(sizechanged){var annotation=document.getElementById(element.id+"_annotation");if(annotation){Qva.PositionAnnotation(annotation,rect)}}element.rect=rect;return sizechanged};Qva.Mgr.CreateAndUpdateResizeHandles=function(frame,borderwidth,isMinimizedObject,allow){var sizeOutTop=4;var sizeIn=0;var sizeOut=4;var cellWidth=parseInt(frame.style.width);var cellHeight=parseInt($(frame).height());var showActiveForTouch=false;if(frame.touchResize&&Qva.Events.resizeActiveForTouch){sizeOutTop+=16;sizeOut+=16;showActiveForTouch=true}if(parseInt($(frame).css("borderTopWidth"))!=0&&!Qva.userAgentDetector.get("msie6o7")){cellHeight=cellHeight+2*borderwidth}if(Qva.userAgentDetector.get("msie6o7")){if(!isNaN(parseInt($(frame).css("borderTopWidth")))){cellWidth+=2*borderwidth;cellHeight+=2*borderwidth}$(frame).css("position","absolute !important")}var resizeParentId=frame.id+"_resize";var handleParent=document.getElementById(resizeParentId);if(!handleParent){var handleParent=document.createElement("div");handleParent.id=resizeParentId;handleParent.className="ResizeFrame";handleParent.ResizeType="Parent";frame.insertBefore(handleParent,frame.firstChild)}if(Qva.userAgentDetector.get("msie6o7")){if(parseInt($(frame).css("borderTopWidth"))!=0){handleParent.style.left="0px";handleParent.style.top="0px"}}else{handleParent.style.left=-borderwidth+"px";handleParent.style.top=-borderwidth+"px"}var handles=isMinimizedObject?["br","r","b"]:["br","r","b","bl","l","tl","t","tr"];switch(allow){case"height":handles=["t","b"];break;case"width":handles=["l","r"];break}for(var i=0;i<handles.length;i++){var resizeId=frame.id+"_resize_"+handles[i];var handle=document.getElementById(resizeId);if(!handle){var handle=document.createElement("div");handle.id=resizeId;handle.ResizeType=handles[i];handleParent.appendChild(handle);handle.className="ResizeZone";Qva.Events.AddDragEvent(handle,Qva.Resize.mouseDown,Qva.Resize.mouseMove,Qva.Resize.mouseUp,{arg:[frame],cleanFunc:Qva.Resize.cleanUp})}var offsetX=0;var offsetY=0;if(Qva.userAgentDetector.get("msie6o7")){offsetX=-borderwidth;offsetY=-borderwidth}if(handles[i].indexOf("r")!=-1){var left=offsetX+cellWidth-sizeIn}else{if(handles[i].indexOf("l")!=-1){var left=offsetX-sizeOut}else{var left=offsetX+sizeIn}}if(handles[i].indexOf("b")!=-1){var top=offsetY+cellHeight-sizeIn}else{if(handles[i].indexOf("t")!=-1){var top=offsetY-sizeOutTop}else{var top=offsetY+sizeIn}}if(handles[i].indexOf("r")!=-1||handles[i].indexOf("l")!=-1){var width=sizeIn+sizeOut}else{var width=cellWidth-2*sizeIn}if(handles[i].indexOf("b")!=-1){var height=sizeIn+sizeOut}else{if(handles[i].indexOf("t")!=-1){var height=sizeIn+sizeOutTop}else{var height=cellHeight-2*sizeIn}}var cu="";if(handles[i].indexOf("t")!=-1){cu="n"}else{if(handles[i].indexOf("b")!=-1){cu="s"}}if(handles[i].indexOf("l")!=-1){cu+="w"}else{if(handles[i].indexOf("r")!=-1){cu+="e"}}$(handle).css({width:width,height:height,cursor:cu+"-resize",left:left,top:top,backgroundColor:showActiveForTouch?"red":""})}};Qva.Mgr.CreateOrDeleteMoveHandle=function(frame,borderwidth,allowmove,isMinimizedObject){var moveElementId=frame.id+"_move";var moveElement=document.getElementById(moveElementId);if(allowmove){var height=isMinimizedObject?parseInt(frame.style.height):4,top=isMinimizedObject?0:-6-borderwidth,cellWidth=parseInt(frame.style.width);if(Qva.userAgentDetector.get("msie6o7")){cellWidth+=2*borderwidth}if(cellWidth<10){cellWidth=10}if(!moveElement){var annotationExists=document.getElementById(frame.id+"_annotation");moveElement=document.createElement("div");moveElement.id=moveElementId;moveElement.className="MoveZone";moveElement.style.cssText="width: "+cellWidth+"px; height: "+height+"px; left: "+0+"px; top: "+top+"px;";moveElement.Name=frame.Name;moveElement.moveObj=frame.id+(annotationExists?":"+frame.id+"_annotation":"");moveElement.yMin=0;moveElement.xMin=0;Qva.Events.AddDragEvent(moveElement,Qva.Move.mouseDown,Qva.Move.mouseMove,Qva.Move.mouseUp);moveElement.binderid=frame.binderid;frame.appendChild(moveElement);if(frame.AvqMgr&&frame.AvqMgr.Caption&&frame.AvqMgr.Caption.Element&&frame.AvqMgr.Caption.Element.moveObj){frame.AvqMgr.Caption.Element.moveObj=moveElement.moveObj}}$(moveElement).css({width:cellWidth,height:height,left:0,top:top})}else{if(moveElement){frame.removeChild(moveElement)}}if(Qva.userAgentDetector.get("touchEnabled")&&!isMinimizedObject){Qva.Mgr.CreateOrDeleteTouchMoveIcon(frame,allowmove)}};Qva.Mgr.CreateOrDeleteTouchMoveIcon=function(frame,allowmove){var moveElementId=frame.id+"_touchmove",moveElement=document.getElementById(moveElementId);if(allowmove){if(!moveElement){var annotationExists=document.getElementById(frame.id+"_annotation");moveElement=document.createElement("div");moveElement.id=moveElementId;moveElement.className="TouchOnlyMoveZone";moveElement.style.cssText="width: "+24+"px; height: "+24+"px; left: "+0+"px; top: "+0+"px; zIndex: 1000; position: absolute;";moveElement.Name=frame.Name;moveElement.moveObj=frame.id+(annotationExists?":"+frame.id+"_annotation":"");moveElement.yMin=0;moveElement.xMin=0;Qva.Events.AddDragEvent(moveElement,Qva.Move.mouseDown,Qva.Move.mouseMove,Qva.Move.mouseUp);moveElement.binderid=frame.binderid;frame.appendChild(moveElement);$("<span>").addClass("prop-left prop-icon-24x24 prop-draggable_icon").css({opacity:1}).appendTo(moveElement)}moveElement.style.display=Qva.Events.moveActiveForTouch?"":"none"}else{if(moveElement){frame.removeChild(moveElement)}}};Qva.Mgr.object=function(owner,elem,name,prefix,data){if(!Qva.MgrSplit(this,name,prefix)){return}owner.AddManager(this);this.Managers=new Array();this.Members={};this.Element=elem;this.binderid=owner.binderid;elem.binderid=owner.binderid;elem.ObjectId=elem.id;elem.Name=this.Name;elem.AvqMgr=this;this.LeftButton=owner.LeftButton;this.TableLimit=owner.TableLimit;this.IsHosted=owner.IsHosted;this.FirstTime=true;this.FontAspectRatio=1;this.BorderColor=null;this.BorderStyle=null;this.BorderWidth=0;this.MinWidth=0;this.MinHeight=0;var ispropertywindow=data!=null&&data.type=="TW";var $elem=$(elem);if(ispropertywindow){var _this=this;$elem.on(Qva.Events.getStartEvents(),function(event){_this.PageBinder.ToolWindowZLevel.PromoteDialog(name);event.stopPropagation()})}else{if(Qva.LabelClick){Qva.Events.AddClickEvent(elem,function(event){Qva.GetBinder(owner.binderid).SetClick(event,this.ObjectId)})}}if(data&&data.extension){$elem.attr("extension","on")}Qva.DragDrop.DropFrames[Qva.DragDrop.DropFrames.length]=this;var transientname=owner.DefaultScope+".DS";if(Qva.LabelClick&&this.PageBinder.CreateTransientListBox&&owner.Members&&!owner.Members[transientname]){this.PageBinder.CreateTransientListBox(transientname)}this.InlineStyle=owner.InlineStyle;if(elem.getAttribute("AvqStyle")){this.InlineStyle=elem.getAttribute("AvqStyle")=="true"}new Qva.Mgr.objectstyle(this,this.Element,name+".Style",prefix);var name=this.Name.substr("Document.".length);this.poll={name:name,clearcache:"true"};this.PostPaintQueue=[];if(data==null||data.id!="DS"){var caption=document.createElement("div");caption.style.display="none";caption.innerText=" ";elem.appendChild(caption);if(!this.PageBinder.isSmallDevices){this.Caption=new Qva.Mgr.caption(this,caption,this.Name+".Caption",(ispropertywindow?"QvCaption_Prop":"QvCaption"),(ispropertywindow?Qva.Mgr.caption.prototype.PropertiesPaint:Qva.Mgr.caption.prototype.CaptionPaint))}}else{this.FirstTime=false}var content=document.createElement("div");content.className="QvContent";if(this.PageBinder.GetDocumentMgr().Platform=="WORKBENCH"||this.PageBinder.GetDocumentMgr().Platform=="WEBPARTS"){content.style.cssText="height:100%; width:100%;";elem.style.zIndex=10;var parent=$elem.parent();if(parent.length===1){elem.rect={height:parent.height(),width:parent.width()}}}else{content.style.cssText="height:auto; width:auto;"}elem.appendChild(content);this.ContentElement=content;if(!this.PageBinder.isSmallDevices){new Qva.Mgr.background(this,content,this.Name+".Background");new Qva.Mgr.fullsize(this,content,this.Name);if(Qva.userAgentDetector.get("touchEnabled")){$elem.on(Qva.Events.getStartEvents(),function(event){if(this===Qva.oldTouchActiveElement){return}if(!ispropertywindow&&this.firstChild.ResizeType&&Qva.Events.resizeActiveForTouch){if(Qva.oldTouchActiveElement&&Qva.oldTouchActiveElement.AvqMgr){Qva.oldTouchActiveElement.touchResize=false;var oldborderwidth=isNaN(Qva.oldTouchActiveElement.AvqMgr.BorderWidth)?0:Qva.oldTouchActiveElement.AvqMgr.BorderWidth;Qva.Mgr.CreateAndUpdateResizeHandles(Qva.oldTouchActiveElement,Qva.oldTouchActiveElement.AvqMgr.BorderAroundContent?0:oldborderwidth)}this.touchResize=true;var borderwidth=isNaN(this.AvqMgr.BorderWidth)?0:this.AvqMgr.BorderWidth;Qva.Mgr.CreateAndUpdateResizeHandles(this,this.AvqMgr.BorderAroundContent?0:borderwidth);Qva.oldTouchActiveElement=this}})}}};Qva.Mgr.object.prototype.Remove=function(){var i;for(i=0;i<this.Managers.length;i++){if(this.Managers[i].Remove){this.Managers[i].Remove()}this.Managers[i]={}}for(i=0;i<Qva.DragDrop.DropFrames.length;++i){if(Qva.DragDrop.DropFrames[i]===this){Qva.DragDrop.DropFrames[i]=Qva.DragDrop.DropFrames[Qva.DragDrop.DropFrames.length-1];Qva.DragDrop.DropFrames.length=Qva.DragDrop.DropFrames.length-1}}this.Managers={};Qva.RemoveHtml(this.Mask);Qva.RemoveHtml(this.Element)};Qva.Mgr.object.prototype.UpdateMoveAndResizeHandles=function(element,isMinimizedObject,data){var allowresizeheightonly=false;if(data){this.AllowResize=data.allowresize=="true";this.AllowMove=data.allowmove=="true";this.AllowColumnResize=data.allowmovesheetobject!=="false";allowresizeheightonly=data.allowresize=="height"}var BorderWidth=this.BorderAroundContent?0:this.BorderWidth;if(this.AllowResize||allowresizeheightonly){Qva.Mgr.CreateAndUpdateResizeHandles(element,BorderWidth,isMinimizedObject,allowresizeheightonly?"height":"true")}else{var resizer=element.firstChild;if(resizer&&resizer.className!="ResizeFrame"){resizer=null}if(resizer){element.removeChild(resizer)}}Qva.Mgr.CreateOrDeleteMoveHandle(element,BorderWidth,this.AllowMove,isMinimizedObject)};Qva.Mgr.object.prototype.Size=function(data){var element=this.Element;if(Qva&&element.id&&data.type==="CH"){if(!Qva.params.objects){Qva.params.objects=[]}Qva.params.objects[element.id]=data.state}var element_minimized=window.document.getElementById(element.id+"_minimized");var rect={};rect.left=data.left;rect.top=data.top;rect.width=data.width;rect.height=data.height;this.Maximized=false;var mode=data.mode;if(mode=="minimized"){element.style.display="none";if(!element_minimized){return}element_minimized.style.display="";if(Qva.Mgr.SizeElement(element_minimized,rect)){$(element_minimized).height(data.height);this.UpdateMoveAndResizeHandles(element_minimized,true,data)}}else{if(mode=="hidden"){if(element_minimized){element_minimized.style.display="none"}element.style.display="none"}else{if(mode=="maximized"||data.maximized=="true"){this.Maximized=true;rect=this.PageBinder.GetMaximizedRect&&this.PageBinder.GetMaximizedRect(element);if(element_minimized){element_minimized.style.display="none"}if(Qva.Mgr.SizeElement(element,rect)){this.Resized();data.allowmove=false;data.allowresize=false;this.UpdateMoveAndResizeHandles(element,false,data)}element.style.display=""}else{if(data.left!=null){if(element_minimized){element_minimized.style.display="none"}if(Qva.Mgr.SizeElement(element,rect)){this.Resized(rect);this.UpdateMoveAndResizeHandles(element,false,data)}else{this.UpdateMoveAndResizeHandles(element,false,data)}element.style.display=""}}}}};Qva.Mgr.object.prototype.Resized=function(){this.SetObjectWidth(0);this.SetObjectHeight(0,null,true);for(var i=0;i<this.Managers.length;++i){if(!this.Managers[i].PostPaint){continue}if(this.Managers[i].Fixed){this.Managers[i].Fixed=false}this.QueuePostPaintMessage(this.Managers[i])}};Qva.Mgr.object.prototype.HandleKeyUp=function(event){var action=Qva.SpecialActions.GetAction(event);if(action){if(!action.document){this.Set(this.Name+"."+action.id,"action","",true);return true}else{Assert(false)}}return false};Qva.Mgr.object.prototype.Inside=function(pos,type){var elem=this.Element;var cellPos=Qva.GetPageCoords(elem);var cellWidth=parseInt(elem.offsetWidth);var cellHeight=parseInt(elem.offsetHeight);if(pos.x>cellPos.x&&pos.x<cellPos.x+cellWidth&&pos.y>cellPos.y&&pos.y<cellPos.y+cellHeight){for(var dix=0;dix<this.DropTypes.length;dix++){var droptype=this.DropTypes[dix];if(droptype==type){return{Element:elem,Dialog:"Drop.qvpp"}}}return{Element:null}}return null};Qva.Mgr.object.prototype.PostPaint=function(){if(!this.Element){return}if(this.Extension){if(!this.FirstTime&&!Qva.Mgr[this.Extension].prototype.PostPaint){var creator=Qva.ExtensionCreator[this.Extension];if(creator==null){Qva.ExtensionCreator[this.Extension]=Qva.WaitingForRequest;Qva.RequestScript(this.Extension,this.PageBinder)}else{if(creator!=Qva.WaitingForRequest){Assert(false)}}this.PageBinder.QueuePostPaintMessage(this);return}else{Qva.ExtensionCreator[this.Extension]=null}}if(this.PostPaintQueue.length==0){this.PaintDone();return}var mgrs=this.PostPaintQueue;this.PostPaintQueue=[];for(var i=0;i<mgrs.length;++i){if(mgrs[i].PostPaint){mgrs[i].PostPaint()}}if(this.PostPaintQueue.length==0){this.PaintDone()}};Qva.Mgr.object.prototype.PaintDone=function(){this.Painting="waiting";var _this=this;setTimeout(function(){if(_this.Painting==="waiting"){_this.Painting=false}},200)};Qva.Mgr.object.prototype.QueuePostPaintMessage=function(mgr){this.Painting=true;for(var ix=0;ix<this.PostPaintQueue.length;++ix){if(this.PostPaintQueue[ix]==mgr){return}}this.PostPaintQueue.push(mgr);this.PageBinder.QueuePostPaintMessage(this)};Qva.Mgr.object.prototype.CreateBookmarkButton=function(row,subname){var cell=row.insertCell(-1);cell.style.cssText="padding:0px 2px 0px 2px;";var button=document.createElement("button");button.setAttribute("type","button");var img=document.createElement("img");img.galleryimg="no";img.style.cssText="float:left;";button.appendChild(img);var textnode=document.createTextNode(" ");button.appendChild(textnode);var span=document.createElement("span");button.appendChild(span);button.PageBinder=this;button.onmouseover=function(){this.style.border="outset 1px Gray"};button.onmouseout=function(){this.style.border="outset 1px Transparent"};cell.appendChild(button);new Qva.Mgr.visibility(this,cell,this.Name+subname);if(!this.ReadOnly){new Qva.Mgr.action(this,button,this.Name+subname)}new Qva.Mgr.style(this,button,this.Name+".Style");new Qva.Mgr.binary(this,img,this.Name+subname);new Qva.Mgr.text(this,span,this.Name+subname);new Qva.Mgr.style(this,button,this.Name+subname)};Qva.Mgr.object.prototype.CreateBookmark=function(readOnly){this.ReadOnly=readOnly;this.ContentElement.className+=" QvBookmarkObject";var table=document.createElement("table");var colgroup=document.createElement("colgroup");var col=document.createElement("col");col.style.cssText="width:45%;";colgroup.appendChild(col);col=document.createElement("col");col.style.cssText="width:55%;";colgroup.appendChild(col);table.appendChild(colgroup);var row1=table.insertRow(-1);var cell1=row1.insertCell(-1);cell1.style.cssText="padding:2px 4px 10px 4px;";cell1.colSpan=2;var select=document.createElement("select");cell1.appendChild(select);var row2=table.insertRow(-1);this.CreateBookmarkButton(row2,".ADD");this.CreateBookmarkButton(row2,".REM");this.ContentElement.appendChild(table);new Qva.Mgr.bookmarksselect(this.PageBinder.GetDocumentMgr(),select,this.PageBinder.GetDocumentMgr().DefaultScope+".Bookmarks",readOnly);new Qva.Mgr.style(this,select,this.Name+".Style")};Qva.Mgr.object.prototype.CreateButton=function(){this.ContentElement.className+=" QvButton";var button=document.createElement("button");button.setAttribute("type","button");button.style.cssText="cursor: pointer; width: auto; height: auto;";var img=document.createElement("img");img.galleryimg="no";button.appendChild(img);this.ContentElement.appendChild(button);new Qva.Mgr.actions(this,button,this.Name+".Content");new Qva.Mgr.button(this,button,this.Name+".Content")};Qva.Mgr.object.prototype.CreateTextOrLineObject=function(istextobject){if(istextobject){var table=document.createElement("table");table.className="TextObject";$(this.Element).attr("objType","TextObject");table.style.cssText="line-height: 1.3; width: 100%; height:100%;";var row=table.insertRow(-1);var cell=row.insertCell(-1);$(cell).css("word-wrap","break-word");this.ContentElement.appendChild(table);this.ContentElement.style.overflow="hidden";new Qva.Mgr.text(this,cell,this.Name+".Content");new Qva.Mgr.style(this,cell,this.Name+".Style");new Qva.Mgr.style(this,cell,this.Name+".Content.Style");Qva.Touch.Textbox.AddTouchScroll(this,new Qva.Mgr.scroll(this,this.ContentElement,this.Name+".Content.Style"))}new Qva.Mgr.actions(this,this.ContentElement,this.Name+".Content")};Qva.Mgr.object.prototype.CreateListBox=function(){var listbox=document.createElement("div"),len=0;listbox.className="QvListbox";$(listbox).attr("objType","Listbox");$(listbox).css("visibility","hidden");this.ContentElement.appendChild(listbox);var mgr=new Qva.Mgr.listbox(this,listbox,this.Name,"",this.PageBinder);new Qva.Mgr.style(this,listbox,this.Name+".Style");if(Qva.userAgentDetector.get("touchEnabled")){Qva.Touch.Listbox.AddTouchScroll(this.ContentElement)}return mgr};Qva.Mgr.container=function(owner,elem,name,prefix){if(!Qva.MgrSplit(this,name,prefix)){return}this.Appearance=null;this.Children=null;this.Element=elem;this.NavigatorElement=null;this.Touched=false;this.NavigatorItems=new Array();this.binderid=owner.binderid;this.oldstylenavigationarea=Qva.GetBinder(this.binderid).oldstylenavigationarea;this.NavigatorElement=document.createElement("ul");var divChildren=document.createElement("div");this.Element.appendChild(this.NavigatorElement);this.Element.appendChild(divChildren);this.Children=new Qva.Mgr.children(owner,divChildren,this.Name+".Children");owner.AddManager(this);this.NavigatorElement.onclick=function(e){Qva.CancelBubble(e)};if(!this.oldstylenavigationarea){var tmpParent=$("<div/>").appendTo(this.Element);this.EllipsisElement=$("<div/>").addClass("Qv_multiline").hide().css({"word-wrap":"break-word"}).appendTo(tmpParent)}};Qva.Mgr.container.prototype={Appearance:null,AppearanceEnum:{Top:"top",Left:"left",Right:"right",Bottom:"bottom",Drop:"drop",Grid:"grid"},Children:null,Touched:null,Element:null,NavigatorElement:null,NavigatorItems:[{itemId:"",elem:null}],NavigatorChange:function(selVal){var binder=Qva.GetBinder(this.binderid);if(this.NavigatorElement.SelectedVal!==selVal){binder.Set(this.Name,"select",selVal,true);this.NavigatorElement.SelectedVal=selVal}},RemoveNavigatorContent:function(){while(this.NavigatorElement.firstChild){this.NavigatorElement.removeChild(this.NavigatorElement.firstChild)}},TabClick:function(e,container){if(!e){e=window.event}var elem=e.target||e.srcElement,tab=$(elem).closest(".QvTab");if(tab.length===1&&tab[0].ObjectId){container.NavigatorChange(tab[0].ObjectId)}},GetLargestTabHeight:function(){var retval=0,i=0,len=this.NavigatorItems.length,tabHeight=0;for(;i<len;i++){tabHeight=this.NavigatorItems[i].elem.offsetHeight;if(retval<tabHeight){retval=tabHeight}}return retval}};Qva.Mgr.container.__class=true;Qva.Mgr.container.prototype.AddTab=function(tab,node){var container=this;Qva.Events.AddClickEvent(tab,function(e){container.TabClick(e,container)});tab.ObjectId=node.getAttribute("id");icon=node.getAttribute("icon");if(icon){var img=document.createElement("img");img.src=Qva.GetBinder(this.binderid).BuildBinaryUrl(null,null,icon);img.className="QvTabIcon";img.style.marginRight="0px";$("<div/>").append(img).appendTo(tab)}this.styleTab(tab,node);var text=node.getAttribute("text");text=text?text.replace(/\t/g," "):" ";var textdiv=$("<div/>").text(text).addClass("QvTabText").appendTo(tab);if(this.oldstylenavigationarea){textdiv.addClass("QvTabTextOldLayout")}};Qva.Mgr.container.prototype.styleTab=function(tab,node){SetElementStyle(tab,"fontWeight",node.getAttribute("fontweight"));SetElementStyle(tab,"fontFamily",node.getAttribute("fontfamily"));SetElementStyle(tab,"fontSize",node.getAttribute("fontsize"),"pt");SetElementStyle(tab,"fontStyle",node.getAttribute("fontstyle"));SetElementStyle(tab,"textDecoration",node.getAttribute("textdecoration"));SetElementStyle(tab,"border","1px solid #7d7d7d");SetElementStyle(tab,"textAlign",node.getAttribute("textalign"));Qva.ApplyColorDataToElement(node,tab,true,true)};Qva.Mgr.container.prototype.Paint=function(mode,node){var container=this,appearance=node.getAttribute("appearance"),members=node.getElementsByTagName("element"),membersCount=members.length,i=0,createNavigatorItems=(container.Appearance!==appearance)||(container.NavigatorItems.length!==membersCount&&appearance!=container.AppearanceEnum.Grid);this.membersCount=membersCount;this.calculateMaxTextWidthAndHeight(members);this.icon=node.getAttribute("icon");container.Appearance=appearance;if(!createNavigatorItems&&(container.NavigatorItems.length>0&&membersCount>0)){for(;i<membersCount;i++){if(members[i].getAttribute("id")!=this.members[i].id||members[i].getAttribute("text")!==this.members[i].text||members[i].getAttribute("icon")!=this.members[i].icon){createNavigatorItems=true;break}}}this.members={};for(i=0;i<membersCount;i++){var data={};ObjectifyXmlAttributes(data,members[i]);this.members[data.id]=data}container.Touched=true;container.NavigatorElement.SelectedVal=node.getAttribute("selected");if(createNavigatorItems){this.NavigatorElement.removeAttribute("style");container.NavigatorItems=new Array();container.RemoveNavigatorContent();container.Children.Grid=(appearance==container.AppearanceEnum.Grid);for(var prop in container.Children.GridElements){var div=container.Children.GridElements[prop];div.removeAttribute("style")}var id="",text="";switch(container.Appearance){case container.AppearanceEnum.Grid:break;case container.AppearanceEnum.Drop:var elemDrop=document.createElement("select");elemDrop.style.maxWidth="100%";elemDrop.style.height="100%";elemDrop.style.margin="0px 1px";container.NavigatorElement.appendChild(elemDrop);for(i=0;i<membersCount;i++){text=members[i].getAttribute("text");id=members[i].getAttribute("id");var option=document.createElement("option");option.innerText=text;option.value=id;elemDrop.appendChild(option);container.NavigatorItems.push({itemId:id,elem:option})}Qva.Events.AddChangeEvent(elemDrop,function(){if(elemDrop.selectedIndex>-1){container.NavigatorChange(elemDrop.options[elemDrop.selectedIndex].value)}});break;case container.AppearanceEnum.Top:case container.AppearanceEnum.Bottom:var tab=null,icon=null,text="",totWidthTabs=getClientWidth(this.Children.Element),tabWidth=Math.floor(totWidthTabs/members.length),margin=3,currTabHeight=0;for(i=0;i<membersCount;i++){tab=document.createElement("li");this.AddTab(tab,members[i]);tab.className="QvTab QvTabTopBottom";$(tab).css({"min-height":this.largestTextHeight+"px"});container.NavigatorElement.appendChild(tab);currTabHeight=getClientHeight(tab);container.NavigatorItems.push({itemId:tab.ObjectId,elem:tab})}break;case container.AppearanceEnum.Left:case container.AppearanceEnum.Right:default:var tab=null,icon=null,text="";for(i=0;i<members.length;i++){tab=document.createElement("li");this.AddTab(tab,members[i]);tab.className="QvTab";if(this.Appearance===this.AppearanceEnum.Left){tab.className+=" QvTabLeft"}else{if(this.Appearance===this.AppearanceEnum.Right){tab.className+=" QvTabRight"}}container.NavigatorElement.appendChild(tab);container.NavigatorItems.push({itemId:tab.ObjectId,elem:tab})}break}}else{if(container.NavigatorItems.length>0){for(i=0;i<membersCount;i++){this.styleTab(this.NavigatorItems[i].elem,members[i])}}}if(container.Appearance==container.AppearanceEnum.Grid){this.GridOrder=[];for(i=0;i<membersCount;i++){this.GridOrder.push(parseInt(members[i].getAttribute("id")))}container.GridColumnWiths=[];var columnWidthsElement=node.getElementsByTagName("columnwidths");if(columnWidthsElement&&columnWidthsElement[0]){var columnWidthsChildren=columnWidthsElement[0].getElementsByTagName("width");for(var cwc=0;cwc<columnWidthsChildren.length;cwc++){container.GridColumnWiths.push(columnWidthsChildren[cwc].getAttribute("value"))}}container.GridRowHeights=[];var rowHeightsElement=node.getElementsByTagName("rowheights");if(rowHeightsElement&&rowHeightsElement[0]){var rowHeightsChildren=rowHeightsElement[0].getElementsByTagName("height");for(var rhc=0;rhc<rowHeightsChildren.length;rhc++){container.GridRowHeights.push(rowHeightsChildren[rhc].getAttribute("value"))}}container.GridSpacing=parseInt(node.getAttribute("spacing"))}else{if(this.PageBinder.PageBinder.OfflineRecorder){this.PageBinder.PageBinder.OfflineRecorder.AddContainer(container)}}container.SetActiveStyle(true);container.PageBinder.QueuePostPaintMessage(this)};Qva.Mgr.container.prototype.calculateMaxTextWidthAndHeight=function(nodes){var largestWidth=0,largestHeight=0;$(nodes).each(function(){var size=Qva.MeasureText(this.getAttribute("text"),this.getAttribute("fontfamily"),this.getAttribute("fontsize")+"pt",this.getAttribute("fontweight"));if(size.width>largestWidth){largestWidth=size.width}if(size.height>largestHeight){largestHeight=size.height}});this.largestTextWidth=largestWidth;this.largestTextHeight=largestHeight};Qva.Mgr.container.prototype.setMultilineEllipsisOnTabs=function(width,height){var tmpEl=this.EllipsisElement,tmpParent=tmpEl.parent(),members=this.members;$(this.NavigatorElement).find(".QvTab").each(function(){var el=$(this).find(".QvTabText"),member=members[this.ObjectId];tmpParent.css({height:height});tmpEl.text(member.text).width(width);tmpEl.css({"font-family":member.fontfamily,"font-size":member.fontsize+"pt","font-weight":member.fontweight});Qva.SetEllipsisOnMultiLineElement(tmpParent);el.html(tmpEl.html())})};Qva.Mgr.container.prototype.PostPaint=function(){switch(this.Appearance){case this.AppearanceEnum.Grid:this.PostPaint_Grid();break;case this.AppearanceEnum.Drop:this.PostPaint_Drop();break;case this.AppearanceEnum.Top:case this.AppearanceEnum.Bottom:this.PostPaint_TopBottom();break;case this.AppearanceEnum.Right:case this.AppearanceEnum.Left:default:this.PostPaint_LeftRight();break}for(i=0;i<this.Children.Managers.length;++i){var objmgr=this.Children.Managers[i];if(objmgr.Element.style.display===""){objmgr.Size({mode:"enabled",maximized:"true"})}}};Qva.Mgr.container.prototype.PostPaint_LeftRight=function(){var maxContainerHeight=this.PageBinder.GetContentMaxHeight(this.Element),maxContainerWidth=this.PageBinder.GetMaxClientWidth(),leftRightNavWidth=!this.oldstylenavigationarea?Math.min(this.largestTextWidth+(this.icon==="1"?30:12),maxContainerWidth/5):this.largestTextWidth+55,navWidth=leftRightNavWidth+"px",navHeight=maxContainerHeight,childLeft=this.Appearance===this.AppearanceEnum.Right?"0px":navWidth,childWidth=this.PageBinder.GetMaxClientWidth()-leftRightNavWidth,childHeight=maxContainerHeight;this.Element.style.height=maxContainerHeight+"px";$(this.NavigatorElement).css({margin:this.Appearance===this.AppearanceEnum.Right?"0px 0px 0px "+childWidth+"px":"0px 0px 0px 0px",position:"relative",left:"0px",top:"0px",width:navWidth,height:navHeight+"px",display:"flex","flex-direction":"column","padding-left":"0px"});$(this.Children.Element).css({display:childWidth<=0?"none":"block",position:"absolute",left:childLeft,top:"0px",width:childWidth-2+"px",height:childHeight-2+"px",margin:"1px"});$(this.Children.Element.childNodes).css({position:"",left:"",top:"",width:"",height:""});this.selectActiveTab();if(this.NavigatorElement.childNodes.length===0){return}var el=$(this.NavigatorElement).find(".QvTabText").first(),width=el.parent().width()-el.position().left-4,largestHeight=0;for(var i in this.members){var item=this.members[i];var height=Qva.MeasureText(item.text,item.fontfamily,item.fontsize+"pt",item.fontweight,width,true).height;if(height>largestHeight){largestHeight=height}}if(!this.oldstylenavigationarea){largestHeight=Math.max(2*this.largestTextHeight,largestHeight);$(this.NavigatorElement).find(".QvTab").css({"flex-basis":largestHeight+"px"});var textHeight=el.parent().height();this.setMultilineEllipsisOnTabs(width,textHeight)}};Qva.Mgr.container.prototype.PostPaint_TopBottom=function(){var maxContainerHeight=this.PageBinder.GetContentMaxHeight(this.Element),childWidth=this.PageBinder.GetMaxClientWidth(),maxHeight=Math.max(maxContainerHeight/5,2*this.largestTextHeight),minheight=Math.min(maxContainerHeight/5,2*this.largestTextHeight);$(this.NavigatorElement).css({display:"flex","flex-direction":"row","padding-left":"0px",height:"auto","max-height":maxHeight+"px","min-height":minheight+"px"});$(this.NavigatorElement).find(".QvTab").css({width:childWidth/this.membersCount+"px"});var members=this.members;$(this.NavigatorElement).find(".QvTab").each(function(){var el=$(this).find(".QvTabText"),member=members[this.ObjectId],text=member.text;text=text?text.replace(/\t/g," "):" ";el.text(text)});var navHeight=$(this.NavigatorElement).height(),childHeight=maxContainerHeight-navHeight-1;$(this.NavigatorElement).css({margin:this.Appearance===this.AppearanceEnum.Bottom?childHeight+"px 0px 1px 0px":"1px 0px",position:"relative",left:"0px",top:"0px",width:"100%",height:navHeight+"px"});$(this.Children.Element).css({display:childWidth<=0?"none":"block",position:this.Appearance===this.AppearanceEnum.Bottom?"absolute":"relative",left:"0px",top:"0px",width:childWidth-2+"px",height:childHeight-2+"px",margin:"1px"});$(this.Children.Element.childNodes).css({position:"",left:"",top:"",width:"",height:""});this.selectActiveTab();if(!this.oldstylenavigationarea){var el=$(this.NavigatorElement).find(".QvTab").first(),iconWidth=el.find(".QvIcon").parent().outerWidth(true)||0,width=el.width()-iconWidth-6,height=el.height();this.setMultilineEllipsisOnTabs(width,height)}};Qva.Mgr.container.prototype.PostPaint_Grid=function(){var childWidth=this.PageBinder.GetMaxClientWidth(),childHeight=this.PageBinder.GetContentMaxHeight(this.Element);$(this.NavigatorElement).css({"padding-left":"0px",margin:"0px 0px 0px 0px",position:"relative",left:"0px",top:"0px",width:"0px",height:"0px"});$(this.Children.Element).css({display:childWidth<=0?"none":"block",position:"relative",left:"0px",top:"0px",width:childWidth+"px",height:childHeight+"px"});var cellDivs=this.Children.Element.childNodes;var cellCount=0;var spacing=this.GridSpacing;var top=spacing;var GridPositions=[];for(var row=0;row<this.GridRowHeights.length;row++){var rowHeight=Math.floor((childHeight-(this.GridRowHeights.length)*spacing*2)*this.GridRowHeights[row]/100);var left=spacing;for(var col=0;col<this.GridColumnWiths.length;col++){var height=rowHeight;var width=Math.floor((childWidth-(this.GridColumnWiths.length)*spacing*2)*this.GridColumnWiths[col]/100);if(col==this.GridColumnWiths.length-1){width=childWidth-left-spacing}if(row==this.GridRowHeights.length-1){height=childHeight-top-spacing}GridPositions.push({position:"absolute",top:top,left:left,height:height,width:width});left+=width+spacing*2}top+=rowHeight+spacing*2}for(var i=0;i<cellDivs.length&&i<this.GridOrder.length&&i<GridPositions.length;i++){$(cellDivs[this.GridOrder[i]]).css(GridPositions[i])}};Qva.Mgr.container.prototype.PostPaint_Drop=function(){var maxContainerHeight=this.PageBinder.GetContentMaxHeight(this.Element),childWidth=this.PageBinder.GetMaxClientWidth()-2,childHeight=maxContainerHeight-25;$(this.NavigatorElement).css({"padding-left":"0px",margin:"1px 0px",position:"relative",left:"0px",top:"0px",width:"100%",height:"22px"});$(this.Children.Element).css({display:childWidth<=0?"none":"block",position:"relative",left:"0px",top:"0px",width:childWidth+"px",height:childHeight+"px",margin:"1px"});$(this.Children.Element.childNodes).css({position:"",left:"",top:"",width:"",height:""});$(this.NavigatorElement).find("select").val(this.NavigatorElement.SelectedVal)};Qva.Mgr.container.prototype.selectActiveTab=function(tabWidth,margin){for(i=0;i<this.NavigatorItems.length;i++){if(this.NavigatorItems[i].itemId===this.NavigatorElement.SelectedVal){if(this.NavigatorItems[i].elem.className.indexOf("QvTabSelected")===-1){this.NavigatorItems[i].elem.className+=" QvTabSelected shadowed"}}else{this.NavigatorItems[i].elem.className=this.NavigatorItems[i].elem.className.replace("QvTabSelected","").replace("shadowed","")}if(tabWidth>0){this.NavigatorItems[i].elem.style.width=tabWidth-2-margin*2+"px"}}};Qva.Mgr.object.prototype.CreateContainer=function(){$(this.Element).attr("objType","Container");new Qva.Mgr.container(this,this.ContentElement,this.Name)};Qva.Mgr.object.prototype.CreateBasicTable=function(readOnly){var grid=document.createElement("div");grid.className="QvGrid";$(this.Element).attr("objType","Grid");this.ContentElement.appendChild(grid);new Qva.Mgr.grid(this,grid,this.Name,"",readOnly);new Qva.Mgr.style(this,grid,this.Name+".Style")};Qva.Mgr.object.prototype.CreateSlider=function(){var slider=document.createElement("div");slider.className="QvSliderObject";$(this.Element).attr("objType","SliderObject");slider.style.cssText="display:none; width: 100%; height: auto;";this.ContentElement.appendChild(slider);var calendar=document.createElement("div");calendar.className="QvSliderObject";calendar.style.cssText="display:none; width: auto; height: auto;";var table=document.createElement("table");table.style.cssText="margin: 5px; width:100%;";var colgroup=document.createElement("colgroup");var col=document.createElement("col");colgroup.appendChild(col);col=document.createElement("col");col.style.cssText="width: 34px;";colgroup.appendChild(col);table.appendChild(colgroup);var row=table.insertRow(-1);var cell1=row.insertCell(-1);cell1.style.cssText="display:none; background-color: White;";var cell2=row.insertCell(-1);cell2.style.cssText="padding: 3px 3px 3px 3px;";var img=document.createElement("input");img.type="image";img.src=this.PageBinder.BuildBinaryUrl(null,null,"Calendar_img");img.title="Date selector";img.style.cssText="display:none; cursor: pointer; border: 1px solid red;";cell2.appendChild(img);calendar.appendChild(table);this.ContentElement.appendChild(calendar);new Qva.Mgr.visibility(this,slider,this.Name+".Slider");new Qva.Mgr.visibility(this,calendar,this.Name+".Calendar");new Qva.Mgr.slider(this,slider,this.Name+".Slider");new Qva.Mgr.style(this,slider,this.Name+".Style");new Qva.Mgr.text(this,cell1,this.Name+".Calendar");new Qva.Mgr.style(this,cell1,this.Name+".Style");new Qva.Mgr.date(this,img,this.Name+".Calendar");new Qva.Mgr.actionicon(this,cell1,this.Name+".Calendar")};Qva.Mgr.hideifhidden=function(owner,elem,name,prefix){if(!Qva.MgrSplit(this,name,prefix)){return}owner.AddManager(this);this.Element=elem};Qva.Mgr.hideifhidden.prototype.Paint=function(mode,node){this.Touched=true;var element=this.Element;if(element.style.display!="none"){element.style.display=Qva.MgrGetDisplayFromMode(this,mode)}};function CreateHeaderOrFooter(tablemgr,table){var parent=table.parentNode;parent.removeChild(table);var div=document.createElement("div");parent.appendChild(div);div.appendChild(table);parent.style.overflowY="hidden";div.style.overflowY="hidden";div.style.overflowX="hidden";div.style.position="relative";var mgr={};mgr.Element=div;mgr.TableElement=table;mgr.ScrollParent=parent;mgr.Lines=[];mgr.Body=table.tBodies[0];if(mgr.Body==null){table.insertRow(-1);mgr.Body=table.tBodies[0]}mgr.TableMgr=tablemgr;table.TableMgr=tablemgr;return mgr}Qva.Mgr.object.prototype.CreateChartOrTableBox=function(ischart){this.CreateBasicTable();if(ischart){var graph=document.createElement("div");graph.className="QvGraph";graph.style.cssText="display:none;width:auto;height:auto;";var chart=document.createElement("img");chart.setAttribute("draggable","false");if(Qva.userAgentDetector.get("gecko")){chart.setAttribute("ondragstart","return false")}chart.style.cssText="width:auto;height:auto;";this.Chart=chart;graph.appendChild(chart);this.ContentElement.appendChild(graph)}if(ischart){new Qva.Mgr.label(this,graph,this.Name+".Graph");var graph=new Qva.Mgr.graph(this,chart,this.Name+".Graph");new Qva.Mgr.actions(this,chart,this.Name+".Graph")}};Qva.Mgr.object.prototype.CreateSearchObject=function(data){var input=$(this.ContentElement).addClass("QvSearchObject ui-helper-clearfix").append('<span class="prop-icon-24x24 prop-dyn-dynamic-dropdown-search-icon"></span><input/>').find("input")[0];$(this.Element).attr("objType","SearchObject");new Qva.Mgr.style(this,input,this.Name+".Style");new Qva.Mgr.style(this,input,this.Name+".Input");new Qva.Mgr.inputsearch(this,input,this.Name+".Input")};Qva.Mgr.object.prototype.CreateObjectContent=function(renderer,format,readOnly){$(this.Element).attr("objsubtype",renderer);switch(renderer){case"CH":var ischart=true;case"TB":this.CreateChartOrTableBox(ischart);break;case"TX":var istextobject=true;case"LA":this.CreateTextOrLineObject(istextobject);break;case"CS":case"IB":case"MB":case"SB":this.CreateBasicTable(readOnly);break;case"LB":this.CreateListBox();break;case"BM":this.CreateBookmark(readOnly);break;case"SL":this.CreateSlider();break;case"BU":this.CreateButton();break;case"SO":this.CreateSearchObject();break;case"CT":this.CreateContainer();break;case"TW":break;default:break}};Qva.Mgr.object.prototype.IsInvalid=function(){return !this.Mode||this.Mode=="invalid"};Qva.Mgr.object.prototype.IsWaiting=function(){return this.Mode&&this.Mode=="waiting"};Qva.Mgr.object.prototype.IsAborted=function(){return this.Mode&&this.Mode=="aborted"};Qva.Mgr.object.prototype.GetUpdates=function(polls){if(this.IsInvalid()){var poll=clone(this.poll);if(this.poll.clearcache){delete this.poll.clearcache}polls.push(poll);this.Mode="waiting";if(this.Hide){this.Hide()}}for(var mix=0;mix<this.Managers.length;++mix){var mgr=this.Managers[mix];if(mgr.GetUpdates){mgr.GetUpdates(polls)}}};Qva.Mgr.object.prototype.Paint=function(mode,node,name,partial){var m=this.Mode=node.getAttribute("mode");if(node.getAttribute("menu")=="true"){Qva.SetContextMenu(this.Element,function(event){return Qva.GetBinder(this.binderid).OnContextMenu(event,this.ObjectId)})}if(m=="aborted"){this.Abort()}else{if(m=="working"||m=="invalid"){}else{this.Show();if(m!="cached"){this.Painting=true;var accept=node.getAttribute("accept");this.DropTypes=accept?accept.split(";"):[];var element=this.Element;var $elem=$(element);element.TargetName=node.getAttribute("objectid");element.style.display=Qva.MgrGetDisplayFromMode(this,mode);if(element.style.display=="none"){if(this.TableMgr){this.TableMgr.Reset()}return}if(this.FirstTime){if(!this.Caption){if(!this.PageBinder.isSmallDevices){var caption=document.createElement("div");caption.className="QvCaption";caption.innerText=" ";this.Element.appendChild(caption);this.Caption=new Qva.Mgr.caption(this,caption,this.Name+".Caption")}}this.Type=node.getAttribute("type");if(node.getAttribute("extension")){this.Extension=node.getAttribute("extension");Qva.AddExtensionBase(this.Extension,this);this.PageBinder.QueuePostPaintMessage(this)}else{this.CreateObjectContent(node.getAttribute("type"),node.getAttribute("format"),node.getAttribute("readOnly")==="true"?true:false)}if(Qva.userAgentDetector.get("msie")&&this.Type!=="TX"&&this.Type!=="TW"&&this.Type!=="IB"&&this.Type!=="SO"&&this.Type!=="CT"&&!$elem.attr("extension")&&this.Element.className.indexOf("ToolWindow")===-1){$(element).disableSelection().attr("unselectable","on")}this.FirstTime=false}if(node.getAttribute("menu")=="true"){Qva.SetContextMenu(element,function(event){return Qva.GetBinder(this.binderid).OnContextMenu(event||window.event,this.ObjectId)})}this.PaintTree(node,partial,this.Name);this.SetActiveStyle(this.IsActive)}else{if(this.Element.style.display=="none"&&(this.PageBinder instanceof Qva.Mgr.children||this.PageBinder.GetDocumentMgr().Platform=="WORKBENCH"||this.PageBinder.GetDocumentMgr().Platform=="WEBPARTS")){this.Element.style.display=""}if(this.Type==="CH"){this[this.oldShow?"oldShow":"Show"]()}}}}};Qva.Mgr.object.prototype.SetMask=function(opacity,clear){var elem=$(this.Element),mask,borderAdjust=0,supportedType=this.Type&&$.inArray(this.Type,["TX","SO","CS","LA","BM","CT"])===-1;if(!elem.length||!supportedType){return}this.Mask=this.Mask||document.createElement("div");mask=$(this.Mask);if(clear&&this.MaskTimeout){this.MaskTimeout=clearTimeout(this.MaskTimeout)}if(opacity===0||mask.is(":visible")){mask.fadeOut("fast");return}if(elem.outerWidth()===Qva.GetViewportWidth()){borderAdjust=parseFloat(elem.css("leftBorderWidth"))}mask.css({width:elem.outerWidth()-borderAdjust,height:elem.outerHeight()-borderAdjust,zIndex:1000,position:"absolute",left:0,top:0,backgroundColor:"white",display:"none",opacity:opacity}).empty().appendTo(elem);return this.AsyncElement};Qva.Mgr.object.prototype.Abort=function(){if(this.State!="Abort"){this.State="Abort";this.SetMask(0.4);if(!this.Mask){return}this.Mask.innerHTML='<img style="position: absolute; width: 100%; height: 100%;" src="'+Qva.QvAjaxZfcPath+'htc/Aborted2.png" alt="" />'}};Qva.Mgr.object.prototype.Hide=function(){var self=this;if(location.port==21544){return}if(this.State!="Hide"){this.State="Hide";this.SetMask(0.4);if(!this.Mask){return}if(typeof this.MaskTimeout!=="number"){this.MaskTimeout=setTimeout(function(){$(self.Mask).fadeIn()},1000)}var binder=Qva.GetBinder(self.binderid);var img=!binder.isSmallDevices?'<img style="position: relative; left: -8px; top: -8px;" src="'+Qva.QvAjaxZfcPath+'htc/Images/Working.gif" alt="" />':'<img style="margin-left: -60px; margin-top: -20px;" src="img/loader-object.gif" />';var offsetLeft=!binder.isSmallDevices?-47:-90;this.Mask.innerHTML='<div style="position: absolute; left: 50%; top: 50%; width: auto; height: auto;">'+img+"</div>"}};Qva.Mgr.object.prototype.Disable=function(){if(this.State!="Disable"){this.State="Disable";this.SetMask(0)}};Qva.Mgr.object.prototype.Show=function(){if(this.State!="Show"){if(this.Element.ObjectId==="Search.DS"){this.Element.style.zIndex=Qva.generalHelper.getHighestZIndex()+10}this.State="Show";this.SetMask(0,true)}};Qva.Mgr.object.prototype.Append=function(mgr,name,attr,noautoview){this.PageBinder.Append(this,this.Name,attr,noautoview)};Qva.Mgr.object.prototype.SetInitial=function(type,value){this.PageBinder.SetInitial(this.Name,type,value)};Qva.ObjectifyXML=function(obj,node){for(var i=0;i<node.attributes.length;i++){var name=node.attributes[i].name;var text=node.attributes[i].value;if(name=="mode"){switch(text){case"enabled":obj.visible=true;obj.enabled=true;break;case"disabled":obj.visible=true;obj.enabled=false;break;case"hidden":obj.visible=false;obj.enabled=false;break}}var value=parseFloat(node.attributes[i].value);if((!obj.from||obj.from&&obj.from!=="tabrow"&&obj.text&&(obj.text.indexOf("Document\\")>-1||obj.text.indexOf("Server\\")>-1))&&text==value&&(!Qva.UrlParams.isQmc||text.length===value.toString().length)){obj[name]=value}else{obj[name]=text}}var pos=0;for(var child=node.firstChild;child;child=child.nextSibling){var tmp={};if(obj.from&&obj.from==="tabrow"){tmp.from="tabrow"}Qva.ObjectifyXML(tmp,child);if(!obj[child.tagName]){obj[child.tagName]=new Array()}obj[child.tagName].push(tmp)}};window.ObjectifyXmlAttributes=function(obj,node){if(!node){return}for(var i=0;i<node.attributes.length;i++){var name=node.attributes[i].name;if(name=="name"){continue}var text=node.attributes[i].value;if(name=="mode"){switch(text){case"enabled":obj.visible=true;obj.enabled=true;break;case"disabled":obj.visible=true;obj.enabled=false;break;case"hidden":obj.visible=false;obj.enabled=false;break}}var value=parseFloat(node.attributes[i].value);if(text==value){obj[node.attributes[i].name]=value}else{obj[node.attributes[i].name]=text}}};Qva.ObjectifyXmlNode=function(obj,node){if(!node.getAttribute("name")){return}obj[node.getAttribute("name")]={};for(var child=node.firstChild;child;child=child.nextSibling){Qva.ObjectifyXmlNode(obj[node.getAttribute("name")],child)}ObjectifyXmlAttributes(obj[node.getAttribute("name")],node)};Qva.Mgr.object.prototype.GenericPaint=function(mode,node){this.Touched=true;if(typeof(this.QvaPublic)==="undefined"){this.QvaPublic=new Qva.Public.Wrapper(this)}if(typeof(this.DynamicMethodsSet)==="undefined"){this.DynamicMethodsSet=true;if(typeof(this.QvaPublic.Type)==="undefined"){this.QvaPublic.Type=this.Type}if(typeof(this.Type)==="undefined"){this.Type=this.QvaPublic.Type}switch(this.Type){case"LB":this.QvaPublic.Data.GetSelected=function(){var returnValue=new Array();for(var i=0;i<this.Rows.length;i++){if(this.Rows[i]!==undefined){var item=this.Rows[i][0];if(item.selected==="yes"){returnValue.push(item)}}}return returnValue};this.QvaPublic.Data.GetEnabled=function(){var returnValue=new Array();for(var i=0;i<this.Rows.length;i++){if(this.Rows[i]!==undefined){var item=this.Rows[i][0];if(item.mode!=="disabled"){returnValue.push(item)}}}return returnValue};case"Field":this.QvaPublic.Data.Lock=function(){var params={};params.action="";this.Super.DocumentMgr.Set(this.Super.Name+".LOC",params)};this.QvaPublic.Data.Unlock=function(){var params={};params.action="";this.Super.DocumentMgr.Set(this.Super.Name+".ULC",params)};this.QvaPublic.Data.Search=function(searchstring,toggle){if(this.Super.ObjectMgr.Extension){this.Super.DocumentMgr.Search(this.Super.Layout.ObjectId,searchstring,toggle,true)}else{this.Super.DocumentMgr.Search(this.Super.Name,searchstring,toggle,true)}};this.QvaPublic.Data.SelectValues=function(values,toggle){var params={};params.select=values;params.toggle=toggle?"true":"false";this.Super.DocumentMgr.Set(this.Super.Name,params)};this.QvaPublic.Data.SelectTexts=function(){var len=arguments.length,searchStr="",i=0;if(len>0){if(len===1&&typeof(arguments[0])==="object"&&arguments[0].length>0){for(i;i<arguments[0].length;i++){if(i==0){searchStr=arguments[0][0]}else{searchStr+="`&&`"+arguments[0][i]}}}else{for(i;i<len;i++){if(i==0){searchStr=arguments[0]}else{searchStr+="`&&`"+arguments[i]}}}var params={};params.selecttexts=searchStr;this.Super.DocumentMgr.Set(this.Super.Name,params)}};this.QvaPublic.Data.ClearSelections=function(){var params={};params.action="";this.Super.DocumentMgr.Set(this.Super.Name+".CD",params)};this.QvaPublic.Data.ClearAllButThis=function(){var params={};params.action="";this.Super.DocumentMgr.Set(this.Super.Name+".CO",params)};this.QvaPublic.Data.SelectAll=function(){var params={};params.action="";this.Super.DocumentMgr.Set(this.Super.Name+".SA",params)};this.QvaPublic.Data.SelectExcluded=function(){var params={};params.action="";this.Super.DocumentMgr.Set(this.Super.Name+".SE",params)};this.QvaPublic.Data.SelectPossible=function(){var params={};params.action="";this.Super.DocumentMgr.Set(this.Super.Name+".SP",params)};break;case"IB":this.QvaPublic.GetVariable=function(row){if(row==undefined){row=0}if(this.Data.Rows[row]){return this.Data.Rows[row][2]}return null};this.QvaPublic.SetVariable=function(text,row){if(row==undefined){row=0}var params={};params.text=text;this.DocumentMgr.Set(this.Name+".V"+row,params)};break;case"TX":this.QvaPublic.GetText=function(){if(this.Layout&&this.Layout.Content&&this.Layout.Content.text){return this.Layout.Content.text}return null};break;case"SO":case"SL":case"BM":case"LA":break;case"BU":this.QvaPublic.Click=function(){var params={};params.action="";this.DocumentMgr.Set(this.Name,params)};break;case"CH":this.QvaPublic.Data.SearchColumn=function(colNo,searchstring,toggle,isfinal){var params={};params.search=searchstring;if(toggle){params.toggle="true"}this.Super.DocumentMgr.Set(this.Super.Name+".C"+colNo,params,isfinal)};this.QvaPublic.Data.SelectTextsInColumn=function(colNo,toggle){var len=arguments.length,params={};if(len>2){params.select="";params.text=[];if(len===3&&typeof(arguments[2])==="object"&&arguments[2].length>0){for(var i=0;i<arguments[2].length;i++){params.text[params.text.length]=arguments[2][i]}}else{for(var i=2;i<len;i++){params.text[params.text.length]=arguments[i]}}params.toggle=toggle?"true":"false";this.Super.DocumentMgr.Set(this.Super.Name+".C"+colNo,params)}};this.QvaPublic.Data.SelectValuesInColumn=function(colNo,values,toggle,isfinal){var params={};params.select=values;params.toggle=toggle?"true":"false";this.Super.DocumentMgr.Set(this.Super.Name+".C"+colNo,params,isfinal)};this.QvaPublic.Data.SelectRow=function(rowNo){var cols=new Array();for(var i=0;i<this.Rows[rowNo].length;i++){if(this.Rows[rowNo][i].value){cols.push(i)}}for(var c=0;c<cols.length;c++){var isFinal=(c==cols.length-1);this.SelectValuesInColumn(c,this.Rows[rowNo][c].value,false,isFinal)}};this.QvaPublic.Data.DrillUp=function(steps,colNo){var params={drillup:steps};if(colNo!=undefined){params.column=colNo}this.Super.DocumentMgr.Set(this.Super.Name,params,true)};this.QvaPublic.Data.Cycle=function(steps,colNo){var params={cycle:steps};if(colNo!=undefined){params.column=colNo}this.Super.DocumentMgr.Set(this.Super.Name,params,true)};case"MB":case"TB":this.QvaPublic.Data.ClearSelections=function(){var params={};params.action="";this.Super.DocumentMgr.Set(this.Super.Name+".CA",params)};break}switch(this.Type){case"LB":case"CH":case"TB":this.QvaPublic.Data.PageObject=function(owner,size,start){if(!start){start=1}this._parent=owner;this._size=size;this.Current=start;this.Count=Math.ceil(owner.TotalSize.y/size);this.Set=function(page){if(page>=1&&page<=this.Count){this.Current=page;this._parent.NewOffset.x=0;this._parent.NewOffset.y=(page-1)*this._size;if(this._parent.IsDataFetched()){this._parent.Super.ObjectMgr.PageBinder.QueuePostPaintMessage(this._parent.Super.PageBinder)}}};this.Next=function(){this.Set(this.Current+1)};this.Prev=function(){this.Set(this.Current-1)};this.StartItem=function(){return(this.Current-1)*this._size}};this.QvaPublic.Data.SetOffset=function(pageoffset){if(!this.Rows[pageoffset.y]&&pageoffset.y<=this.TotalSize.y){this.Super.ObjectMgr.PartialLoad(this.Super.Name,pageoffset)}else{this.PageOffset=pageoffset;this.Super.Paint()}};this.QvaPublic.Data.SetPagesize=function(pageSize){this.PageSize=pageSize;var params={};params.pageSize=pageSize.x+":"+pageSize.y;this.Super.DocumentMgr.Set(this.Super.Name,params)};this.QvaPublic.Data.SetPagesizeX=function(val){var pagesize={};pagesize.x=val;pagesize.y=this.PageSize.y;this.SetPagesize(pagesize)};this.QvaPublic.Data.SetPagesizeY=function(val){var pagesize={};pagesize.x=this.PageSize.x;pagesize.y=val;this.SetPagesize(pagesize)};case"MB":this.QvaPublic.Data.SetRect=function(rect,isfinal){this.Super.DocumentMgr.Set(this.Super.Name,"rect",rect,isfinal)}}}this.QvaPublic.Layout.ObjectId=node.getAttribute("objectid");this.ResetScrollPosition=true;if(node.getAttribute("pageoffset")){var pageoffset=node.getAttribute("pageoffset");this.QvaPublic.Data.PageOffset.x=parseInt(pageoffset.split(":")[0]);this.QvaPublic.Data.PageOffset.y=parseInt(pageoffset.split(":")[1]);var pagesize=node.getAttribute("pagesize");this.QvaPublic.Data.PageSize.x=parseInt(pagesize.split(":")[0]);this.QvaPublic.Data.PageSize.y=parseInt(pagesize.split(":")[1]);var totalsize=node.getAttribute("totalsize");this.QvaPublic.Data.TotalSize.x=parseInt(totalsize.split(":")[0]);this.QvaPublic.Data.TotalSize.y=parseInt(totalsize.split(":")[1]);this.SetOffset=this.PageBinder.SetOffset}if(this.QvaPublic.Data.PageOffset.y==0){this.QvaPublic.Data.Rows.length=0;this.QvaPublic.Data.HeaderRows.length=0}else{this.ResetScrollPosition=false}for(var chgrp=node.firstChild;chgrp;chgrp=chgrp.nextSibling){if(chgrp.nodeName=="value"){var colNo=parseInt(chgrp.getAttribute("name").substr(1));if(!isNaN(colNo)){var rowNo=0;var headerRowNo=0;if(!isNaN(this.QvaPublic.Data.PageOffset.y)){rowNo=this.QvaPublic.Data.PageOffset.y}for(var child=chgrp.firstChild;child;child=child.nextSibling){if(child.nodeName!="element"){continue}var data={};var isheaderrow=child.getAttribute("position")=="top";var text=child.getAttribute("title");if(!text){text=child.getAttribute("text")}data.text=text;for(var i=0;i<child.attributes.length;i++){if(child.attributes[i].name=="name"){continue}if(child.attributes[i].name=="text"){continue}if(child.attributes[i].name=="title"){continue}if(child.attributes[i].name=="position"){continue}data[child.attributes[i].name]=child.attributes[i].value}if(isheaderrow){if(!this.QvaPublic.Data.HeaderRows[headerRowNo]){if(headerRowNo!=this.QvaPublic.Data.HeaderRows.length){Assert(false)}this.QvaPublic.Data.HeaderRows[headerRowNo]=new Array()}for(var memb=child.firstChild;memb;memb=memb.nextSibling){if(memb.nodeName!="member"){continue}if(!data.members){data.members=[]}data.members[data.members.length]={label:memb.getAttribute("label"),active:memb.getAttribute("active")=="true"}}this.QvaPublic.Data.HeaderRows[headerRowNo++][colNo]=data}else{if(this.Type=="Field"){if(!this.QvaPublic.Data.Rows[rowNo]){this.QvaPublic.Data.Rows[rowNo]=data}this.QvaPublic.Data.Rows[rowNo++]=data}else{if(!this.QvaPublic.Data.Rows[rowNo]){this.QvaPublic.Data.Rows[rowNo]=new Array()}this.QvaPublic.Data.Rows[rowNo++][colNo]=data}}}}else{Qva.ObjectifyXmlNode(this.QvaPublic.Layout,chgrp)}}else{if(chgrp.nodeName=="style"){for(var child=chgrp.firstChild;child;child=child.nextSibling){var style={};ObjectifyXmlAttributes(style,child);this.QvaPublic.Data.CellStyles[this.QvaPublic.Data.CellStyles.length]=style}}else{if(chgrp.nodeName=="borderstyle"){for(var child=chgrp.firstChild;child;child=child.nextSibling){var style={};ObjectifyXmlAttributes(style,child);this.QvaPublic.Data.CellBorderStyles[this.QvaPublic.Data.CellBorderStyles.length]=style}}}}}this.PageBinder.QueuePostPaintMessage(this)};Qva.Mgr.object.prototype.AddManager=function(mgr){mgr.PageBinder=this;mgr.Touched=false;if(mgr.SelectedClassName==null){mgr.SelectedClassName="QvSelected";mgr.DeselectedClassName="QvDeselected";mgr.EnabledClassName="QvOptional";mgr.DisabledClassName="QvExcluded";mgr.LockedClassName="QvLocked";mgr.SelectedExcludedClassName="QvSelectedExcluded";mgr.LockedExcludedClassName="QvLockedExcluded";mgr.AlternativeClassName="QvAlternative";mgr.ModeIfNotEnabled="n"}if(!mgr.Paint){mgr.Paint=this.GenericPaint;mgr.pageoffset={};mgr.pagesize={};mgr.totalsize={}}this.Managers[this.Managers.length]=mgr;this.AddSubscription(mgr,mgr.Name)};Qva.Mgr.object.prototype.AddSubscription=function(mgr,name){if(name==null||name.substr(0,1)=="."){Assert(false)}if(name==null||name==""){return}var list=this.Members[name];if(list==null){list=new Array();this.Members[name]=list}for(var i=0;i<list.length;i++){if(list[i]==mgr){break}}if(i==list.length){list[list.length]=mgr}};Qva.Mgr.CreateObject=function(parent,data){var frame=document.createElement("div");var $frame=$(frame);$frame.addClass("QvFrame");if(data.objectid){$frame.addClass(data.objectid.replace("\\","_"))}frame.id=Qva.GetUniqueID(data.id);if(data.mode=="maximized"||data.maximized=="true"){frame.style.left="0";frame.style.top="0";frame.style.width="100%";frame.style.height="100%"}else{if(data.left!=null){frame.style.left=data.left+"px";frame.style.top=data.top+"px";if(data.width){frame.style.width=data.width+"px";frame.style.height=data.height+"px"}}else{frame.style.display="none"}}var object=new Qva.Mgr.object(parent,frame,data.name,null,data);return object};Qva.PageBinding.prototype.RemoveObject=function(objectname){this.SignalVisibility(objectname,false);var mgr=this.Members["Document."+objectname];if(mgr){mgr=mgr[0]}if(mgr){if(mgr.Remove){mgr.Remove()}this.RemoveFromManagers(mgr)}this.Members["Document."+objectname]={};this.Members["Document."+objectname]=null;var annotation=document.getElementById(objectname+"_annotation");if(annotation){Qva.RemoveHtml(annotation)}};Qva.PageBinding.prototype.DetachObject=function(objectid){var detached=undefined;var parent=$("#"+objectid).parents()[0];detached=$("#"+objectid).detach();Qva.Detached[parseInt(objectid)]=[detached[0],parent]};Qva.Mgr.object.prototype.PaintElem=function(node,name,partial){var list=this.Members[name];if(list!=null){var mode="d";switch(node.getAttribute("mode")){case"not-applicable":mode="n";break;case"hidden":mode="h";break;case"enabled":mode="e";break}var xlen=list.length;for(var ixx=0;ixx<xlen;++ixx){var mgr=list[ixx];var mgrmode=mode;if(mode!="n"&&mgr.HideIf&&mgr.HideIf(node.getAttribute("value"),node.getAttribute("text"))){mgrmode="n"}mgr.Paint(mgrmode,node,name,partial)}}};Qva.Mgr.object.prototype.PaintTree=function(rootnode,partial,rootname){var prefix=rootname+".";for(var node=rootnode.firstChild;node!=null;node=node.nextSibling){if(node.nodeName!="value"&&node.nodeName!="action"&&node.nodeName!="group"&&node.nodeName!="list"){continue}var name=prefix+node.getAttribute("name");this.PaintTree(node,partial,name)}this.PaintElem(rootnode,rootname,partial)};Qva.Mgr.object.prototype.BuildBinaryUrl=function(path,stamp,name,color){return this.PageBinder.BuildBinaryUrl(path,stamp,name,color)};Qva.Mgr.object.prototype.PartialLoad=function(name,pageoffset){if(isNaN(parseInt(pageoffset.x))||isNaN(parseInt(pageoffset.y))){return}var docMgr=this.GetDocumentMgr();docMgr.IsPartialLoad=true;docMgr._Send("get",name.substr("Document.".length),true,{offset:pageoffset.x+":"+pageoffset.y})};Qva.Mgr.object.prototype.SetScrollPos=function(scrollposition){if(isNaN(parseInt(scrollposition.x))||isNaN(parseInt(scrollposition.y))){return}var docMgr=this.GetDocumentMgr();docMgr._Send("set",this.Name.substr("Document.".length),true,{scrollposition:scrollposition.x+":"+scrollposition.y})};Qva.Mgr.object.prototype.FixName=function(name){return name};Qva.Mgr.object.prototype._Send=function(cmd,name,_final,extra){this.PageBinder._Send(cmd,this.FixName(name),_final,extra)};Qva.Mgr.object.prototype.Set=function(name,type,value,_final){this.PageBinder.Set(this.FixName(name),type,value,_final)};Qva.Mgr.object.prototype.Search=function(name,text,toggle,_final){this.PageBinder.Search(this.FixName(name),text,toggle,_final)};Qva.Mgr.object.prototype.Hover=function(name,pos){this.PageBinder.Hover(this.FixName(name),pos)};Qva.Mgr.object.prototype.SetSize=function(name,size){this.poll.size=size;this.Mode="invalid"};Qva.Mgr.object.prototype.GetEnabled=function(){return this.PageBinder.GetEnabled()};Qva.Mgr.object.prototype.IsValid=function(){return !this.IsInvalid()&&this.GetEnabled()&&!this.IsWaiting()&&!this.IsAborted()};Qva.Mgr.object.prototype.GetDocumentMgr=function(){return this.PageBinder.GetDocumentMgr()};Qva.Mgr.object.prototype.LoadBegin=function(){this.PageBinder.LoadBegin()};Qva.Mgr.object.prototype.GetBody=function(){for(var mix=0;mix<this.Managers.length;++mix){var mgr=this.Managers[mix];if(mgr.IsBody){return mgr}}return null};Qva.Mgr.object.prototype.GetSearchMgr=function(){mgr=this.GetBody();if(mgr){return mgr}for(var mix=0;mix<this.Managers.length;++mix){mgr=this.Managers[mix];if(mgr.SearchName){return mgr}}return null};Qva.Mgr.object.prototype.GetMaxClientHeight=function(element,root){if(!element){element=this.Element}if(!root){root=this}if(element.rect){var borderwidth=isNaN(root.BorderWidth)?0:root.BorderWidth;return element.rect.height-2*borderwidth}else{return getClientHeight(element)}};Qva.Mgr.object.prototype.GetMaxClientWidth=function(){if(this.Element.rect){var borderwidth=isNaN(this.BorderWidth)?0:this.BorderWidth;return Math.max(0,this.Element.rect.width-2*borderwidth)}else{return getClientWidth(this.Element)}};Qva.Mgr.object.prototype.GetElementSize=function(element,type,rowHeight,lilength,fixedCols){var size,numberofchildren,ichild,child,contentElement,cssTags,cssTrimmed,oCss,i,cssSplit,bWidth,tmpString;size=0;if(element){if(element.className.indexOf("QvFrame")==-1){contentElement=element;element=$(element).parent()[0]}if(!element){return}}switch(type){case"Height":case"MaxHeight":if(Qva.UseTraditional(element)){size=this.GetMaxClientHeight();numberofchildren=this.Element.childNodes.length;for(ichild=0;ichild<numberofchildren;ichild++){child=this.Element.childNodes[ichild];if(child==element){continue}if(child.nodeName!="DIV"){continue}if(child.style.display=="none"){continue}if(child.ResizeType){continue}if(child.className=="MoveZone"){continue}if(child.className=="TouchOnlyMoveZone"){continue}if(Qva.userAgentDetector.get("msie")){if(child.currentStyle.position!="relative"){continue}}else{var gs=document.defaultView.getComputedStyle(child,"");if(gs.getPropertyValue("position")!="relative"){continue}}size-=child.offsetHeight}}else{size=this.GetMaxClientHeight(element);var stamp=Qva.GetStamp(this);var children=$(element).children();numberofchildren=children.length;for(ichild=0;ichild<numberofchildren;ichild++){child=children[ichild];if(child==contentElement){continue}if(child.nodeName!="DIV"){continue}if(child.style.display=="none"){continue}if(child.ResizeType){continue}if(child.className=="MoveZone"){continue}if(child.className=="TouchOnlyMoveZone"){continue}if(Qva.userAgentDetector.get("msie")){if(child.currentStyle.position!="relative"){continue}}else{var gs=document.defaultView.getComputedStyle(child,"");if(gs.getPropertyValue("position")!="relative"){continue}}var cpath=$(child).getPath();var childHeight=Qva.ElementAttributesHandler(cpath,child,"offsetHeight",stamp);if(Qva.ElementAttributes[cpath]&&Qva.ElementAttributes[cpath][0]){childHeight=Qva.ElementAttributes[cpath][0].offsetHeight}if(childHeight===0){cssTags=child.style.cssText.split(";");oCss={};for(i=0;i<cssTags.length;i+=1){if(cssTags[i].replace(/ /g)!==""){cssSplit=cssTags[i].split(":");if(cssSplit[0].toLowerCase().replace(/^\s+/,"")!==""){oCss[cssSplit[0].toLowerCase().replace(/^\s+/,"")]=cssSplit[1].replace(/^\s+/,"")}}}if(oCss["border-bottom-width"]){bWidth=parseInt(oCss["border-bottom-width"])}else{tmpString=oCss["border-bottom"];if(tmpString){bWidth=parseInt(tmpString.substr(tmpString.indexOf(" ")+1,tmpString.indexOf("px")-tmpString.indexOf(" ")-1));if(!bWidth){bWidth=parseInt(tmpString.substr(0,tmpString.indexOf("px")))}}else{bWidth=0}}childHeight=parseInt(oCss.height)+bWidth}switch(type){case"Height":var borderwidth=parseInt($(element).css("border-bottom-width"));size-=childHeight;if(!fixedCols){fixedCols=1}if(lilength){if(!rowHeight||rowHeight==0){rowHeight=1}var maxlines=Math.floor((size-($(element).attr("cached")=="1"?0:borderwidth))/rowHeight);if(maxlines>lilength){maxlines=lilength}size=maxlines*rowHeight+childHeight+borderwidth*2}else{size=Math.floor((size-($(element).attr("cached")=="1"?0:borderwidth))/rowHeight)*rowHeight+childHeight+borderwidth*2}$(element).attr("cached","1");break;case"MaxHeight":size-=childHeight;break}}}break}return size};Qva.Mgr.object.prototype.GetContentMaxHeight=function(element){if(typeof element=="undefined"){element=this.ContentElement}var newparentheigh,rowHeight;var useTraditional=false;if(element.className==="QvContent"){if($(element).parent()[0]){useTraditional=Qva.UseTraditional($(element).parent()[0])}}else{if($(element).children()[0]){useTraditional=Qva.UseTraditional($(element).children()[0])}}if(useTraditional){newparentheigh=this.GetMaxClientHeight();var numberofchildren=this.Element.childNodes.length;for(var ichild=0;ichild<numberofchildren;ichild++){var child=this.Element.childNodes[ichild];if(child==element){continue}if(child.nodeName!="DIV"){continue}if(child.style.display=="none"){continue}if(child.ResizeType){continue}if(child.className=="MoveZone"){continue}if(child.className=="TouchOnlyMoveZone"){continue}if(Qva.userAgentDetector.get("msie")){if(child.currentStyle.position!="relative"){continue}}else{var gs=document.defaultView.getComputedStyle(child,"");if(gs.getPropertyValue("position")!="relative"){continue}}if(child.offsetHeight===0&&parseInt(child.style.height)>0){newparentheigh-=parseFloat(child.style.height)+parseFloat(child.style.borderBottomWidth)}else{newparentheigh-=child.offsetHeight}}}else{var object=$(element).children(".QvListbox")[0];if(object){var cssText=object.style.cssText.split(";");var cssArray=[{}];for(var i=0;i<cssText.length;i++){var tmp=cssText[i].split(":");if(tmp[0]){cssArray[0][$.trim(tmp[0])]=$.trim(tmp[1])}}var textHeight=Qva.MeasureText("?g",cssArray[0]["font-family"],cssArray[0]["font-size"],cssArray[0]["font-weight"]).height;var lines=object.Mgr.Lines;if(!lines){}else{var any_cell=lines[lines.length-1];rowHeight=any_cell?any_cell.rowspan*textHeight:0;if(this.PageBinder.GetDocumentMgr().isSmallDevices&&this.ObjectId==="DS"){this.rowHeight+=32}}}if(rowHeight!=0){newparentheigh=this.GetElementSize(element,"MaxHeight",rowHeight)}else{newparentheigh=this.GetElementSize(null,"MaxHeight")}}if(newparentheigh>0){return parseInt(newparentheigh)}newparentheigh=parseInt(element.style.height);if(isNaN(newparentheigh)){return 0}return newparentheigh};Qva.Mgr.object.prototype.GetContentHeight=function(ele){var element,lilength,fixedCols;if(!ele){element=this.Element}else{element=ele}var h=element.style.height,parentheight=h&&h.indexOf("%")<0&&parseInt(h),rowHeight=0,className="";if(typeof $(element).children()[1]!="undefined"&&typeof $(element).children()[1].children[0]!="undefined"){className=$(element).children()[1].children[0].className}else{return}var useTraditional=Qva.UseTraditional(element);if(isNaN(parentheight)||typeof parentheight!=="number"){if(useTraditional){parentheight=element.offsetHeight}else{switch(className){case"Listbox":case"QvListbox":var object=Qva.GetChildByClassName(element,"QvListbox");if(object){var cssText=object.style.cssText.split(";");var cssArray=[{}];for(var i=0;i<cssText.length;i++){var tmp=cssText[i].split(":");if(tmp[0]){cssArray[0][$.trim(tmp[0])]=$.trim(tmp[1])}}var textHeight=Qva.MeasureText("?g",cssArray[0]["font-family"],cssArray[0]["font-size"],cssArray[0]["font-weight"]).height;var lines=object.Mgr.Lines;fixedCols=object.Mgr.fixedCols;if(lines){lilength=lines.length;var any_cell=lines[lines.length-1];rowHeight=any_cell?any_cell.rowspan*textHeight:0;if(this.PageBinder.GetDocumentMgr().isSmallDevices&&this.ObjectId==="DS"){this.rowHeight+=32}parentheight=parseInt($(element).css("height"))}}break}}}if(useTraditional){parentheight-=2*this.BorderWidth}else{parentheight-=parseInt($(element).css("border-bottom-width"))}if(useTraditional){var numberofchildren=element.childNodes.length;for(var ichild=0;ichild<numberofchildren;ichild++){var child=element.childNodes[ichild];if(child==this.ContentElement){continue}if(child.nodeName!="DIV"){continue}if(child.style.display=="none"){continue}if(child.ResizeType){continue}if(child.className=="MoveZone"){continue}if(child.className=="TouchOnlyMoveZone"){continue}if(Qva.userAgentDetector.get("msie")){if(child.currentStyle.position!="relative"){continue}}else{var gs=document.defaultView.getComputedStyle(child,"");if(gs.getPropertyValue("position")!="relative"){continue}}if(child.offsetHeight===0&&parseInt(child.style.height)>0){parentheight-=parseFloat(child.style.height)+parseFloat(child.style.borderBottomWidth)}else{parentheight-=child.offsetHeight}}}else{parentheight=this.GetElementSize(element,"Height",rowHeight,lilength,fixedCols)}if(parentheight>0){return parseInt(parentheight)}parentheight=parseInt(element.style.height);parentheight-=2*this.BorderWidth;if(isNaN(parentheight)){return 0}if(parentheight<0){return 0}return parentheight};Qva.Mgr.object.prototype.GetImageSize=function(element){var size={width:0,height:0};var width=element.style.width;if(width=="auto"||element.autosize){if(width=="auto"){element.autosize=true}width=this.GetMaxClientWidth();element.style.width=width+"px";size.width=width}else{size.width=element.offsetWidth}var height=element.style.height;if(height=="auto"||element.autosize){if(height=="auto"){element.autosize=true}height=this.GetContentMaxHeight();if(height<0){height=getClientHeight(element.parentNode)}element.style.height=height+"px";size.height=height}else{size.height=element.offsetHeight}return size};Qva.Mgr.object.prototype.SetObjectHeight=function(deltaframeY,path){var fpath=path;if(Qva.UseTraditional(this.Element)){var borderwidth=isNaN(this.BorderWidth)?0:this.BorderWidth;if(this.Element.rect&&this.Element.rect.height){var maxframeheight=this.Element.rect.height;var maxclientheight=Math.max(0,maxframeheight-2*borderwidth);if(Qva.userAgentDetector.get("msie6o7")&&!this.BorderAroundContent){maxframeheight=maxclientheight}var frameheight=parseInt(this.Element.style.height);var height=maxframeheight-deltaframeY;if(height!=frameheight){this.Element.style.height=height+"px";if(this.Element.firstChild.ResizeType){Qva.Mgr.CreateAndUpdateResizeHandles(this.Element,this.BorderAroundContent?0:borderwidth)}}}var new_height=this.GetContentHeight();if(new_height!=undefined){new_height+="px";if(this.ContentElement.style.height!==new_height){this.ContentElement.style.height=new_height;if(this.BackgroundMgr){this.QueuePostPaintMessage(this.BackgroundMgr)}}}}else{var element=this.Element;var cachedElements=Qva.ElementCacheHandler();var cacheLength=cachedElements.length;if(!path){path=$(element).getPath()}var stamp=Qva.GetStamp(this);if(!cachedElements.length||cachedElements.length==0){Qva.ElementCacheHandler(false,element,stamp,path,this);return}if(!Qva.CheckElementCache(path)){var toproc=cacheLength-1;if(cachedElements[toproc][4]=="complete"){toproc++}var cache=cachedElements[toproc];var procElement=cache[1];var root=cache[3];var borderwidth=isNaN(root.BorderWidth)?0:root.BorderWidth;var new_height=this.GetContentHeight(procElement);if($(procElement).find(".Qv_ScrollbarHorizontalDivider")){return}if(new_height&&root.ContentElement.style.height!==new_height){$(procElement).addClass("lockedheight");switch($($(root.ContentElement).children()[0]).attr("objType")){case"Listbox":$(procElement).css("height",new_height+borderwidth);$(procElement).css("visibility","visible");$($(root.ContentElement).children()[0]).css("visibility","visible");break}if(procElement.firstChild){if(procElement.firstChild.ResizeType){}}if(!fpath&&root.BackgroundMgr){this.QueuePostPaintMessage(root.BackgroundMgr)}}Qva.ElementCacheHandler(false,element,stamp,$(element).getPath(),this)}else{$(element).css("visibility","visible");return}}};Qva.Mgr.object.prototype.SetObjectWidth=function(deltaframeX){if(!this.Element.rect||!this.Element.rect.width){return}if(this.Maximized){deltaframeX=0}var borderwidth=isNaN(this.BorderWidth)?0:this.BorderWidth;var maxframewidth=this.Element.rect.width;maxclientwidth=Math.max(0,maxframewidth-2*borderwidth);if(Qva.userAgentDetector.get("msie6o7")&&!this.BorderAroundContent){maxframewidth=maxclientwidth}var framewidth=parseInt(this.Element.style.width);var width=maxframewidth-deltaframeX;if(width!=framewidth){this.Element.style.width=width+"px";if(this.Element.firstChild.ResizeType){Qva.Mgr.CreateAndUpdateResizeHandles(this.Element,this.BorderAroundContent?0:borderwidth)}}var numberofchildren=this.Element.childNodes.length;for(var ichild=0;ichild<numberofchildren;ichild++){var child=this.Element.childNodes[ichild];if(child.nodeName!="DIV"){continue}if(child.style.display=="none"){continue}if(child.className=="Qv_Scrollbar"){continue}if(child.className=="Qv_ScrollbarBackground"){continue}if($(child).hasClass("QvAnnotation")){continue}if(child.className=="TouchScrollbar"){continue}if(child.className=="TouchOnlyMoveZone"){continue}if(child.ResizeType){continue}var newwidth=maxclientwidth-deltaframeX;if(this.BorderAroundContent&&child!=this.ContentElement){newwidth+=2*borderwidth}var currentwidth=parseInt(child.style.width);if(currentwidth!=newwidth){child.style.width=newwidth+"px"}}};Qva.Mgr.object.prototype.SetColumnWidth=function(colIndex,colWidth){this.Set(this.Name,"resizecolumn",colIndex+":"+colWidth,true)};Qva.Mgr.object.prototype.SetActiveStyle=function(isactive){var element=this.BorderAroundContent?this.ContentElement:this.Element;var $element=$(element);this.IsActive=isactive;if(this.Element.firstChild.ResizeType&&Qva.Events.resizeActiveForTouch){var borderwidth=isNaN(this.BorderWidth)?0:this.BorderWidth;Qva.Mgr.CreateAndUpdateResizeHandles(this.Element,this.BorderAroundContent?0:borderwidth)}if(!this.Caption){return}if(this.Element.style.display=="none"){return}if(this.BorderStyle==null){return}var bordercolor=isactive&&this.ActiveBorderColor?this.ActiveBorderColor:this.BorderColor;var borderstyle=this.BorderWidth+"px "+this.BorderStyle+" "+Qva.RGBAIgnoreTranparancy(bordercolor);element.style.border=borderstyle;var captionelem=this.Caption.Element;if(captionelem!=null){var color=isactive?this.Caption.activecolor:this.Caption.color;if(color==null){return}if(captionelem.style.display=="none"){return}Qva.ApplyColorDataToElement(color,captionelem,true,true);if(!this.BorderAroundContent){captionelem.style.borderBottom="1px "+this.BorderStyle+" "+bordercolor;var numberofchildren=captionelem.childNodes.length;for(var ichild=0;ichild<numberofchildren;ichild++){var child=captionelem.childNodes[ichild];if(child.nodeName!="IMG"){continue}var url=child.src;url=Qva.FixUrl(url,"color",HtmlifyARGB(color.color));url=Qva.FixUrl(url,"bkgcolor",HtmlifyARGB(color.bkgColor));child.src=url}}var $captionelem=$(captionelem);var icons=$captionelem.find(".caption-icon-16x16");var usedarkicons=Qva.generalHelper.detectDarkColor(color.color,color.PrimaryColor);for(var iicon=0;iicon<icons.length;iicon++){var icon=icons[iicon];var classname=icon.className;if(!usedarkicons){classname=classname.replace("-dark-","-light-")}else{classname=classname.replace("-light-","-dark-")}icon.className=classname}}else{Assert(false)}};Qva.Mgr.container.prototype.SetActiveStyle=Qva.Mgr.object.prototype.SetActiveStyle;Qva.Mgr.captionstyle=function(owner,elem,name){if(!Qva.MgrSplit(this,name)){return}owner.AddManager(this);this.Element=elem;this.InlineStyle=owner.InlineStyle};window.SetElementColorStyle=function(elem,name,color){if(Qva.userAgentDetector.get("msie")&&Qva.userAgentDetector.get("msieDocMode")<=8){color=HtmlifyARGB(color)}else{color=Qva.Hex2RGBA(color)}elem.style[name]=color};window.SetElementStyle=function(elem,name,value,unit){if(!value){return false}if(unit){value+=unit}if(value!=elem.style[name]){elem.style[name]=value;return true}return false};Qva.Mgr.captionstyle.prototype.Paint=function(mode,node){this.Touched=true;var changes=SetElementStyle(this.Element,"fontFamily",node.getAttribute("fontfamily"));changes|=SetElementStyle(this.Element,"fontSize",node.getAttribute("fontsize"),"pt");changes|=SetElementStyle(this.Element,"fontStyle",node.getAttribute("fontstyle"));changes|=SetElementStyle(this.Element,"fontWeight",node.getAttribute("fontweight"));changes|=SetElementStyle(this.Element,"textAlign",node.getAttribute("textalign"));changes|=SetElementStyle(this.Element,"verticalAlign",node.getAttribute("verticalalign"));changes|=SetElementStyle(this.Element,"textDecoration",node.getAttribute("textdecoration"));if(changes){this.PageBinder.Resized()}};Qva.Mgr.caption=function(owner,elem,name,cssStyle,paintFunc){if(!Qva.MgrSplit(this,name)){return}this.Paint=paintFunc;this.Element=elem;var $element=$(this.Element);$element.addClass(cssStyle);owner.AddManager(this);this.ObjectId=owner.Element.id;elem.moveObj=this.ObjectId;elem.yMin=0;elem.xMin=0;elem.Name=this.Name;elem.binderid=owner.binderid;this.RowHeight=-1;this.InlineStyle=owner.InlineStyle;if(elem.getAttribute("AvqStyle")){this.InlineStyle=elem.getAttribute("AvqStyle")=="true"}if(this.InlineStyle){new Qva.Mgr.captionstyle(owner,this.Element,name+".Style")}};Qva.Mgr.caption.prototype.SetPending=function(names){for(var ix=0;ix<names.length;++ix){if(this.ObjectId!=names[ix]){continue}this.Element.parentNode.className+=" QvPending";if(this.Element.BkgElem){this.Element.BkgElem.className+=" QvPending"}return}var classname=this.Element.parentNode.className;this.Element.parentNode.className=classname.replace(" QvPending","")};Qva.Mgr.caption.prototype.GeneralPaint=function(mode,node,name){this.Touched=true;var display=Qva.MgrGetDisplayFromMode(this,mode);if(display!=this.Element.style.display){this.PageBinder.Resized()}this.Element.style.display=display;if(this.Element.style.display=="none"){return}var $Element=$(this.Element);if(node.getAttribute("allowmove")=="true"){Qva.Events.AddDragEvent(this.Element,Qva.Move.mouseDown,Qva.Move.mouseMove,Qva.Move.mouseUp,{arg:[name]})}else{Qva.Events.RemoveDragEvent(this.Element)}if(this.InlineStyle){this.activecolor={};this.color={};ObjectifyXmlAttributes(this.activecolor,node.getElementsByTagName("activecolor")[0]);ObjectifyXmlAttributes(this.color,node.getElementsByTagName("color")[0])}this.label=node.getAttribute("label");if(this.ObjectId==="CurrentSelection"){this.label=Qva.localization.getStringFromKey("Current.Selections")}if(!this.label){this.NoText=true;this.Element.title=""}else{this.NoText=false;this.Element.title=this.label}};Qva.Mgr.caption.MinHeight=16;Qva.Mgr.caption.prototype.createLayout=function(){var captionHeight;var $element=$(this.Element);if($element.css("display")=="none"){return}if(this.RowHeight==-1&&this.RowSpan!=1){this.RowHeight=$element.height()}if(this.RowHeight!=-1){captionHeight=Math.max(this.RowSpan==1?this.RowHeight:(this.RowHeight*this.RowSpan),Qva.Mgr.caption.MinHeight);$element.height(captionHeight);$element.find(".vertical").css("vertical-align",$element.css("verticalAlign"));$element.find(".vertical").height(captionHeight);if(!Qva.userAgentDetector.get("msie6o7")){$element.find(".vertical").width($element.width());var imgCWidth=$element.find(".QvCaptionImgContainer").width();var elementWidth=$element.width();var fwidth=Qva.MeasureText("W",$element.css("font-family"),$element.css("font-size"),$element.css("font-weight")).width;var deltaW=elementWidth-imgCWidth;$element.find(".vertical").children().first().width(deltaW);if(elementWidth-imgCWidth<fwidth){$element.find(".vertical").children().first().css("display","none")}else{var textNode=$element.find(".vertical").children().first().text().split(" ");var longest=0;var li;for(var index=textNode.length-1;index>=0;index-=1){if(textNode[index].length>longest){longest=textNode[index].length;li=index}}var tlength=Qva.MeasureText(textNode[li],$element.css("font-family"),$element.css("font-size"),$element.css("font-weight")).width;if(elementWidth-imgCWidth<(tlength+fwidth)){var newwidth=elementWidth-imgCWidth;$element.find(".vertical").children().first().css("display","block").css("width",newwidth-fwidth)}else{$element.find(".vertical").children().first().css("display","inline")}}}}if(this.NoText){$element.find(".horizontal").html("&nbsp;")}};Qva.Mgr.caption.prototype.PropertiesPaint=function(mode,node,name){this.GeneralPaint(mode,node,name);var $span=$(document.createElement("span"));$span.addClass("QvCaption_PropText");var $element=$(this.Element);var icons;var img;var label;if(mode!="n"){$element.html("");var $img=$(document.createElement("span"));$img.attr("alt","");$img.addClass("prop-icon-34x34").addClass("QvClosePropIcon");$element.append($img);$img.prop("binderid",$element.prop("binderid"));$img.prop("ObjectId",this.ObjectId);Qva.Events.AddClickEvent($img[0],onclick_action);$img[0].Action=this.Name.replace("Caption","CX");label=node.getAttribute("label");if(!label){if(this.Element.color&&this.Element.color.getAttribute("bkgcolor")){this.Element.style.color=this.Element.color.getAttribute("bkgcolor")}label=" ";this.NoText=true;this.Element.title=""}else{switch(this.ObjectId){case"TOOLS\\REPOSITORY":label=Qva.localization.getStringFromKey("REPOSITORY");break;case"TOOLS\\NEWSHEETOBJ":label=Qva.localization.getStringFromKey("New.Sheet.Object");break;case"TOOLS\\SHOWFIELDS":label=Qva.localization.getStringFromKey("Fields");break;case"TOOLS\\SUPPORTINFO":label=Qva.localization.getStringFromKey("SUPPORTINFO");break;case"Annotations":label=Qva.localization.getStringFromKey("NOTES");break;default:var objType=node.getAttribute("objectType"),caption=node.getAttribute("label"),pos=caption.indexOf("[");if(objType==="objectType-2"){label=Qva.localization.getStringFromKey("SHEETPROPS")}else{if(objType==="objectType-1"){label=Qva.localization.getStringFromKey("bookmark")}else{if(objType.indexOf("objectType")===0&&objType!=="objectType0"){label=Qva.localization.getStringFromKey(objType)}}}label+=" "+Qva.localization.getStringFromKey("PROPS");if(pos>-1){label+=" "+caption.substring(pos)}}this.NoText=false;this.Element.title=label}$span.text(label);this.Element.appendChild($span.get(0))}this.PostPaint=null};Qva.Mgr.caption.prototype.Remove=function(){Qva.RemoveHtml(this.Element)};Qva.Mgr.captionstyle.prototype.Remove=function(){Qva.RemoveHtml(this.Element)};Qva.Mgr.caption.prototype.CaptionPaint=function(mode,node,name){this.GeneralPaint(mode,node,name);var $element=$(this.Element);var $horizontalAlignDiv;var $textDiv;var $tableCell;var rowspan;var img;var $imgcontainer;if(mode!="n"){$element.html("");var icons=node.getElementsByTagName("action");if(icons.length>=1){if(!Qva.userAgentDetector.get("msie6o7")){$imgcontainer=$(document.createElement("div"));$imgcontainer.addClass("QvCaptionImgContainer")}if(this.InlineStyle){var color=this.PageBinder.IsActive?this.activecolor:this.color;var usedarkicons=Qva.generalHelper.detectDarkColor(color.color,color.PrimaryColor)}for(var i=(icons.length-1);i>=0;i--){var icon=icons[i];if(icon.getAttribute("type")=="divider"){Assert(false);continue}var action=icon.getAttribute("name");var disabled=icon.getAttribute("mode")=="disabled";var img=document.createElement("div");$img=$(img);if(!disabled){$img.addClass("QvCaptionIcon")}else{$img.addClass("QvCaptionIcon-disabled")}if(action==="HELP"){img.title=icon.getAttribute("text")}else{img.title=Qva.localization.getStringFromKey(action)}$img.addClass("caption-icon-16x16").addClass("caption-"+action+(!usedarkicons?"-light":"-dark")+"-icon");if(this.PageBinder.GetDocumentMgr().CustomIcons[action]){$img.css("background-image","url('"+this.PageBinder.GetDocumentMgr().CustomIcons[action]+"')")}if(!disabled){var clientaction=icon.getAttribute("clientaction");$img[0].binderid=this.Element.binderid;$img[0].ObjectId=this.ObjectId;if(clientaction){$img[0].clientaction=clientaction;$img[0].param=icon.getAttribute("param");Qva.Events.AddClickEvent($img[0],onclick_ContextClientAction)}else{if(action){$img[0].Action=this.Name.replace("Caption",action);Qva.Events.AddClickEvent($img[0],onclick_action)}}if(icon.getAttribute("menu")=="true"){$img[0].position=action;Qva.SetContextMenu($img.get(0),function(event){return Qva.GetBinder(this.binderid).OnContextMenu(event,this.ObjectId)})}}if(!Qva.userAgentDetector.get("msie6o7")){$imgcontainer.append($img)}else{$element.append($img)}}if(!Qva.userAgentDetector.get("msie6o7")){$imgcontainer.width(function(){return $imgcontainer.get(0).childNodes.length*17});$element.append($imgcontainer)}}}var textHeight=Math.ceil(Qva.MeasureFontHeight($element.css("font-family"),$element.css("font-size"),$element.css("font-weight")));this.RowHeight=textHeight;if(this.InlineStyle){$horizontalAlignDiv=$(document.createElement("div"));$textDiv=$(document.createElement("div"));$textDiv.css("display","inline");$horizontalAlignDiv.addClass("horizontal").addClass("alignmentcontainer");$textDiv.html(this.label?Qva.ConvertToBr(this.label):"");rowspan=node.getAttribute("rowspan");if(rowspan&&rowspan>1){$tableCell=$(document.createElement("div"));$tableCell.addClass("vertical").addClass("alignmentcontainer").addClass("QvCaptionmultitext");$tableCell.append($textDiv);$horizontalAlignDiv.append($tableCell);$element.find(".QvCaptionImgContainer").css("float","right");if(this.RowSpan!=rowspan){this.PageBinder.Resized()}this.RowSpan=rowspan;this.PageBinder.QueuePostPaintMessage(this)}else{this.PageBinder.Resized();this.RowSpan=1;$horizontalAlignDiv.addClass("QvCaptiontext");$horizontalAlignDiv.append($textDiv)}$element.append($horizontalAlignDiv);this.createLayout()}else{var span=document.createElement("span");span.innerText=this.label;if(this.PropertyDialog){$(span).addClass("QvCaption_PropText")}$element.append(span)}};Qva.Mgr.restore=function(owner,elem,name,prefix){if(!Qva.MgrSplit(this,name,prefix)){return}owner.AddManager(this);this.Element=elem;this.Element.Name=this.Name;this.Element.binderid=owner.binderid;this.Element.moveObj=elem.id;this.Element.yMin=0;this.Element.xMin=0;owner.Append(this,this.Name,"action");Qva.SetContextMenu(elem,function(event){return Qva.GetBinder(this.binderid).OnContextMenu(event,this.Name.replace(".RE",""))});Qva.Events.AddDblClickEvent(this.Element,this.Restore)};Qva.Mgr.restore.prototype.Remove=function(){Qva.RemoveHtml(this.Element)};Qva.Mgr.restore.prototype.Restore=function(){Qva.GetBinder(this.binderid).Set(this.Name,"action","",true)};Qva.Mgr.restore.prototype.PostPaint=function(){if(this.Element.style.display=="none"){return}var url=this.avq_url;url+="&width="+Qva.EncodeComponent(parseInt(this.Element.offsetWidth+2));url+="&height="+Qva.EncodeComponent(parseInt(this.Element.offsetHeight));this.Element.style.backgroundImage="url('"+url+"')"};Qva.Mgr.restore.prototype.Paint=function(mode,node){this.Touched=true;var element=this.Element;var width=this.Element.offsetWidth;var height=this.Element.offsetHeight;if(element.rect){height=element.rect.height;width=element.rect.width}$(element).width(width).height(height);$(".MoveZone",element).height(height).width(width);element.style.display=Qva.MgrGetDisplayFromMode(this,mode);if(element.style.display=="none"){return}var url=this.PageBinder.BuildBinaryUrl(node.getAttribute("path"),node.getAttribute("stamp"),this.Name);this.avq_url=url;this.PageBinder.QueuePostPaintMessage(this)};Qva.Mgr.QvObject=function(owner,name,prefix){if(!Qva.MgrSplit(this,name,prefix)){return}owner.AddManager(this);this.Managers=new Array();this.Members={};this.IsInvalid=Qva.Mgr.object.prototype.IsInvalid;this.GetUpdates=Qva.Mgr.object.prototype.GetUpdates;this.GetWidth=Qva.Mgr.object.prototype.GetMaxClientWidth;this.GetHeight=Qva.Mgr.object.prototype.GetMaxClientHeight;this.pageoffset={};this.pagesize={};this.totalsize={};var name=this.Name.substr("Document.".length);this.poll={name:name,clearcache:"true"};this.PostPaintQueue=[];this.Paint=function(mode,node,name,partial){this.Type=node.getAttribute("type");var m=this.Mode=node.getAttribute("mode");if(m=="aborted"){}else{if(m=="working"||m=="invalid"){}else{if(m!="cached"){Qva.Mgr.object.prototype.GenericPaint.apply(this,Array(mode,node))}}}};this.QvaPublic=new Qva.Public.Wrapper(this);return this};Qva.Mgr.QvObject.prototype.PartialLoad=function(name,pageoffset){if(isNaN(parseInt(pageoffset.x))||isNaN(parseInt(pageoffset.y))){return}this.PageBinder.IsPartialLoad=true;this.PageBinder._Send("get",name.substr("Document.".length),true,{offset:pageoffset.x+":"+pageoffset.y})};Qva.Mgr.QvObject.prototype.QueuePostPaintMessage=function(mgr){for(var ix=0;ix<this.PostPaintQueue.length;++ix){if(this.PostPaintQueue[ix]==mgr){return}}this.PostPaintQueue.push(mgr);this.PageBinder.QueuePostPaintMessage(this)};Qva.Mgr.search=function(owner,elem,name,prefix){if(!Qva.MgrSplit(this,name,prefix)){return}owner.AddManager(this);this.Element=elem;this.Element.Name=this.Name;this.Element.binderid=owner.binderid;this.Element.className="PopupSearch";this.First=true;this.InputTimeout=undefined};Qva.Mgr.search.Do=function(binder,text,_final){binder.Set(".Search","search",text,_final)};Qva.Mgr.search.prototype.InputChecker=function(){var elem=this.TextBox;if(elem.value!=elem.last_search){elem.last_search=elem.value;var binder=Qva.GetBinder(elem.binderid);if(binder.GetEnabled()){Qva.Mgr.search.Do(binder,elem.value,true)}else{binder.PendingSearchName=".Search";binder.PendingSearchValue=elem.value}}var that=this;that.InputTimeout=setTimeout(function(){that.InputChecker()},300)};Qva.Mgr.search.Close=function(elem,accept,ctrl){Qva.KeepPopupSearchAlive=false;var SearchName=".Search";var currentsearchvalue=elem.value;elem.value="";window.focus();var binder=Qva.GetBinder(elem.binderid);if(binder.Enabled){if(accept){Qva.Mgr.search.Do(binder,currentsearchvalue,false)}var cmd;if(accept){cmd=ctrl?"ctrlaccept":"accept"}else{cmd="abort"}binder.Set(SearchName,"closesearch",cmd,true)}else{Qva.PendingSearchKey=(accept?"accept":"abort");Qva.PendingSearchKeyName=SearchName}};Qva.Mgr.search.TryClose=function(elem,accept,ctrl){if(Qva.GetBinder(elem.binderid).GetEnabled()){Qva.Mgr.search.Close(elem,accept,ctrl)}else{setTimeout(function(){Qva.Mgr.search.TryClose(elem,accept,ctrl)},100);return}};Qva.Mgr.search.KeyDown=function(event){if(!event){event=window.event}var key=event.keyCode;switch(key){case 13:Qva.Mgr.search.TryClose(this,true,ctrlKeyPressed(event));return false;case 27:var _this=this;window.setTimeout(function(){Qva.Mgr.search.Close(_this,false)},0);break}};Qva.Mgr.search.prototype.Paint=function(mode,node){if(this.InputTimeout){this.InputTimeout=clearTimeout(this.InputTimeout)}if(this.First){this.First=false;var expand_img=this.ToogleImg=document.createElement("div");expand_img.style.display="none";var $expand_img=$(expand_img);$expand_img.addClass("caption-icon-16x16");if(Qva.userAgentDetector.get("msie6o7")){$expand_img.addClass("QvCaptionIconIE7")}else{$expand_img.addClass("QvCaptionIcon")}$expand_img.addClass("search-expand-icon");expand_img.alt="expand";expand_img.Action="Document.Search.TG";Qva.Events.AddClickEvent(expand_img,onclick_action);expand_img.binderid=this.Element.binderid;this.Element.appendChild(expand_img);var close_img=document.createElement("div");var $close_img=$(close_img);$close_img.addClass("caption-icon-16x16");if(Qva.userAgentDetector.get("msie6o7")){$close_img.addClass("QvCaptionIconIE7")}else{$close_img.addClass("QvCaptionIcon")}$close_img.addClass("search-close-icon");close_img.alt="close";close_img.Action="Document.Search.Close";Qva.Events.AddClickEvent(close_img,onclick_action);close_img.binderid=this.Element.binderid;this.Element.appendChild(close_img);var data={};data.name="Document.Search.DS";data.id="Search.DS";var frame=this.AssosiatedDS=Qva.Mgr.CreateObject(this.PageBinder,data,false);frame.Element.className+=" DS";frame.Element.style.cssText="z-index: 100; display: none; left: 10pt; top: 10pt; width: 10pt; height: 800pt; position:absolute;";new Qva.Mgr.transientpos(frame,frame.Element,data.name);new Qva.Mgr.closetransient(frame,frame.Element,name,"",frame.CreateListBox());document.body.appendChild(frame.Element)}this.Touched=true;var element=this.Element;element.style.display=Qva.MgrGetDisplayFromMode(this,mode);if(element.style.display=="none"){if(this.AssosiatedDS){this.AssosiatedDS.Element.style.display="none"}if(this.TextBox){purge(this.TextBox);this.Element.removeChild(this.TextBox);this.TextBox=null}return}if(!this.TextBox){var p=this.TextBox=document.createElement("input");p.binderid=this.Element.binderid;p.tabIndex=1;p.onkeydown=Qva.Mgr.search.KeyDown;Qva.Events.AddCancelBubble(p,".transientpos");this.Element.appendChild(p);if(Qva.userAgentDetector.get("ios8orBelow")){$(p).bind("touchstart",function(e){e.preventDefault();e.stopPropagation()})}this.TextBox.last_search=""}var that=this;that.InputTimeout=setTimeout(function(){that.InputChecker()},300);var owner=node.getAttribute("owner");var text=node.getAttribute("text");var associatedsearch=node.getAttribute("associatedsearch");var elem=window.document.getElementById(owner);if(!elem){return}var elemPageCoords=Qva.GetAbsolutePageCoords(elem);var iconwidth=36;if(Qva.userAgentDetector.get("msie6o7")){iconwidth=38}var top=elemPageCoords.y-20;var width=elem.offsetWidth;switch(associatedsearch){case"true":width*=2;this.ToogleImg.alt="collapse";$(this.ToogleImg).removeClass("search-expand-icon").addClass("search-collapse-icon");this.ToogleImg.style.display="";break;case"false":this.AssosiatedDS.Element.style.display="none";this.ToogleImg.alt="expand";$(this.ToogleImg).addClass("search-expand-icon").removeClass("search-collapse-icon");this.ToogleImg.style.display="";break;case"hidden":default:this.AssosiatedDS.Element.style.display="none";iconwidth=18;this.ToogleImg.style.display="none";break}width-=2;if(width<100){width=100}element.style.left=elemPageCoords.x+"px";element.style.top=top+"px";element.style.width=width+"px";if(Qva.userAgentDetector.get("msie6o7")){this.TextBox.style.width=(width-iconwidth-4)+"px"}else{this.TextBox.style.width=(width-iconwidth)+"px"}this.TextBox.focus();Qva.ActiveElement=this.TextBox;if(Qva.InitSearch){if(Qva.InitSearch=="<"||Qva.InitSearch==">"||Qva.InitSearch=="="){this.TextBox.value=Qva.InitSearch}else{if(text=="**"){this.TextBox.value="*"+Qva.InitSearch+"*"}else{if(text=="~"){this.TextBox.value="~"+Qva.InitSearch}else{this.TextBox.value=Qva.InitSearch}}}this.TextBox.last_search=this.TextBox.value;Qva.Mgr.search.Do(this.PageBinder,this.TextBox.value,true);Qva.SetCursor(this.TextBox,false);Qva.InitSearch=""}else{if(this.PageBinder.PendingSearchName==""&&this.TextBox.value!=text&&this.TextBox.last_search==this.TextBox.value){this.TextBox.value=text;Qva.SetCursor(this.TextBox,false)}}};Qva.Mgr.textdatetemplate=function(owner,elem,name,prefix){if(!Qva.MgrSplit(this,name,prefix)){return}owner.AddManager(this);this.Element=elem};Qva.Mgr.textdatetemplate.prototype.Paint=function(mode,node){this.Touched=true;var element=this.Element;var text=getDateTemplateAttribute(node,"text");element.innerText=text;element.style.display=Qva.MgrGetDisplayFromMode(this,mode)};function PadNumStr(num,length){num=(""+num);while(num.length<length){num="0"+num}return num}function ToInt(str){if(!str){return null}while(str.length>1&&str.charAt(0)==="0"){str=str.substr(1)}return parseInt(str)}function ToDateTime(str,format){var re=/(\d\d\d\d)-(\d\d)-(\d\d) (\d\d):(\d\d):(\d\d)/;var r=re.exec(str);if(r){var year=ToInt(r[1]);var month=ToInt(r[2]);var date=ToInt(r[3]);var hours=ToInt(r[4]);var minutes=ToInt(r[5]);var seconds=ToInt(r[6]);var d=new Date(Date.UTC(year,month-1,date,hours,minutes,seconds));if(format){return format(d)}else{return d.toLocaleString()}}else{return str}}function getDateTemplateAttribute(node,name){var template;var templateId=node.getAttribute(name+"_labelId");if(templateId!==null){template=Qva.localization.getStringFromNode(node,name)}else{template=node.getAttribute(name+"_template")}var d=ToDateTime(node.getAttribute(name+"_date"),function(x){return x});var date=PadNumStr(d.getFullYear(),4)+"."+PadNumStr(d.getMonth()+1,2)+"."+PadNumStr(d.getDate(),2);var time=PadNumStr(d.getHours(),2)+":"+PadNumStr(d.getMinutes(),2);return template.replace("{date}",date).replace("{time}",time)}Qva.Mgr.notelist=function(owner,elem,name,prefix){if(!Qva.MgrSplit(this,name,prefix)){return}owner.AddManager(this);this.Element=elem};Qva.Mgr.notelist.prototype.Paint=function(mode,node){this.Touched=true;var element=this.Element;element.style.display=Qva.MgrGetDisplayFromMode(this,mode);if(element.style.display=="none"){return}element.innerHTML="";var compactview=node.getAttribute("compactview")==="true";$(element).parent().parent().addClass(compactview?"ConciseView":"VerboseView").removeClass(compactview?"VerboseView":"ConciseView");element.className=compactview?"ConciseView":"VerboseView";var entries=node.getElementsByTagName("element");for(var i=0;i<entries.length;++i){var entry=entries[i];var div=document.createElement("div");div.className="Note";if(!compactview){var header=document.createElement("div");header.className="Header";header.innerText=Qva.localization.getStringFromNode(entry,"header");div.appendChild(header)}if(entry.getAttribute("bookmark")==="true"){var bookmark=document.createElement("span");bookmark.className="has-snapshot";div.appendChild(bookmark)}var title=document.createElement("div");title.className="Title";title.innerText=entry.getAttribute("title");div.appendChild(title);var body=document.createElement("div");body.className="Body";body.innerText=entry.getAttribute("body");div.appendChild(body);if(compactview){var footer=document.createElement("div");footer.className="Footer";footer.innerText=Qva.localization.getStringFromNode(entry);div.appendChild(footer)}else{var f1=document.createElement("div");f1.className="Footer";f1.innerText=getDateTemplateAttribute(entry,"footer1");div.appendChild(f1);var f2=document.createElement("div");f2.className="Footer";if(entry.getAttribute("footer2")!=null){f2.innerText=Qva.localization.getStringFromNode(entry,"footer2")}else{f2.innerText=getDateTemplateAttribute(entry,"footer2")}div.appendChild(f2);var f3=document.createElement("div");f3.className="Footer";f3.innerText=Qva.localization.getStringFromNode(entry,"footer3");f3.style.cssText="text-align: right;";div.appendChild(f3)}div.binderid=this.PageBinder.binderid;div.Position=entry.getAttribute("id");div.Action="Document.Annotations.Show";Qva.Events.AddClickEvent(div,onclick_action);element.appendChild(div)}};Qva.Mgr.commentlist=function(owner,elem,name,prefix){if(!Qva.MgrSplit(this,name,prefix)){return}owner.AddManager(this);this.Element=elem};Qva.Mgr.commentlist.prototype.Paint=function(mode,node){this.Touched=true;var element=this.Element;element.style.display=Qva.MgrGetDisplayFromMode(this,mode);if(element.style.display=="none"){return}element.innerHTML="";var entries=node.getElementsByTagName("element");var links=$(element).parents(".NoteBg").prev().find("div a");Assert(links.length===2);if(entries.length===0){if(links.length>0&&links[0]){links[0].removeAttribute("href","");links[1].removeAttribute("href","");links[0].className="disabled";links[1].className="disabled"}}else{if(links.length>0&&links[0]){links[0].setAttribute("href","#comment_first");links[1].setAttribute("href","#comment_last");links[0].className="";links[1].className=""}}for(var i=0;i<entries.length;++i){var entry=entries[i];var div=document.createElement("div");div.className="Comment";if(entry.getAttribute("menu")==="true"){var menuImg=document.createElement("img");menuImg.style.cssText="float: right;";menuImg.title="menu";menuImg.src=this.PageBinder.PageBinder.BuildBinaryUrl(null,null,"bundled:caption_menu");div.appendChild(menuImg);menuImg.binderid=this.PageBinder.binderid;menuImg.Position="comment:"+entry.getAttribute("id");Qva.Events.AddClickEvent(menuImg,function(){Qva.GetBinder(this.binderid).OnContextMenu(event,"Annotations",this.Position)})}var deleted_text=entry.getAttribute("deleted");if(deleted_text){var del=document.createElement("div");del.className="Body";del.style.cssText="font-style: italic";del.innerText=Qva.localization.getStringFromKey(deleted_text);div.appendChild(del)}else{var pic=document.createElement("span");pic.style.cssText="float: left; margin: 0 5px 6px 1px; position: static;";pic.className="ui-icon-user";div.appendChild(pic);var header1=document.createElement("div");header1.className="Header";header1.innerText=getDateTemplateAttribute(entry,"h1");div.appendChild(header1);var header2=document.createElement("div");header2.className="Header";header2.innerText=Qva.localization.getStringFromNode(entry,"h2");div.appendChild(header2);var bookmark_id=entry.getAttribute("bookmarkid");if(bookmark_id){var bookmark=document.createElement("a");bookmark.className="use-snapshot";bookmark.Bookmark=entry.getAttribute("bookmarkid");bookmark.binderid=this.PageBinder.binderid;Qva.Events.AddClickEvent(bookmark,function(){Qva.GetBinder(this.binderid).Set("bookmark-apply","docaction",this.Bookmark,true)});div.appendChild(bookmark)}var body=document.createElement("div");body.className="Body";body.innerText=entry.getAttribute("body");div.appendChild(body)}element.appendChild(div)}};Qva.Mgr.icon=function(owner,elem,name,prefix){var icon=elem.getAttribute("icon");var binder=Qva.GetBinder(owner.binderid);elem.src=binder.BuildBinaryUrl(null,null,icon)};Qva.Mgr.annotations=function(owner,elem,name,prefix,offset){var name=Qva.MgrMakeName(name,prefix);this.Element=elem;var that=this;owner.OnComplete=function(){that.Update()};var notes_name=name+".NoteList.Notes";this.pageoffset=0;this.totalsize=0;this.visible_notes=0;owner.AddManager({Name:notes_name,Paint:function(mode,node){that.pageoffset=parseInt(node.getAttribute("pageoffset"),10);that.totalsize=parseInt(node.getAttribute("totalsize"),10)}});var buttons=$(elem).find(".Notes button");$(buttons[0]).click(function(){if($(this).hasClass("Disabled")){return}owner.PageBinder.Set(notes_name,"scroll",-that.visible_notes,true)});$(buttons[1]).click(function(){if($(this).hasClass("Disabled")){return}owner.PageBinder.Set(notes_name,"scroll",that.visible_notes,true)});$(elem).find(":button").button();var frame=$(elem).closest(".QvFrame");owner.AddManager({Frame:frame,Name:name+".Height",Paint:function(mode,node){var height=parseInt(node.getAttribute("text"),10);Assert(!isNaN(height));this.Frame.height(height)}});$(elem).find(".Resizer").bind("mousedown",function(event){if(event.which!==1){return}var resize_elem=$(elem).find('*[data-height="auto"]:visible');Assert(resize_elem.length===1);var start_h1=frame.outerHeight();var start_h2;if(resize_elem.css("box-sizing")==="border-box"){start_h2=resize_elem.outerHeight()}else{start_h2=resize_elem.height()}var startY=event.pageY;function onmousemove(event){var dy=event.pageY-startY;if(start_h1+dy<490){dy=490-start_h1}frame.height(start_h1+dy);resize_elem.height(start_h2+dy)}function onmouseup(event){if(event.which!==1){return}$(document).unbind("mousemove",onmousemove);$(document).unbind("mouseup",onmouseup);var dy=event.pageY-startY;if(start_h1+dy<490){dy=490-start_h1}frame.height(start_h1+dy);resize_elem.height(start_h2+dy);owner.PageBinder.Set("Document.Annotations","resize",start_h1+dy,true)}$(document).bind("mousemove",onmousemove);$(document).bind("mouseup",onmouseup)});if(Qva.userAgentDetector.get("msie")){$(elem).find(".text-input").not("textarea").keypress(function(e){if(e.which==13){return false}})}if(Qva.userAgentDetector.get("touchEnabled")){var $scroll_elems=$(elem).find('div[data-height="auto"]').filter(function(){return $(this).css("overflow")==="auto"}).wrapInner("<div>").children();for(var i=0;i<$scroll_elems.length;++i){$scroll_elems[i].qvscroll=new QvScroll({attachElement:$scroll_elems[i],horizontal:"disabled",cornerBounce:true});try{var parent=$scroll_elems[i].parentNode;parent.addEventListener("touchstart",Qva.NoAction,false);parent.addEventListener("touchend",Qva.NoAction,false)}catch(e){}}this.$scroll_elems=$scroll_elems}};Qva.Mgr.annotations.prototype.Update=function(){this.UpdateHeight();this.UpdateNotesScroll();if(this.$scroll_elems){for(var i=0;i<this.$scroll_elems.length;++i){this.$scroll_elems[i].qvscroll.calculateScrollValues()}}};Qva.Mgr.annotations.prototype.UpdateHeight=function(){var resize_elem=$(this.Element).find('*[data-height="auto"]:visible');Assert(resize_elem.length<=1);if(resize_elem.length!==1){return}var parent=resize_elem.parent();var others=parent.children(":visible").not(resize_elem);var frame=parent.closest(".QvFrame");var frame_height=frame.height();var caption_height=frame.children(".QvCaption_Prop").outerHeight();var total_height=frame_height-caption_height-2;var others_height=0;others.each(function(){others_height+=$(this).outerHeight(true)});var d_height=0;if(resize_elem.css("box-sizing")!=="border-box"){d_height=resize_elem.outerHeight(true)-resize_elem.height()}var new_height=total_height-others_height-d_height;resize_elem.height(new_height);if(resize_elem[0].firstChild&&resize_elem[0].firstChild.qvscroll){resize_elem[0].firstChild.qvscroll.attach()}};Qva.Mgr.annotations.prototype.UpdateNotesScroll=function(){var notes=$(this.Element).find(".Notes");if(!notes.is(":visible")){return}var notelist_height=notes.children(".NoteList").height();var note_height=notes.children(".NoteList").children().children().outerHeight()+5;this.visible_notes=Math.floor(notelist_height/note_height);var up_button_is_active=this.pageoffset>0;var down_button_is_active=(this.totalsize-this.pageoffset)*note_height>notelist_height;var buttons=notes.children("button");$(buttons[0])[up_button_is_active?"removeClass":"addClass"]("Disabled");$(buttons[1])[down_button_is_active?"removeClass":"addClass"]("Disabled")}})(window.$QvJq);(function($,undefined){function ListDiff(old_list,new_list,added,removed){var i_p=0;var i_n=0;while(i_p<old_list.length&&i_n<new_list.length){if(old_list[i_p]<new_list[i_n]){removed.push(old_list[i_p]);++i_p}else{if(old_list[i_p]>new_list[i_n]){added.push(new_list[i_n]);++i_n}else{++i_p;++i_n}}}for(;i_p<old_list.length;++i_p){removed.push(old_list[i_p])}for(;i_n<new_list.length;++i_n){added.push(new_list[i_n])}}function SetRelatedElementsZindex(objectname,zindex){var frame=window.document.getElementById(objectname);if(frame){var oldzindex=frame.style.zIndex;if(zindex==oldzindex){return}frame.style.zIndex=zindex}var ids=[objectname+"_minimized",objectname+"_minimized_resize",objectname+"_minimized_move",objectname+"_frame_resize",objectname+"_frame_move"];for(var i=0;i<ids.length;i++){var elem=window.document.getElementById(ids[i]);if(elem){elem.style.zIndex=zindex}}}Qva.Collaboration=function(owner,elem){this.Name=owner.DefaultScope+".ActiveSheet";this.Attr="collobj";this.Element=elem;this.PageBinder=owner;owner.AddManager(this);this.Objects=[]};Qva.Collaboration.prototype.Scale=function(node,attr,min){var dim=parseFloat(node.getAttribute(attr));if(isNaN(dim)||dim<0){dim=100}if(dim<min){dim=min}return dim};Qva.Collaboration.prototype.Paint=function(mode,rootnode){this.Touched=true;if(this.Element==null){this.Element=document.getElementById("MainContainer")}if(this.Element==null){return}this.ZList=[];this.PropZList=[];var currentObjects=[];var nodes=rootnode.getElementsByTagName("object");var count=nodes.length;var maxtop=0;Qva.Help.Context={};var maximizedobject=null;for(var ix=0;ix<count;++ix){var node=nodes[ix];var name=node.getAttribute("name");var objectid=node.getAttribute("objectid");if(this.PageBinder.SingleObjectId&&objectid){if(objectid!=this.PageBinder.SingleObjectId){continue}}if(!name){continue}if(window.IS_QVCLIENT&&name==="Annotations"){if(node.getAttribute("mode")!=="hidden"){$(window.QvEvent).trigger("notesDialog",["opened"])}continue}var obj={};obj.id=name;obj.objectid=objectid;obj.mode=node.getAttribute("mode");obj.left=node.getAttribute("left");obj.width=node.getAttribute("width");obj.height=node.getAttribute("height");if(obj.id=="Annotations"){obj.top=parseInt($(window).scrollTop()).toString()}else{obj.top=node.getAttribute("top")}obj.state=node.getAttribute("state");obj.allowmove=node.getAttribute("allowmove");obj.allowmovesheetobject=node.getAttribute("allowmovesheetobject");obj.allowresize=node.getAttribute("allowresize");if(obj.mode=="maximized"){obj.maximized=true;maximizedobject=name}else{obj.maximized=false}obj.type=node.getAttribute("type");obj.help=node.getAttribute("help");obj.extension=node.getAttribute("extension");if(obj.mode!="hidden"){Qva.Help.Context[obj.id]={Name:obj.id,Topic:obj.help,SubType:obj.extension}}currentObjects.push(name);if(node.getAttribute("type")=="TW"){if(!this.PageBinder.Members[this.PageBinder.DefaultScope+"."+name]&&obj.mode=="hidden"){continue}this.PropZList.push(name)}else{this.ZList.push(name)}this.PageBinder.SignalVisibility(obj.id,obj.mode!=="hidden");var frame_toresize=name;name=this.PageBinder.DefaultScope+"."+name;var mgr=this.PageBinder.Members[name];if(mgr){mgr=mgr[0]}if(mgr){mgr.Size(obj);if(mgr.setAnnotation){mgr.setAnnotation(node)}if(node.getAttribute("type")!="TW"){continue}var WantPage=node.getAttribute("page")!=null;if(!!mgr.HasPage==WantPage){continue}this.PageBinder.RemoveObject(frame_toresize)}obj.create=true;obj.name=name;if(obj.type=="TW"){obj.page=node.getAttribute("page")}switch(obj.type){case"TW":this.CreateToolWindow(obj);break;default:this.AddObject(obj);break}if(obj.type!="TW"){this.CreateMinimized(obj)}mgr=this.PageBinder.Members[name];if(mgr){mgr=mgr[0]}if(mgr){mgr.Size(obj);if(mgr.setAnnotation){mgr.setAnnotation(node)}}}currentObjects.sort();var added=[];var removed=[];ListDiff(this.Objects,currentObjects,added,removed);this.Objects=currentObjects;var ToolWindowZLevel=this.PageBinder.ToolWindowZLevel;for(var i=0;i<removed.length;++i){this.PageBinder.RemoveObject(removed[i]);ToolWindowZLevel.Remove(removed[i]);this.PageBinder.RemoveObject(removed[i]+".RE")}var deltaobjectcount=ToolWindowZLevel.SetObjectCount(this.ZList.length,this.PropZList.length);for(var i=0;i<this.ZList.length;i++){var name=this.ZList[i];var zindex=name==maximizedobject?ToolWindowZLevel.MaximizedObject:ToolWindowZLevel.Start+ToolWindowZLevel.Step*(this.ZList.length-i);SetRelatedElementsZindex(name,zindex);var zindexAnnotation=ToolWindowZLevel.AnnotationIcons;Qva.ZLevelAnnotation(name,zindexAnnotation)}for(var i=this.PropZList.length-1;i>=0;i--){var name=this.PropZList[i];ToolWindowZLevel.SetZLevel(name,deltaobjectcount)}};Qva.Collaboration.prototype.AddObject=function(data){var frame=Qva.Mgr.CreateObject(this.PageBinder,data,true);this.Element.appendChild(frame.Element);this.AddAnnotation(frame,data)};Qva.Collaboration.prototype.CreateToolWindow=function(data){var frame=Qva.Mgr.CreateObject(this.PageBinder,data,true);frame.Element.className+=" ToolWindow Qv_"+data.help;frame.Element.style.display="none";frame.Element.style.zIndex="100";if(Qva.userAgentDetector.get("msie8lte")){frame.Element.style.left=data.left;frame.Element.style.top=data.top}var table=document.createElement("table");table.style.cssText="height:100%; width:100%;";if(data.page){frame.HasPage=true;var row=table.insertRow(-1);var cell3=row.insertCell(-1);cell3.vAlign="top";if(data.name==="Document.TOOLS\\REPOSITORY"){var rowShow=table.insertRow(0);var rowGroup=table.insertRow(1);var cellShow=rowShow.insertCell(-1);var cellGroup=rowGroup.insertCell(-1);$(cellShow).css("height","22px");$(cellGroup).css("height","22px");new Qva.Mgr.toolwindowfilter(this.PageBinder,cellShow,data.name+".Filter");new Qva.Mgr.toolwindowfilter(this.PageBinder,cellGroup,data.name+".Sorting")}}else{var rowHeader=table.insertRow(-1);var cellHeader=rowHeader.insertCell(-1);cellHeader.vAlign="top";cellHeader.innerHTML="<div class='ToolWindow-Navigation'></div>";var row=table.insertRow(-1);var cell3=row.insertCell(-1);cell3.vAlign="top";cell3.innerHTML="<div class='ToolWindow-Body'></div>"}frame.ContentElement.appendChild(table);Qva.SetContextMenu(frame,function(event){return Qva.GetBinder(this.binderid).OnContextMenu(event,this.Name)});this.Element.appendChild(frame.Element);new Qva.Mgr.style(frame,frame.ContentElement,data.name+".Style");if(data.page){var pageBinder=this.PageBinder;var bmgr=new Qva.Mgr.toolwindowbody(pageBinder,null,data.name+".Body");bmgr.TopElement=frame.Element;this.PageBinder.LoadHtml(data.page,function(body){cell3.innerHTML=body;bmgr.Element=$(cell3).children().get(0);bmgr.Scan();bmgr.Paint()})}else{new Qva.Mgr.toolwindownavigation(this.PageBinder,cellHeader.firstChild,data.name+".Navigation");new Qva.Mgr.toolwindowbody(this.PageBinder,$(cell3).children().get(0),data.name+".Body")}};Qva.Collaboration.prototype.CreateMinimized=function(data){var frame=document.createElement("div");frame.className="QvFrame";frame.style.cssText="vertical-align:middle;text-align:left; display:none;";frame.id=data.id+"_minimized";this.Element.appendChild(frame);new Qva.Mgr.restore(this.PageBinder,frame,data.name+".RE")};Qva.PositionAnnotation=function(annotation,data){annotation.style.left=data.left-3+"px";annotation.style.top=data.top-29+"px"};Qva.ZLevelAnnotation=function(name,zIndex){var annotation=window.document.getElementById(name+"_annotation");if(annotation){annotation.style.zIndex=zIndex}};Qva.Collaboration.prototype.AddAnnotation=function(frame,data){var annotation=document.createElement("div");annotation.style.display="none";annotation.className="QvAnnotation";annotation.onclick=function(event){frame.PageBinder.Set("Document.Annotations.Filter","value",frame.Name,true)};annotation.id=data.id+"_annotation";Qva.PositionAnnotation(annotation,data);var textnode=document.createElement("span");annotation.appendChild(textnode);this.Element.appendChild(annotation);frame.setAnnotation=function(node){var text=node.getAttribute("annotations");var selected=node.getAttribute("selected_annotations")==="true";annotation.style.display=text?"":"none";if(annotation.style.display=="none"){return}$(annotation)[selected?"addClass":"removeClass"]("Selected");textnode.innerText=text}};Qva.Mgr.children=function(owner,elem,name,prefix){if(!Qva.MgrSplit(this,name,prefix)){return}owner.AddManager(this);this.Element=elem;elem.binderid=owner.binderid;this.PageBinder=owner.PageBinder;this.Objects=[];this.Managers=[];this.InlineStyle=owner.InlineStyle;this.LeftButton=owner.LeftButton;this.TableLimit=owner.TableLimit;this.IsHosted=owner.IsHosted;this.Enabled=true;this.binderid=owner.binderid;this.GridElements={}};Qva.Mgr.children.prototype.GetEnabled=function(){return this.PageBinder.GetEnabled()};Qva.Mgr.children.prototype.Paint=function(mode,rootnode){this.Touched=true;var currentObjects=[];var nodes=rootnode.getElementsByTagName("object");var count=nodes.length;var maxtop=0;var htmlObjectOrder=[];for(var ix=0;ix<count;++ix){var node=nodes[ix];var name=node.getAttribute("name");if(!name){continue}currentObjects.push(name);htmlObjectOrder.push(name);var obj={};obj.id=name;obj.mode=node.getAttribute("mode");obj.left=node.getAttribute("left");obj.top=node.getAttribute("top");obj.width=node.getAttribute("width");obj.height=node.getAttribute("height");obj.allowmove=node.getAttribute("allowmove");obj.allowresize=node.getAttribute("allowresize");obj.maximized=obj.mode=="maximized";if(Qva.userAgentDetector.get("msie6o7")){var top=parseInt(node.getAttribute("top"))+parseInt(node.getAttribute("height"));if(top>maxtop){maxtop=top}}var frame_toresize=name;name=this.PageBinder.GetDocumentMgr().DefaultScope+"."+name;var mgr=this.PageBinder.GetDocumentMgr().Members[name];if(mgr){mgr=mgr[0]}if(mgr){mgr.Size(obj);continue}obj.create=true;obj.name=name;obj.type=node.getAttribute("type");obj.extension=node.getAttribute("extension");var frame=Qva.Mgr.CreateObject(this,obj);var div=document.createElement("div");this.GridElements[name]=div;div.appendChild(frame.Element);this.Element.appendChild(div)}if(Qva.userAgentDetector.get("msie6o7")){this.Element.style.height=maxtop+10+"px"}currentObjects.sort();var added=[];var removed=[];ListDiff(this.Objects,currentObjects,added,removed);this.Objects=currentObjects;for(var i=0;i<removed.length;++i){var divToRemove=this.GridElements["Document."+removed[i]];if(divToRemove){divToRemove.parentNode.removeChild(divToRemove)}this.RemoveObject(removed[i])}for(var i=0;i<htmlObjectOrder.length;++i){var divToMove=this.GridElements["Document."+htmlObjectOrder[i]];$(this.Element).append(divToMove)}};Qva.Mgr.children.prototype.QueuePostPaintMessage=function(mgr){this.PageBinder.QueuePostPaintMessage(mgr)};Qva.Mgr.children.prototype.BuildBinaryUrl=function(path,stamp,name,color){return this.PageBinder.BuildBinaryUrl(path,stamp,name,color)};Qva.Mgr.children.prototype.Set=function(name,type,value,_final){this.PageBinder.GetDocumentMgr().Set(name,type,value,_final)};Qva.Mgr.children.prototype.GetDocumentMgr=function(){return this.PageBinder.GetDocumentMgr()};Qva.Mgr.children.prototype.GetUpdates=function(polls){for(var mix=0;mix<this.Managers.length;++mix){var mgr=this.Managers[mix];if(mgr.GetUpdates){mgr.GetUpdates(polls)}}};Qva.Mgr.children.prototype.GetMaximizedRect=function(element){var rect={};rect.left="0";rect.top="0";if(this.Grid){rect.width=""+this.GridElements[element.Name].offsetWidth;rect.height=""+this.GridElements[element.Name].offsetHeight}else{rect.width=""+this.Element.offsetWidth;rect.height=""+this.Element.offsetHeight}return rect};Qva.Mgr.children.prototype.AddManager=function(mgr){mgr.PageBinder=this;mgr.Touched=false;if(mgr.SelectedClassName==null){mgr.SelectedClassName="QvSelected";mgr.DeselectedClassName="QvDeselected";mgr.EnabledClassName="QvOptional";mgr.DisabledClassName="QvExcluded";mgr.LockedClassName="QvLocked";mgr.SelectedExcludedClassName="QvSelectedExcluded";mgr.LockedExcludedClassName="QvLockedExcluded";mgr.AlternativeClassName="QvAlternative";mgr.ModeIfNotEnabled="n"}this.Managers[this.Managers.length]=mgr;this.PageBinder.GetDocumentMgr().Append(mgr,mgr.Name,mgr.Attr)};Qva.Mgr.children.prototype.Append=function(mgr,name,attr,noautoview){this.PageBinder.GetDocumentMgr().Append(mgr,name,attr,noautoview)};Qva.Mgr.children.prototype.RemoveFromManagers=Qva.PageBinding.prototype.RemoveFromManagers;Qva.Mgr.children.prototype.RemoveObject=function(objectname){var mgr=this.PageBinder.GetDocumentMgr().Members["Document."+objectname];if(mgr){mgr=mgr[0]}if(mgr){if(mgr.Remove){mgr.Remove()}this.RemoveFromManagers(mgr)}this.PageBinder.GetDocumentMgr().Members["Document."+objectname]={};this.PageBinder.GetDocumentMgr().Members["Document."+objectname]=null};Qva.Mgr.children.prototype.Remove=function(){for(var objIndex=0;objIndex<this.Objects.length;objIndex++){this.RemoveObject(this.Objects[objIndex])}Qva.RemoveHtml(this.Element);this.PageBinder=null;this.Objects={};this.Managers={};this.InlineStyle=null;this.LeftButton=null;this.TableLimit=null;this.IsHosted=null;this.Enabled=null;this.binderid=null;this.GridElements={}}})($QvJq);(function($,undefined){if(!Qva.DragDrop){Qva.DragDrop=new Object({mouseOffset:null,DropTargets:[],DropFrames:[],DropDefault:null,curDrag:null,dragHelper:null,curDrop:null,dragType:null,DragStarted:null})}Qva.DragDrop.GetDropTarget=function(mousePos,type,exclude){if(!type){type=Qva.DragDrop.curDrag.Type}if(exclude){var names=exclude.split(".");if(names.length>=2){exclude=names[0]+"."+names[1]}}for(var i=0;i<Qva.DragDrop.DropTargets.length;++i){if(Qva.DragDrop.dragElement&&Qva.DragDrop.dragElement.binderid!=Qva.DragDrop.DropTargets[i].binderid){continue}var dropTarget=Qva.DragDrop.DropTargets[i].Inside(mousePos,type);if(dropTarget){return dropTarget}}for(var i=0;i<Qva.DragDrop.DropFrames.length;++i){var frame=Qva.DragDrop.DropFrames[i];if(exclude&&frame.Name==exclude){continue}var dropTarget=frame.Inside(mousePos,type);if(dropTarget){return dropTarget}}if(Qva.DragDrop.DropDefault){return Qva.DragDrop.DropDefault.Inside(mousePos,type)}return null};Qva.DragDrop.Inside=function(cell,mousePos){try{var cellPos=Qva.GetPageCoords(cell);var cellWidth=parseInt(cell.offsetWidth);var cellHeight=parseInt(cell.offsetHeight);return(mousePos.x>cellPos.x&&mousePos.x<cellPos.x+cellWidth&&mousePos.y>cellPos.y&&mousePos.y<cellPos.y+cellHeight)}catch(err){return false}};Qva.DragDrop.mouseMove=function(event){if(!Qva.DragDrop.curDrag){Assert(false)}var d=new Date();if(d.getTime()-Qva.MouseDownStartTime<200){return}var mousePos={x:Qva.Events.getClientX(event),y:Qva.Events.getClientY(event)};var target=Qva.DragDrop.dragElement;if(!Qva.DragDrop.DragStarted){Qva.DragDrop.DragStarted=true;while(Qva.DragDrop.dragHelper.firstChild){Qva.DragDrop.dragHelper.removeChild(Qva.DragDrop.dragHelper.firstChild)}if(Qva.DragDrop.dragType=="cell"){Qva.DragDrop.dragHelper.appendChild(target.cloneNode(true));Qva.DragDrop.dragHelper.className="QvDragRect";Qva.DragDrop.dragHelper.style.display="block";Qva.DragDrop.dragHelper.firstChild.dragObj=null}else{var dragRow=target.cloneNode(true);var arr=target.getElementsByTagName("select");if(arr.length>0){var arrClone=dragRow.getElementsByTagName("select");for(var i=0;i<arr.length;i++){arrClone[i].selectedIndex=arr[i].selectedIndex}}var arrSpan=dragRow.getElementsByTagName("span");for(var i=0;i<arrSpan.length;i++){arrSpan[i].style.cursor="inherit"}var tableTarget=target;while(tableTarget&&tableTarget.nodeName!="TABLE"){tableTarget=tableTarget.parentNode}if(tableTarget){var colgroupTarget=tableTarget.firstChild;while(colgroupTarget&&colgroupTarget.nodeName!="COLGROUP"){colgroupTarget=colgroupTarget.nextSibling}}var dragTbody=document.createElement("tbody");var dragTable=document.createElement("table");var path=$(target).getPath();dragTable.style.width=Qva.ElementAttributesHandler(path,target,"offsetWidth")+"px";dragTable.style.height=Qva.ElementAttributesHandler(path,target,"offsetHeight")+"px";dragTable.style.tableLayout="fixed";dragTbody.appendChild(dragRow);if(colgroupTarget){dragTable.appendChild(colgroupTarget.cloneNode(true))}dragTable.appendChild(dragTbody);Qva.DragDrop.dragHelper.appendChild(dragTable);Qva.DragDrop.dragHelper.className="QvDragRect";Qva.DragDrop.dragHelper.style.display="block";Qva.DragDrop.dragHelper.style.fontFamily="arial";Qva.DragDrop.dragHelper.style.fontSize="10pt";dragRow.dragObj=null}Qva.DragDrop.dragHelper.style.zIndex=99000}Qva.DragDrop.dragHelper.style.top=Qva.GetScrollTop()+mousePos.y-Qva.DragDrop.mouseOffset.y+"px";Qva.DragDrop.dragHelper.style.left=Qva.GetScrollLeft()+mousePos.x-Qva.DragDrop.mouseOffset.x+"px";var curDrop=Qva.DragDrop.GetDropTarget(mousePos);if(Qva.DragDrop.curDrop!=curDrop){if(Qva.DragDrop.curDrop&&Qva.DragDrop.curDrop.Element){for(var rowElement=Qva.DragDrop.curDrop.Element.firstChild;rowElement!=null;rowElement=rowElement.nextSibling){if(rowElement.nodeName=="TD"){rowElement.className="";rowElement.style.backgroundImage=""}}}Qva.DragDrop.curDrop=curDrop;Qva.DragDrop.dragHelper.style.cursor="pointer";if(Qva.DragDrop.curDrop){Qva.DragDrop.dragHelper.style.cursor="";var url=Qva.GetBinder(Qva.DragDrop.dragElement.binderid).BuildBinaryUrl(null,null,"dropinsert");if(Qva.DragDrop.curDrop.VerticalPosition=="insertafter"){var className="DropTarget-Bottom"}else{if(Qva.DragDrop.curDrop.VerticalPosition=="insertbefore"){var className="DropTarget-Top"}else{var className="DropTarget-Open"}}if(Qva.DragDrop.curDrop.Element){for(var rowElement=Qva.DragDrop.curDrop.Element.firstChild;rowElement!=null;rowElement=rowElement.nextSibling){if(rowElement.nodeName=="TD"){rowElement.className=className;rowElement.style.backgroundImage="url('"+url+"')"}}}else{Qva.DragDrop.dragHelper.style.cursor="not-allowed"}}}if(!Qva.DragDrop.curDrop){if(Qva.DragDrop.dragType=="row"){Qva.DragDrop.dragHelper.style.cursor="not-allowed"}}Qva.DragDrop.dragHelper.style.backgroundColor=Qva.DragDrop.dragHelper.style.cursor=="not-allowed"?"#ff6961":"#90ee90"};Qva.DragDrop.mouseUp=function(event){if(Qva.DragDrop.curDrag){Qva.DragDrop.dragHelper.style.display="none";if(Qva.DragDrop.curDrop){if(Qva.DragDrop.curDrop.Element){for(var rowElement=Qva.DragDrop.curDrop.Element.firstChild;rowElement!=null;rowElement=rowElement.nextSibling){if(rowElement.nodeName!="TD"){continue}rowElement.className="";rowElement.style.backgroundImage=""}var binder=Qva.GetBinder(Qva.DragDrop.curDrop.Element.binderid);if(binder.Enabled){var target=Qva.DragDrop.curDrop.Element;if(typeof(target)!="string"){target=target.TargetName||target.ObjectId||target.Name}if(Qva.DragDrop.curDrop.VerticalPosition){if(Qva.DragDrop.curDrop.listobject){Qva.DragDrop.curDrop.listobject.RowCount++}binder.Set(Qva.DragDrop.curDrag.Name,Qva.DragDrop.curDrop.VerticalPosition,target,true)}else{var mousePos={x:Qva.Events.getX(event),y:Qva.Events.getY(event)};var atY=mousePos.y-Qva.DragDrop.mouseOffset.y-document.getElementById("PageContainer").offsetTop;var atX=mousePos.x-Qva.DragDrop.mouseOffset.x;target={target:target,x:atX,y:atY,drop:Qva.DragDrop.curDrag.Value};if(Qva.DragDrop.curDrag.Value==="CurrentSelections"){target.title=Qva.localization.getStringFromKey("Current.Selections.Box")}binder.Set(Qva.DragDrop.curDrag.Name,target)}}}}else{if(Qva.DragDrop.curDrag.DropAt){event=event||window.event;var mousePos={x:Qva.Events.getX(event),y:Qva.Events.getY(event)};if(!Qva.DragDrop.Inside(Qva.DragDrop.dragElement,mousePos)){var atY=mousePos.y-Qva.DragDrop.mouseOffset.y-document.getElementById("PageContainer").offsetTop;var atX=mousePos.x-Qva.DragDrop.mouseOffset.x;var binder=Qva.GetBinder(Qva.DragDrop.curDrag.binderid);if(binder.Enabled){binder.Set(Qva.DragDrop.curDrag.Name,{target:"Document.ActiveSheet",x:atX,y:atY,drop:Qva.DragDrop.curDrag.Value})}}}}}else{if(Qva.DragDrop.curDrop){Assert(false)}}Qva.DragDrop.curDrop=null;Qva.DragDrop.curDrag=null;Qva.DragDrop.DragStarted=null};Qva.DragDrop.mouseDown=function(event){var target=event.target||event.srcElement;var type=target.nodeName.toUpperCase();if(target.disabled||type==="INPUT"||type==="SELECT"||type==="TEXTAREA"){return}var dragObj=target.dragObj;if(dragObj){Qva.DragDrop.dragType="cell";Qva.DragDrop.dragElement=target}else{while(target&&target.nodeName!="TR"){target=target.parentNode}if(target){var dragObj=target.dragObj;if(dragObj){Qva.DragDrop.dragType="row";Qva.DragDrop.dragElement=target}}}Qva.DragDrop.curDrag=dragObj;Qva.DragDrop.DragStarted=null;if(dragObj){var mousePos={x:Qva.Events.getX(event),y:Qva.Events.getY(event)};var rowPos=Qva.GetPageCoords(target);Qva.DragDrop.mouseOffset={x:mousePos.x-Qva.GetScrollLeft()-rowPos.x,y:mousePos.y-Qva.GetScrollTop()-rowPos.y};var d=new Date();Qva.MouseDownStartTime=d.getTime()}};Qva.DragDrop.Init=function(){Qva.DragDrop.dragHelper=document.createElement("DIV");Qva.DragDrop.dragHelper.style.cssText="position:absolute; display:none;";Qva.DragDrop.dragHelper.style.zIndex=666;document.body.appendChild(Qva.DragDrop.dragHelper)};var old_QvaStart=Qva.Start;Qva.Start=function(){old_QvaStart();Qva.DragDrop.Init()};Qva.Move={$document:null,StartX:0,StartY:0,moveElement:null,MoveStarted:false,old_cursor:null,moveAlwaysActive:["CurrentSelection","TOOLS\\NEWSHEETOBJ","Annotations","TOOLS\\SHOWFIELDS","TOOLS\\REPOSITORY","PROPS"],mouseDown:function(event,name){var target=event.currentTarget;if(Qva.Events.isTouchEvent(event)&&!Qva.Events.moveActiveForTouch&&(name==undefined||!Qva.Move.strConArrayVal(name,Qva.Move.moveAlwaysActive))){return false}var cancel=target.disabled||(target.nodeName!="INPUT"&&target.nodeName!="SELECT");if(cancel){if(!target.moveObj){while(!target.moveObj){target=target.parentNode}}if(target.moveObj){$document=$(document);old_cursor=document.body.style.cursor;document.body.style.cursor="move";moveElement=target;MoveStarted=false;StartX=Qva.Events.getX(event);StartY=Qva.Events.getY(event)}Qva.BlurActiveElement()}},mouseMove:function(event){if(!moveElement){return}if(!MoveStarted){MoveStarted=true;var arr=moveElement.moveObj.split(":");Qva.Move.curMove=[];for(var i=0;i<arr.length;i++){var element=(arr[i]!="*")?document.getElementById(arr[i]):moveElement;var left=element.style&&element.style.display=="none"&&element.style.left?parseInt(element.style.left):element.offsetLeft;var top=element.style&&element.style.display=="none"&&element.style.top?parseInt(element.style.top):element.offsetTop;Qva.Move.curMove[i]={Element:element,StartLeft:left,StartTop:top,ClassName:element.className,zIndex:element.style.zIndex};element.className+=" QvMoveRect";element.style.zIndex=666}}var deltaX=Qva.Events.getX(event)-StartX;var deltaY=Qva.Events.getY(event)-StartY;for(var i=0;i<Qva.Move.curMove.length;i++){var newX=Qva.Move.curMove[i].StartLeft+deltaX;if(!isNaN(moveElement.xMax)){if(i==0){newX=Math.min(newX,moveElement.xMax)}else{newX=Math.min(newX,moveElement.xMax+Qva.Move.curMove[i].StartLeft-Qva.Move.curMove[0].StartLeft)}}if(!isNaN(moveElement.xMin)){if(i==0){newX=Math.max(newX,moveElement.xMin)}else{newX=Math.max(newX,moveElement.xMin+Qva.Move.curMove[i].StartLeft-Qva.Move.curMove[0].StartLeft)}}if(!moveElement.xOnly){var newY=Qva.Move.curMove[i].StartTop+deltaY;if(!isNaN(moveElement.yMin)){if(i==0){newY=Math.max(newY,moveElement.yMin)}else{newY=Math.max(newY,moveElement.yMin+Qva.Move.curMove[i].StartTop-Qva.Move.curMove[0].StartTop)}}Qva.Move.curMove[i].Element.style.top=newY+"px"}Qva.Move.curMove[i].Element.style.left=newX+"px"}},mouseUp:function(event){if(MoveStarted){var mousePos={x:Qva.Events.getClientX(event),y:Qva.Events.getClientY(event)};var curDrop=Qva.DragDrop.GetDropTarget(mousePos,"Object",moveElement.Name);var binder=Qva.GetBinder(moveElement.binderid);if(curDrop&&curDrop.Element&&curDrop.Element.Name){binder.Set(curDrop.Element.Name,{drop:moveElement.Name,cursor:event.clientX+":"+event.clientY});for(var i=0;i<Qva.Move.curMove.length;i++){Qva.Move.curMove[i].Element.style.left=Qva.Move.curMove[i].StartLeft+"px";Qva.Move.curMove[i].Element.style.top=Qva.Move.curMove[i].StartTop+"px"}}else{var deltaX=Qva.Events.getX(event)-StartX;var deltaY=Qva.Events.getY(event)-StartY;var y=Qva.Move.curMove[0].StartTop+deltaY;var x=Qva.Move.curMove[0].StartLeft+deltaX;if(moveElement.xOnly){x-=moveElement.xMin;x/=(moveElement.xMax-moveElement.xMin);binder.Set(moveElement.Name,"value",Math.round(x*255),true)}else{if(!isNaN(moveElement.xMin)){x=Math.max(x,moveElement.xMin)}if(!isNaN(moveElement.yMin)){y=Math.max(y,moveElement.yMin)}binder.Set(moveElement.Name,{moveto:x+":"+y,cursor:Qva.Events.getClientX(event)+":"+Qva.Events.getClientY(event)})}}for(var i=0;i<Qva.Move.curMove.length;i++){Qva.Move.curMove[i].Element.className=Qva.Move.curMove[i].ClassName;Qva.Move.curMove[i].Element.style.zIndex=Qva.Move.curMove[i].zIndex}Qva.Move.curMove=null;moveElement=null;MoveStarted=false}document.body.style.cursor=old_cursor},strConArrayVal:function(needle,haystack){var length=haystack.length;for(var i=0;i<length;i++){if(needle.indexOf(haystack[i])!=-1){return true}}return false}};Qva.Resize={};Qva.Resize.mouseDown=function(event,frame){if(Qva.Events.isTouchEvent(event)&&!Qva.Events.resizeActiveForTouch){return false}var target=Qva.Events.getTarget(event);var at=Qva.GetPageCoords(frame);Qva.Resize.ResizeType=target.ResizeType;Qva.Resize.Frame=frame;Qva.Resize.StartX=Qva.Events.getX(event);Qva.Resize.StartY=Qva.Events.getY(event);Qva.Resize.StartLeft=Qva.GetScrollLeft()+at.x-1;Qva.Resize.StartTop=Qva.GetScrollTop()+at.y-1;Qva.Resize.StartH=$(frame).outerHeight();Qva.Resize.StartW=$(frame).outerWidth();Qva.Resize.sizeToDataOffsetWidth=Math.max(Qva.Resize.Frame.rect.width-Qva.Resize.StartW,0);Qva.Resize.sizeToDataOffsetHeight=Math.max(Qva.Resize.Frame.rect.height-Qva.Resize.StartH,0);if(!Qva.Resize.SizeRect){Qva.Resize.SizeRect=document.createElement("div");Qva.Resize.SizeRect.className="QvSizeRect";Qva.Resize.SizeRect.style.display="";document.body.insertBefore(Qva.Resize.SizeRect,document.body.firstChild)}else{Qva.Resize.SizeRect.style.display=""}Qva.Resize.SizeRect.style.left=Qva.Resize.StartLeft+"px";Qva.Resize.SizeRect.style.top=Qva.Resize.StartTop+"px";Qva.Resize.SizeRect.style.width=Qva.Resize.StartW+"px";Qva.Resize.SizeRect.style.height=Qva.Resize.StartH+"px";Qva.Resize.SizeRect.X=null;Qva.Resize.SizeRect.Y=null;Qva.Resize.SizeRect.W=null;Qva.Resize.SizeRect.H=null;Qva.Resize.minWidth=0;Qva.Resize.minHeight=0;Qva.Resize.maxWidth=Infinity;Qva.Resize.maxHeight=Infinity;if(Qva.Resize.Frame.AvqMgr&&Qva.Resize.Frame.AvqMgr.Limits){var limits=Qva.Resize.Frame.AvqMgr.Limits;var sizetodata=Qva.Resize.Frame.AvqMgr.SizeToData;var $element=$(Qva.Resize.Frame.AvqMgr.Element);var captionHeight=$(Qva.Resize.Frame.AvqMgr.Caption.Element).outerHeight();var scrollWidth=Qva.Resize.Frame.AvqMgr.ScrollWidth;var borderWidth=parseInt($element.css("border-left-width"))+parseInt($element.css("border-right-width"));var borderHeight=parseInt($element.css("border-top-width"))+parseInt($element.css("border-bottom-width"));Qva.Resize.minWidth=limits.min_width+borderWidth;Qva.Resize.minHeight=limits.min_height+borderHeight+captionHeight}};Qva.Resize.mouseMove=function(event){if(!Qva.Resize.SizeRect){return}if(Qva.Events.isTouchEvent(event)&&!Qva.Events.resizeActiveForTouch){return false}var deltaX=Qva.Events.getX(event)-Qva.Resize.StartX;var deltaY=Qva.Events.getY(event)-Qva.Resize.StartY;var minWidth=Qva.Resize.minWidth;var minHeight=Qva.Resize.minHeight;var maxWidth=Qva.Resize.maxWidth;var maxHeight=Qva.Resize.maxHeight;if(Qva.Resize.ResizeType.indexOf("t")!=-1){if(deltaY>=0){var maxY=Qva.Resize.StartY+Qva.Resize.StartH-minHeight;Qva.Resize.SizeRect.Y=Math.min(maxY,Qva.Resize.StartTop+deltaY);Qva.Resize.SizeRect.H=Math.max(minHeight,Qva.Resize.StartH-deltaY)}else{var minY=Math.max(0,Qva.Resize.StartTop+Qva.Resize.StartH-maxHeight);Qva.Resize.SizeRect.Y=Math.max(minY,Qva.Resize.StartTop+deltaY);Qva.Resize.SizeRect.H=Math.min(Qva.Resize.StartH-deltaY,Qva.Resize.StartTop-minY+Qva.Resize.StartH)}}if(Qva.Resize.ResizeType.indexOf("b")!=-1){if(deltaY>=0){Qva.Resize.SizeRect.H=Math.min(Qva.Resize.StartH+deltaY,maxHeight)}else{Qva.Resize.SizeRect.H=Math.max(Qva.Resize.StartH+deltaY,minHeight)}}if(Qva.Resize.ResizeType.indexOf("l")!=-1){if(deltaX>=0){var maxX=Qva.Resize.StartX+Qva.Resize.StartW-minWidth;Qva.Resize.SizeRect.X=Math.min(maxX,Qva.Resize.StartLeft+deltaX);Qva.Resize.SizeRect.W=Math.max(minWidth,Qva.Resize.StartW-deltaX)}else{var minX=Math.max(0,Qva.Resize.StartLeft+Qva.Resize.StartW-maxWidth);Qva.Resize.SizeRect.X=Math.max(minX,Qva.Resize.StartLeft+deltaX);Qva.Resize.SizeRect.W=Math.min(Qva.Resize.StartW-deltaX,Qva.Resize.StartLeft-minX+Qva.Resize.StartW)}}if(Qva.Resize.ResizeType.indexOf("r")!=-1){if(deltaX>=0){Qva.Resize.SizeRect.W=Math.min(Qva.Resize.StartW+deltaX,maxWidth)}else{Qva.Resize.SizeRect.W=Math.max(Qva.Resize.StartW+deltaX,minWidth)}}if(Qva.Resize.SizeRect.Y){Qva.Resize.SizeRect.style.top=Qva.Resize.SizeRect.Y+"px"}if(Qva.Resize.SizeRect.X){Qva.Resize.SizeRect.style.left=Qva.Resize.SizeRect.X+"px"}if(Qva.Resize.SizeRect.W){Qva.Resize.SizeRect.style.width=Qva.Resize.SizeRect.W+"px"}if(Qva.Resize.SizeRect.H){Qva.Resize.SizeRect.style.height=Qva.Resize.SizeRect.H+"px"}};Qva.Resize.mouseUp=function(event){if(Qva.Events.isTouchEvent(event)&&!Qva.Events.resizeActiveForTouch){return false}if(!Qva.Resize.Frame){return}var style=Qva.Resize.ResizeType;var width=(Qva.Resize.SizeRect.W?Qva.Resize.SizeRect.W:Qva.Resize.StartW);var height=(Qva.Resize.SizeRect.H?Qva.Resize.SizeRect.H:Qva.Resize.StartH);if(Qva.Resize.ResizeType.indexOf("l")!=-1){width+=Qva.Resize.sizeToDataOffsetWidth}if(Qva.Resize.ResizeType.indexOf("t")!=-1){height+=Qva.Resize.sizeToDataOffsetHeight}var binder,name;if(Qva.Resize.Frame.AvqMgr){binder=Qva.Resize.Frame.AvqMgr;name=Qva.Resize.Frame.ObjectId}else{binder=Qva.GetBinder(Qva.Resize.Frame.binderid);name=Qva.Resize.Frame.Name}binder.Set(name,"resize",style+":"+width+":"+height+":"+Qva.Resize.sizeToDataOffsetWidth+":"+Qva.Resize.sizeToDataOffsetHeight,true)};Qva.Resize.cleanUp=function(event){if(Qva.Resize.SizeRect){Qva.Resize.SizeRect.style.display="none"}Qva.Resize.Frame=null};Qva.DragDrop.resizeColumn={colIndex:null,oldCursor:null,resizeRect:null,startDragX:0,widthOuter:0,avqMgr:null,mouseDown:function(event){if(Qva.Events.isTouchEvent(event)){return false}var target=Qva.Events.getTarget(event);var frameCoords=Qva.GetAbsolutePageCoords(target.parentNode);var resizeColumn=Qva.DragDrop.resizeColumn;resizeColumn.colIndex=target.columnData.colIndex;resizeColumn.startDragX=Qva.Events.getX(event);resizeColumn.widthOuter=target.columnData.widthOuter;resizeColumn.avqMgr=Qva.GetObjectBinder(target);if(resizeColumn.resizeRect===null){resizeColumn.resizeRect=document.createElement("div");resizeColumn.resizeRect.className="QvSizeRect";resizeColumn.resizeRect.style.display="";document.body.insertBefore(resizeColumn.resizeRect,document.body.firstChild)}else{resizeColumn.resizeRect.style.visibility="visible"}var columnLeftCoordinate=frameCoords.x+target.columnData.outerLeftCoordinate;var columnRightCoordinate=columnLeftCoordinate+target.columnData.widthOuter;var rectLeft=Math.max(frameCoords.x,columnLeftCoordinate);var rectWidth=columnRightCoordinate-rectLeft;resizeColumn.resizeRect.style.left=rectLeft+"px";resizeColumn.resizeRect.style.top=target.columnData.top+"px";resizeColumn.resizeRect.style.height=target.columnData.height+"px";resizeColumn.resizeRect.style.width=rectWidth+"px";resizeColumn.resizeRect.startWidth=rectWidth;resizeColumn.resizeRect.delta=0},mouseMove:function(event){if(!Qva.DragDrop.resizeColumn.resizeRect){return}Qva.DragDrop.resizeColumn.resizeRect.delta=Qva.Events.getX(event)-Qva.DragDrop.resizeColumn.startDragX;var width=Math.max(10,Qva.DragDrop.resizeColumn.resizeRect.startWidth+Qva.DragDrop.resizeColumn.resizeRect.delta);Qva.DragDrop.resizeColumn.resizeRect.style.width=width+"px"},mouseUp:function(event){var objColRes=Qva.DragDrop.resizeColumn;if(typeof(objColRes.resizeRect.delta)!=="undefined"&&objColRes.resizeRect.delta!==0){var newWidth=Math.max(10,objColRes.widthOuter+objColRes.resizeRect.delta),mgr=objColRes.avqMgr;mgr.SetColumnWidth(objColRes.colIndex,newWidth)}Qva.DragDrop.resizeColumn.cleanup()},cleanup:function(){var objColRes=Qva.DragDrop.resizeColumn;objColRes.resizeRect.style.visibility="hidden";objColRes.avqMgr=null;document.body.style.cursor=objColRes.oldCursor}};Qva.DragDrop.reorder={source:{x:null,y:null,Orientation:""},target:{x:null,y:null,Orientation:""},displayRect:null,PosMarker:null,oldCursor:null,startDragX:0,startDragY:0,startDragHeaderLeft:0,startDragHeaderTop:0,frame:null,lstZoneCoords:null,ColumnWidth:0,RowHeight:0,mouseDown:function(event,colMap,dropZones){var target=Qva.Events.getTarget(event),index,length,frameCoords,rectLeft,rectWidth,scrollbarHeight;while(target.parentNode.xx===undefined){target=target.parentNode}if(Qva.Events.isTouchEvent(event)&&!Qva.Events.moveColumnsActiveForTouch){return false}this.frame=target.parentNode.parentNode.parentNode.parentNode;frameCoords=Qva.GetAbsolutePageCoords(this.frame);this.oldCursor=document.body.style.cursor;this.source.x=target.parentNode.xx;this.source.y=target.parentNode.yy;this.target.x=this.source.x;this.target.y=this.source.y;var path=$(target).getPath();this.ColumnWidth=parseInt(Qva.ElementAttributesHandler(path,target,"offsetWidth"));this.RowHeight=parseInt(Qva.ElementAttributesHandler(path,target,"offsetHeight"));for(var i=0;i<dropZones.length;i++){var zone=dropZones[i];if(zone.orientation=="horizontal"){if(this.target.y!=parseInt(zone.y)){continue}if(this.target.x<parseInt(zone.x)){continue}}else{if(this.target.x!=parseInt(zone.x)){continue}if(this.target.y<parseInt(zone.y)){continue}}this.source.Orientation=zone.orientation;break}if(this.source.Orientation==""){Assert(false);return}this.target.Orientation=this.source.Orientation;var elemPos=Qva.GetAbsolutePageCoords(target);this.startDragX=Qva.Events.getX(event);this.startDragY=Qva.Events.getY(event);this.startDragHeaderLeft=elemPos.x;this.startDragHeaderTop=elemPos.y;if(this.displayRect===null){this.displayRect=document.createElement("div");this.displayRect.className="QvReorderTable";document.body.insertBefore(this.displayRect,document.body.firstChild)}this.displayRect.style.visibility="hidden";this.displayRect.style.left=elemPos.x+"px";this.displayRect.style.top=elemPos.y+"px";if(this.target.Orientation=="vertical"){this.displayRect.style.height=this.frame.style.height;this.displayRect.style.width=this.ColumnWidth+"px"}else{this.displayRect.style.height=this.RowHeight+"px";this.displayRect.style.width=parseInt(this.frame.style.width)-target.parentNode.offsetLeft+"px"}this.displayRect.delta=0;if(this.PosMarker===null){this.PosMarker=document.createElement("div")}this.PosMarker.style.visibility="hidden";this.PosMarker.style.top=this.displayRect.style.top;this.PosMarker.style.left=this.displayRect.style.left;if(this.target.Orientation=="vertical"){this.PosMarker.className="QvReorderColumnPos";this.PosMarker.style.height=this.displayRect.style.height;this.PosMarker.style.width=""}else{this.PosMarker.className="QvReorderRowPos";this.PosMarker.style.height="";this.PosMarker.style.width=this.displayRect.style.width}document.body.insertBefore(this.PosMarker,document.body.firstChild);this.lstZoneCoords=[];for(index=0;index<dropZones.length;++index){var zone=dropZones[index];if(!colMap[zone.x]){continue}var colwidth=colMap[zone.x].width;var left=colMap[zone.x].xPos+frameCoords.x;var top=zone.y*this.RowHeight+frameCoords.y;if(zone.orientation=="vertical"){var right=left+colwidth;var middle=left+colwidth*colMap[zone.x].middle;var bottom}else{var bottom=top+this.RowHeight;var middle=top+(bottom-top)/2;var right}this.lstZoneCoords.push({leftCoord:left,rightCoord:right,middleCoord:middle,topCoord:top,bottomCoord:bottom,orientation:zone.orientation,x:zone.x,y:zone.y})}},mouseMove:function(event){var objCol=Qva.DragDrop.reorder;if(!objCol.displayRect||objCol.displayRect===null){return}var mouseX=Qva.Events.getX(event),mouseY=Qva.Events.getY(event),index,length,frameLeft=Qva.GetAbsolutePageCoords(objCol.frame).x,frameRight=frameLeft+objCol.frame.offsetWidth,frameTop=Qva.GetAbsolutePageCoords(objCol.frame).y,frameBottom=frameTop+objCol.frame.offsetHeight;if(Math.abs(objCol.startDragX-mouseX)<2&&Math.abs(objCol.startDragY-mouseY)<2){return}event.stopPropagation();if(mouseX>=frameLeft&&mouseX<=frameRight&&mouseY>=frameTop&&mouseY<=frameBottom){for(index=0,length=objCol.lstZoneCoords.length;index<length;index++){var target={x:objCol.lstZoneCoords[index].x,y:objCol.lstZoneCoords[index].y};var zone=objCol.lstZoneCoords[index];if(mouseX>=zone.leftCoord&&mouseY>=zone.topCoord){if(zone.orientation=="vertical"&&mouseX<=zone.rightCoord){objCol.displayRect.style.left=objCol.startDragHeaderLeft+event.clientX+Qva.GetScrollLeft()-objCol.startDragX+"px";objCol.PosMarker.className="QvReorderColumnPos";if(mouseX>=zone.middleCoord){objCol.PosMarker.style.left=zone.rightCoord+"px";target.x++}else{objCol.PosMarker.style.left=zone.leftCoord+"px"}objCol.displayRect.style.top=zone.topCoord+"px";objCol.displayRect.style.height=objCol.frame.style.height;objCol.displayRect.style.width=objCol.ColumnWidth+"px";objCol.PosMarker.style.height=objCol.displayRect.style.height;objCol.PosMarker.style.top=objCol.displayRect.style.top;objCol.PosMarker.style.width=""}else{if(zone.orientation=="horizontal"&&mouseY<=zone.bottomCoord){objCol.displayRect.style.top=objCol.startDragHeaderTop+event.clientY+Qva.GetScrollTop()-objCol.startDragY+"px";objCol.PosMarker.className="QvReorderRowPos";if(mouseY>=zone.middleCoord){objCol.PosMarker.style.top=zone.bottomCoord+"px";target.y++}else{objCol.PosMarker.style.top=objCol.lstZoneCoords[index].topCoord+"px"}objCol.displayRect.style.left=zone.leftCoord+"px";objCol.displayRect.style.height=objCol.RowHeight+"px";objCol.displayRect.style.width=frameLeft+parseInt(objCol.frame.style.width)-zone.leftCoord+"px";objCol.PosMarker.style.width=objCol.displayRect.style.width;objCol.PosMarker.style.left=objCol.displayRect.style.left;objCol.PosMarker.style.height=""}else{continue}}objCol.target.x=target.x;objCol.target.y=target.y;objCol.target.Orientation=zone.orientation;break}}objCol.displayRect.style.visibility="visible";objCol.PosMarker.style.visibility="visible";document.body.style.cursor="move"}},mouseUp:function(event){var objCol=Qva.DragDrop.reorder;objCol.displayRect.style.visibility="hidden";objCol.PosMarker.style.visibility="hidden";document.body.style.cursor=objCol.oldCursor;params={};params.reorder="";params.source=objCol.source.Orientation+":"+objCol.source.x+":"+objCol.source.y;params.target=objCol.target.Orientation+":"+objCol.target.x+":"+objCol.target.y;if(params.source!=params.target){var mgr=objCol.frame.parentNode.Mgr;mgr.PageBinder.Set(mgr.Name,params)}}};Qva.Events={eventsCancelled:false,eventsCancelledBy:undefined,eventStopped:[],clickThreshold:800,longPressThreshold:1600,clearThreshold:2600,clearStopThreshold:500,resizeActiveForTouch:false,moveActiveForTouch:false,moveColumnsActiveForTouch:false,resizeColumnsActiveForTouch:false,loggingActive:false,clickActive:true,longpressActive:true,contextmenuActive:true,touchscrollActive:true,dragActive:true,dragselectActive:true,longpressQueue:{},getOriginalEvent:function(event){return event.originalEvent?event.originalEvent:event},isPointerSupported:function(){if(window.PointerEvent){if(window.navigator.PointerEnabled==false){return false}if(window.navigator.msPointerEnabled==false){return false}return true}return false},getMoveEvent:function(event){if(event.type.indexOf("pointer")>-1){return"pointermove"}else{if(event.type.indexOf("mouse")>-1){return"mousemove"}else{if(event.type.indexOf("touch")>-1){return"touchmove"}else{if(event.type.indexOf("MSPointer")>-1){return"MSPointerMove"}}}}},getEndEvent:function(event){if(event.type.indexOf("pointer")>-1){return"pointerup"}else{if(event.type.indexOf("mouse")>-1){return"mouseup"}else{if(event.type.indexOf("touch")>-1){return"touchend"}else{if(event.type.indexOf("MSPointer")>-1){return"MSPointerUp"}}}}},getStartEvents:function(ns,config){if(ns==undefined){ns=""}if(config==undefined){config={}}var events=[];var returnString="";if(Qva.userAgentDetector.get("webview")){events.unshift("mousedown")}else{if(Qva.Events.isPointerSupported()){events.unshift("pointerdown")}else{if(window.navigator.msPointerEnabled){events.unshift("MSPointerDown")}else{var iosTouch=Qva.userAgentDetector.get("ipad")||Qva.userAgentDetector.get("iphone");if("onmousedown" in document.documentElement&&!iosTouch&&!config.nomouse){events.unshift("mousedown")}if("ontouchstart" in document.documentElement&&!config.notouch){events.unshift("touchstart")}}}}for(var i=0;i<events.length;i++){returnString+=events[i]+ns+" "}if(Qva.Events.loggingActive){console.log("getStartEvents="+returnString)}return returnString},getEndEvents:function(ns){if(ns==undefined){ns=""}var events=[];var returnString="";if(Qva.userAgentDetector.get("webview")){events.unshift("mouseup")}else{if(Qva.Events.isPointerSupported()){events.unshift("pointerup")}else{if(window.navigator.msPointerEnabled){events.unshift("MSPointerUp")}else{var iosTouch=Qva.userAgentDetector.get("ipad")||Qva.userAgentDetector.get("iphone");if("onmouseup" in document.documentElement&&!iosTouch){events.unshift("mouseup")}if("ontouchend" in document.documentElement){events.unshift("touchend")}}}}for(var i=0;i<events.length;i++){returnString+=events[i]+ns+" "}if(Qva.Events.loggingActive){console.log("getEndEvents="+returnString)}return returnString},getOverEvent:function(){if(Qva.userAgentDetector.get("webview")){return"mouseover"}else{if(Qva.Events.isPointerSupported()){return"pointerover"}else{if(window.navigator.msPointerEnabled){return"MSPointerOver"}else{if("onmouseover" in document.documentElement){return"mouseover"}else{return false}}}}},getOutEvent:function(event){if(event.type.indexOf("pointer")>-1){return"pointerout"}else{if(event.type.indexOf("MSPointer")>-1){return"MSPointerOut"}else{if(event.type.indexOf("mouse")>-1){return"mouseout"}else{return false}}}},getScrollWheelEvents:function(ns){if(ns==undefined){ns=""}var events="mousewheel"+ns;events+=" DOMMouseScroll"+ns;return events},getX:function(event){if(event.pageX){return event.pageX}if(event.changedTouches){return event.changedTouches[0].pageX}return event.clientX+Qva.GetScrollLeft()},getY:function(event){if(event.pageY){return event.pageY}if(event.changedTouches){return event.changedTouches[0].pageY}return event.clientY+Qva.GetScrollTop()},getOffsetX:function(e){if(e.offsetX){return e.offsetX}if(e.changedTouches&&e.changedTouches[0]){return e.changedTouches[0].pageX-$(e.changedTouches[0].target).offset().left}if(e.pageX){return e.pageX-$(e.target).offset().left}},getOffsetY:function(e){if(e.offsetY){return e.offsetY}if(e.changedTouches&&e.changedTouches[0]){return e.changedTouches[0].pageY-$(e.changedTouches[0].target).offset().top}if(e.pageY){return e.pageY-$(e.target).offset().top}},getClientX:function(event){return Qva.Events.getX(event)-Qva.GetScrollLeft()},getClientY:function(event){return Qva.Events.getY(event)-Qva.GetScrollTop()},getTarget:function(event){return event.changedTouches?event.changedTouches[0].target:event.target},getIdentifier:function(event){if(event.pointerId!=undefined){return event.pointerId}if(event.identifier!=undefined){return event.identifier}return event.changedTouches?event.changedTouches[0].identifier:"i"},getTouch:function(event,identifier){if(identifier==null){return null}if(event.changedTouches){for(var i=0;i<event.changedTouches.length;++i){if(Qva.Events.getIdentifier(event.changedTouches[i])==identifier){return event.changedTouches[i]}}}else{if(Qva.Events.getIdentifier(event)==identifier){return event}}return null},Flags:{Click:"Click",LongPress:"LongPress",Menu:"Menu"},setClickElem:function(element,value){if(Qva.Events.loggingActive){console.log("setClickElem="+value)}element[Qva.Events.Flags.Click]=value},getClickElem:function(container,e){var target=Qva.Events.getTarget(e),found=false;for(;target!=container&&!found;target=target.parentNode){if(target[Qva.Events.Flags.Click]){found=true;break}}return found?target:false},getClickElemForPoint:function(container,x,y){var target,found=false,elems=[],values=[];do{target=document.elementFromPoint(x,y);if(target!=null){if(target[Qva.Events.Flags.Click]){found=true;break}else{elems.push(target);values.push(target.style.display);target.style.display="none"}}else{break}}while(target!=container&&!found&&target!=null);for(var i=0;i<elems.length;i++){elems[i].style.display=values[i]}return found?target:false},isClickValid:function(endevent,x0,y0){var x=Qva.Events.getX(endevent),y=Qva.Events.getY(endevent);return Qva.Events.isClickValidExt(x0,y0,x,y)},isClickValidExt:function(x0,y0,x,y){var clicklimit=10;var xdist=Math.abs(x-x0);var ydist=Math.abs(y-y0);if(Qva.Events.loggingActive){console.log("isClickValid xdist="+xdist+", ydist="+ydist)}return xdist<clicklimit&&ydist<clicklimit},StopPropagation:function(ns,elem){if(ns==undefined){ns=""}if(Qva.Events.eventStopped[ns]){return}Qva.Events.eventStopped[ns]=elem;if(Qva.Events.loggingActive){console.log("Stopping event "+ns+" value="+Qva.Events.eventStopped[ns])}var clear=function(){if(Qva.Events.loggingActive){console.log("StopPropagation cleared for "+ns)}Qva.Events.eventStopped[ns]=false};setTimeout(clear,Qva.Events.clearStopThreshold)},isEventStopped:function(ns,elem){var stopped=Qva.Events.eventStopped[ns]&&Qva.Events.eventStopped[ns]!=elem&&$.contains(elem,Qva.Events.eventStopped[ns]);if(Qva.Events.loggingActive){console.log("isEventStopped="+stopped+", ns="+ns)}return stopped},isSingelTouch:function(event){var e=Qva.Events.getOriginalEvent(event);var singeltouch=true;if(e.touches&&e.changedTouches&&e.touches.length>1){singeltouch=false}if(e.isPrimary===false){singeltouch=false}if(Qva.Events.loggingActive){console.log("singel touch="+singeltouch)}if(Qva.Events.loggingActive){console.log(e)}return singeltouch},isDoubleTouch:function(event){var e=Qva.Events.getOriginalEvent(event);if(e.touches&&e.touches.length==2){return true}return false},isLeftClick:function(event){return(event.which==1)},isRightClick:function(event){return(event.which==3)},isMouseEvent:function(event){var e=Qva.Events.getOriginalEvent(event);if(e.type.indexOf("mouse")>-1){return true}return e.pointerType==="mouse"||e.pointerType===4},isTouchEvent:function(event){if(Qva.Debug.SimulateTouchDevice){return true}var e=Qva.Events.getOriginalEvent(event);if(e.type.indexOf("touch")>-1){return true}return e.pointerType==="touch"||e.pointerType===2},isPenEvent:function(event){var e=Qva.Events.getOriginalEvent(event);return e.pointerType==="pen"||e.pointerType===3},isPointerEvent:function(event){var e=Qva.Events.getOriginalEvent(event);return e.pointerType!=undefined},isEventAlreadyAttached:function(selector,eventType){var ret=false;if($(selector).data(eventType)){ret=true}$(selector).data(eventType,true);return ret},isBinderBusy:function(){var ret=false;for(var id in Qva.binders){if(Qva.binders[id].IsUpdating){ret=true}}if(Qva.Events.loggingActive){console.log("isBinderBusy = "+ret)}return ret},RemoveAllQueuedLongpressEvents:function(ns){if(Qva.Events.loggingActive){console.log("RemoveAllQueuedLongpressEvents called by "+ns)}Qva.Events.longpressQueue={}},QueueLongpressEvent:function(ns){if(Qva.Events.loggingActive){console.log("QueueLongpressEvent called by "+ns)}Qva.Events.longpressQueue[ns]=true},RemoveQueuedLongpressEvent:function(ns){if(Qva.Events.loggingActive){console.log("RemoveQueuedLongpressEvent called by "+ns)}delete Qva.Events.longpressQueue[ns]},isLongpressEventStillQueued:function(ns){var ret=Qva.Events.longpressQueue[ns];if(Qva.Events.loggingActive){console.log("isLongpressEventStillQueued called by "+ns+" return "+ret)}return ret},SetTouchAction:function(elem,xscroll,yscroll){var ta=xscroll||yscroll?"none":"";$(elem).css({"touch-action":ta});$(elem).data("touchscroll",xscroll||yscroll)},ExecuteIfNotMoved:function(event,ns,threshold,fn){if(Qva.Events.loggingActive){console.log("ExecuteIfNotMoved started for "+ns)}if(Qva.Events.loggingActive){console.log(event.originalEvent)}var x0=Qva.Events.getX(event.originalEvent),y0=Qva.Events.getY(event.originalEvent),t0=new Date(),scroll_x0=Qva.GetScrollTop(),scroll_y0=Qva.GetScrollLeft(),timeout=0,moved=false,ended=false,invalid=false,moveEvent=Qva.Events.getMoveEvent(event)+ns+"_ExecuteIfNotMoved",endEvent=Qva.Events.getEndEvent(event)+ns+"_ExecuteIfNotMoved",scrollEvent="scroll"+ns+"_ExecuteIfNotMoved",cleanup=function(){if(timeout){clearTimeout(timeout)}$(document).off(moveEvent);$(document).off(endEvent);$(document).off(scrollEvent);Qva.Events.RemoveQueuedLongpressEvent(ns)};cleanup();Qva.Events.QueueLongpressEvent(ns);if(Qva.Events.loggingActive){console.log(ns+" defining end="+endEvent)}$(document).one(endEvent,function(event){if(Qva.Events.loggingActive){console.log(ns+" running end")}$(document).off(moveEvent);ended=true});$(document).on(moveEvent,function(event){if(Qva.Events.loggingActive){console.log(ns+" running move")}if(!invalid){if(Qva.Events.isSingelTouch(event)){if(!Qva.Events.isClickValid(event.originalEvent,x0,y0)){moved=true}}else{invalid=true}}if(invalid||moved){cleanup()}});$(document).on(scrollEvent,function(event){if(!invalid&&!moved){var x=Qva.GetScrollTop(),y=Qva.GetScrollLeft();if(!Qva.Events.isClickValidExt(x0,y0,x,y)){moved=true}}if(invalid||moved){cleanup()}});if(Qva.Events.loggingActive){console.log(event)}var toExecute=function(){var eventStillQueued=Qva.Events.isLongpressEventStillQueued(ns);if(Qva.Events.loggingActive){console.log(ns+" toExecute started")}if(Qva.Events.loggingActive){console.log(ns+" moved:"+moved)}if(Qva.Events.loggingActive){console.log(ns+" ended:"+ended)}if(Qva.Events.loggingActive){console.log(ns+" invalid:"+invalid)}if(Qva.Events.loggingActive){console.log(ns+" eventStillQueued:"+eventStillQueued)}if(!moved&&!ended&&!invalid&&eventStillQueued){if(Qva.Events.loggingActive){console.log(ns+" executed, not moved:"+threshold)}if(!Qva.Events.isBinderBusy()){fn()}}cleanup()},timeout=setTimeout(toExecute,threshold)},RemoveDragEvent:function(selector){$(selector).off(Qva.Events.getStartEvents(".drag"))},AddEvent:function(selector,type,fn){var action=function(event){if(Qva.Events.loggingActive){console.log("AddEvent="+event.type)}fn.apply(this,[event])};$(selector).on(type,action)},AddDragEvent:function(selector,start,move,end,config){if(!Qva.Events.dragActive){return}Qva.Events.SetTouchAction(selector,true,true);Qva.Events.CancelTouchScroll(selector);var ns=".drag";if(!config){config={}}if(config.xns){ns+=config.xns}var moving=false,started=false,$pendiv=$(Qva.GetPenHoverDiv());showPenCursor=function(elem){var pos,cursor=$(elem).css("cursor");cursor=cursor.replace("-resize","");switch(cursor){case"move":pos="0px 0px";break;case"e":case"w":pos="-24px 0px";break;case"n":case"s":pos="-48px 0px";break;case"sw":case"ne":pos="-72px 0px";break;case"nw":case"se":pos="-96px 0px";break}if(pos){$pendiv.css({display:"block",backgroundPosition:pos})}};hidePenCursor=function(){if($pendiv.css("display")==="block"){$pendiv.css("display","none")}};positionPenCursor=function(e){$pendiv.css({left:Qva.Events.getX(e)-25,top:Qva.Events.getY(e)-25})};Qva.Events.AddOverEvent(selector,function(event){if(!Qva.Events.isPenEvent(event)){return}showPenCursor(this);positionPenCursor(event)},function(event){if(!Qva.Events.isPenEvent(event)){return}if(!started&&!moving){hidePenCursor()}},{xns:".pencursor"});$(selector).on(Qva.Events.getStartEvents(ns),function(event){if(Qva.Events.isBinderBusy()){return}if(Qva.Events.loggingActive){console.log(ns+"="+event.type)}if(Qva.Events.loggingActive){console.log(selector)}if(Qva.Events.isMouseEvent(event)&&!Qva.Events.isLeftClick(event)){return}if(!Qva.Events.isSingelTouch(event)){return}if(Qva.Events.loggingActive){console.log(ns+" ok")}var x0=Qva.Events.getX(event.originalEvent),y0=Qva.Events.getY(event.originalEvent);var endEvent=Qva.Events.getEndEvent(event)+ns;var old_cursor=document.body.style.cursor;$(document).one(endEvent,function(event){if(Qva.Events.loggingActive){console.log(ns+" ended")}$(document).off(moveEvent);$(document).enableSelection();if(!Qva.Events.isPenEvent(event)){document.body.style.cursor=old_cursor}if(Qva.Events.isPenEvent(event)){hidePenCursor()}if(started&&moving){event.preventDefault();var endarg=config.arg?config.arg.slice(0):[];endarg.unshift(event.originalEvent);if(end){end.apply(config._this?config._this:this,endarg)}}started=false;moving=false;if(config.cleanFunc){config.cleanFunc()}});var moveEvent=Qva.Events.getMoveEvent(event)+ns;$(document).on(moveEvent,function(event){if(!started){started=!Qva.Events.isClickValid(event.originalEvent,x0,y0)}if(Qva.Events.loggingActive){console.log(ns+" started="+started)}if(started){if(moving&&Qva.Events.isSingelTouch(event)){if(Qva.Events.isPenEvent(event)){positionPenCursor(event)}if(Qva.Events.loggingActive){console.log(ns+" moving")}event.preventDefault();event.stopPropagation();var movearg=config.arg?config.arg.slice(0):[];movearg.unshift(event.originalEvent);move.apply(config._this?config._this:this,movearg)}else{moving=false}}});var downarg=config.arg?config.arg.slice(0):[];downarg.unshift(event.originalEvent);if(start.apply(config._this?config._this:this,downarg)===false){$(document).off(moveEvent);$(document).off(endEvent);return}moving=true;started=false;event.preventDefault();if(!Qva.Events.isPenEvent(event)){document.body.style.cursor=selector.style.cursor}})},CancelTouchScroll:function(selector){var ns=".touchscroll";$(selector).on(Qva.Events.getStartEvents(ns,{nomouse:true}),function(event){Qva.Events.StopPropagation(ns,selector)})},AddTouchScrollEvent:function(selector,start,move,end,config){if(!Qva.Events.touchscrollActive){return}var type=".touchscroll";var ns=type;if(!config){config={}}if(config.xns){ns+=config.xns}var endrun=true;$(selector).on(Qva.Events.getStartEvents(ns,{nomouse:true}),function(event){if(Qva.Events.isBinderBusy()){return}if(!$(this).data("touchscroll")){return}if(Qva.Events.loggingActive){console.log(ns+"="+event.type)}if(Qva.Events.loggingActive){console.log(this)}if(!Qva.Events.isTouchEvent(event)){return}if(!Qva.Events.isSingelTouch(event)){return}if(Qva.Events.isEventStopped(type,this)){return}if(Qva.Events.loggingActive){console.log(ns+" ok")}event.preventDefault();var that=this;var x0=Qva.Events.getX(event.originalEvent),y0=Qva.Events.getY(event.originalEvent);var moveEvent=Qva.Events.getMoveEvent(event)+ns;var endEvent=Qva.Events.getEndEvent(event)+ns;if(!endrun){if(Qva.Events.loggingActive){console.log(ns+" cleaning upp events")}$(that).off(moveEvent);$(that).off(endEvent)}endrun=false;$(that).one(endEvent,function(event){if(Qva.Events.loggingActive){console.log(ns+" ended")}$(that).off(moveEvent);if(started&&moving){event.preventDefault();var endarg=config.arg?config.arg.slice(0):[];endarg.unshift(event.originalEvent);end.apply(that,endarg)}endrun=true});$(that).on(moveEvent,function(event){if(!started){started=!Qva.Events.isClickValid(event.originalEvent,x0,y0)}if(Qva.Events.loggingActive){console.log(ns+" started="+started)}if(started){if(moving&&Qva.Events.isSingelTouch(event)){if(Qva.Events.loggingActive){console.log(ns+" moving")}event.preventDefault();var movearg=config.arg?config.arg.slice(0):[];movearg.unshift(event.originalEvent);move.apply(that,movearg)}else{moving=false}}});var downarg=config.arg?config.arg.slice(0):[];downarg.unshift(event.originalEvent);if(start.apply(this,downarg)===false){$(that).off(moveEvent);$(that).off(endEvent);return}var moving=true,started=false})},AddDragSelectEvent:function(selector,start,move,end,config){if(!Qva.Events.dragselectActive){return}var ns=".dragselect";if(!config){config={}}var alreadyStartedEvent=false;var dragStart=function(event){if(Qva.Events.isBinderBusy()){return}if(alreadyStartedEvent&&alreadyStartedEvent.type!=event.type){event.stopPropagation();return}alreadyStartedEvent=event;setTimeout(function(){alreadyStartedEvent=false},500);if(Qva.Events.loggingActive){console.log(ns+"="+event.type)}if(Qva.Events.isTouchEvent(event)){return}if(Qva.Events.isMouseEvent(event)&&!Qva.Events.isLeftClick(event)){return}if(Qva.Events.loggingActive){console.log(ns+" ok")}var downarg=[event.originalEvent];var x0=Qva.Events.getX(event.originalEvent),y0=Qva.Events.getY(event.originalEvent),started=false,moveEvent=Qva.Events.getMoveEvent(event)+ns,endEvent=Qva.Events.getEndEvent(event)+ns,that=this,dragSelectOut=false,intervalId=null,moveEventTarget=config.useDocumentForMoveEvent?document:that;$(moveEventTarget).on(moveEvent,function(event){dragSelectOut=false;if(!started){if(Qva.Events.loggingActive){console.log(ns+" started")}if(Qva.Events.loggingActive){console.log(that)}started=!Qva.Events.isClickValid(event.originalEvent,x0,y0)}if(started){if(Qva.Events.loggingActive){console.log(ns+" moving")}event.preventDefault();event.stopPropagation();var movearg=[event.originalEvent];move.apply(selector,movearg);if(config.fnInterval){if(intervalId==null){intervalId=window.setInterval(function(){if(dragSelectOut){config.fnInterval.apply()}},400)}}}});$(document).on(moveEvent,function(event){if(started&&config.fnMoveOutside){dragSelectOut=true;if(Qva.Events.loggingActive){console.log(ns+" moving outside")}event.preventDefault();config.fnMoveOutside.apply(selector,[event.originalEvent])}});if(Qva.Events.loggingActive){console.log(ns+" endevent defined")}$(document).one(endEvent,function(event){if(Qva.Events.loggingActive){console.log(ns+" ended")}$(moveEventTarget).off(moveEvent);$(document).off(moveEvent);dragSelectOut=false;if(intervalId!=null){window.clearInterval(intervalId);intervalId=null}if(!started){return}var endarg=[event.originalEvent];if(Qva.Events.loggingActive){console.log(ns+" executed")}if(Qva.Events.loggingActive){console.log(this)}end.apply(selector,endarg)});if(start.apply(config.useEventTarget?event.target:this,downarg)===false){$(moveEventTarget).off(moveEvent);$(document).off(moveEvent);$(document).off(endEvent);return}};$(selector).on(Qva.Events.getStartEvents(ns),dragStart)},AddClickEvent:function(selector,fn,config){if(!Qva.Events.clickActive){return}if(!config){config={}}if(config.preventDefault===undefined){config.preventDefault=false}var type=".clickevent";var ns=type;if(config.xns){ns+=config.xns}else{ns+="."+Qva.getRandomString(8)}var cleanup=function(that){if(config.endEffect){config.endEffect.apply(that)}};var alreadyStartedEvent=false,target;var clickStart=function(event){if(Qva.Events.isBinderBusy()){return}if(alreadyStartedEvent&&target===Qva.Events.getTarget(event)&&alreadyStartedEvent.type!=event.type){if(Qva.Events.loggingActive){console.log(ns+" already started, stopPropagation="+event.type)}event.stopPropagation();return}alreadyStartedEvent=event;target=Qva.Events.getTarget(event);setTimeout(function(){alreadyStartedEvent=false},500);if(Qva.Events.loggingActive){console.log(ns+"="+event.type)}if(Qva.Events.loggingActive){console.log(this)}if(Qva.Events.isMouseEvent(event)&&!Qva.Events.isLeftClick(event)){return}if(!Qva.Events.isSingelTouch(event)){return}if(Qva.Events.isEventStopped(type,this)){return}if(Qva.Events.loggingActive){console.log("nostop="+config.nostop)}if(!config.nostop){Qva.Events.StopPropagation(type,this)}if(Qva.Events.loggingActive){console.log(ns+" ok")}if(config.startEffect){config.startEffect.apply(this)}if(config.stopPropagation){event.stopPropagation()}var started=true,that=this;var newarg=config.arg?config.arg.slice(0):[];newarg.unshift(event.originalEvent);var x0=Qva.Events.getX(event.originalEvent),y0=Qva.Events.getY(event.originalEvent),t0=new Date();if(config.preventDefault){event.preventDefault()}if(Qva.Events.loggingActive){console.log(ns+" preventDefault="+config.preventDefault)}$(document).one(Qva.Events.getEndEvent(event)+ns,function(e){if(Qva.Events.loggingActive){console.log(ns+" ending")}var t1=new Date();if((t1-t0<Qva.Events.clickThreshold||(config.longpressOk&&!Qva.Events.isTouchEvent(event)))&&Qva.Events.isClickValid(e.originalEvent,x0,y0)){if(Qva.Events.loggingActive){console.log(ns+" executed")}if(Qva.Events.loggingActive){console.log(this)}fn.apply(config.useEventTarget?Qva.Events.getTarget(event):(config.scope?config.scope:that),newarg)}if(started){cleanup(that)}})};var startEvents=Qva.Events.getStartEvents(ns);if(Qva.Events.loggingActive){console.log("defing start event for "+ns)}$(selector).on(startEvents,clickStart)},RemoveClickEvent:function(selector,xns){var ns=".clickevent";if(xns){ns+=xns}$(selector).off(Qva.Events.getStartEvents(ns))},AddDblClickEvent:function(selector,fn){$(selector).on("dblclick",function(event){if(Qva.Events.isMouseEvent(event)&&!Qva.Events.isLeftClick(event)){return}if(!Qva.Events.isSingelTouch(event)){return}if(Qva.Events.loggingActive){console.log("AddDblClickEvent="+event.type)}fn.apply(selector,[event.originalEvent])})},AddContextmenu:function(selector,fn,arg){if(!Qva.Events.contextmenuActive){return}var type=".AddContextmenu";if(Qva.Events.isEventAlreadyAttached(selector,type)){return}var alreadyStarted=false,alreadyStartedEvent;$(selector).on("contextmenu touchstart",function(event){if(Qva.Events.isBinderBusy()){return}var ns=type+"_"+Qva.getRandomString(8);if(Qva.Events.loggingActive){console.log(ns+"="+event.type)}if(Qva.Events.loggingActive){console.log(selector)}if(Qva.Events.loggingActive){console.log("alreadyStarted="+alreadyStarted)}if(alreadyStarted&&alreadyStartedEvent===event.type){alreadyStarted=false}if(Qva.Events.loggingActive){console.log("alreadyStarted2="+alreadyStarted)}if(alreadyStarted){if(event.type==="contextmenu"){event.stopPropagation();event.preventDefault();return false}}alreadyStarted=true;alreadyStartedEvent=event.type;var alreadyStartedTimeout=("ontouchstart" in document.documentElement)?Qva.Events.longPressThreshold+100:0;setTimeout(function(){alreadyStarted=false},alreadyStartedTimeout);if(event.shiftKey&&ctrlKeyPressed(event)){return true}var newarg=arg?arg.slice(0):[];newarg.unshift(event.originalEvent);if(event.type==="contextmenu"){event.stopPropagation();event.preventDefault();if(Qva.Events.loggingActive){console.log(ns+" executed")}fn.apply(selector,newarg)}else{type=".Longpress";if(!Qva.Events.isSingelTouch(event)){return}if(Qva.Events.isEventStopped(type,this)){return}Qva.Events.StopPropagation(type,this);if(Qva.Events.loggingActive){console.log(ns+" ok")}if(Qva.Events.loggingActive){console.log(this)}Qva.Events.ExecuteIfNotMoved(event,ns,Qva.Events.longPressThreshold,function(){if(Qva.Events.loggingActive){console.log(ns+" executed")}fn.apply(selector,newarg)})}})},AddLongPressEvent:function(selector,fn,config){if(!Qva.Events.longpressActive){return}var type=".Longpress";if(!config){config={}}var stopContextmenu;$(selector).on("contextmenu",function(event){if(stopContextmenu){event.preventDefault();event.stopPropagation();return false}});$(selector).on(Qva.Events.getStartEvents(type,{nomouse:true}),function(event){stopContextmenu=false;if(Qva.Events.isBinderBusy()){return}var ns=type+"_"+Qva.getRandomString(8);if(Qva.Events.loggingActive){console.log(ns+"="+event.type)}var newarg=config.arg?config.arg.slice(0):[];newarg.unshift(event.originalEvent);if(!Qva.Events.isTouchEvent(event)){return}if(!Qva.Events.isSingelTouch(event)){return}if(Qva.Events.isEventStopped(type,this)){return}var valid=true;if(config.fnValidation){valid=config.fnValidation.apply(this,[event]);if(Qva.Events.loggingActive){console.log(ns+" valid")}}if(valid){Qva.Events.StopPropagation(type,this);if(Qva.Events.loggingActive){console.log(selector)}Qva.Events.ExecuteIfNotMoved(event,ns,Qva.Events.longPressThreshold,function(){if(Qva.Events.loggingActive){console.log(ns+" executed")}var res=fn.apply(selector,newarg);if(res!=false){stopContextmenu=true}})}})},AddOverEvent:function(selector,fnOver,fnOut,config){var type=".overevent";var ns=type;if(!config){config={}}if(config.xns){ns+=config.xns}var overEvent=Qva.Events.getOverEvent()+ns;$(selector).on(overEvent,function(event){if(Qva.userAgentDetector.get("touchEnabled")&&!Qva.Events.isPointerEvent(event)){return}if(Qva.Events.isPointerEvent(event)&&Qva.Events.isTouchEvent(event)){return}if(Qva.Events.loggingActive){console.log("AddOverEvent="+event.type)}var outEvent=Qva.Events.getOutEvent(event);if(outEvent){outEvent+=ns;var moveEvent=Qva.Events.getMoveEvent(event)+ns;var that=this;$(that).off(outEvent);$(that).off(moveEvent);$(that).on(moveEvent,function(event){if(Qva.Events.loggingActive){console.log("AddOverEvent: move")}fnOver.apply(that,[Qva.Events.getOriginalEvent(event)])});$(that).one(outEvent,function(event){if(Qva.Events.loggingActive){console.log("AddOverEvent: out")}$(that).off(moveEvent);fnOut.apply(that,[Qva.Events.getOriginalEvent(event)])});if(Qva.Events.loggingActive){console.log("AddOverEvent: over")}fnOver.apply(that,[Qva.Events.getOriginalEvent(event)])}})},AddChangeEvent:function(selector,fn){Qva.Events.CancelTouchScroll(selector);$(selector).on("change",fn)},AddEmptyTextEvent:function(selector){$(selector).on("focus",function(){Qva.ActiveObjectsCloak=true;var emptyText=$(this).attr("data-emptyText");if(!emptyText){return}if(!$(this).hasClass("EmptyText")){return}$(this).val("");$(this).removeClass("EmptyText")}).on("blur",function(){if(this===Qva.ActiveElement){Qva.ActiveElement=null}var emptyText=$(this).attr("data-emptyText");if(!emptyText){return}if($(this).val()){return}if($(this).hasClass("EmptyText")){return}$(this).addClass("EmptyText");$(this).val(emptyText)})},AddNoAction:function(selector){$(selector).on("drag",false);$(selector).on("mousedown mouseup click",Qva.NoAction)},AddCancelAction:function(selector){$(selector).on("click",Qva.CancelAction)},AddCancelBubble:function(selector,ns){$(selector).on(Qva.Events.getStartEvents(ns),function(e){e.stopPropagation()})},AddScrollWheelEvent:function(selector,fn,ns){$(selector).on(Qva.Events.getScrollWheelEvents(ns),function(event){if(Qva.Events.loggingActive){console.log("AddScrollWheelEvent="+event.type)}fn.apply(selector,[event.originalEvent]);event.stopPropagation();event.preventDefault()})},AddNoContextMenu:function(selector){$(selector).on("contextmenu",function(event){event.preventDefault();event.stopPropagation();return false})},AddRunOnceOnClickOutside:function(selector,fn){if(Qva.Events.loggingActive){console.log("AddRunOnceOnClickOutside created")}var ns="."+Qva.getRandomString(8),startEvents=Qva.Events.getStartEvents(ns);var cancelFn=function(){if(Qva.Events.loggingActive){console.log("RemoveRunOnceOnClickOutside")}$(selector).off(startEvents);$(document).off(startEvents)};$(selector).on(startEvents,function(e){e.originalEvent[ns]=true});$(document).on(startEvents,function(e){if(!e.originalEvent[ns]){if(Qva.Events.loggingActive){console.log("AddRunOnceOnClickOutside triggered")}fn.apply(selector,[e.originalEvent]);cancelFn()}});return cancelFn}};Qva.SimulateEvents={getCoordinates:function($element){var offset=$element.offset();return{x:offset.left+$element.outerWidth()/2,y:offset.top+$element.outerHeight()/2}},createEvent:function(type,page,target){var evt=jQuery.Event(type,{originalEvent:{type:type,pageX:page.x,pageY:page.y,screenX:page.x-Qva.GetScrollLeft(),screenY:page.y-Qva.GetScrollTop(),target:target,currentTarget:target},target:target,bubbles:true,cancelable:true,which:1});if(type.indexOf("pointer")>-1){evt.originalEvent.pointerType="mouse"}return evt},click:function(selector,container,iframe){if(iframe==undefined){var $element=(container==undefined)?$(selector):$(container).find(selector)}else{var $element=(container==undefined)?$("iframe").contents().find(selector):$("iframe").contents().find(container).find(selector)}var $triggerElement=(container==undefined)?$element:$(container);var coord=Qva.SimulateEvents.getCoordinates($element);if($element[0].onclick!=undefined){var clickEvent=Qva.SimulateEvents.createEvent("click",coord,$element[0]);$triggerElement.trigger(clickEvent)}else{var startEvent=Qva.SimulateEvents.createEvent(Qva.Events.getStartEvents("",{notouch:true}).replace(" ",""),coord,$element[0]);var endEvent=Qva.SimulateEvents.createEvent(Qva.Events.getEndEvent(startEvent),coord,$element[0]);setTimeout(function(){$triggerElement.trigger(endEvent)},Qva.Events.clickThreshold-100);$triggerElement.trigger(startEvent)}}}})($QvJq);var Graphics={VML:{CreateElement:function(type,parent){var elem=document.createElement("v:"+type);elem.unselectable="on";if(parent){parent.appendChild(elem)}return elem},CreateShape:function(path,coordsize,color,parent){var s=Graphics.VML.CreateElement("shape",parent);s.coordsize=coordsize;if(color){s.fillcolor=color}s.path=path;return s},CreateArea:function(size,parent){var area=Graphics.VML.CreateElement("group",parent);area.style.width=size[0]+"px";area.style.height=size[1]+"px";area.coordsize=size.join(",");area.style.position="absolute";return area},CreatePolygonObj:function(points,color,parent,pos,size){var path="m "+points[0][0]+","+points[0][1]+" l";for(var i=1;i<points.length;++i){path+=" "+points[i][0]+" "+points[i][1]}path+=" x e";var polygon=Graphics.VML.CreateShape(path,size.join(","),color,parent);polygon.style.width=size[0]+"px";polygon.style.height=size[1]+"px";polygon.style.position="absolute";polygon.style.left=pos[0]+"px";polygon.style.top=pos[1]+"px";return polygon},CreatePolygon:function(points,color,parent){return Graphics.VML.CreatePolygonObj(points,color,parent,[0,0],[parent.style.pixelWidth,parent.style.pixelHeight])},CreateLine:function(from,to,color,parent,width){var l=Graphics.VML.CreateElement("line",parent);l.from=from.join(",");l.to=to.join(",");if(color){l.strokecolor=color}if(width){l.strokeweight=width}else{l.strokeweight=1}return l},CreatePolyLine:function(points,color,parent,width){var l=Graphics.VML.CreateElement("polyline",parent);l.points=points.join(" ");if(color){l.strokecolor=color}var f=Graphics.VML.CreateElement("fill");f.on="false";l.appendChild(f);if(width){l.strokeweight=width}else{l.strokeweight=1}return l},CreateRect:function(pos,size,color,parent,border){var r=Graphics.VML.CreateElement("rect",parent);r.fillcolor=color;r.style.left=pos[0]+"px";r.style.top=pos[1]+"px";r.style.width=size[0]+"px";r.style.height=size[1]+"px";if(!border){Graphics.VML.CreateElement("stroke",r).on="false"}return r},FixPolygon:function(polygon,points,size,color){var path="m "+points[0][0]+","+points[0][1]+" l";for(var i=1;i<points.length;++i){path+=" "+points[i][0]+" "+points[i][1]}path+=" x e";polygon.path=path;polygon.coordsize=size.join(",");polygon.style.width=size[0]+"px";polygon.style.height=size[1]+"px"},Init:function(){if(Qva.userAgentDetector.get("msieDocMode")<10){if(Qva.userAgentDetector.get("msieDocMode")>=8){if(!document.namespaces.v){document.namespaces.add("v","urn:schemas-microsoft-com:vml","#default#VML")}}else{if(!document.namespaces.v){document.namespaces.add("v","urn:schemas-microsoft-com:vml")}}}if(!Graphics.VML.styleSheet){Graphics.VML.styleSheet=document.createStyleSheet();Graphics.VML.styleSheet.cssText="v\\:*{behavior:url(#default#VML);display: inline-block;}"}},styleSheet:null},Canvas:{CreateArea:function(size,parent){var area=document.createElement("canvas");area.style.width=size[0]+"px";area.style.height=size[1]+"px";area.width=size[0];area.height=size[1];if(parent){parent.appendChild(area)}return area},CreatePolygonObj:function(points,color,parent,pos,size){var area=Graphics.Canvas.CreateArea(size,parent);area.style.position="absolute";area.style.left=pos[0]+"px";area.style.top=pos[1]+"px";Graphics.Canvas.CreatePolygon(points,color,area);return area},CreatePolygon:function(points,color,parent){var ctx=parent.getContext("2d");ctx.fillStyle=color||"rgb(0,0,0)";ctx.beginPath();ctx.moveTo(points[0][0],points[0][1]);for(var i=1;i<points.length;++i){ctx.lineTo(points[i][0],points[i][1])}ctx.fill()},CreateLine:function(from,to,color,parent,width){var ctx=parent.getContext("2d");ctx.lineWidth=width||1;ctx.strokeStyle=color||"rgb(0,0,0)";ctx.beginPath();ctx.moveTo(from[0],from[1]);ctx.lineTo(to[0],to[1]);ctx.stroke()},CreatePolyLine:function(points,color,parent,width){if(points.length===0){return}var ctx=parent.getContext("2d");ctx.lineWidth=width||1;ctx.strokeStyle=color||"rgb(0,0,0)";ctx.beginPath();ctx.moveTo(points[0][0],points[0][1]);for(var i=1;i<points.length;++i){ctx.lineTo(points[i][0],points[i][1])}ctx.stroke()},CreateRect:function(pos,size,color,parent,border){var ctx=parent.getContext("2d");if(border){ctx.strokeStyle=border===true?"rgb(0,0,0)":border;ctx.strokeRect(pos[0],pos[1],size[0],size[1])}ctx.fillStyle=color;ctx.fillRect(pos[0],pos[1],size[0],size[1])},FixPolygon:function(polygon,points,size,color){polygon.style.width=size[0]+"px";polygon.style.height=size[1]+"px";polygon.width=size[0];polygon.height=size[1];var ctx=polygon.getContext("2d");ctx.clearRect(0,0,size[0],size[1]);Graphics.Canvas.CreatePolygon(points,color,polygon)},Init:function(){}},SVG:{CreateElement:function(type,parent){var SVG_namespace="http://www.w3.org/2000/svg";try{var elem=document.createElementNS(SVG_namespace,type)}catch(e){var elem=document.createElement(type);elem.setAttribute("xmlns",SVG_namespace)}if(parent){parent.appendChild(elem)}return elem},CreateArea:function(size,parent){var area=Graphics.SVG.CreateElement("svg",parent);area.setAttribute("width",size[0]+"px");area.setAttribute("height",size[1]+"px");area.style.width=size[0]+"px";area.style.height=size[1]+"px";return area},CreatePolygonObj:function(points,color,parent,pos,size){var area=Graphics.SVG.CreateArea(size,parent);area.style.position="absolute";area.style.left=pos[0]+"px";area.style.top=pos[1]+"px";Graphics.SVG.CreatePolygon(points,color,area);return area},CreatePolygon:function(points,color,parent){var polygon=Graphics.SVG.CreateElement("polygon",parent);polygon.setAttribute("points",points.join(","));polygon.setAttribute("fill",color||"black");return polygon},CreateLine:function(from,to,color,parent,width){var line=Graphics.SVG.CreateElement("line",parent);line.setAttribute("x1",from[0]+"px");line.setAttribute("y1",from[1]+"px");line.setAttribute("x2",to[0]+"px");line.setAttribute("y2",to[1]+"px");line.setAttribute("stroke",color||"black");line.setAttribute("strokeWidth",width);return line},CreatePolyLine:function(points,color,parent,width){var line=Graphics.SVG.CreateElement("polyline",parent);line.setAttribute("points",points.join(","));line.setAttribute("stroke",color||"black");line.setAttribute("strokeWidth",width);line.setAttribute("fill","none");return line},CreateRect:function(pos,size,color,parent,border){var rect=Graphics.SVG.CreateElement("rect",parent);rect.setAttribute("x",pos[0]+"px");rect.setAttribute("y",pos[1]+"px");rect.setAttribute("width",size[0]+"px");rect.setAttribute("height",size[1]+"px");rect.setAttribute("fill",color||"black");if(border){rect.setAttribute("stroke","black")}return rect},FixPolygon:function(){Assert(false)},Init:function(){}}};if(Qva.userAgentDetector.get("msie")&&Qva.userAgentDetector.get("msieDocMode")<10){var SelectGraphics=function(){return Graphics.VML}}else{var SelectGraphics=function(type){if(Graphics[type]&&type!=="VML"){return Graphics[type]}return Graphics.Canvas}}function SelectInitGraphics(type){var g=SelectGraphics(type);g.Init();return g}window.SelectInitGraphics=SelectInitGraphics;function MeasureText(text,fontSize){if(!MeasureText.div){MeasureText.div=document.createElement("div");MeasureText.div.style.position="absolute";MeasureText.div.style.width="auto";MeasureText.div.style.height="auto";MeasureText.div.style.visibility="hidden";document.body.insertBefore(MeasureText.div,document.body.firstChild)}MeasureText.div.style.fontSize=fontSize;MeasureText.div.innerText=text;return{width:MeasureText.div.offsetWidth,height:MeasureText.div.offsetHeight}}MeasureText.div=null;var ModalType={popup:0,messagebox:1};Qva.Modal=function(scriptPath){if(typeof scriptPath!=="string"){scriptPath=null}this.ScriptPath=scriptPath||Qva.QvAjaxZfcPath+"htc/";this.HideSelects=false;this.TabIndexes=[];this.PageBinders=[];this.PopupMasks=[];this.PopupCointainers=[];this.PopFrames=[];this.TitleBar=[];this.TabbableTags=["A","BUTTON","TEXTAREA","INPUT","IFRAME"];this.PopupIsShown=false;this.NumberOfShownWindows=0;this.Type=[];Qva.Modal.instance=this;$(window).on("resize",function(){if(Qva.Modal.instance.NumberOfShownWindows>0){Qva.Modal.instance.SetMaskSize.apply(Qva.Modal.instance)}})};Qva.Modal.prototype.ShowEx=function(pagebinder,url,width,height,type,nocaption,className){iFrameWidth=width;iFrameHeight=height;this.NumberOfShownWindows++;this.Type[this.NumberOfShownWindows]=type;this.PageBinders[this.NumberOfShownWindows]=pagebinder;if(this.PageBinders[this.NumberOfShownWindows].Session){url+=((url.indexOf("?")==-1)?"?":"&")+"session="+Qva.EncodeComponent(this.PageBinders[this.NumberOfShownWindows].Session)}if(this.PageBinders[this.NumberOfShownWindows].Ticket){url=Qva.FixUrl(url,"ticket",this.PageBinders[this.NumberOfShownWindows].Ticket)}if(this.PageBinders[this.NumberOfShownWindows].Host){url=Qva.FixUrl(url,"host",this.PageBinders[this.NumberOfShownWindows].Host)}if(this.PageBinders[this.NumberOfShownWindows].Unicorn){url=Qva.FixUrl(url,"unicorn","3")}if(this.PageBinders[this.NumberOfShownWindows].View!=""){url=Qva.FixUrl(url,"view",this.PageBinders[this.NumberOfShownWindows].View)}if(this.PageBinders[this.NumberOfShownWindows].Remote!=""){url=Qva.FixUrl(url,"remote",this.PageBinders[this.NumberOfShownWindows].Remote)}url=Qva.AddProxyIfAny(url);url=Qva.XrfSecure(url);this.Init(pagebinder,url);var closeBox=document.getElementById("popCloseBox"+this.NumberOfShownWindows);if(closeBox){closeBox.style.display="block"}this.PopupIsShown=true;this.DisableTabs();this.PopupMasks[this.NumberOfShownWindows].style.display="block";this.TitleBar[this.NumberOfShownWindows].style.display="";if(width&&height){this.SetSize(width,height)}if(Qva.Benchmark){this.Benchmark=new Qva.Benchmark()}this.TitleBar[this.NumberOfShownWindows].style.display=nocaption?"none":"";this.PopFrames[this.NumberOfShownWindows].className=className||"QvModal_Default";if(this.HideSelects==true){this.HideSelectBoxes()}};Qva.Modal.prototype.Show=function(pagebinder,url,width,height,nocaption,className){this.ShowEx(pagebinder,url,width,height,ModalType.popup,nocaption,className)};Qva.Modal.prototype.SetSize=function(width,height){var titleBarHeight=parseInt(document.getElementById("popupTitleBar"+this.NumberOfShownWindows).offsetHeight,10);this.CenterWin(width,height+titleBarHeight);this.PopupCointainers[this.NumberOfShownWindows].style.width=width+"px";this.PopupCointainers[this.NumberOfShownWindows].style.height=height+titleBarHeight+"px";this.SetMaskSize();this.PopFrames[this.NumberOfShownWindows].style.height=height+"px";this.PopFrames[this.NumberOfShownWindows].style.width=(isNaN(iFrameWidth)?width:iFrameWidth)+"px"};Qva.Modal.prototype.Init=function(pagebinder,url){this.Localized=false;if(this.PopupMasks[this.NumberOfShownWindows]!=null){this.Hide()}theBody=document.getElementsByTagName("BODY")[0];var popmask=document.createElement("div");popmask.style.zIndex=99998*this.NumberOfShownWindows;popmask.className="popupMask";popmask.style.position="absolute";popmask.onclick=Qva.CancelBubble;var popcont=document.createElement("div");popcont.style.zIndex=99999*this.NumberOfShownWindows;popcont.style.position="absolute";$(popcont).css("display","none");var imageText=" ";var normalHTML='<div class="PropModalRoundedCorners ToolWindowModal"><div class="QvCaption_Prop" id="popupTitleBar'+this.NumberOfShownWindows+'"><div class="prop-icon-34x34 prop-modal-icon-star" style="float:left;"></div><div class="QvCaption_PropText" id="popupTitle'+this.NumberOfShownWindows+'" style="width:100%"></div><div class="popupControls" id="popupControls'+this.NumberOfShownWindows+'" style="width:15px">'+imageText+'</div></div><div style="width:100%;height:50%;background-color:transparent;position:absolute;display:none;z-index:9999" id="mousedownfix"></div> <iframe style="background-color:#efefef;" src="'+url+'" scrolling="auto" frameborder="0" allowtransparency="true" id="popupFrame'+this.NumberOfShownWindows+'" name="popupFrame"></iframe></div>';var mrgenocideHTML='<div class="PropModalRoundedCorners"><div class="QvCaption_Prop" id="popupTitleBar'+this.NumberOfShownWindows+'"><div class="QvCaption_PropText" id="popupTitle'+this.NumberOfShownWindows+'" style="width:100%"></div><div class="popupControls" id="popupControls'+this.NumberOfShownWindows+'" style="width:15px">'+imageText+'</div></div><div style="width:100%;height:50%;background-color:transparent;position:absolute;display:none;z-index:9999" id="mousedownfix"></div> <iframe style="background-color:#efefef;" src="'+url+'" scrolling="auto" frameborder="0" allowtransparency="true" id="popupFrame'+this.NumberOfShownWindows+'" name="popupFrame"></iframe></div>';if(!Qva.userAgentDetector.get("msie6o7")){popcont.innerHTML=""+normalHTML}else{popcont.innerHTML=""+mrgenocideHTML}theBody.appendChild(popmask);theBody.appendChild(popcont);this.PopupCloseBox=document.getElementById("popCloseBox"+this.NumberOfShownWindows);this.PopupMasks[this.NumberOfShownWindows]=popmask;this.PopupCointainers[this.NumberOfShownWindows]=popcont;this.PopFrames[this.NumberOfShownWindows]=document.getElementById("popupFrame"+this.NumberOfShownWindows);pagebinder.Enabled=false;var self=this;$(this.PopFrames[this.NumberOfShownWindows]).on("load",function(){pagebinder.Enabled=true;if(!self.Localized){this.contentDocument=Qva.localization.localize(this.contentDocument);self.Localized=true}});this.PopFrames[this.NumberOfShownWindows].contentWindow.location.replace(url);var popupTitleBar=this.TitleBar[this.NumberOfShownWindows]=document.getElementById("popupTitleBar"+this.NumberOfShownWindows);var mousedownfix=document.getElementById("mousedownfix");popupTitleBar.style.zIndex=202+3*this.NumberOfShownWindows;popupTitleBar.onmousedown=function(event){if(!event){event=window.event}mousedownfix.style.display="block";var offsets=Qva.GetOffsets(event,popcont);function EndMove(event){document.onmousemove=null;document.onmouseup=null;mousedownfix.style.display="none";return false}function MouseMove(event){if(!event){event=window.event}var mousePos={x:event.clientX+Qva.GetScrollLeft(),y:event.clientY+Qva.GetScrollTop()};popcont.style.left=(mousePos.x-offsets.offsetX)+"px";popcont.style.top=(mousePos.y-offsets.offsetY)+"px";return false}document.onmousemove=MouseMove;document.onmouseup=EndMove;return false};if(this.PopupCloseBox){this.PopupCloseBox.onmousedown=Qva.Modal.Close}var brsVersion=parseInt(window.navigator.appVersion.charAt(0),10);if(brsVersion<=6&&window.navigator.userAgent.indexOf("MSIE")>-1){this.HideSelects=true}};Qva.Modal.Close=function(event){Qva.Modal.instance.Close()}
/*!
Copyright 2016 Qlik
Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except in compliance with the License. You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE2.0 Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License.
*/
;Qva.Modal.prototype.DisableTabs=function(){if(document.all){var i=0;for(var j=0;j<this.TabbableTags.length;j++){var tagElements=document.getElementsByTagName(this.TabbableTags[j]);for(var k=0;k<tagElements.length;k++){this.TabIndexes[i]=tagElements[k].tabIndex;tagElements[k].tabIndex="-1";i++}}}};Qva.Modal.prototype.RestoreTabs=function(){if(document.all){var i=0;for(var j=0;j<this.TabbableTags.length;j++){var tagElements=document.getElementsByTagName(this.TabbableTags[j]);for(var k=0;k<tagElements.length;k++){tagElements[k].tabIndex=this.TabIndexes[i];tagElements[k].tabEnabled=true;i++}}}};Qva.Modal.prototype.CenterWin=function(width,height){if(this.PopupIsShown){if(width==null||isNaN(width)){width=this.PopupCointainers[this.NumberOfShownWindows].offsetWidth}if(height==null){height=this.PopupCointainers[this.NumberOfShownWindows].offsetHeight}var theBody=document.getElementsByTagName("BODY")[0];var scTop=parseInt(Qva.GetScrollTop(),10);var scLeft=parseInt(theBody.scrollLeft,10);this.SetMaskSize();var titleBarHeight=parseInt(document.getElementById("popupTitleBar"+this.NumberOfShownWindows).offsetHeight,10);var fullHeight=Qva.GetViewportHeight();var fullWidth=Qva.GetViewportWidth();this.PopupCointainers[this.NumberOfShownWindows].style.top=(scTop+((fullHeight-(height+titleBarHeight))/2))+titleBarHeight+"px";this.PopupCointainers[this.NumberOfShownWindows].style.left=(scLeft+((fullWidth-width)/2))+"px";this.PopupCointainers[this.NumberOfShownWindows].style.display="block"}};Qva.Modal.prototype.SetMaskSize=function(){var theBody=document.getElementsByTagName("BODY")[0];var fullHeight=Qva.GetViewportHeight();var fullWidth=Qva.GetViewportWidth();if(fullHeight>theBody.scrollHeight){popHeight=fullHeight}else{popHeight=theBody.scrollHeight}if(fullWidth>theBody.scrollWidth){popWidth=fullWidth}else{popWidth=theBody.scrollWidth}this.PopupMasks[this.NumberOfShownWindows].style.height=popHeight+"px";this.PopupMasks[this.NumberOfShownWindows].style.width=popWidth+"px"};Qva.Modal.prototype.HideSelectBoxes=function(){for(var i=0;i<document.forms.length;i++){for(var e=0;e<document.forms[i].length;e++){if(document.forms[i].elements[e].tagName=="SELECT"){document.forms[i].elements[e].style.visibility="hidden"}}}};Qva.Modal.prototype.DisplaySelectBoxes=function(){for(var i=0;i<document.forms.length;i++){for(var e=0;e<document.forms[i].length;e++){if(document.forms[i].elements[e].tagName=="SELECT"){document.forms[i].elements[e].style.visibility="visible"}}}};Qva.Modal.prototype.Hide=function(){var theBody=document.getElementsByTagName("BODY")[0];theBody.style.overflow="";this.RestoreTabs();if(this.PopupMasks[this.NumberOfShownWindows]==null){return}if(Qva.UrlParams.isQmc){var tempinput=document.createElement("input");$(tempinput).css({height:"1px",width:"1px"}).appendTo("body");tempinput.focus()}Qva.RemoveHtml(this.PopFrames[this.NumberOfShownWindows]);delete this.PopFrames[this.NumberOfShownWindows];delete this.TitleBar[this.NumberOfShownWindows];Qva.RemoveHtml(this.PopupMasks[this.NumberOfShownWindows]);Qva.RemoveHtml(this.PopupCointainers[this.NumberOfShownWindows]);delete this.PopupMasks[this.NumberOfShownWindows];delete this.PopupCointainers[this.NumberOfShownWindows];if(this.HideSelects==true){this.DisplaySelectBoxes()}this.NumberOfShownWindows--;this.PopupIsShown=this.NumberOfShownWindows>0;if(Qva.UrlParams.isQmc){$(tempinput).remove()}};Qva.Modal.prototype.SetTitle=function(text){try{document.getElementById("popupTitle"+this.NumberOfShownWindows).innerText=text}catch(e){}};Qva.Modal.prototype.Close=function(){if(this.Type[this.NumberOfShownWindows]!=ModalType.popup){return}this.CloseEx()};Qva.Modal.prototype.CloseEx=function(){this.Hide();if(this.PageBinders[this.NumberOfShownWindows+1]){if(this.PageBinders[this.NumberOfShownWindows+1].LabelClick){this.PageBinders[this.NumberOfShownWindows+1].Set(".Nothing","add","nothing",true)}else{this.PageBinders[this.NumberOfShownWindows+1].Refresh()}}};Qva.Modal.prototype.IsOpen=function(){return this.NumberOfShownWindows>0};Qva.Modal.prototype.IsOpenEx=function(name){var ret=false;if(this.IsOpen()){ret=$(this.PopFrames[this.NumberOfShownWindows]).attr("src").indexOf(name)>0}return ret};Qva.Scanner=function(binder,ns){this.DefaultBinder=binder;this.Errors=new Array();if(ns){this.NameSpace=ns;this.Prefix=ns+":";this.Attr=ns+":bind"}else{this.NameSpace="avq";this.Prefix="avq";this.Attr="avq"}this.ModeIfNotEnabled="n";Qva.Scanner.instance=this};Qva.Scanner.prototype.Start=function(){var binder=this.DefaultBinder||Qva.GetBinder();var scope=(binder&&(binder.Autoview!=null||binder.Kind!=null))?binder.DefaultScope:null;this.Scan(document.body,scope,binder);if(this.Errors.length>0){var msg="Errors:\n"+this.Errors.join("\n");this.Errors.length=0;alert(msg)}};Qva.Scanner.prototype.Scan=function(elem,parPrefix,binder){if(!elem.getAttribute){return}var doc=elem.getAttribute(this.Prefix+"doc");if(doc!=null){doc=doc.split(":");binder=Qva.GetBinder(doc[0],doc[1]);parPrefix=(binder.Autoview!=null||binder.Kind!=null)?binder.DefaultScope:null}var view=elem.getAttribute(this.Prefix+"view");if(view!=null){binder=Qva.GetBinder(view,view);parPrefix=(binder.Autoview!=null||binder.Kind!=null)?binder.DefaultScope:null}if(parPrefix==null&&binder!=null){parPrefix=binder.DefaultScope}var prefix=elem.getAttribute(this.Prefix+"scope");if(prefix==null){prefix=parPrefix}else{if(prefix.substr(0,1)=="."){prefix=parPrefix+prefix}}var avqatt=elem.getAttribute(this.Attr);if(avqatt!=null){if(avqatt.indexOf(":")==-1&&avqatt.indexOf(".")>=0){avqatt="edit:"+avqatt}var parts=avqatt.split(":");var mgrtype=parts[0];if(mgrtype=="edit"){var alttype=elem.tagName.toLowerCase();if(alttype=="input"){alttype+=elem.type.toLowerCase()}if(Qva.Mgr[alttype]){mgrtype=alttype}else{if(alttype!="span"){}}}if(Qva.Mgr[mgrtype]){var name=(parts.length>1)?parts[1]:null;var condition=(parts.length>2)?parts.slice(2).join(":"):null;var mgr=new Qva.Mgr[mgrtype](binder,elem,name,prefix,condition);if(mgr.Name!=null){this.PostManager(mgr)}else{if(mgr.Paint){this.Errors[this.Errors.length]="Invalid "+this.NameSpace+"-attribute: "+avqatt}}}else{this.Errors[this.Errors.length]="Unknown type: "+mgrtype}}if(elem.SelfScanning){return}var len=elem.childNodes.length;for(var ix=0;ix<len;++ix){if(elem.childNodes[ix]){this.Scan(elem.childNodes[ix],prefix,binder)}}};Qva.Scanner.prototype.PostManager=function(mgr){var elem=mgr.Element;mgr.SelectedClassName=elem.getAttribute("QvSelected");if(mgr.SelectedClassName==null){mgr.SelectedClassName="QvSelected"}mgr.DeselectedClassName=elem.getAttribute("QvDeselected");if(mgr.DeselectedClassName==null){mgr.DeselectedClassName="QvDeselected"}mgr.EnabledClassName=elem.getAttribute("QvOptional");if(mgr.EnabledClassName==null){mgr.EnabledClassName="QvOptional"}mgr.DisabledClassName=elem.getAttribute("QvExcluded");if(mgr.DisabledClassName==null){mgr.DisabledClassName="QvExcluded"}mgr.LockedClassName=elem.getAttribute("QvLocked");if(mgr.LockedClassName==null){mgr.LockedClassName="QvLocked"}mgr.SelectedExcludedClassName=elem.getAttribute("QvSelectedExcluded");if(mgr.SelectedExcludedClassName==null){mgr.SelectedExcludedClassName="QvSelectedExcluded"}mgr.LockedExcludedClassName=elem.getAttribute("QvLockedExcluded");if(mgr.LockedExcludedClassName==null){mgr.LockedExcludedClassName="QvLockedExcluded"}mgr.AlternativeClassName=elem.getAttribute("QvAlternative");if(mgr.AlternativeClassName==null){mgr.AlternativeClassName="QvAlternative"}mgr.TextIfNull=mgr.Element.getAttribute(this.Prefix+"textifnull");mgr.Icon=mgr.Element.getAttribute(this.Prefix+"icon");mgr.ModeIfNotEnabled=this.ModeIfNotEnabled;var ifNotEnabled=mgr.Element.getAttribute(this.Prefix+"ifnotenabled");if(ifNotEnabled!=null){switch(ifNotEnabled){case"disabled":mgr.ModeIfNotEnabled="d";break;case"hidden":mgr.ModeIfNotEnabled="h";break;default:this.Errors[this.Errors.length]="IfNotEnabled is not implemented for "+ifNotEnabled;break}}var HideIf=mgr.Element.getAttribute(this.Prefix+"hideif");if(HideIf){mgr.HideIf=new Function("value","text","return "+HideIf)}if(mgr.PostScan){mgr.PostScan(this)}};if(!Qva.Mgr){Qva.Mgr={}}Qva.Mgr.slider=function(owner,elem,name,prefix){if(!Qva.MgrSplit(this,name,prefix)){return}this.Element=elem;this.Touched=false;owner.AddManager(this);this.G=SelectInitGraphics()};Qva.Mgr.slider.prototype.Lock=Qva.LockDisabled;Qva.Mgr.slider.prototype.Unlock=Qva.UnlockDisabled;Qva.Mgr.slider.prototype.Paint=function(mode,node){this.ReadOnly=node.getAttribute("readOnly")==="true"||node.getAttribute("Locked")==="1";this.Touched=true;var element=this.Element;element.style.display=Qva.MgrGetDisplayFromMode(this,mode);if(element.style.display=="none"){return}delete this.Choice;for(var child=node.firstChild;child;child=child.nextSibling){if(child.nodeName=="layout"){this.Node=child}else{if(child.nodeName=="choice"){if(!this.Choice){this.Choice=[]}var index=0;for(var elem=child.firstChild;elem;elem=elem.nextSibling){this.Choice[index++]=elem.getAttribute("text")}this.Choice.length=index}}}this.PageBinder.QueuePostPaintMessage(this)};Qva.Mgr.slider.tooltip=null;Qva.Mgr.slider.prototype.PostPaint=function(){if(this.Element.style.display=="none"){return}var mgr=this;var div=this.Element;var node=this.Node;var swap=true;var dir=node.getAttribute("orientation")||"horizontal";var slider_color=HtmlifyARGB(node.getAttribute("color"))||"#AABCDD";var tics=null;var thumb=null;var arrows=null;for(var child=node.firstChild;child;child=child.nextSibling){if(tics==null&&child.nodeName=="tics"){tics=child}if(thumb==null&&child.nodeName=="thumb"){thumb=child}if(arrows==null&&child.nodeName=="arrows"){arrows=child}}var max=parseFloat(node.getAttribute("max"));var min=parseFloat(node.getAttribute("min"));var current_min=parseFloat(node.getAttribute("current_min"));var current_max=parseFloat(node.getAttribute("current_max"));var userange=node.getAttribute("selectionrange")=="multi";var selectionvalid=node.getAttribute("selectionvalid")=="true"&&!isNaN(current_min)&&!isNaN(current_max);var step=node.getAttribute("step");if(step){step=parseFloat(step)}var top=div.offsetTop;var width=getClientWidth(div);var objectframeNode=div.parentNode;var height=objectframeNode.clientHeight-top;var fontSize=div.style.fontSize;var length=dir=="horizontal"?width:height;var offset=19;var _left=dir=="horizontal"?"left":"top";var _top=dir=="horizontal"?"top":"left";var _width=dir=="horizontal"?"width":"height";var _height=dir=="horizontal"?"height":"width";var _line=dir=="horizontal"?height-15:12;var _textAlign=dir=="horizontal"?"center":"left";var _textTop=dir=="horizontal"?_line-28:_line+23;var _oPos=dir=="horizontal"?"left":"top";var _thumb=dir=="horizontal"?[[0,4],[4,0],[8,4],[8,12],[0,12]]:[[0,0],[8,0],[12,4],[8,8],[0,8]];var fix_point=dir=="horizontal"?function(x,y){return[x,y]}:function(y,x){return[x,y]};var sign=dir=="horizontal"?-1:1;var _ticStart=_line+sign*10;var _ticMajorEnd=_ticStart+sign*13;var _ticMinorEnd=_ticStart+sign*7;var _factor=4;var thumb_onmouseover=null;var thumb_onmousedown=null;var thumb_onmouseout=null;var root=document.createElement("div");root.style.width=width+"px";root.style.height=height+"px";var slider=mgr.G.CreateArea([width,height],root);var l=mgr.G.CreateLine(fix_point(offset,_line),fix_point(length-offset,_line),slider_color,slider,4);if(!l){l=slider}var tics_space=length-2*(offset+5);var valueCount=max-min+1;var dval=valueCount>1?tics_space/(valueCount-1):0;if(tics&&dval>0){var color=HtmlifyARGB(tics.getAttribute("color"))||"#A4A4A4";function create_line(pos,start,end){mgr.G.CreateLine(fix_point(pos,end),fix_point(pos,start),color,slider)}var labelCount=parseInt(tics.getAttribute("labels"));var majorCount=parseInt(tics.getAttribute("major"));if(majorCount<2){majorCount=0}var minorCount=parseInt(tics.getAttribute("minor"));if(minorCount<0){minorCount=0}var iv=0;var labels=tics.getElementsByTagName("label");var startticoffset=parseFloat(tics.getAttribute("startticoffset"))||0;var endvalueoffset=parseFloat(tics.getAttribute("endvalueoffset"))||0;var dmajor=(tics_space-endvalueoffset*dval)/(majorCount-1+startticoffset);for(var imajor=0;imajor<majorCount;++imajor){var labelnode=labels[iv++];var pos;if(labelnode&&labelnode.getAttribute("index")){pos=Math.round(offset+5+parseInt(labelnode.getAttribute("index"))*dval)}else{pos=Math.round(offset+5+(imajor+startticoffset)*dmajor)}if(dir=="horizontal"){create_line(pos,_ticStart+3,_ticMajorEnd+3,color)}else{create_line(pos,_ticStart-3,_ticMajorEnd-3,color)}if(labelCount>0&&imajor%labelCount==0&&labelnode){var text=labelnode.getAttribute("text");var size=Qva.MeasureText(text,div.style.fontFamily,fontSize,div.style.fontWeight);var attrib={position:"absolute",fontSize:fontSize,overflow:"visible",color:color,fontFamily:div.style.fontFamily,fontWeight:div.style.fontWeight,textAlign:_textAlign};attrib[_left]=(dir=="horizontal"?Math.round(pos-size.width/2):Math.floor(pos-size.height/2)+2)+"px";attrib[_top]=(dir=="horizontal"?Math.max(Math.round(_textTop-size.height/2),0):_textTop)+"px";attrib.width=size.width+2+"px";attrib.height=size.height+"px";var label=document.createElement("div");for(var k in attrib){if(k=="color"){label.style[k]=HtmlifyARGB(attrib[k])}else{label.style[k]=attrib[k]}}label.innerText=text;root.appendChild(label)}if(imajor==majorCount-1){continue}var dminor=dmajor/(minorCount+1);for(var iminor=1;iminor<=minorCount;++iminor){var pos2=Math.round(pos+iminor*dminor);create_line(pos2,_ticStart,_ticMinorEnd,color)}}}if(Qva.Mgr.slider.tooltip===null){Qva.Mgr.slider.tooltip=document.createElement("div");Qva.Mgr.slider.tooltip.style.position="absolute";Qva.Mgr.slider.tooltip.style.width="auto";Qva.Mgr.slider.tooltip.style.height="auto";Qva.Mgr.slider.tooltip.style.zIndex=666;Qva.Mgr.slider.tooltip.style.backgroundColor="#FFFFCC";Qva.Mgr.slider.tooltip.style.borderWidth="1px";Qva.Mgr.slider.tooltip.style.borderColor="black";Qva.Mgr.slider.tooltip.style.borderStyle="solid";Qva.Mgr.slider.tooltip.style.padding="3px";Qva.Mgr.slider.tooltip.style.whiteSpace="nowrap";document.body.insertBefore(Qva.Mgr.slider.tooltip,document.body.firstChild)}Qva.Mgr.slider.tooltip.style.visibility="hidden";var thumb_color=HtmlifyARGB(thumb.getAttribute("color"))||"#3796FF";var thumb_pos=fix_point(30,_line-6);var thumb_size=fix_point(8,12);var thumb=mgr.G.CreatePolygonObj(_thumb,thumb_color,root,thumb_pos,thumb_size);if(Qva.userAgentDetector.get("touchEnabled")){var thumbtouch=create_touchArea(thumb_pos,thumb_size)}thumb.style.cursor="inherit";thumb.formattooltip=node.getAttribute("formattooltip")=="true";function val_to_pos(val){if(max==min){return 0}return(thumb.maxVal-thumb.minVal)*(val-min)/(max-min)+thumb.minVal}function pos_to_val(pos){return(pos-thumb.minVal)*(max-min)/(thumb.maxVal-thumb.minVal)+min}function fix_thumb(min,max,end,done){thumb._min=min;thumb._max=max;var min_range=8;var range=Math.round(val_to_pos(max)-val_to_pos(min));if(range>min_range){_fix_thumb(min,range)}else{if(end=="min"){_fix_thumb(max,0);if(done){thumb._min=thumb._max}}else{_fix_thumb(min,0);if(done){thumb._max=thumb._min}}}}function _fix_thumb(min,range){thumb.style[_oPos]=Math.round(val_to_pos(min))+"px";if(range>0){var path=[[4,0],[8,4],[range,4],[range+4,0],[range+4,12],[range,8],[8,8],[4,12]];if(dir!="horizontal"){for(var i=0;i<path.length;++i){var temp=path[i][0];path[i][0]=path[i][1];path[i][1]=temp}}mgr.G.FixPolygon(thumb,path,fix_point(range+8,12),thumb_color)}else{mgr.G.FixPolygon(thumb,_thumb,thumb_size,thumb_color)}if(Qva.userAgentDetector.get("touchEnabled")){thumbtouch.style[_oPos]=Math.round(val_to_pos(min)-0.5*(_factor-1)*thumb_size[dir=="horizontal"?0:1])+"px";if(range>0){thumbtouch.style[_width]=range+8+(_factor-1)*thumb_size[dir=="horizontal"?0:1]+"px"}}}function _get_eventcoord(event){return dir=="horizontal"?Qva.Events.getClientX(event):Qva.Events.getClientY(event)}if(userange&&!this.ReadOnly){thumb_onmouseover=function(event){if(mgr.Active){if(!event){event=window.event}var event_mPos=_get_eventcoord(event);var target=Qva.Events.isTouchEvent(event)?thumbtouch:thumb;var targetminsize=Qva.Events.isTouchEvent(event)?32:8;var pos=Qva.GetPageCoords(target);var i=dir==="horizontal"?"x":"y";var w=parseFloat(target.style[_width]);var diff=thumb._min==thumb._max?targetminsize/3:2*targetminsize/3;if(Math.abs(pos[i]-event_mPos)<diff){document.body.style.cursor=dir==="horizontal"?"w-resize":"n-resize"}else{if(Math.abs(pos[i]+w-event_mPos)<diff){document.body.style.cursor=dir==="horizontal"?"e-resize":"s-resize"}else{document.body.style.cursor="pointer"}}}};thumb_onmouseout=function(){if(mgr.Active){document.body.style.cursor="default"}};Qva.Events.AddOverEvent(thumb,thumb_onmouseover,thumb_onmouseout)}thumb._updateTooltip=function(data){if(thumb.style.visibility==="hidden"){return}var pos=Qva.GetAbsolutePageCoords(thumb);var val={};if(data){for(var i=0;i<data.values.length;i++){val[i]=data.values[i].text}}else{val=thumb.val}if(userange){if(mgr.Choice){Qva.Mgr.slider.tooltip.innerHTML="Min: "+(mgr.Choice[val[0]]||"?")+"<br/>Max: "+(mgr.Choice[val[1]]||"?")}else{Qva.Mgr.slider.tooltip.innerHTML="Min: "+val[0]+"<br/>Max: "+val[1]}}else{Qva.Mgr.slider.tooltip.innerText=mgr.Choice?(mgr.Choice[val[0]]||"?"):val[0]}if(dir=="horizontal"){Qva.Mgr.slider.tooltip.style.left=(pos.x-5)+"px";Qva.Mgr.slider.tooltip.style.top=(pos.y-50)+"px"}else{Qva.Mgr.slider.tooltip.style.left=(pos.x+50)+"px";Qva.Mgr.slider.tooltip.style.top=(pos.y-5)+"px"}Qva.Mgr.slider.tooltip.style.fontFamily=mgr.Element.style.fontFamily;Qva.Mgr.slider.tooltip.style.fontSize=mgr.Element.style.fontSize;Qva.Mgr.slider.tooltip.style.fontWeight=mgr.Element.style.fontWeight;Qva.Mgr.slider.tooltip.style.visibility="visible"};thumb._setPos=function(done){var val=[thumb._min,thumb._max];if(step){if(val[0]>=0){val[0]=(val[0]+step/2)-((val[0]+step/2)%step)}else{val[0]=(val[0]-step/2)-((val[0]-step/2)%step)}if(val[1]>=0){val[1]=(val[1]+step/2)-((val[1]+step/2)%step)}else{val[1]=(val[1]-step/2)-((val[1]-step/2)%step)}}if(done){var setvalue=thumb.lastValue!=val[0]||thumb.lastValue!=val[1];Qva.Mgr.slider.tooltip.style.visibility="hidden";if(userange){val=val[0]+":"+val[1]}else{val=val[0]}if(setvalue){mgr.PageBinder.Set(mgr.Name,"value",val,true)}}else{val[0]=Math.round(val[0]*100)/100;val[1]=Math.round(val[1]*100)/100;if(thumb.val&&val[0]==thumb.val[0]&&val[1]==thumb.val[1]){return}thumb.val=val;if(thumb.formattooltip&&!mgr.Choice){var binder=mgr.PageBinder.GetDocumentMgr();if(thumb.hoverTimout){thumb.hoverTimout=clearTimeout(thumb.hoverTimout)}thumb.hoverTimout=setTimeout(function(){if(Qva.IsContextOpen()){return}if(!binder.GetEnabled()){return}binder.SimpleCall("tooltip",mgr.Name,thumb._updateTooltip,{val1:thumb.val[0],val2:thumb.val[1]})},200)}else{thumb._updateTooltip()}}};thumb.setPos=function(npos,done){if(npos<thumb.minVal){npos=thumb.minVal}if(npos>thumb.maxVal){npos=thumb.maxVal}var m=pos_to_val(npos);if(!isNaN(m)){fix_thumb(m,m,"max",done)}thumb._setPos(done)};mgr.Active=!this.ReadOnly;if(!this.ReadOnly){function SlideEnd(event){var npos=_get_eventcoord(event);npos-=thumb.mouseZero;thumb.setPos(npos,true)}function SlideDrag(event){var npos=_get_eventcoord(event);npos-=thumb.mouseZero;thumb.setPos(npos)}thumb_onmousedown=function(event){switch(document.body.style.cursor){case"w-resize":case"n-resize":thumb.setPos=function(npos,done){var t_max=val_to_pos(thumb._max);if(t_max<npos){npos=t_max}if(npos<thumb.minVal){npos=thumb.minVal}fix_thumb(pos_to_val(npos),thumb._max,"min",done);thumb._setPos(done)};break;case"e-resize":case"s-resize":var t_len=parseFloat(thumb.style[_width])-8;thumb.setPos=function(npos,done){npos+=t_len;var t_min=val_to_pos(thumb._min);if(npos<t_min){npos=t_min}if(thumb.maxVal<npos){npos=thumb.maxVal}fix_thumb(thumb._min,pos_to_val(npos),"max",done);thumb._setPos(done)};break;default:var t_len=parseFloat(thumb.style[_width])-8;var range=thumb._max-thumb._min;thumb.setPos=function(npos,done){var t_end=thumb.maxVal-t_len;if(npos<thumb.minVal){npos=thumb.minVal}if(npos>t_end){npos=t_end}var m=pos_to_val(npos);if(!isNaN(m)){fix_thumb(m,m+range,"max",done)}thumb._setPos(done)};break}var x=parseFloat(thumb.style[_oPos]);thumb.mouseZero=_get_eventcoord(event);thumb.mouseZero-=x;thumb._setPos(false)};Qva.Events.AddDragEvent(thumbtouch?thumbtouch:thumb,function(event){if(userange){thumb_onmouseover(event)}thumb_onmousedown(event)},SlideDrag,SlideEnd);Qva.Events.AddClickEvent(thumbtouch?thumbtouch:thumb,function(event){if(userange){thumb_onmouseover(event)}thumb_onmousedown(event)})}thumb.minVal=17+3;thumb.maxVal=parseFloat(thumb.parentNode.style[_width])-parseFloat(thumb.style[_width])-17-3;thumb.lastValue=current_min==current_max?current_min:-1;if(selectionvalid){fix_thumb(current_min,current_max,"max",true)}else{if(!this.ReadOnly){thumb.style.visibility="hidden";Qva.Events.AddClickEvent(l,function(event){var x=dir=="horizontal"?"x":"y";var npos=(_get_eventcoord(event))-(Qva.GetPageCoords(div)[x]+4);thumb.style.visibility="visible";thumb.setPos(npos,false);if(userange){thumb_onmouseover(event)}thumb_onmousedown(event);SlideEnd(event)})}}function create_touchArea(pos,size,side){var element=document.createElement("div");var w=dir=="horizontal"?0:1;element.style.position="absolute";element.style.left=pos[0]-0.5*(_factor-1)*size[0]+"px";element.style.top=pos[1]-0.5*(_factor-1)*size[1]+"px";element.style.height=_factor*size[1]+"px";element.style.width=_factor*size[0]+"px";if(side=="start"){element.style[_left]=parseFloat(element.style[_left])+0.5*(_factor-1)*size[w]+"px"}if(side=="end"){element.style[_left]=parseFloat(element.style[_left])-0.5*(_factor-1)*size[w]+"px"}root.appendChild(element);return element}function create_arrow(side,color){var x0=side=="start"?0:10;var x2=side=="start"?10:0;var points=[fix_point(x0,0),fix_point(x2,6),fix_point(x0,12)];var pos=fix_point(side=="start"?(length-15):5,_line-6);var size=fix_point(10,12);var arrow=mgr.G.CreatePolygonObj(points,color,root,pos,size);var diff=userange?1:(step!=null?step:1);if(side!=="start"){diff=-diff}if(Qva.userAgentDetector.get("touchEnabled")){var arrowtouch=create_touchArea(pos,size,side)}Qva.Events.AddClickEvent(Qva.userAgentDetector.get("touchEnabled")?arrowtouch:arrow,function(){if(thumb._min!=-1&&thumb._min+diff>=min&&thumb._max+diff<=max){thumb._min+=diff;thumb._max+=diff;thumb._setPos(true)}})}if(arrows){var arrow_color=HtmlifyARGB(arrows.getAttribute("color"))||"#0080C0";create_arrow("start",arrow_color);create_arrow("end",arrow_color)}if(swap&&div.firstChild){div.replaceChild(root,div.firstChild)}else{div.appendChild(root)}};Qva.Mgr.slider.prototype.Remove=function(){Qva.RemoveHtml(this.Element)};(function($,undefined){function action_mu(elem){if(!elem.pressed){return}elem.pressed=false;var action=elem.action;if(elem.ObjectId!=null){var binder=Qva.GetObjectBinder(elem);var params={};if(typeof(elem.val)==="undefined"){params.position=elem.xx+":"+elem.yy}else{params.value=elem.val}params.action="";binder.Set(elem.ObjectId+"."+action,params)}}Qva.PageBinding.prototype.CreateCellIcon=function(icon,stretchmode,adjust,width,height){var name=icon.getAttribute("name");if(height&&(name==="EXC"||name==="COC"||name==="ODDC"||name==="CY"||name==="DU"||name==="SEARCH")){return this.CreateCellSpriteIcon(icon,height)}var img=document.createElement("img");var style="cursor: pointer;";var alttext=icon.getAttribute("alttext");img.alt=alttext?alttext:"";var align=icon.getAttribute("align");img.className="Qv_CellIcon";if(align){img.className+="_"+align}img.className+=" Qv_"+name;var sendsizetoserver=icon.getAttribute("sendsize")==="true";if(sendsizetoserver){style+="height:"+height+"px; width:"+width+"px; "}img.style.cssText=style;var url=icon.getAttribute("url");if(url){url=Qva.AddProxyIfAny(url);url=Qva.XrfSecure(url);img.src=url}else{var stamp=icon.getAttribute("stamp");var color=HtmlifyARGB(icon.getAttribute("color"));url=this.BuildBinaryUrl(icon.getAttribute("path"),stamp,name,color);if(sendsizetoserver){if(icon.getAttribute("stretchmode")){stretchmode=icon.getAttribute("stretchmode")}url+="&width="+width+"&height="+height+"&stretchmode="+stretchmode+"&adjust="+adjust;url=Qva.AddProxyIfAny(url);url=Qva.XrfSecure(url)}$(img).error(function(){if(alttext){$(this).replaceWith($('<div style="'+style+'">').text(alttext))}else{$(this).remove()}});img.src=url}return img};Qva.PageBinding.prototype.CreateCellSpriteIcon=function(icon,height){var name=icon.getAttribute("name");var align=icon.getAttribute("align");var target=document.createElement("div");target.style.width=Qva.userAgentDetector.get("touchEnabled")?"18px":"14px";target.style.height=height+"px";target.className="Qv_CellIcon";if(align){target.className+="_"+align}var img=document.createElement("div");img.className="cell-icon cell-"+name+"-icon";img.title="";if(Qva.userAgentDetector.get("touchEnabled")){target.style.zIndex=700}target.appendChild(img);return target};window.AppendAction=function(elem,xml,mgr,pos){var action=xml.getAttribute("action");var clientaction=xml.getAttribute("clientaction");var drag=xml.getAttribute("drag");if(action||clientaction){elem.binderid=mgr.binderid;if(action){Qva.Events.setClickElem(elem,"action");elem.pressed=false;elem.action=action}else{if(clientaction){elem.AvqMgr=mgr;Qva.Events.setClickElem(elem,"clientaction");elem.clientaction=clientaction;elem.param=xml.getAttribute("param")}}elem.ObjectId=mgr.ObjectId;elem.pos=pos;if(xml.getAttribute("menu")=="true"){elem.position=action+":"+pos;Qva.SetContextMenu(elem,function(event){return Qva.GetBinder(this.binderid).OnContextMenu(event,this.ObjectId)})}}else{if(drag){elem.dragObj={Name:mgr.PageName,type:"col"}}else{Qva.Events.AddNoAction(elem)}}};window.onclick_Action=function(event){this.pressed=true;var _this=this;if(Qva.Events.isTouchEvent(event)){do_Action(_this)}else{window.setTimeout(function(){do_Action(_this)},200)}};function do_Action(elem){if(!elem.pressed){return}elem.pressed=false;var action=elem.action;var params={action:"",position:elem.pos};var binder=Qva.GetBinder(elem.binderid);binder.Set(elem.ObjectId+"."+action,params)}Qva.GetScrollBarProperties=function(size,scrollbtncolor,scrollbkgcolor,bordercolor){var props={width:12,backgroundColor:"#FFF",buttonColor:"#DDD",borderColor:"#fff"};if(size){props.width=parseFloat(size)}if(scrollbtncolor){props.buttonColor=scrollbtncolor}if(scrollbkgcolor){props.backgroundColor=scrollbkgcolor}if(bordercolor){props.borderColor=bordercolor}return props};Qva.ScrollBarMgr=function(owner,vertical,buttons){this.vertical=vertical;this.bar_pos=0;this.PageBinder=owner.PageBinder;var w=this.w=vertical?"width":"height";var h=this.h=vertical?"height":"width";function createScrollButton(parent,isStart){var btn=document.createElement("div"),arrow=document.createElement("span"),text="";btn.className="TouchScrollbar";btn.style.display="none";btn.style.opacity=1;btn.style.backgroundColor="transparent";text=isStart?vertical?"&#9650;":"&#9668;":vertical?"&#9660;":"&#9658;";arrow.innerHTML=text;arrow.style.fontFamily="Monospace";arrow.style.fontSize="120%";arrow.style.position="absolute";arrow.style.left=arrow.style.top=arrow.style.right=arrow.style.bottom="0px";btn.appendChild(arrow);parent.appendChild(btn);return btn}var bar=this.bar=document.createElement("div");bar.className="TouchScrollbar";bar.style.display="none";bar.style.opacity=1;bar.style.right="auto";bar.style.bottom="auto";initTransition(bar,"cubic-bezier(0, 0.3, 0.6, 1)");bar.style.borderRadius="3px";owner.Element.appendChild(bar);this.buttons=buttons;if(buttons){this.start=createScrollButton(owner.Element,true);this.end=createScrollButton(owner.Element,false)}var backgroundDivider=this.backgroundDivider=document.createElement("div");backgroundDivider.className=vertical?"Qv_ScrollbarVerticalDivider":"Qv_ScrollbarHorizontalDivider";owner.Element.appendChild(backgroundDivider);var background=this.background=document.createElement("div");background.className="Qv_ScrollbarBackground";background.style.display="none";owner.Element.appendChild(background)};Qva.ScrollBarMgr.prototype.Set=function(left,top,visible_height,scroll_height,bkgheight,bkgleft,bkgtop){if(visible_height<0){return}var max_scroll=visible_height-scroll_height;var scrollbarWidth=this.props.width;left+=2;top+=2;if(this.buttons){this.start.style.left=left+"px";this.start.style.top=top+"px";this.start.style.display="";this.end.style.left=left+"px";this.end.style.top=top+"px";if(this.vertical){this.end.style.top=(top+visible_height-scrollbarWidth)+"px";top+=scrollbarWidth-4}else{this.end.style.left=(left+visible_height-scrollbarWidth)+"px";left+=scrollbarWidth-4}this.end.style.display="";visible_height-=(scrollbarWidth*2)}var scrollbarHeight=this.bar_height=Math.max(Math.round(visible_height*visible_height/scroll_height),10);var scrollMax=visible_height-scrollbarHeight;this.ScrollStep=scrollMax/max_scroll;this.left=this.vertical?left:left+2;this.top=this.vertical?top+2:top;this.visible_height=visible_height;this.backgroundDivider.style.left=bkgleft+"px";this.backgroundDivider.style.top=bkgtop+"px";this.backgroundDivider.style.display="block";if(!this.vertical){this.backgroundDivider.style.width=(bkgheight+scrollbarWidth)+"px"}else{this.backgroundDivider.style.height=(bkgheight+scrollbarWidth)+"px"}this.background.style.left=bkgleft+"px";this.background.style.top=bkgtop+"px";this.background.style[this.h]=bkgheight+"px";this.background.style.display="";this.bar.style.top=this.top+"px";this.bar.style.left=this.left+"px";this.bar.style[this.w]=scrollbarWidth-3+"px";this.bar.style[this.h]=scrollbarHeight+"px";this.bar.style.display="";this.bar._topOffset=this.top;this.bar._leftOffset=this.left;this.setTransitionTime("0ms")};Qva.ScrollBarMgr.prototype.Hide=function(){this.bar.style.display="none";this.background.style.display="none";this.backgroundDivider.style.display="none";if(this.paddingelement){this.paddingelement.style.display="none"}if(this.buttons){this.start.style.display="none";this.end.style.display="none"}};Qva.ScrollBarMgr.prototype.EnablePaddingElement=function(){if(!this.paddingelement){this.paddingelement=document.createElement("div");var $paddEl=$(this.paddingelement);$paddEl.addClass("Qv_ScrollbarBackground").css({backgroundColor:this.props.backgroundColor,bottom:"0px",right:"0px",width:this.props.width+"px",height:this.props.width+"px"}).on("click mousedown",Qva.CancelBubble).appendTo(this.background.parentNode)}this.paddingelement.style.display=""};Qva.ScrollBarMgr.prototype.DisablePaddingElement=function(){if(this.paddingelement){this.paddingelement.style.display="none"}};Qva.ScrollBarMgr.prototype.IsVisible=function(){return this.bar.style.display==""};Qva.ScrollBarMgr.prototype.Get=function(){return 0};Qva.ScrollBarMgr.prototype.setPosition=function(pos){if(this.bar.style.display=="none"||typeof this.bar_pos==="undefined"){return}var newVal=Math.round(this.bar_pos=pos*this.ScrollStep);if(this.vertical){translate(this.bar,0,newVal)}else{translate(this.bar,newVal,0)}};Qva.ScrollBarMgr.prototype.setProperties=function(props){this.props=props;var btnWidth=props.width-3;function updateBtn(btn){var offset=btnWidth/4+"px";btn.style.width=btnWidth+"px";btn.style.height=btnWidth+"px";btn.style.color=props.buttonColor;btn.style.lineHeight=btnWidth+"px";btn.style.fontSize=btnWidth+"px";btn.style.textAlign="center";btn.firstChild.style.display="block";btn.firstChild.style.width=btnWidth+"px";btn.firstChild.style.height=btnWidth+"px";btn.firstChild.style.lineHeight="0.9";btn.firstChild.style.color=props.buttonColor;if(this.vertical){}else{}}if(this.buttons){updateBtn(this.start);updateBtn(this.end)}if(!this.bar.style.width){this.bar.style.width=btnWidth+"px";this.bar.style.height=btnWidth+"px"}if(!this.vertical){this.backgroundDivider.style.borderTopColor=props.borderColor}else{this.backgroundDivider.style.borderLeftColor=props.borderColor}this.bar.style.backgroundColor=props.buttonColor;this.background.style[this.w]=props.width+"px";this.background.style.backgroundColor=props.backgroundColor;if(this.paddingelement){this.EnablePaddingElement()}};Qva.ScrollBarMgr.prototype.setTransitionTime=function(time){setDuration(this.bar,time)};Qva.ScrollBarMgr.prototype.bindEvents=function(actions){this.eventsBound=true;this.actions=actions};Qva.ScrollBarMgr.prototype.addEvents=function(){var that=this;function getOffset(event){var offset=Qva.GetOffsets(event,that.background.parentNode);if(that.vertical){return offset.offsetY}else{return offset.offsetX}}function getPos(event){return that.vertical?Qva.Events.getY(event):Qva.Events.getX(event)}var start;var button_diff;var inMoveArea;function dragbar_mouseUp(event){if(!inMoveArea){return}$(document).enableSelection();var d=(getPos(event)-start)/that.ScrollStep;that.actions.scroll_end(d)}function dragbar_mouseMove(event){if(!inMoveArea){return}var d=(getPos(event)-start)/that.ScrollStep;that.actions.scroll(d)}function button_apply(){that.actions.step(button_diff)}function page_apply(){that.actions.page(button_diff)}var startProp=that.vertical?"top":"left";function background_onmousedown(event,isClick){if(that.PageBinder.Element.Type!=="LB"&&that.PageBinder.Element.attributes.cached==="undefined"&&that.PageBinder.Painting){return false}var p=getOffset(event);start=getPos(event);inMoveArea=true;if(p<that[startProp]){inMoveArea=false;button_diff=1;if(isClick){button_apply()}}else{if(p>that[startProp]+that.visible_height){inMoveArea=false;button_diff=-1;if(isClick){button_apply()}}else{if(p<that[startProp]+that.bar_pos){inMoveArea=false;button_diff=1;if(isClick){page_apply()}}else{if(p>that[startProp]+that.bar_pos+that.bar_height){button_diff=-1;if(isClick){page_apply()}}else{inMoveArea=true;if(!isClick){$(document).disableSelection()}}}}}setTimeout(function(){that.background.parentNode.scrollTop=0},50)}this.background.parentNode.scroll="no";Qva.Events.AddClickEvent(this.background,background_onmousedown,{arg:[true]});Qva.Events.AddDragEvent(this.bar,background_onmousedown,dragbar_mouseMove,dragbar_mouseUp);Qva.Events.AddClickEvent(this.start,background_onmousedown,{arg:[true]});Qva.Events.AddClickEvent(this.end,background_onmousedown,{arg:[true]});Qva.Events.AddCancelBubble(this.bar)};Qva.AddScroll=function(mgr){var elem=mgr.Element;mgr.YScroll=new Qva.ScrollBarMgr(mgr,true,true);mgr.XScroll=new Qva.ScrollBarMgr(mgr,false,true);mgr.YScroll.addEvents();mgr.XScroll.addEvents();Qva.AddMouseScroll(mgr)};Qva.AddMouseScroll=function(mgr){var elem=mgr.Element;function on_wheel(event){if(!event){event=window.event}var delta;if(event.wheelDelta){delta=event.wheelDelta/120;if(window.opera){delta=-delta}}else{if(event.detail){delta=-event.detail/3}}if(!delta){return}if(mgr.actions){mgr.actions.step(3*delta)}if(event.preventDefault){event.preventDefault()}event.returnValue=false}Qva.Events.AddScrollWheelEvent(elem,on_wheel)};Qva.UpdateScroll=function(mgr){mgr.ScrollProperties=Qva.GetScrollBarProperties(mgr.PageBinder.ScrollWidth,mgr.PageBinder.ScrollButtonColor,mgr.PageBinder.ScrollBkgColor,mgr.PageBinder.BorderColor);if(mgr.YScroll){mgr.YScroll.setProperties(mgr.ScrollProperties)}if(mgr.XScroll){mgr.XScroll.setProperties(mgr.ScrollProperties)}};window.translate=null;window.setDuration=null;window.initTransition=null;(function(){var p=document.createElement("p");if(typeof p.style.webkitTransform!=="undefined"){window.translate=function(elem,x,y){x=Math.round(x);y=Math.round(y);if(elem.forceFixed&&elem.forceFixed===true){elem.forceFixedValue=-x}elem.style.webkitTransform="translate3d("+x+"px, "+y+"px, 0)"};window.setDuration=function(elem,time){elem.style.webkitTransitionDuration=time};window.initTransition=function(elem,value){elem.style.webkitTransitionTimingFunction=value;elem.style.webkitTransitionProperty="-webkit-transform"}}else{if(Qva.userAgentDetector.get("gecko")){window.translate=function(elem,x,y){x=Math.round(x);y=Math.round(y);if(elem.forceFixed&&elem.forceFixed===true){elem.forceFixedValue=-x}elem.style.MozTransform="translate("+x+"px, "+y+"px)"};window.setDuration=function(elem,time){elem.style.MozTransitionDuration=time};window.initTransition=function(elem,value){elem.style.MozTransitionTimingFunction=value;elem.style.MozTransitionProperty="-moz-transform"}}else{if(typeof p.style.transition!=="undefined"){window.translate=function(elem,x,y){x=Math.round(x);y=Math.round(y);if(elem.forceFixed&&elem.forceFixed===true){elem.forceFixedValue=-x}if(elem._leftOffset===undefined){elem._leftOffset=$(elem).position().left}if(elem._topOffset===undefined){elem._topOffset=$(elem).position().top}elem.style.left=(x+elem._leftOffset)+"px";elem.style.top=(y+elem._topOffset)+"px"};window.setDuration=function(elem,time){elem.style.transitionDuration=time};window.initTransition=function(elem,value){elem.style.transitionTimingFunction=value;elem.style.transitionProperty="top, left"}}}}if(!translate){window.translate=function(elem,x,y){if(elem._leftOffset===undefined){elem._leftOffset=$(elem).position().left}if(elem._topOffset===undefined){elem._topOffset=$(elem).position().top}elem.style.left=(x+elem._leftOffset)+"px";elem.style.top=(y+elem._topOffset)+"px"}}if(!setDuration){window.setDuration=function(){}}if(!initTransition){window.initTransition=function(){}}p=null;window.applyTranslate=window.translate;window.applyDuration=window.setDuration;window.applyInitTransition=window.initTransition;window.translate=function(elem,x,y){x=Math.round(x);y=Math.round(y);if(elem.pages){for(el in elem.pages){applyTranslate(elem.pages[el],x,y+el*$(elem.pages[el]).height())}}else{applyTranslate(elem,x,y)}};window.setDuration=function(elem,time){if(elem.pages){for(el in elem.pages){applyDuration(elem.pages[el],time)}}else{applyDuration(elem,time)}};window.initTransition=function(elem,value){if(elem.pages){for(el in elem.pages){applyInitTransition(elem.pages[el],value)}}else{applyInitTransition(elem,value)}}})();Qva.MeasureText=function(text,fontfamily,fontsize,fontweight,width,breakWord){if(!this.MeasuredTexts){this.MeasuredTexts={}}if(!fontweight){fontweight="normal"}if(this.MeasuredTexts[fontfamily]){if(this.MeasuredTexts[fontfamily][fontsize]){if(this.MeasuredTexts[fontfamily][fontsize][fontweight]){if(this.MeasuredTexts[fontfamily][fontsize][fontweight][text]){if(width&&this.MeasuredTexts[fontfamily][fontsize][fontweight][text][width]){return this.MeasuredTexts[fontfamily][fontsize][fontweight][text][width]}else{if(!width&&this.MeasuredTexts[fontfamily][fontsize][fontweight][text].def){return this.MeasuredTexts[fontfamily][fontsize][fontweight][text].def}}}}}}var div=Qva.Measure_div;if(!div){div=document.createElement("div");div.style.position="absolute";div.style.width="auto";div.style.height="auto";div.style.visibility="hidden";document.body.insertBefore(div,document.body.firstChild);Qva.Measure_div=div}if(width){div.style.width=width+"px"}else{div.style.width="auto"}$(div).css("font-family",fontfamily);$(div).css("font-size",fontsize);$(div).css("font-weight",fontweight);$(div).css("word-wrap",(width&&breakWord)?"break-word":"");div.innerText=text;var ret={width:div.offsetWidth,height:div.offsetHeight};if(ret.height===0){div.innerText=text+"\xA0";ret.height=div.offsetHeight}if(!this.MeasuredTexts[fontfamily]){this.MeasuredTexts[fontfamily]={}}if(!this.MeasuredTexts[fontfamily][fontsize]){this.MeasuredTexts[fontfamily][fontsize]={}}if(!this.MeasuredTexts[fontfamily][fontsize][fontweight]){this.MeasuredTexts[fontfamily][fontsize][fontweight]={}}if(!this.MeasuredTexts[fontfamily][fontsize][fontweight][text]){this.MeasuredTexts[fontfamily][fontsize][fontweight][text]={}}if(width&&!this.MeasuredTexts[fontfamily][fontsize][fontweight][text][width]){this.MeasuredTexts[fontfamily][fontsize][fontweight][text][width]=ret}else{if(!width){this.MeasuredTexts[fontfamily][fontsize][fontweight][text].def=ret}}return ret};Qva.MeasureText.TextSample="gGfjl";Qva.MeasureFontHeight=function(fontfamily,fontsize,fontweight){return Qva.MeasureText(Qva.MeasureText.TextSample,fontfamily,fontsize,fontweight).height};if(!Qva.Mgr){Qva.Mgr={}}Qva.Mgr.grid=function(owner,elem,name,prefix,readOnly){this.SearchName=this.Name=Qva.MgrMakeName(name,prefix);this.ObjectId=owner.Element.id;this.LeftButton=owner.LeftButton;this.Element=elem;this.Cols=[];this.Body={position:"Body"};this.Headers={position:"Head"};this.Footers={position:"Foot"};this.Selection={};this.binderid=owner.binderid;this.readOnly=readOnly;owner.AddManager(this);elem.Mgr=this;elem.style.position="relative";elem.style.overflow="hidden";elem.style.cursor="Default";this.Content=document.createElement("div");elem.appendChild(this.Content);Qva.AddScroll(this);Qva.Events.AddClickEvent(elem,function(event){if(elem.Mgr.multiselect){return}var origevent=Qva.Events.getOriginalEvent(event);var target=Qva.Events.getClickElem(elem,event);switch(target[Qva.Events.Flags.Click]){case"action":onclick_Action.apply(target,[origevent]);break;case"clientaction":window.onclick_ContextClientAction.apply(target,[origevent]);break;case"input":Qva.OpenPopupInput(target,true);break;case"gridclick":Qva.Mgr.grid.Click.apply(target,[origevent]);break;case"select":var div=target;if(div.disabled){return}var mgr=Qva.Mgr.grid.getMgr(div);if(!mgr.PageBinder.IsValid()){return}Qva.Mgr.grid.SelectMgr=mgr;mgr.Selection.Start=mgr.Selection.End=div;mgr.Selection.SelectSource=div.selectsource;var rectstring=""+div.xx-mgr.fixed_cols_right+":"+div.yy+":"+1+":"+1;if(getSection(mgr.Selection.Start.position)==="Head"){rectstring+=":Head"}mgr.PageBinder.Set(mgr.ObjectId,"rect",rectstring,true);mgr._ClearCellsToSelect()}});if(!this.readOnly){Qva.Events.AddDblClickEvent(elem,function(event){var target=Qva.Events.getTarget(event),found=false;for(;target!=elem&&!found;target=target.parentNode){if($(target).data("cell")){found=true;break}}if(found&&$(target).data("cell").dblclick){Qva.Mgr.grid.DblClick.apply(target,[Qva.Events.getOriginalEvent(event)])}})}Qva.Events.AddDragSelectEvent(elem,function(event){var target=Qva.Events.getClickElem(elem,event);if(!target||target[Qva.Events.Flags.Click]!="select"){return false}var mgr=Qva.Mgr.grid.getMgr(target);Qva.Mgr.grid.SelectMgr=mgr;mgr.Selection.Start=mgr.Selection.End=target;mgr.Selection.SelectSource=target.selectsource;mgr._IndicateCellsToSelect();var $parent=$(mgr.Element);var elemoffset=$parent.offset();elemoffset.top-=Qva.GetScrollTop();elemoffset.left-=Qva.GetScrollLeft();mgr.Selection.ParentCoords={top:elemoffset.top,left:elemoffset.left,right:(elemoffset.left+$parent.width()),bottom:(elemoffset.top+$parent.height())};mgr.Selection.ParentCoords.top+=mgr.Headers.height;mgr.Selection.ParentCoords.bottom-=mgr.Footers.height;return true},function(event){var target=Qva.Events.getClickElem(elem,event);var mgr=Qva.Mgr.grid.getMgr(target);if(Qva.Mgr.grid.SelectMgr!=mgr){return}if(mgr.Selection.SelectSource!=target.selectsource){return}if(!mgr.PageBinder.IsValid()){return}mgr.Selection.End=target;if(target.singleselect){mgr.Selection.Start=mgr.Selection.End}mgr._IndicateCellsToSelect()},function(event){var mgr=Qva.Mgr.grid.SelectMgr;Qva.Mgr.grid.SelectMgr=null;mgr._ClearCellsToSelect();if(getSection(mgr.Selection.Start.position)===getSection(mgr.Selection.End.position)){var x=Math.min(mgr.Selection.Start.xx,mgr.Selection.End.xx);x-=mgr.fixed_cols_right;var y=Math.min(mgr.Selection.Start.yy,mgr.Selection.End.yy);var width=Math.abs(mgr.Selection.Start.xx-mgr.Selection.End.xx)+1;var height=Math.abs(mgr.Selection.Start.yy-mgr.Selection.End.yy)+1;var rectstring=""+x+":"+y+":"+width+":"+height;if(getSection(mgr.Selection.Start.position)==="Head"){rectstring+=":Head"}mgr.PageBinder.Set(mgr.ObjectId,"rect",rectstring,true)}else{alert("error")}mgr.Selection.ParentCoords={}},{fnInterval:function(){var mgr=Qva.Mgr.grid.SelectMgr;var event=mgr.Selection.latestMoveEvent;if(!event){return}var clientX=Qva.Events.getClientX(event),clientY=Qva.Events.getClientY(event);var fnIndicateSelection=function(xstep,ystep){var selections=mgr.Selection;if(selections.ParentCoords.right==undefined){return}var pos={x:clientX,y:clientY},diff=2,scrollwidth=mgr.ScrollProperties.width;if(xstep<0){pos.x=selections.ParentCoords.right-diff;if(mgr.YScroll.IsVisible()){pos.x-=scrollwidth}}else{if(xstep>0){pos.x=selections.ParentCoords.left+diff}}if(ystep<0){pos.y=selections.ParentCoords.bottom-diff;if(mgr.XScroll.IsVisible()){pos.y-=scrollwidth}}else{if(ystep>0){pos.y=selections.ParentCoords.top+diff}}var target=Qva.Events.getClickElemForPoint(mgr.Element,pos.x,pos.y);if(target&&target[Qva.Events.Flags.Click]==="select"){selections.End=target;if(target.singleselect){selections.Start=selections.End}mgr._IndicateCellsToSelect()}};var xstep=0,ystep=0;if(mgr.XScroll.IsVisible()){if(clientX<mgr.Selection.ParentCoords.left){xstep=1}else{if(clientX>mgr.Selection.ParentCoords.right){xstep=-1}}}if(mgr.YScroll.IsVisible()){if(clientY<mgr.Selection.ParentCoords.top){ystep=1}else{if(clientY>mgr.Selection.ParentCoords.bottom){ystep=-1}}}if(xstep!=0||ystep!=0){if(xstep!=0){mgr.XScroll.actions.step(xstep,true)}if(ystep!=0){mgr.YScroll.actions.step(ystep,true)}mgr.PageBinder.GetDocumentMgr().CallOnceOnUpdateComplete(function(){fnIndicateSelection.apply(this,[xstep,ystep])})}},fnMoveOutside:function(event){var mgr=Qva.Mgr.grid.SelectMgr;mgr.Selection.latestMoveEvent=event}});if(Qva.userAgentDetector.get("touchEnabled")){this._addTouchEvents(elem)}};Qva.Mgr.grid.prototype.Paint=function(mode,node,name,partial){this.isCurrentSelections=node.getAttributeNode("type").value==="CS";this.isMultiBox=node.getAttributeNode("type").value==="MB";this.isStatisticsBox=node.getAttributeNode("type").value==="SB";if(node.getAttribute("fullwidth")){this.PageBinder.FullWidth=node.getAttribute("fullwidth")*this.PageBinder.FontAspectRatio}Qva.UpdateScroll(this);this.Touched=true;var element=this.Element;function getNodeByName(name){for(var i=0;i<node.childNodes.length;++i){if(node.childNodes[i].tagName=="value"&&node.childNodes[i].getAttribute("name")==name){return node.childNodes[i]}}return null}var bodyNode=getNodeByName("Body");if(bodyNode){element.style.display=bodyNode.getAttribute("mode")=="enabled"?"":"none"}if(element.style.display=="none"){return}var stylenodes=node.getElementsByTagName("style");if(stylenodes.length>0){this.Style=[];stylenodes=stylenodes[0].getElementsByTagName("style");for(var istyle=0;istyle<stylenodes.length;istyle++){this.Style[istyle]=new this._StyleObject(stylenodes[istyle])}}stylenodes=node.getElementsByTagName("borderstyle");if(stylenodes.length>0){this.BorderStyle=[];stylenodes=stylenodes[0].getElementsByTagName("borderstyle");for(istyle=0;istyle<stylenodes.length;istyle++){var b=this.BorderStyle[istyle]=new this._BorderStyleObject(stylenodes[istyle])}}var styleNode=getNodeByName("Style");if(styleNode){var fontfamily=styleNode.getAttribute("fontfamily");var fontsize=styleNode.getAttribute("fontsize")+"pt";var fontweight=styleNode.getAttribute("fontweight");this.fontfamily=fontfamily;this.fontsize=fontsize;this.fontweight=fontweight;this.TextHeight=Qva.MeasureFontHeight(fontfamily,fontsize,fontweight)}var DropZonesNodes=node.getElementsByTagName("dropzones");if(DropZonesNodes.length>0){this.DropZones=[];for(var chgrp=DropZonesNodes[0].firstChild;chgrp;chgrp=chgrp.nextSibling){var zone={};ObjectifyXmlAttributes(zone,chgrp);this.DropZones[this.DropZones.length]=zone}}function getPos(name){var val=node.getAttribute(name);if(!val){return{x:0,y:0}}var pos=val.split(":");return{x:parseInt(pos[0]),y:parseInt(pos[1])}}var fixedrows=0;if(node.getAttribute("totalsize")!=null){this.ChunkOffset=getPos("pageoffset");this.ChunkSize=getPos("pagesize");this.TotalSize=getPos("totalsize");if(node.getAttribute("fixed_rows")!=null){fixedrows=node.getAttribute("fixed_rows");this.TotalSize.y-=fixedrows}}else{this.ChunkOffset={x:0,y:0};for(var x=0;getNodeByName("C"+x)!=null;++x){}if(x==1&&getNodeByName("C2")!=null){++x}var y=getNodeByName("C0").getElementsByTagName("element").length;this.TotalSize=this.ChunkSize={x:x,y:y}}if(node.getAttribute("scrollposition")!=null){this.ScrollPosition=getPos("scrollposition")}else{this.ScrollPosition={x:0,y:0}}partial=this.ChunkOffset.x!=0||this.ChunkOffset.y!=0;if(!partial){this.Cols=[];this.Body.Lines=[];this.Headers.Lines=[];this.Headers.Heights=[];this.Footers.Lines=[];this.YScroll.Scrolled=false;this.XScroll.Scrolled=false;this.LastSize=null}this.sizetodata=node.getAttribute("sizetodata")==="true";var startCol=this.ChunkOffset.x;var endCol=Math.min(this.ChunkOffset.x+this.ChunkSize.x,this.TotalSize.x);var default_width=this.PageBinder.GetMaxClientWidth()/Math.max(1,endCol-startCol);var isSmallDevices=this.PageBinder.PageBinder.isSmallDevices;for(var colIx=startCol;colIx<endCol;++colIx){var colNode=getNodeByName("C"+colIx);if(!colNode&&colIx==1){colNode=getNodeByName("C2")}if(!colNode){continue}var colwidth=parseInt(colNode.getAttribute("width"));if(isNaN(colwidth)||colwidth<0){colwidth=default_width}if(!this.Cols[colIx]){this.Cols[colIx]={}}this.Cols[colIx].width=colwidth*this.PageBinder.FontAspectRatio;this.Cols[colIx].allowresize=colNode.getAttribute("allowresize")!="false";if(!this.PageBinder.AllowColumnResize){this.Cols[colIx].allowresize=false}var HeaderCount=0;var FooterCount=0;var entries=colNode.getElementsByTagName("element");for(var rix=0;rix<entries.length;++rix){var entry=entries[rix];var position=entry.getAttribute("position");var full_rix=rix;var lines;if(position==="top"){HeaderCount++;lines=this.Headers.Lines}else{if(position==="bottom"){full_rix-=HeaderCount;FooterCount++;lines=this.Footers.Lines}else{full_rix-=HeaderCount;full_rix-=FooterCount;full_rix+=this.ChunkOffset.y;if(partial){full_rix-=fixedrows}lines=this.Body.Lines}}if(lines[full_rix]==null){lines[full_rix]=[]}var line=lines[full_rix];line[colIx]=new this._CellObject(entry,this)}}if(this.Headers.Lines.length===0&&this.Footers.Lines.length===0&&this.Body.Lines.length===0){this.TotalSize={x:0,y:0}}this.Footers.rowHeight=this.Footers.Lines.length>0?this.Footers.Lines[0][0].rowspan*this.TextHeight:0;if(this.isCurrentSelections||this.isMultiBox){this.Body.rowHeight=this.TextHeight}else{this.Body.rowHeight=this.Body.Lines.length>0?this.Body.Lines[0][0].rowspan*this.TextHeight:0}this.Headers.height=0;for(var i=0;i<this.Headers.Lines.length;++i){if(this.Headers.Lines[i][0].vertical){this.Headers.Heights[i]=this.TextHeight;for(var j=0;j<this.Headers.Lines[i].length;j++){var style=this.Style[this.Headers.Lines[i][j].style];var textWidth=Qva.MeasureText(this.Headers.Lines[i][j].val,this.fontfamily,this.fontsize,style.FontWeight).width+8;this.Headers.Heights[i]=Math.max(this.Headers.Heights[i],textWidth)}this.Headers.height+=this.Headers.Heights[i]}else{this.Headers.height+=this.Headers.Lines[i][0].rowspan*this.TextHeight}}this.Footers.height=this.Footers.Lines.length*this.Footers.rowHeight;var fixed_cols_left=this.TotalSize.x===0?0:parseInt(node.getAttribute("fixed_cols"));var fixed_cols_right=this.TotalSize.x===0?0:parseInt(node.getAttribute("fixed_cols_right"));if(isNaN(fixed_cols_left)){fixed_cols_left=0}if(isNaN(fixed_cols_right)){fixed_cols_right=0}if(this.Body.Lines.length>0){fixed_cols_left=Math.min(fixed_cols_left,this.Body.Lines[0].length)}if(this.fixed_cols_left_org===undefined||this.fixed_cols_left_org!==fixed_cols_left||this.fixed_cols_right_org===undefined||this.fixed_cols_right_org!==fixed_cols_right){this.overrideFixedColumnsFromServer=false}if(!this.overrideFixedColumnsFromServer){var changed_fixed_cols=(this.fixed_cols_left!=null&&this.fixed_cols_left!==fixed_cols_left)||(this.fixed_cols_right!=null&&this.fixed_cols_right!==fixed_cols_right);if(changed_fixed_cols){this.LastSize=null}this.fixed_cols_left=fixed_cols_left;this.fixed_cols_right=fixed_cols_right;this.fixed_cols_left_org=fixed_cols_left;this.fixed_cols_right_org=fixed_cols_right}this._UpdateLimits();this.PageBinder.QueuePostPaintMessage(this);this.PageBinder[this.PageBinder.oldShow?"oldShow":"Show"]()};Qva.Mgr.grid.prototype._UpdateLimits=function(){var min_height,max_height,min_width=0,fixed_width=0,max_width=0,fixed_cols_total=this.fixed_cols_left+this.fixed_cols_right;min_height=max_height=this.Headers.height+this.Footers.height;min_height+=this.Body.rowHeight;max_height+=this.TotalSize.y*this.Body.rowHeight;for(var colIx=0;colIx<this.TotalSize.x;++colIx){if(!this.Cols[colIx]){max_width=Infinity;break}var w=this.Cols[colIx].width;if(colIx<fixed_cols_total){fixed_width+=w}else{min_width=Math.max(min_width,w)}max_width+=w}min_width+=fixed_width;this.fixed_width=fixed_width;this.limits={min_width:min_width,max_width:max_width,min_height:min_height,max_height:max_height};this.PageBinder.MinWidth=min_width;this.PageBinder.MinHeight=min_height;this.PageBinder.Limits=this.limits;this.PageBinder.SizeToData=this.sizetodata};Qva.Mgr.grid.prototype._LoadCells=function(lineMap,colMap){if(lineMap.count===0||colMap.count===0){return false}var start_rix=lineMap.start;var end_rix=start_rix+lineMap.count-1;var start_cix=colMap.start;var end_cix=Math.min(start_cix+colMap.count-1,this.TotalSize.x-1);var part=lineMap.part;var that=this;function load(cix,rix){if(part.Lines[rix]&&part.Lines[rix][cix]){return false}that.PageBinder.PartialLoad("Document."+that.ObjectId,{x:Math.floor(cix/that.ChunkSize.x)*that.ChunkSize.x,y:Math.floor(rix/that.ChunkSize.y)*that.ChunkSize.y});return true}if(load(start_cix,start_rix)){return true}if(load(start_cix,end_rix)){return true}if(load(end_cix,start_rix)){return true}if(load(end_cix,end_rix)){return true}for(var rix=start_rix+40;rix<end_rix;++rix){for(var cix=start_cix+40;cix<end_cix;++cix){if(load(cix,rix)){return true}}}return false};Qva.Mgr.grid.prototype._PaintCell_Borders=function(new_part,div,rix,cix,rowspan,colspan){var inner_top=0;for(var inner_y=0;inner_y<rowspan;++inner_y){var inner_left=0;for(var inner_x=0;inner_x<colspan;++inner_x){var inner_cell=new_part.getCell(rix+inner_y,cix+inner_x);if(!inner_cell){continue}var inner_width=new_part.getWidth(cix+inner_x);var inner_height=new_part.getHeight(rix+inner_y);var border_div=document.createElement("div");border_div.style.position="absolute";if(inner_x==0){var left_cell=new_part.getCell(rix+inner_y,cix+inner_x-1);if(left_cell){inner_width-=this._MakeBorder(border_div,inner_cell,left_cell,"Left","Right",function(w){return Math.ceil(w/2)-1})}else{if(new_part.left_border){inner_width-=this._MakeBorder(border_div,inner_cell,inner_cell,"Left","Left",function(w){return w})}}}if(inner_x==colspan-1){var right_cell=new_part.getCell(rix+inner_y,cix+inner_x+1);if(right_cell){inner_width-=this._MakeBorder(border_div,inner_cell,right_cell,"Right","Left",function(w){return Math.floor(w/2)+1})}else{if(new_part.right_border){inner_width-=this._MakeBorder(border_div,inner_cell,inner_cell,"Right","Right",function(w){return w})}}}if(inner_y==0){var top_cell=new_part.getCell(rix+inner_y-1,cix+inner_x);if(top_cell){inner_height-=this._MakeBorder(border_div,inner_cell,top_cell,"Top","Bottom",function(w){return Math.ceil(w/2)-1})}else{if(new_part.top_border){inner_height-=this._MakeBorder(border_div,inner_cell,inner_cell,"Top","Top",function(w){return w})}}}if(inner_y==rowspan-1){var bottom_cell=new_part.getCell(rix+inner_y+1,cix+inner_x);if(bottom_cell){inner_height-=this._MakeBorder(border_div,inner_cell,bottom_cell,"Bottom","Top",function(w){return Math.floor(w/2)+1})}else{if(new_part.bottom_border){inner_height-=this._MakeBorder(border_div,inner_cell,inner_cell,"Bottom","Bottom",function(w){return w})}}}border_div.style.left=inner_left+"px";border_div.style.top=inner_top+"px";border_div.style.width=inner_width>=0?inner_width+"px":"0px";border_div.style.height=inner_height>=0?inner_height+"px":"0px";border_div.position=div.position;border_div.binderid=this.binderid;border_div.ObjectId=this.ObjectId;border_div.setAttribute("unselectable","on");div.insertBefore(border_div,div.firstChild);inner_left+=new_part.getWidth(cix+inner_x)}if(!div.getAttribute("mrect")){inner_top+=new_part.getHeight(rix+inner_y)}}};Qva.Mgr.grid.prototype._PaintCell_Content=function(cell,left,top,width,height,max_height,rowspan,rix,cix,position){var div=document.createElement("div"),hasInp=false;div.xx=cix;div.yy=rix;if(cell.title==null){cell.title=""}div.title=cell.title;div.style.cssText=this._SetCellStyle(cell,cell.state!=null,false);div.style.cursor="pointer";div.style.position="absolute";div.style.overflow="hidden";div.style.left=left>=0?left+"px":"0px";div.style.top=top>=0?top+"px":"0px";div.style.width=width>=0?width+"px":"0px";div.style.height=height>=0?height+"px":"0px";div.binderid=this.binderid;div.ObjectId=this.ObjectId;if(!this.readOnly){if(cell.dragable){var _this=this;Qva.Events.AddDragEvent(div,function(event){var colMap=_this.makeColMap();return Qva.DragDrop.reorder.mouseDown(event,colMap,_this.DropZones)},Qva.DragDrop.reorder.mouseMove,Qva.DragDrop.reorder.mouseUp)}if(cell.selecttype==null){var action=cell.action;if(action){Qva.Events.setClickElem(div,"gridclick");div.pos=cix+":"+rix;div.action=action}}else{if(cell.selecttype=="input"){div.value=cell.intval;div.inputname=this.Name+".V"+rix;$(div).addClass("QvInput");Qva.Events.setClickElem(div,"input")}else{Qva.Events.setClickElem(div,"select");if(cell.selecttype=="multi"){div.multiselect=true}else{div.singleselect=true}div.selectsource=cell.selectsource}}}$(div).data("cell",cell);width=Math.max(width-4,0);var inner_div=document.createElement("div");div.fixedWidth=width;if(height>max_height&&!this.isCurrentSelections&&!cell.vertical){this.scroll_fix_divs.push({offset:top,max:(height-max_height),div:inner_div});initTransition(inner_div,"cubic-bezier(0, 0.3, 0.6, 1)");inner_div.style.position="relative";height=max_height}div.forceFixed=false;if(cix>=this.fixed_cols_left&&cix<=(this.TotalSize.x-this.fixed_cols_right)){var max_width=this.body_width-2*parseInt(this.Element.parentNode.parentNode.style.borderLeftWidth);if(width>max_width){width=max_width;div.fixedWidth=max_width;div.forceFixed=true}}var style=this.Style[cell.style];var innerDivTextPadding=2;inner_div.style.padding="0 "+innerDivTextPadding+"px";inner_div.style.width=width+"px";inner_div.style.height=height+"px";inner_div.className+=" injected";div.appendChild(inner_div);if(style){var table_cell_div=document.createElement("div");table_cell_div.style.width=width+"px";inner_div.appendChild(table_cell_div);if(cell.vertical){var vertical_position=cell.label?style.LabelVertAdjust:style.VertAdjust;table_cell_div.style.width=Math.min(height,width)+"px";table_cell_div.className="QvVertical";var assumedBorderHeight=0,inner_height=height-assumedBorderHeight;if(Qva.userAgentDetector.get("msie")){inner_div.style.letterSpacing="-.05em"}table_cell_div.style.width=(inner_height-innerDivTextPadding*2)+"px";table_cell_div.style.left=-1*Math.ceil(inner_height/2-width/2)+"px";table_cell_div.style.top=Math.ceil((inner_height-this.TextHeight)/2)+"px";if(vertical_position==="top"){table_cell_div.style.textAlign="right"}else{if(vertical_position==="bottom"){table_cell_div.style.textAlign="left"}else{table_cell_div.style.textAlign="center"}}}inner_div=table_cell_div}height-=1;var style=this.Style[cell.style];var textalign=cell.label?style.LabelAdjust:(cell.isnum?style.NumAdjust:style.TextAdjust);var stretchmode=style.StretchMode;var targetTextElem=null,usedarkicons=Qva.generalHelper.detectDarkColor(style.Color,style.BgColorRGB);for(var iicons=0;iicons<cell.icons.length;iicons++){var icon=cell.icons[iicons];var iconelem=this._appendCellIcon(icon,cix,rix+(position==="Body"?this.Headers.Lines.length:0),stretchmode,textalign,width,height);if(!usedarkicons&&iconelem.children[0]){iconelem.children[0].className=iconelem.children[0].className+"-light"}iconelem.style.maxWidth=width>=0?width+"px":"0px";iconelem.style.maxHeight=height>=0?height+"px":"0px";if(cell.vertical){iconelem.className+=" QvVerticalIcon";if(iconelem.children[0]){iconelem.children[0].style.top=0}if(iconelem.nodeName.toLowerCase()!=="img"){iconelem.style.height=this.TextHeight+"px";iconelem.style.maxHeight=this.TextHeight+"px"}}inner_div.appendChild(iconelem)}if(cell.state){div.className="Qv"+cell.state}if(cell.val){inner_div.setAttribute("unselectable","on");inner_div.title=cell.title;if(cell.url){var link=document.createElement("a");link.style.display="inline-block";link.href=cell.url;link.target="_blank";targetTextElem=link;inner_div.appendChild(link);div.onmousedown=Qva.CancelAction;div.onmousemove=Qva.CancelAction;if(Qva.userAgentDetector.get("touchEnabled")){div.ontouchstart=Qva.CancelAction;div.ontouchmove=Qva.CancelAction;div.onmspointerdown=Qva.CancelAction;div.onpointerdown=Qva.CancelAction}inner_div.onclick=Qva.CancelAction;inner_div.onmousedown=Qva.CancelAction;inner_div.onmousemove=Qva.CancelAction;if(Qva.userAgentDetector.get("touchEnabled")){inner_div.ontouchstart=Qva.CancelAction;inner_div.ontouchmove=Qva.CancelAction;inner_div.onmspointerdown=Qva.CancelAction;inner_div.onpointerdown=Qva.CancelAction}inner_div.style.cursor="Default";var link=document.createElement("a");link.href=cell.url;link.target="_blank";link.appendChild(div);link.style.position="absolute";div=link}else{if(cell.icons.length>0){var d=document.createElement("div");d.style.overflow="hidden";d.position=div.position;d.binderid=this.binderid;d.ObjectId=this.ObjectId;d.title=cell.title;inner_div.appendChild(d);targetTextElem=d}else{targetTextElem=inner_div}}if(Qva.userAgentDetector.get("touchEnabled")&&hasInp){inp.style.display="none"}if(targetTextElem&&rowspan===1&&cell.rowspan===1){if(this.TotalSize.x==1&&this.TotalSize.y==1){div.style.overflow=""}inner_div.style.whiteSpace="pre";inner_div.style.wordWrap="normal";inner_div.style.overflow="hidden";$(targetTextElem).html(Qva.ConvertToBr(cell.val))}else{if(targetTextElem){targetTextElem=$(targetTextElem);var cellText=cell.val.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\r?\n|\r|\&#xA;|\&#xD;/g,"<br />");targetTextElem.html(cellText);if(!cell.vertical){targetTextElem.addClass("Qv_multiline");targetTextElem.addClass("Qv_"+(cell.label?style.LabelVertAdjust:style.VertAdjust));targetTextElem.data("text",cellText)}}}if(targetTextElem&&cell.selecttype=="input"){$(targetTextElem).addClass("QvInputText")}if(targetTextElem&&Qva.userAgentDetector.get("msie")){$(targetTextElem).disableSelection().attr("unselectable","on")}}inner_div.position=div.position;inner_div.binderid=this.binderid;inner_div.ObjectId=this.ObjectId;return div};Qva.Mgr.grid.prototype.getCurrentScroll=function(){return this.scroll_obj?this.scroll_obj.getCurrentScroll():{x:0,y:0}};Qva.Mgr.grid.prototype.makeColMap=function(){var cix,left,right,width,middle,fixed_cols_total=this.fixed_cols_left+this.fixed_cols_right,scroll=this.getCurrentScroll().x,colMap={};left=0;for(cix=0;cix<this.fixed_cols_left;++cix){width=this._getColWidth(cix);colMap[cix]={xPos:left,width:width,middle:0.5};left+=width}left=this.fixed_cols_left_width+this.body_width;for(cix=this.fixed_cols_left;cix<this.fixed_cols_left+this.fixed_cols_right;++cix){width=this._getColWidth(cix);colMap[cix]={xPos:left,width:width,middle:0.5};left+=width}left=this.fixed_cols_left_width;right=this.fixed_cols_left_width+this.body_width;for(cix=fixed_cols_total;left<right;++cix){width=this._getColWidth(cix);if(width<scroll){scroll-=width}else{middle=0.5;if(scroll>0){width-=scroll;scroll=0;middle=0}if(left+width>right){width=right-left;middle=middle===0?0.5:1}colMap[cix]={xPos:left,width:width,middle:middle};left+=width}}return colMap};Qva.Mgr.grid.prototype._CreatePage=function(contentPart,page,part){var part_x2=contentPart.pages[page]=document.createElement("div");part_x2.style.position="absolute";var extra_rows=(this.isMultiBox||this.isCurrentSelections)&&this.ExtraRows?this.ExtraRows:0;var pageheight=(extra_rows+this.pagesizeRows)*this.Body.rowHeight;part_x2.style.height=contentPart.y==1?(pageheight+"px"):"100%";if(contentPart.x==1||contentPart.y==1){initTransition(part_x2,"cubic-bezier(0, 0.3, 0.6, 1)")}contentPart.element.appendChild(part_x2);var scrollpos=this.getCurrentScroll();var topOffset=page*pageheight-scrollpos.y;translate(contentPart.pages[page],0,topOffset);$(contentPart.pages[page]).attr("page",page)};Qva.Mgr.grid.prototype._PostPaintCells2=function(content,x_offset,y_offset,rows,columns,isMrect){if(columns.count===0&&rows.count===0){return}var div,rix,cix,left,part=rows.part,position=part.position,pageSize,pageSizeStd;if(content.y===1){pageSize=rows.count<this.pagesizeRows?rows.count:this.pagesizeRows;pageSizeStd=this.pagesizeRows}else{pageSize=rows.count;pageSizeStd=rows.count}var new_part=(function(grid){function getLine(rix){return part.Lines[rix]}return{getCell:function(rix,cix){var line=getLine(rix);return line&&line[cix]},getWidth:function(cix){return grid._getColWidth(cix)},getHeight:function(rix){if(grid.isCurrentSelections&&this.getCell(rix,1)){return rows.getHeight(rix)*this.getCell(rix,1).rowspan}if(grid.isMultiBox&&this.getCell(rix,0)){return rows.getHeight(rix)*this.getCell(rix,0).rowspan}return rows.getHeight(rix)},left_border:false,right_border:false,top_border:(position==="Foot"),bottom_border:(position==="Head")}}(this));var start_rix=rows.start;var end_rix=start_rix+rows.count;var start_cix=columns.start;var end_cix=start_cix+columns.count;var topAbs=y_offset;var requestedMoreColumns=false;for(rix=start_rix;rix<end_rix;topAbs+=new_part.getHeight(rix),++rix){var line=part.Lines[rix];var page=pageSize>0?(Math.floor((rix)/pageSizeStd)):0;if(!content.pages[page]){this._CreatePage(content,page,part)}var top=topAbs-page*pageSizeStd*this.Body.rowHeight;left=x_offset;for(cix=start_cix;cix<end_cix;left+=new_part.getWidth(cix),++cix){var fixed_cols_total=this.fixed_cols_left+this.fixed_cols_right;if(!line){if(position!=="Body"){continue}this.PageBinder.PartialLoad("Document."+this.ObjectId,{x:Math.floor(cix/this.ChunkSize.x)*this.ChunkSize.x,y:Math.floor(rix/this.ChunkSize.y)*this.ChunkSize.y});return true}if(!line[cix]){if(!requestedMoreColumns){this.PageBinder.PartialLoad("Document."+this.ObjectId,{x:Math.floor(cix/this.ChunkSize.x)*this.ChunkSize.x,y:Math.floor(rix/this.ChunkSize.y)*this.ChunkSize.y});requestedMoreColumns=true}continue}var cell=new_part.getCell(rix,cix);Assert(line[cix]===cell);var colspan=1;var rowspan=1;var width=new_part.getWidth(cix);var height=new_part.getHeight(rix);var prev;if(cix>start_cix&&new_part.getCell(rix,cix-1)&&(rect=new_part.getCell(rix,cix-1).multirect)&&rect.x+1<rect.width){continue}if(rix>start_rix&&new_part.getCell(rix-1,cix)&&(rect=new_part.getCell(rix-1,cix).multirect)&&rect.y+1<rect.height){continue}if(cell.multirect){if(cell.multirect.x>0&&cix>start_cix){continue}var m_cix=cix-cell.multirect.x;var m_rix=rix-cell.multirect.y;if(!part.Painted[m_rix]){part.Painted[m_rix]=[]}var pline=part.Painted[m_rix];var painted=pline[m_cix];var mrect=painted&&painted.multirect;if(mrect){var expand_left=mrect.left>0&&new_part.getCell(rix,m_cix+mrect.left-1);var expand_top=mrect.top>0&&new_part.getCell(m_rix+mrect.top-1,cix);var expand_right=mrect.right<cell.multirect.width&&new_part.getCell(rix,m_cix+mrect.right+1);var expand_bottom=mrect.bottom<cell.multirect.height&&new_part.getCell(m_rix+mrect.bottom+1,cix);if(!expand_left&&!expand_top&&!expand_right&&!expand_bottom&&mrect.top===cell.multirect.top&&mrect.left===cell.multirect.left){continue}}var _cix=cix;var _rix=rix;var _left=left;var _top=top;for(;m_cix<_cix&&new_part.getCell(_rix,_cix-1);++colspan,--_cix){var w=new_part.getWidth(_cix-1);width+=w;_left-=w}for(;m_rix<_rix&&new_part.getCell(_rix-1,_cix);++rowspan,--_rix){if(isMrect){height=new_part.getHeight(_rix-1);_top=rix*height}else{var h=new_part.getHeight(_rix-1);height+=h;_top-=h}}for(;_cix-m_cix+colspan<cell.multirect.width&&new_part.getCell(_rix,_cix+colspan);++colspan){width+=new_part.getWidth(_cix+colspan)}for(;_rix-m_rix+rowspan<cell.multirect.height&&new_part.getCell(_rix+rowspan,_cix);++rowspan){height+=new_part.getHeight(_rix+rowspan)}var rect={left:_cix-m_cix,top:_rix-m_rix,right:_cix-m_cix+colspan,bottom:_rix-m_rix+rowspan};if(painted){if(mrect){if(mrect.left<=rect.left&&mrect.top<=rect.top&&mrect.right>=rect.right&&mrect.bottom>=rect.bottom&&mrect.top===cell.multirect.top&&mrect.top===cell.multirect.top&&mrect.left===cell.multirect.left){continue}}$(pline[m_cix]).remove();for(var ix=0;ix<this.scroll_fix_divs.length;++ix){if(this.scroll_fix_divs[ix].div.parentNode===pline[m_cix]){this.scroll_fix_divs.splice(ix,1);break}}}div=pline[m_cix]=this._PaintCell_Content(cell,_left,_top,width,height,rows.height,rowspan,rix,cix,position);div.position=cix+":"+rix+":"+position;div.multirect=rect;if(isMrect){div.setAttribute("mrect","yes")}this._PaintCell_Borders(new_part,div.tagName==="A"?div.firstChild:div,_rix,_cix,rowspan,colspan)}else{if(!part.Painted[rix]){part.Painted[rix]=[]}var pline=part.Painted[rix];if(pline[cix]){continue}div=pline[cix]=this._PaintCell_Content(cell,left,top,width,height,rows.height,rowspan,rix,cix,position);div.position=cix+":"+rix+":"+position;this._PaintCell_Borders(new_part,div.tagName==="A"?div.firstChild:div,rix,cix,rowspan,colspan)}if(cix<this.fixed_cols_left){div.setAttribute("fixed","true")}if(div.forceFixed===true){content.pages[page].forceFixed=true;var newWidth=div.fixedWidth;if(content.pages[page].forceFixedValue+div.fixedWidth>parseInt(div.style.width)+parseInt(div.style.left)){newWidth=div.fixedWidth-(content.pages[page].forceFixedValue+div.fixedWidth-parseInt(div.style.width))}var maxLeft=content.pages[page].forceFixedValue-parseInt(div.style.left);if(isNaN(maxLeft)||maxLeft<0){maxLeft=0}var $injected=$(div).children(".injected");var $injectedChild=$injected.children().first();$injected.css({position:"absolute",left:maxLeft+"px",width:newWidth+"px"});$injectedChild.css({width:newWidth+"px"})}else{if(content.pages[page].forceFixed!==true){content.pages[page].forceFixed=false}}if(content.pages){content.pages[page].appendChild(div)}div.setAttribute("unselectable","on")}}};Qva.Mgr.grid.prototype._CheckSize=function(ignorewidth,ignoreheight){var initContainer=false,i=0,j=0,xed=0,children=[],newWidth=0,scrollWidth=false,that=this;var r,changed,height;var inContainerAttr=$(this.Element).attr("inContainer");if(inContainerAttr!=="true"&&inContainerAttr!=="false"){$.each($(this.Element).parents(".QvFrame"),function(ix,ele){if($(ele).attr("objtype")&&$(ele).attr("objtype").toLowerCase()==="container"){initContainer=true;$(that.Element).attr("inContainer","true");$(that.Element).closest(".QvFrame").css("overflow","hidden")}});if($(that.Element).attr("inContainer")!=="true"){$(that.Element).attr("inContainer","false")}}var width=this.PageBinder.GetMaxClientWidth();if(this.fixed_cols_left){if(this.fixed_cols_left>0){$(this.Element).attr("fixed_cols_left",this.fixed_cols_left)}else{if($(this.Element).attr("fixed_cols_left")){this.fixed_cols_left=parseInt($(this.Element).attr("fixed_cols_left"))}}}if(this.fixed_cols_left&&initContainer&&this.PageBinder.FullWidth>width){children=$(this.Element).find(".QvColumnResizer").siblings();if(children.length>0){if($(this.Element).attr("fixedColWidth")){$(this.Element).attr("fixedColWidth",0)}while(children[j]&&(i<this.fixed_cols_left||newWidth<width)){if(children[j].className!=="QvColumnResizer"){newWidth+=children[j].offsetWidth;if(i<this.fixed_cols_left){var fixedWidth=0;if($(this.Element).attr("fixedColWidth")){fixedWidth=parseInt($(this.Element).attr("fixedColWidth"))+children[j].offsetWidth}else{fixedWidth=children[j].offsetWidth}$(this.Element).attr("fixedColWidth",fixedWidth)}i+=1}else{if(!children||!children[j]){i+=1}}j+=1}}if(newWidth>width){scrollWidth=width}if($(this.Element).find(".Qv_ScrollbarVerticalDivider")[0]&&scrollWidth){scrollWidth-=parseInt($(this.Element).find(".Qv_ScrollbarVerticalDivider").siblings(".Qv_ScrollbarBackground").width())}}height=this.PageBinder.GetContentMaxHeight();if(this.LastSize&&this.LastSize.width==width&&this.LastSize.height==height&&(($(this.Element).attr("inContainer")!=="true")||($(this.Element).attr("inContainer")==="true"&&$(this.Element).attr("fixedColWidth")&&parseInt($(this.Element).attr("fixedColWidth"))<=width)||!$(this.Element).attr("fixedColWidth")||this.scrolling===1)){r=this.LastSize.r;changed=false}else{r=this._UpdateSize(width,height,scrollWidth);this.LastSize={width:width,height:height,r:r};changed=true}var dx=r.dx;var dy=r.dy;this.Element.style.width=(this.PageBinder.GetMaxClientWidth()-dx)+"px";if(this.Element.className.indexOf("QvListbox")==-1||($(this.Element).find(".Qv_ScrollbarHorizontalDivider")&&$(this.Element).find(".Qv_ScrollbarHorizontalDivider").css("display")!="none")){this.Element.style.height=(this.PageBinder.GetContentMaxHeight()-dy)+"px"}this.PageBinder.SetObjectWidth(dx);this.PageBinder.SetObjectHeight(dy,null,true);return{width:r.width,height:r.height,changed:changed}};function get_scrollbars_needed(screen,limits,scrollbar_width){if(Math.max(screen.width,limits.min_width)>=limits.max_width&&Math.max(screen.height,limits.min_height)>=limits.max_height){return{horizontal:false,vertical:false}}else{if(Math.max(screen.width-scrollbar_width,limits.min_width)>=limits.max_width){return{horizontal:false,vertical:true}}else{if(Math.max(screen.height-scrollbar_width,limits.min_height)>=limits.max_height){return{horizontal:true,vertical:false}}else{return{horizontal:true,vertical:true}}}}}function get_new_size(screen,limits,scrollbar_padding,size_to_data){var new_size={};new_size.width=Math.max(screen.width-scrollbar_padding.x,limits.min_width);new_size.height=Math.max(screen.height-scrollbar_padding.y,limits.min_height);if(size_to_data){new_size.width=Math.min(new_size.width,limits.max_width);new_size.height=Math.min(new_size.height,limits.max_height)}new_size.dx=screen.width-(new_size.width+scrollbar_padding.x);new_size.dy=screen.height-(new_size.height+scrollbar_padding.y);return new_size}Qva.Mgr.grid.prototype._UpdateSize=function(width,height,scrollWidth){var props=this.ScrollProperties;if(this.limits.min_width>width&&this.PageBinder.Maximized){this.limits.min_width=0;this.fixed_cols_left=0;this.fixed_cols_right=0;this.overrideFixedColumnsFromServer=true}if(this.ExtraRows){this.limits.max_height+=this.ExtraRows*this.TextHeight}var limits=this.limits;var screen={width:width,height:height};var scrollbars_needed=get_scrollbars_needed(screen,limits,props.width);var scrollbar_padding={x:scrollbars_needed.vertical?props.width:0,y:scrollbars_needed.horizontal?props.width:0};var is_empty=this.TotalSize.x===0&&this.TotalSize.y===0;var new_size=get_new_size(screen,limits,scrollbar_padding,this.sizetodata&&!is_empty);this._UpdateBodySize(new_size.width,new_size.height);if(scrollWidth){this._UpdateScrollbars(scrollbars_needed,scrollWidth,new_size.height)}else{this._UpdateScrollbars(scrollbars_needed,new_size.width,new_size.height)}this._UpdateMaxVisibleRows();this._UpdateMaxVisibleCols();this._UpdateFixedRowsAndCols();return new_size};Qva.Mgr.grid.prototype._UpdateFixedRowsAndCols=function(){var that=this;this.left_cols={start:0,count:this.fixed_cols_left};this.right_cols={start:this.fixed_cols_left,count:this.fixed_cols_right};this.top_rows={start:0,count:this.Headers.Lines.length,part:this.Headers,height:this.Headers.height,getHeight:function(rix){if(that.Headers.Lines[rix][0].vertical){return that.Headers.Heights[rix]}return that.Headers.Lines[rix][0].rowspan*that.TextHeight}};this.bottom_rows={start:0,count:this.Footers.Lines.length,part:this.Footers,height:this.Footers.height,getHeight:function(){return that.Footers.rowHeight}}};Qva.Mgr.grid.prototype._UpdateBodySize=function(width,height){var fixed_cols_left=this.fixed_cols_left,fixed_cols_right=this.fixed_cols_right,fixed_cols_total=fixed_cols_left+fixed_cols_right,fixed_cols_left_width=0,fixed_cols_right_width=0,cix;for(cix=0;cix<fixed_cols_left;++cix){if(this.Cols[cix]){fixed_cols_left_width+=this.Cols[cix].width}}for(;cix<fixed_cols_total;++cix){fixed_cols_right_width+=this.Cols[cix].width}var fixed_cols_total_width=fixed_cols_left_width+fixed_cols_right_width;this.fixed_cols_left_width=fixed_cols_left_width;this.fixed_cols_right_width=fixed_cols_right_width;this.body_width=width-fixed_cols_total_width;this.body_height=height-this.Headers.height-this.Footers.height};Qva.Mgr.grid.prototype._UpdateScrollbars=function(scrollbars_needed,width,height){var fullwidth=0,fallback=false;if(this.PageBinder.FullWidth!=undefined){fullwidth=this.PageBinder.FullWidth-this.fixed_cols_left_width}else{}var props=this.ScrollProperties,fixed_cols_total=this.fixed_cols_left+this.fixed_cols_right;if(scrollbars_needed.vertical){var body_height=this.body_height;var y_max=this.TotalSize.y*this.Body.rowHeight;if(this.ExtraRows){y_max+=this.ExtraRows*this.TextHeight}this.YScroll.Set(width,this.Headers.height,body_height,y_max,height,width,0);this.y_max_scroll=Math.max(0,y_max-body_height)}else{this.y_max_scroll=0;this.YScroll.Hide()}if(scrollbars_needed.horizontal&&this.body_width>50){var body_width=this.body_width;if(fallback){var x_max=0;for(var cix=fixed_cols_total;cix<this.TotalSize.x&&this.Cols[cix];++cix){x_max+=this.Cols[cix].width}x_max+=(this.TotalSize.x-cix)*this.Cols[this.Cols.length-1].width;this.XScroll.Set(this.fixed_cols_left_width,height,body_width,x_max,width+props.width,0,height);this.x_max_scroll=Math.max(0,x_max-body_width)}else{this.XScroll.Set(this.fixed_cols_left_width,height,body_width,fullwidth,width+props.width,0,height);this.x_max_scroll=Math.max(0,fullwidth-body_width)}}else{this.x_max_scroll=0;this.XScroll.Hide()}Qva.Events.SetTouchAction(this.Element,scrollbars_needed.horizontal,scrollbars_needed.vertical)};Qva.Mgr.grid.prototype._UpdateMaxVisibleRows=function(){if((this.isMultiBox||this.isCurrentSelections)&&this.ExtraRows){this.max_visible_rows=this.TotalSize.y}else{if(this.y_max_scroll>0){this.max_visible_rows=Math.ceil(this.body_height/this.Body.rowHeight)}else{this.max_visible_rows=this.TotalSize.y}}};Qva.Mgr.grid.prototype._UpdateMaxVisibleCols=function(){if(this.x_max_scroll==0){this.max_visible_cols=this.TotalSize.x;return}var max_visible_cols=0;var width=0;var start=0;var count=0;for(var i=0;i<this.Cols.length;++i){width+=this._getColWidth(i);++count;if(count>max_visible_cols){max_visible_cols=count}while(width>this.body_width){width-=this._getColWidth(start);++start;--count}}this.max_visible_cols=max_visible_cols};Qva.Mgr.grid.prototype._getColWidth=function(cix){return this.Cols.length>0?(this.Cols[cix]||this.Cols[this.Cols.length-1]).width:10};Qva.Mgr.grid.prototype.IsVisible=function(){return this.Element.style.display!=="none"};Qva.Mgr.grid.prototype.PostPaint=function(){if(!this.IsVisible()){return}if(this.ScrollPosition.y===0&&(this.isCurrentSelections||this.isMultiBox)){this.ExtraRows=0;for(var i=0;i<this.TotalSize.y;++i){if(this.isMultiBox){this.ExtraRows+=(this.Body.Lines[i][0].rowspan-1)}if(this.isCurrentSelections&&this.Body.Lines[i][1]){var fontFamily=this.Element.style.fontFamily;var fontSize=this.Element.style.fontSize;var fontWeight=this.Element.style.fontWeight;var extra_rows_needed=(function calcExtraRows(text,width,rowHeight){if(text===""){return 1}return Math.ceil(Qva.MeasureText(text,fontFamily,fontSize,fontWeight,width).height/rowHeight)})(this.Body.Lines[i][1].val,this.Cols[1].width,this.Body.rowHeight)-1;if(extra_rows_needed===0){continue}this.ExtraRows+=extra_rows_needed;this.Body.Lines[i][1].rowspan=(extra_rows_needed+1);this.Body.Lines[i][0].rowspan=(extra_rows_needed+1)}}}var size=this._CheckSize();if(this.TotalSize.x===0&&this.TotalSize.y===0){var emptyContent=document.createElement("div");this.Element.replaceChild(emptyContent,this.Content);this.Content=emptyContent;return}var width=size.width;var height=size.height;var changed=size.changed;if(changed){if(this.scroll_obj){this.scroll_obj.Remove()}this.scroll_obj=null}this._UpdateMaxVisibleCols();var scroll=this._GetGridScroll();var body=this._GetCurrentBody(scroll);var body_cols={start:body.col_start,count:body.col_count};var that=this;var body_rows={start:body.row_start,count:body.row_count,part:this.Body,height:this.body_height,getHeight:function(){return that.Body.rowHeight}};if(this._LoadCells(body_rows,this.left_cols)){if(changed){this.LastSize=null}return}if(this._LoadCells(body_rows,body_cols)){if(changed){this.LastSize=null}return}this.scrolling=0;if(changed){var content=this._CreateContent(width,height);this.Body.Painted=[];this.Headers.Painted=[];this.Footers.Painted=[];this.scroll_fix_divs=[];this.ColumnResizers=[];this._PaintFixedCells(height);this._PaintScrollCells(body,body_cols,body_rows,height);Assert(!this.scroll_obj);this._makeScrollObj(make_bodyscroll(this));var touch_scroll=this.getCurrentScroll();this.scroll_obj.setPosition(-touch_scroll.x,-touch_scroll.y);this.scroll_obj.setTransitionTime("0ms");this._addMouseScroll();this.Element.replaceChild(content,this.Content);Qva.RemoveHtml(this.Content);this.Content=content;$(content).closest(".QvContent").css({overflow:"visible"});size=this._CheckSize();if(this.ScrollPosition.x!==0||this.ScrollPosition.y!==0){if(this.ScrollPosition.x!==0&&this.XScroll.actions){this.XScroll.actions.step(-this.ScrollPosition.x)}if(this.ScrollPosition.y!==0&&this.YScroll.actions){this.YScroll.actions.step(-this.ScrollPosition.y)}this.PageBinder.QueuePostPaintMessage(this)}else{this.PageBinder.SetScrollPos(this.ScrollPosition)}}else{this._PaintScrollCells(body,body_cols,body_rows,height);var touch_scroll=this.getCurrentScroll();this.setPosition_scroll_fix_divs(-touch_scroll.x,-touch_scroll.y);if(this.ScrollPosition&&(this.ScrollPosition.x!==scroll.col||this.ScrollPosition.y!==scroll.row)){if(this.SendPosition){this.SendPosition=clearTimeout(this.SendPosition)}var ObjectBinder=this.PageBinder;var ScrollPosition={x:scroll.col,y:scroll.row};this.SendPosition=setTimeout(function(){if(!ObjectBinder.GetEnabled()){return}ObjectBinder.SetScrollPos(ScrollPosition)},500)}}Qva.SetEllipsisOnMultiLineElement(this.Content)};Qva.Mgr.grid.prototype._CleanUpContentParts=function(){for(var part in this.parts){if(this.parts[part].pages){for(var page in this.parts[part].pages){Qva.RemoveHtml(this.parts[part].pages[page])}}else{Qva.RemoveHtml(this.parts[part])}}};Qva.Mgr.grid.prototype._RemoveInvisibleRows=function(row){var scroll=this._GetGridScroll(),min=Math.max(0,scroll.row-this.max_visible_rows),max=Math.min(scroll.row+2*this.max_visible_rows,this.TotalSize.y);for(var rix in row.Painted){if(rix<min||rix>max){for(var cix in row.Painted[rix]){$(row.Painted[rix][cix]).remove()}delete row.Painted[rix]}}};Qva.Mgr.grid.prototype._CreateContent=function(width,height){var content=document.createElement("div");content.style.position="relative";content.style.overflow="hidden";content.style.width=width+"px";content.style.height=height+"px";var part_widths=[this.fixed_cols_left_width,this.body_width,this.fixed_cols_right_width];var part_heights=[this.Headers.height,this.body_height,this.Footers.height];if(this.parts){this._CleanUpContentParts()}var parts=this.parts={};var left=0;var maxRows=Math.floor(Qva.userAgentDetector.get("maxHeight")/this.Body.rowHeight);this.pagesizeRows=Math.min(this.TotalSize.y+(this.ExtraRows?this.ExtraRows:0),maxRows);this.buffert=0;this.added=0;for(var x=0;x<part_widths.length;++x){var part_width=part_widths[x];if(part_width<0){part_width=0}var top=0;for(var y=0;y<part_heights.length;++y){var part=parts[x+":"+y]={};var part_height=part_heights[y];var part_x=document.createElement("div");part_x.style.position="absolute";part_x.style.overflow="hidden";part_x.style.left=left+"px";part_x.style.top=top+"px";part_x.style.width=part_width+"px";part_x.style.height=part_height+"px";part.element=part_x;part.x=x;part.y=y;part.pages={};this._CreatePage(part,0);content.appendChild(part_x);top+=part_height}left+=part_width}return content};Qva.Mgr.grid.prototype._PaintFixedCells=function(height){this._PostPaintCells2(this.parts["0:0"],0,0,this.top_rows,this.left_cols);this._PostPaintCells2(this.parts["0:2"],0,0,this.bottom_rows,this.left_cols);this._PostPaintCells2(this.parts["2:0"],0,0,this.top_rows,this.right_cols);this._PostPaintCells2(this.parts["2:2"],0,0,this.bottom_rows,this.right_cols);this._AddColumnResizers(0,height,0,this.left_cols);this._AddColumnResizers(2,height,0,this.right_cols)};Qva.Mgr.grid.prototype._PaintScrollCells=function(body,body_cols,body_rows,height){this._PostPaintCells2(this.parts["0:1"],0,body.y_offset,body_rows,this.left_cols);this._PostPaintCells2(this.parts["2:1"],0,body.y_offset,body_rows,this.right_cols);this._PostPaintCells2(this.parts["1:0"],body.x_offset,0,this.top_rows,body_cols,true);this._PostPaintCells2(this.parts["1:2"],body.x_offset,0,this.bottom_rows,body_cols);this._PostPaintCells2(this.parts["1:1"],body.x_offset,body.y_offset,body_rows,body_cols);this._AddColumnResizers(1,height,body.x_offset,body_cols);this._RemoveInvisibleRows(body_rows.part)};Qva.Mgr.grid.prototype._AddColumnResizers=function(part_x,obj_height,left,columns){var start_cix=columns.start;var end_cix=start_cix+columns.count;var self=this;var top=Qva.GetAbsolutePageCoords(this.Element).y;function make_resizer_div(parent,cix,right,columnData,height){var colResizerDiv=document.createElement("div");colResizerDiv.className=(cix===end_cix-1)?"QvColumnResizer QvColumnResizerLast":"QvColumnResizer";colResizerDiv.style.height="100%";colResizerDiv.style.top="0px";colResizerDiv.style.zIndex=3;colResizerDiv.title="Resize column";colResizerDiv.columnData=columnData;colResizerDiv.style.left=right+"px";Qva.Events.AddDragEvent(colResizerDiv,Qva.DragDrop.resizeColumn.mouseDown,Qva.DragDrop.resizeColumn.mouseMove,Qva.DragDrop.resizeColumn.mouseUp,{cleanFunc:Qva.DragDrop.resizeColumn.cleanup});parent.appendChild(colResizerDiv);return colResizerDiv}for(cix=start_cix;cix<end_cix;left+=this._getColWidth(cix),++cix){var width=this._getColWidth(cix);var right=left+width;if(!this.Cols[cix]||!this.Cols[cix].allowresize||this.ColumnResizers[cix]){continue}var columnData={};columnData.top=top;columnData.height=obj_height;columnData.widthOuter=width;columnData.colIndex=cix;columnData.outerRightCoordinate=right;columnData.outerLeftCoordinate=columnData.outerRightCoordinate-columnData.widthOuter;for(el in this.parts[part_x+":0"].pages){make_resizer_div(this.parts[part_x+":0"].pages[el],cix,right,columnData,this.Headers.height)}for(el in this.parts[part_x+":1"].pages){make_resizer_div(this.parts[part_x+":1"].pages[el],cix,right,columnData,this.body_height)}for(el in this.parts[part_x+":2"].pages){make_resizer_div(this.parts[part_x+":2"].pages[el],cix,right,columnData,this.Footers.height)}this.ColumnResizers[cix]=true}};Qva.Mgr.grid.prototype._GetGridScroll=function(){var fixed_cols_total=this.fixed_cols_left+this.fixed_cols_right,touch_scroll=this.getCurrentScroll();var scroll_row;if((this.isMultiBox||this.isCurrentSelections)&&this.ExtraRows){scroll_row=0;var height=0;var preHeight=0;for(rix=0;rix<this.TotalSize.y;rix++){preHeight=height;height+=this.Body.Lines[rix][0].rowspan*this.TextHeight;if(touch_scroll.y>=preHeight&&touch_scroll.y<height){break}}scroll_row=rix}else{scroll_row=this.TotalSize.y===0?0:Math.floor(touch_scroll.y/this.Body.rowHeight);scroll_row=Math.max(0,Math.min(this.TotalSize.y-1,scroll_row))}var scroll_col=fixed_cols_total;while(true){touch_scroll.x-=this._getColWidth(scroll_col);if(touch_scroll.x<=0){break}++scroll_col}scroll_col=Math.max(0,Math.min(this.TotalSize.x-1,scroll_col));scroll_col-=fixed_cols_total;return{row:scroll_row,col:scroll_col,direction_y:touch_scroll.direction_y}};Qva.Mgr.grid.prototype._GetCurrentBody=function(scroll){var r_extra=1,c_extra=1,fixed_cols_total=this.fixed_cols_left+this.fixed_cols_right;var row_start=Math.max(0,scroll.row-r_extra);var row_end=Math.min(this.TotalSize.y,scroll.row+this.max_visible_rows+r_extra);if(this.Body.Painted&&scroll.direction_y!=undefined){if(scroll.direction_y==1&&!this.Body.Painted[Math.min(this.TotalSize.y,row_end+this.buffert*this.pagesizeRows)]){row_end=Math.min(this.TotalSize.y,row_end+(this.buffert+this.added)*this.pagesizeRows)}else{if(!this.Body.Painted[Math.max(0,row_start-this.buffert*this.pagesizeRows)]){row_start=Math.max(0,row_start-(this.buffert+this.added)*this.pagesizeRows)}}}var col_start=Math.max(fixed_cols_total,scroll.col+fixed_cols_total-c_extra);var col_end=Math.min(this.TotalSize.x,scroll.col+fixed_cols_total+this.max_visible_cols+c_extra);var row_count=row_end-row_start;if((this.isMultiBox||this.isCurrentSelections)&&this.ExtraRows){var y_offset=0;for(var rix=0;rix<row_start;rix++){y_offset+=this.Body.Lines[rix][0].rowspan*this.TextHeight}}else{var y_offset=row_start*this.Body.rowHeight}var col_count=col_end-col_start;var x_offset=0;for(var cix=fixed_cols_total;cix<col_start;++cix){x_offset+=this._getColWidth(cix)}return{x_offset:x_offset,row_start:row_start,row_count:row_count,y_offset:y_offset,col_start:col_start,col_count:col_count}};Qva.Mgr.grid.prototype._find_x_left=function(x){for(var cix=0;(cix<this.fixed_cols_left-1)&&(x>=this.Cols[cix].width);++cix){x-=this.Cols[cix].width}return{cix:cix,x:x,width:this.Cols[cix].width}};Qva.Mgr.grid.prototype._find_x_center=function(x){var fixed_cols_total=this.fixed_cols_left+this.fixed_cols_right;for(cix=fixed_cols_total;(cix<this.TotalSize.x-1)&&(x>=this._getColWidth(cix));++cix){x-=this._getColWidth(cix)}return{cix:cix,x:x,width:this._getColWidth(cix)}};Qva.Mgr.grid.prototype._find_x_right=function(x){var fixed_cols_total=this.fixed_cols_left+this.fixed_cols_right;for(cix=this.fixed_cols_left;(cix<fixed_cols_total-1)&&(x>=this.Cols[cix].width);++cix){x-=this.Cols[cix].width}return{cix:cix,x:x,width:this.Cols[cix].width}};Qva.Mgr.grid.prototype._find_y_top=function(y){var _;_.TODO();return{rix:rix,y:y,height:null}};Qva.Mgr.grid.prototype._find_y_center=function(y){var rix=Math.max(0,Math.min(this.TotalSize.y-1,Math.floor(y/this.Body.rowHeight)));y-=rix*this.Body.rowHeight;return{rix:rix,y:y,height:this.Body.rowHeight}};Qva.Mgr.grid.prototype._find_x_bottom=function(y){var _;_.TODO();return{rix:rix,y:y,height:null}};Qva.Mgr.grid.multiselect=function(target,mgr,f_close){this.f_close=f_close;this.mgr=mgr;var page=mgr.pagesizeRows>0?(Math.floor((target.yy)/mgr.pagesizeRows)):0;for(var y=0;y<3;++y){for(var x=0;x<3;++x){if(mgr.parts[x+":"+y].pages[page]==target.parentNode){this.part_x=x;this.part_y=y}}}this.selection={x:target.xx,y:target.yy,width:1,height:1};this.part=this.part_y==1?mgr.Body:(this.part_y==0?mgr.Headers:mgr.Footers);this.contextmenutarget=target;var cell=this.part.Painted[target.yy][target.xx];this.rect={left:cell.offsetLeft,top:cell.offsetTop,right:(cell.offsetLeft+cell.offsetWidth),bottom:(cell.offsetTop+cell.offsetHeight)};var selection_div=this.selection_div=document.createElement("div");selection_div.className="TouchSelectionRect";selection_div.style.border="2px solid green";selection_div.style.position="absolute";selection_div.style.left="0px";selection_div.style.top="0px";selection_div.style.webkitTransitionTimingFunction="ease-in-out";selection_div.style.zIndex=50;selection_div.style.webkitTransitionDuration="0s";selection_div.style.webkitTransitionProperty="all";selection_div.style.display="";this._positionSelectionDiv(this.rect);target.parentNode.appendChild(selection_div);this.move_x=[];this.move_y=[];var isSmallDevices=Qva.GetBinder(mgr.binderid).isSmallDevices;if(!this.menu){var config={SmallDevices:isSmallDevices,AddPointerElem:true,that:mgr.legacy,Buttons:[{Fn:this._close,Scope:this,CssClass:"img_cancel_cross",Text:"Cancel",Style:{"float":"right"}},{Fn:this._makeSelection,Scope:this,CssClass:"img_accept_tick",Text:"Select",Style:{"float":"left"}}],Style:{position:"absolute",visibility:"hidden"}};if(!isSmallDevices){config.Buttons.unshift({Fn:this._more,Text:"More",Scope:this,CssClass:"img_more_dots",Style:{display:"inline-block"}})}this.menu=new Qva.Touch.SelectionMenu(config);if(!isSmallDevices){document.documentElement.appendChild(this.menu.Element)}}var coords=Qva.Touch.GetCoordinatesForElem(this.mgr.PageBinder.Element),x=coords.x+(this.mgr.PageBinder.Element.offsetWidth-this.menu.Element.offsetWidth)/2,y=coords.y-this.menu.Element.clientHeight;this.menu.Show(x,y)};Qva.Mgr.grid.multiselect.prototype._makeSelection=function(){var rectstring=""+this.selection.x+":"+this.selection.y+":"+this.selection.width+":"+this.selection.height;if(this.part_y==0){rectstring+=":Head"}if(this.part_y==2){rectstring+=":Foot"}this.mgr.PageBinder.Set(this.mgr.ObjectId,"rect",rectstring,true);this._close()};Qva.Mgr.grid.multiselect.prototype._close=function(){Qva.Events.RemoveDragEvent(this.mgr.Element);$(this.selection_div).remove();this.menu.Hide();this.f_close()};Qva.Mgr.grid.multiselect.prototype._more=function(event){this._close();this.mgr.PageBinder.GetDocumentMgr().OnContextMenu(event,this.mgr.PageBinder.Name,undefined,this.contextmenutarget)};Qva.Mgr.grid.multiselect.prototype._positionSelectionDiv=function(rect){var p=document.createElement("p");if(typeof p.style.transform!=="undefined"){this.selection_div.style.transform="translate3d("+(rect.left+0)+"px, "+(rect.top+0)+"px, 0)"}else{if(typeof p.style.webkitTransform!=="undefined"){this.selection_div.style.webkitTransform="translate3d("+(rect.left+0)+"px, "+(rect.top+0)+"px, 0)"}}this.selection_div.style.width=(rect.right-rect.left-4)+"px";this.selection_div.style.height=(rect.bottom-rect.top-4)+"px"};Qva.Mgr.grid.multiselect.prototype._isMoving=function(){return this.move_x.length>0||this.move_y.length>0};Qva.Mgr.grid.multiselect.prototype._find_x=function(x){if(this.part_x==0){return this.mgr._find_x_left(x)}else{if(this.part_x==1){return this.mgr._find_x_center(x)}else{if(this.part_x==2){return this.mgr._find_x_right(x)}}}};Qva.Mgr.grid.multiselect.prototype._find_y=function(y){if(this.part_y==0){return this.mgr._find_y_top(y)}else{if(this.part_y==1){return this.mgr._find_y_center(y)}else{if(this.part_y==2){return this.mgr._find_y_bottom(y)}}}};Qva.Mgr.grid.multiselect.prototype._fix_min_rect=function(rect){if(rect.right-rect.left<10){if(this.move_x[0]=="left"){rect.left=rect.right-10}else{rect.right=rect.left+10}}if(rect.bottom-rect.top<10){if(this.move_y[0]=="top"){rect.top=rect.bottom-10}else{rect.bottom=rect.top+10}}};Qva.Mgr.grid.multiselect.prototype.touchStart=function(startX,startY){var pos=Qva.GetAbsolutePageCoords(this.selection_div.parentNode);var x=startX-pos.x;var y=startY-pos.y;var rect=this.rect;this.move_x=[];this.move_y=[];var dleft=x-rect.left;var dright=rect.right-x;var dtop=y-rect.top;var dbottom=rect.bottom-y;var margin=50;var margin_inner_x=(rect.right-rect.left<3*margin)?0:margin;var margin_inner_y=(rect.bottom-rect.top<3*margin)?0:margin;var margin_outer=-margin;if(dleft>margin_inner_x&&dright>margin_inner_x&&dtop>margin_inner_y&&dbottom>margin_inner_y){this.move_x=["left","right"];this.move_y=["top","bottom"]}else{if(dleft>margin_outer&&dright>margin_outer&&dtop>margin_outer&&dbottom>margin_outer){if(dleft<=margin_inner_x&&dleft>margin_outer){this.move_x.push("left")}if(dright<=margin_inner_x&&dright>margin_outer){this.move_x.push("right")}if(dtop<=margin_inner_y&&dtop>margin_outer){this.move_y.push("top")}if(dbottom<=margin_inner_y&&dbottom>margin_outer){this.move_y.push("bottom")}}}};Qva.Mgr.grid.multiselect.prototype.touchMove=function(dx,dy){if(!this._isMoving()){return false}var rect={left:this.rect.left,top:this.rect.top,right:this.rect.right,bottom:this.rect.bottom};for(var i=0;i<this.move_x.length;++i){rect[this.move_x[i]]+=dx}for(var i=0;i<this.move_y.length;++i){rect[this.move_y[i]]+=dy}this._fix_min_rect(rect);this.selection_div.style.webkitTransitionDuration="0ms";this._positionSelectionDiv(rect);return true};Qva.Mgr.grid.multiselect.prototype.touchEnd=function(dx,dy){if(!this._isMoving()){return false}for(var i=0;i<this.move_x.length;++i){this.rect[this.move_x[i]]+=dx}for(var i=0;i<this.move_y.length;++i){this.rect[this.move_y[i]]+=dy}this._fix_min_rect(this.rect);function snap_x(pos){if(pos.width>2*pos.x){return -pos.x}else{++pos.cix;return pos.width-pos.x}}var left=this._find_x(this.rect.left);var right=this._find_x(this.rect.right);if(left.cix==right.cix){this.rect.left-=left.x;this.rect.right+=right.width-right.x;++right.cix}else{if(left.cix+1==right.cix){if(left.width-left.x<right.x){this.rect.left+=snap_x(left);this.rect.right+=right.width-right.x;++right.cix}else{this.rect.left-=left.x;this.rect.right+=snap_x(right)}}else{this.rect.left+=snap_x(left);this.rect.right+=snap_x(right)}}function snap_y(pos){if(pos.height>2*pos.y){return -pos.y}else{++pos.rix;return pos.height-pos.y}}var top=this._find_y(this.rect.top);var bottom=this._find_y(this.rect.bottom);if(top.rix==bottom.rix){this.rect.top-=top.y;this.rect.bottom+=bottom.height-bottom.y;++bottom.rix}else{if(top.rix+1==bottom.rix){if(top.height-top.y<bottom.y){this.rect.top+=snap_y(top);this.rect.bottom+=bottom.height-bottom.y;++bottom.rix}else{this.rect.top-=top.y;this.rect.bottom+=snap_y(bottom)}}else{this.rect.top+=snap_y(top);this.rect.bottom+=snap_y(bottom)}}this.selection.x=left.cix;this.selection.y=top.rix;this.selection.width=right.cix-left.cix;this.selection.height=bottom.rix-top.rix;this.selection_div.style.webkitTransitionDuration="500ms";this._positionSelectionDiv(this.rect);return true};function make_bodyscroll(mgr){return{setPosition:function(x,y){x=Math.round(x);y=Math.round(y);translate(mgr.parts["1:1"],x,y);translate(mgr.parts["0:1"],0,y);translate(mgr.parts["2:1"],0,y);translate(mgr.parts["1:0"],x,0);translate(mgr.parts["1:2"],x,0);mgr.setPosition_scroll_fix_divs(x,y)},setTransitionTime:function(time){setDuration(mgr.parts["1:1"],time);setDuration(mgr.parts["0:1"],time);setDuration(mgr.parts["2:1"],time);setDuration(mgr.parts["1:0"],time);setDuration(mgr.parts["1:2"],time);mgr.setTransitionTime_scroll_fix_divs(time)},getPosition:function(){var part=mgr.parts["1:1"].pages[0];var webkitTransform=window.getComputedStyle(part).webkitTransform;if((webkitTransform==="none"||!webkitTransform)){return{x:part.offsetLeft,y:part.offsetTop}}if(webkitTransform&&webkitTransform!=="none"){var matrix=new WebKitCSSMatrix(webkitTransform);return{x:matrix.e,y:matrix.f}}}}}Qva.Mgr.grid.prototype.setPosition_scroll_fix_divs=function(x,y){for(var ix=0;ix<this.scroll_fix_divs.length;++ix){var _y=Math.min(Math.max(0,-(y+this.scroll_fix_divs[ix].offset)),this.scroll_fix_divs[ix].max);translate(this.scroll_fix_divs[ix].div,0,_y)}};Qva.Mgr.grid.prototype.setTransitionTime_scroll_fix_divs=function(time){for(var ix=0;ix<this.scroll_fix_divs.length;++ix){setDuration(this.scroll_fix_divs[ix].div,time)}};Qva.Mgr.grid.prototype._makeScrollObj=function(bodyscroll){var that=this;var scroll_x=0;var scroll_y=0;var direction_y=1;function setPosition(x,y){x=Math.round(x);y=Math.round(y);that.XScroll.setPosition(x);that.YScroll.setPosition(y);bodyscroll.setPosition(x,y);if(y<scroll_y){direction_y=1}else{if(y>scroll_y){direction_y=-1}}scroll_x=x;scroll_y=y}function setTransitionTime(time){bodyscroll.setTransitionTime(time);that.XScroll.setTransitionTime(time);that.YScroll.setTransitionTime(time)}this.scroll_obj={getCurrentScroll:function(){return{x:-scroll_x,y:-scroll_y,direction_y:direction_y}},setPosition:setPosition,setTransitionTime:setTransitionTime,getPosition:function(){return bodyscroll.getPosition()},Remove:function(){that=null;bodyscroll=null},pageSize:{y:that.max_visible_rows}}};Qva.Mgr.grid.prototype._addTouchEvents=function(content){var self=this,legacy={};if(self.grid){legacy=self;self=legacy.grid}var isZooming=false,firstTouchHasEnded=false,that=self,touchCanceled=false,lockX=false,lockedX=0;that.legacy=legacy;var fixed_cols_total=self.fixed_cols_left+self.fixed_cols_right;var startX,startY,startTime,list,identifier,scroll_x,scroll_y,moved,selection,selection_timeout,selection_div;scroll_x=scroll_y=0;list=[];function limit_x(x){var x_max=self.x_max_scroll;if(-x<0){return 0}if(-x>x_max){return -x_max}return x}function limit_y(y){var y_max=self.y_max_scroll;if(-y<0){return 0}if(-y>y_max){return -y_max}return y}var wait=false;function queuePostPaint(){that.PageBinder.QueuePostPaintMessage(that)}function setPosition(x,y){that.scroll_obj.setPosition(x,y)}function setTransitionTime(time){that.scroll_obj.setTransitionTime(time)}function getTouch(e){return(Qva.Events.getTouch(e,identifier))}function update(e){var touch=getTouch(e);if(!touch){return false}var dx=Qva.Events.getX(touch)-startX;var dy=Qva.Events.getY(touch)-startY;var dt=e.timeStamp-startTime;list.push({dx:dx,dy:dy,dt:dt});if(!moved&&(Math.abs(dx)+Math.abs(dy)>3)){moved=true}if(moved&&selection_timeout){clearTimeout(selection_timeout);selection_timeout=null}if(moved&&selection){if(selection.timeout){clearTimeout(selection.timeout);selection.timeout=null}else{that._IndicateSelection(selection.part,selection.y,selection.x,false)}selection=null}return true}Qva.Events.AddLongPressEvent(content,function(e){if(!that.PageBinder.IsValid()){return}startX=Qva.Events.getX(e);startY=Qva.Events.getY(e);var target=Qva.Events.getTarget(e),found=false;for(;target&&target!=content&&!found;target=target.parentNode){if(target.multiselect==true){found=true;break}}if(found){if(Qva.gridMultiselect){Qva.gridMultiselect._close()}that.multiselect=new Qva.Mgr.grid.multiselect(target,that,function(){that.multiselect=null});that.multiselect.touchStart(startX,startY);Qva.gridMultiselect=that.multiselect;Qva.Events.AddDragEvent(content,function(e){if(!that.PageBinder.IsValid()){return}list=[];identifier=Qva.Events.getIdentifier(e);startX=Qva.Events.getX(e);startY=Qva.Events.getY(e);that.multiselect.touchStart(startX,startY)},function(e){if(!that.PageBinder.IsValid()){return}if(!update(e)){return}var last=list[list.length-1];that.multiselect.touchMove(last.dx,last.dy)},function(e){if(!update(e)){return}var last=list[list.length-1];that.multiselect.touchEnd(last.dx,last.dy)})}else{return false}},{fnValidation:function(e){var target=Qva.Events.getTarget(e),found=false;for(;target!=content&&!found;target=target.parentNode){if(target.multiselect==true){found=true;break}}return found}});Qva.Events.AddTouchScrollEvent(content,function(e){if(!that.PageBinder.IsValid()){return false}list=[];identifier=Qva.Events.getIdentifier(e);startX=Qva.Events.getX(e);startY=Qva.Events.getY(e);var current_pos=that.scroll_obj.getPosition();that.lockedX=current_pos.x;setTransitionTime("0ms");if(current_pos.x!=scroll_x||current_pos.y!=scroll_y){scroll_x=current_pos.x;scroll_y=current_pos.y;setPosition(scroll_x,scroll_y);queuePostPaint();return false}var target=Qva.Events.getTarget(e).parentNode;if($(target).attr("fixed")==="true"){that.lockX=true}else{that.lockX=false}startTime=e.timeStamp},function(e){if(that.multiselect&&that.multiselect._isMoving()){return}if(!update(e)){return}var last=list[list.length-1];var x_max=self.x_max_scroll;var y_max=self.y_max_scroll;var dx=last.dx+scroll_x;var dy=last.dy+scroll_y;if(x_max===0){dx=0}if(-dx<0){dx=dx/3}if(-dx>x_max){dx=(dx+x_max)/3-x_max}if(y_max===0){dy=0}if(-dy<0){dy=dy/3}if(-dy>y_max){dy=(dy+y_max)/3-y_max}if(that.lockX===true){dx=that.lockedX}setPosition(dx,dy)},function(e){if(that.multiselect&&that.multiselect._isMoving()){return}if(!update(e)){return}var last=list[list.length-1];var x_max=self.x_max_scroll;var y_max=self.y_max_scroll;for(var i=list.length-1;i>0&&last.dt-list[i-1].dt<100;--i){}var dx=2*last.dx-list[i].dx+scroll_x;var dy=2*last.dy-list[i].dy+scroll_y;if(-dx<0){dx=0}if(-dx>x_max){dx=-x_max}dy=-Math.round(-dy/that.Body.rowHeight)*that.Body.rowHeight;if(-dy<0){dy=0}if(-dy>y_max){dy=-y_max}scroll_x=dx;scroll_y=dy;list=[];setTransitionTime("500ms");if(that.lockX===true){dx=that.lockedX}setPosition(dx,dy);queuePostPaint()})};Qva.Mgr.grid.prototype._addMouseScroll=function(){var that=this;var x_max=this.x_max_scroll;var y_max=this.y_max_scroll;var scroll_x=0;var scroll_y=0;function limit_x(x){if(-x<0){return 0}if(-x>that.x_max_scroll){return -that.x_max_scroll}return x}function limit_y(y){if(-y<0){return 0}if(-y>that.y_max_scroll){return -that.y_max_scroll}return y}function queuePostPaint(){that.PageBinder.QueuePostPaintMessage(that)}function setPosition(x,y){that.scroll_obj.setPosition(x,y)}function setTransitionTime(time){that.scroll_obj.setTransitionTime(time)}function snap_y(y){y=Math.round(y/that.Body.rowHeight)*that.Body.rowHeight;return limit_y(y)}function snap_y2(y,d){var new_y=Math.round(y/that.Body.rowHeight)*that.Body.rowHeight;if(Math.abs(new_y-y)<d){y=new_y}return limit_y(y)}function snap_x(x){var pos=that._find_x_center(-x);if(pos.width>2*pos.x){return limit_x(-(-x-pos.x))}else{return limit_x(-(-x+pos.width-pos.x))}}function snap_x2(x,d){var pos=that._find_x_center(-x);if(pos.x<d){return limit_x(x+pos.x)}else{if(pos.width-pos.x<d){return limit_x(x-pos.width+pos.x)}else{return limit_x(x)}}}var x_actions={step:function(dx){var pos=that._find_x_center(-scroll_x);scroll_x+=pos.x;var step=dx>0?1:-1;if(pos.x!=0&&dx>0){dx--}if(dx!=0){if(step<0){for(var cix=pos.cix;cix<pos.cix-dx;++cix){scroll_x=scroll_x+step*that._getColWidth(cix)}}else{for(var cix=pos.cix-1;cix>pos.cix-1-dx;--cix){scroll_x=scroll_x+step*that._getColWidth(cix)}}}scroll_x=limit_x(scroll_x);setTransitionTime("500ms");setPosition(scroll_x,scroll_y);queuePostPaint()},scroll:function(dx){var x=snap_x2(dx+scroll_x,5);setPosition(x,scroll_y);setTransitionTime("0ms");queuePostPaint()},scroll_end:function(dx){scroll_x=limit_x(dx+scroll_x);setTransitionTime("500ms");setPosition(scroll_x,scroll_y);queuePostPaint()},page:function(dx){scroll_x=limit_x(dx*that.body_width+scroll_x);setTransitionTime("500ms");setPosition(scroll_x,scroll_y);queuePostPaint()}};var y_actions={step:function(dy){if(dy>0){scroll_y=limit_y((Math.floor(scroll_y/that.Body.rowHeight)+dy)*that.Body.rowHeight)}else{scroll_y=limit_y((Math.ceil(scroll_y/that.Body.rowHeight)+dy)*that.Body.rowHeight)}setTransitionTime("500ms");setPosition(scroll_x,scroll_y);queuePostPaint()},scroll:function(dy){that.scrolling=1;var y=snap_y2(dy+scroll_y,5);setTransitionTime("0ms");setPosition(scroll_x,y);queuePostPaint()},scroll_end:function(dy){that.scrolling=1;scroll_y=limit_y(dy+scroll_y);setTransitionTime("500ms");setPosition(scroll_x,scroll_y);queuePostPaint()},page:function(dy){scroll_y=limit_y(dy*that.Body.rowHeight*(that.max_visible_rows-1)+scroll_y);setTransitionTime("500ms");setPosition(scroll_x,scroll_y);queuePostPaint()}};if(!this.eventsBound){this.XScroll.bindEvents(x_actions);this.YScroll.bindEvents(y_actions);this.actions=y_max>0?y_actions:x_actions}};Qva.Mgr.grid.prototype.Remove=function(){if(this.scroll_obj){this.scroll_obj.Remove()}if(this.multiselect){this.multiselect._close()}Qva.RemoveHtml(this.Content);Qva.RemoveHtml(this.Element);if(this.parts){this._CleanUpContentParts()}this.Content=null;this.SearchName=null;this.ObjectId=null;this.LeftButton=null;this.Element=null;this.Cols=null;this.Body=null;this.Headers=null;this.Footers=null;this.Selection=null};Qva.Mgr.grid.prototype._CombineColors=function(c1,c2){if(c1.A===0&&c2.A===0){return"Transparent"}if(c1.A===0){return c2.css}if(c2.A===0){return c1.css}if(c1.R+c1.G+c1.B>c2.R+c2.G+c2.B){return c2.css}return c1.css};Qva.Mgr.grid.prototype._CombineBorders=function(b1,b2){var width=Math.max(b1.width,b2.width);var color=this._CombineColors(b1.color,b2.color);var style=b1.style==="double"||b2.style==="double"?"double":b1.style==="solid"||b2.style==="solid"?"solid":"none";return{width:width,color:color,style:style}};Qva.Mgr.grid.prototype._MakeBorder=function(div,cell,other_cell,near,far,f){var BorderStyleIx=this.Style[cell.style].BorderStyle;if(this.BorderStyle.length-1<BorderStyleIx){return 0}var b1=this.BorderStyle[BorderStyleIx][near];if(!this.Style[other_cell.style]){Assert(false)}var b2=this.BorderStyle[this.Style[other_cell.style].BorderStyle][far];var border=this._CombineBorders(b1,b2);if(border.style==="solid"){var border_width=f(border.width);div.style["border"+near]="solid "+border_width+"px "+border.color;return border_width}else{if(border.style==="double"){div.style["border"+near]="solid 3px "+border.color;return(near==="Left"||near==="Top")?4:5}else{Assert(border.style==="none");return 0}}};Qva.Mgr.grid.prototype._StyleObject=function(node){var bgColor=node.getAttribute("bgcolor");this.BgColorRGB=HtmlifyARGB(bgColor);this.BgColorCSSExpr=Qva.Hex2CSSExpression(bgColor);this.Color=HtmlifyARGB(node.getAttribute("color"));this.NumAdjust=node.getAttribute("numadjust");this.TextAdjust=node.getAttribute("textadjust");this.VertAdjust=node.getAttribute("vertadjust");this.LabelAdjust=node.getAttribute("labeladjust");this.LabelVertAdjust=node.getAttribute("labelvertadjust");this.BorderStyle=node.getAttribute("borderstyle");var fontstyle=node.getAttribute("fontstyle");this.FontStyle=fontstyle;this.FontWeight=node.getAttribute("fontweight");this.TextDecoration=node.getAttribute("textdecoration");this.SizeMod=node.getAttribute("sizemod");var stretchmode=node.getAttribute("stretchmode");if(stretchmode){this.StretchMode=stretchmode}};Qva.Mgr.grid.prototype._BorderStyleObject=function(node){function getBorder(name){var b=node.getAttribute(name).split(" ");if(b[0]==="none"){return{width:0,style:"none",color:Qva.generalHelper.ObjectifyARGB(null)}}var width=parseInt(b[1]);return{width:width,style:b[0],color:Qva.generalHelper.ObjectifyARGB(b[2])}}this.Top=getBorder("top");this.Right=getBorder("right");this.Bottom=getBorder("bottom");this.Left=getBorder("left")};Qva.Mgr.grid.prototype._CellObject=function(value,gridMgr){if(gridMgr.isStatisticsBox){var defaultTextId=value.getAttribute("defaulttextid");if(defaultTextId&&defaultTextId.length>0){this.val=Qva.localization.getStringFromKey(defaultTextId)}else{this.val=value.getAttribute("text")}}else{if(value.getAttribute("labelId")){this.val=Qva.localization.getStringFromNode(value)}else{this.val=value.getAttribute("text")}}this.title=value.getAttribute("title")||this.val;if(value.getAttribute("value")){this.intval=value.getAttribute("value")}if(value.getAttribute("state")){this.state=value.getAttribute("state")}this.dblclick=!!value.getAttribute("dblclick");this.mode=value.getAttribute("mode");this.disabled=this.mode=="disabled";this.style=value.getAttribute("style")?value.getAttribute("style"):"0";this.isnum=value.getAttribute("isnum")=="true";this.label=value.getAttribute("label")=="true";this.icons=[];var iconNodes=value.getElementsByTagName("icon");for(var i=0;i<iconNodes.length;i++){this.icons.push(iconNodes[i])}this.subcell=value.getAttribute("subcell");this.first=value.getAttribute("first");this.colspan=parseInt(value.getAttribute("colspan"));if(isNaN(this.colspan)){this.colspan=1}this.action=value.getAttribute("action");this.url=value.getAttribute("url");if(value.getAttribute("position")){this.position=value.getAttribute("position")}var selecttype=value.getAttribute("selecttype");if(selecttype){this.selecttype=selecttype;this.selectsource=value.getAttribute("selectsource")=="true";if(this.action){Assert(false)}}this.input=value.getAttribute("input")=="true";this.dragable=value.getAttribute("dragable")=="true";this.vertical=value.getAttribute("vertical")=="true";var rowspan=value.getAttribute("rowspan");if(rowspan){this.rowspan=parseInt(rowspan)}else{this.rowspan=1}var multirect=value.getAttribute("multirect");if(multirect){multirect=multirect.split(":");Assert(multirect.length===4);this.multirect={x:parseInt(multirect[0],10),y:parseInt(multirect[1],10),width:parseInt(multirect[2],10),height:parseInt(multirect[3],10)}}};Qva.Mgr.grid.prototype._SetCellStyle=function(data,ignorecolor,hidetext){if(!data.style){return""}var style=this.Style[data.style];if(!style){return""}var csstext="";if(hidetext){if(style.BgColorCSSExpr){csstext+="; background-color:"+style.BgColorCSSExpr}else{if(style.BgColorRGB){csstext+="; background-color:"+style.BgColorRGB}}csstext+="; color:"+style.BgColorRGB;if(Qva.userAgentDetector.get("msie8lte")&&style.Color.toString().toLowerCase()==="transparent"){csstext+="; font-size: 0 !important"}}else{if(!ignorecolor){if(style.BgColorCSSExpr){csstext+="; background-color:"+style.BgColorCSSExpr}else{if(style.BgColorRGB){csstext+="; background-color:"+style.BgColorRGB}}csstext+="; color:"+style.Color;if(Qva.userAgentDetector.get("msie8lte")&&style.Color.toString().toLowerCase()==="transparent"){csstext+="; font-size: 0 !important"}}else{csstext+="; background-color:";csstext+="; color:"}}csstext+="; text-align:"+(data.label?style.LabelAdjust:(data.isnum?style.NumAdjust:style.TextAdjust));csstext+="; font-style:"+style.FontStyle;csstext+="; font-weight:"+style.FontWeight;csstext+="; text-decoration:"+style.TextDecoration;switch(style.SizeMod){case"2":csstext+="; font-size:140%";break;case"1":csstext+="; font-size:larger";break;case"-1":csstext+="; font-size:smaller";break;case"-2":csstext+="; font-size:71%";break}return csstext};Qva.Mgr.grid.prototype._appendCellIcon=function(icon,cix,rix,stretchmode,adjust,width,height){var img=this.PageBinder.GetDocumentMgr().CreateCellIcon(icon,stretchmode,adjust,width,height);AppendAction(img,icon,this,cix+":"+rix);return img};Qva.Mgr.grid.getMgr=function(elem){var parent=elem.parentNode;while(parent&&!parent.Mgr){parent=parent.parentNode}return parent?parent.Mgr:null};Qva.Mgr.grid.DblClick=function(event){this.pressed=false;if(!event){event=window.event}var mgr=Qva.Mgr.grid.getMgr(this);if(!mgr.PageBinder.GetEnabled()){return}mgr.PageBinder.Set(mgr.ObjectId,"dblclick",this.xx+":"+this.yy,true)};Qva.Mgr.grid.Click=function(event){if(!event){event=window.event}event.cancelBubble=true;this.pressed=true;var _this=this;window.setTimeout(function(){action_mu(_this)},200)};function getSection(position){var pos=position.split(":");if(pos.length<3){return""}return pos[2]}Qva.Mgr.grid.prototype._IndicateCellsToSelect=function(){if(this.ObjectId!=Qva.SearchableObject){SetSearchableAndActives(this.ObjectId,[this.ObjectId])}var left=Math.min(this.Selection.Start.xx,this.Selection.End.xx);var top=Math.min(this.Selection.Start.yy,this.Selection.End.yy);var right=Math.max(this.Selection.Start.xx,this.Selection.End.xx);var bottom=Math.max(this.Selection.Start.yy,this.Selection.End.yy);var rect={left:left,top:top,right:right,bottom:bottom};if(!this.Selection.Old){this.Selection.Old=rect}left=Math.min(left,this.Selection.Old.left);top=Math.min(top,this.Selection.Old.top);right=Math.max(right,this.Selection.Old.right);bottom=Math.max(bottom,this.Selection.Old.bottom);this.Selection.Old=rect;var part=this.Body;if(getSection(this.Selection.Start.position)==="Head"){part=this.Headers}if(getSection(this.Selection.Start.position)==="Foot"){part=this.Footers}for(var x=left;x<=right;++x){for(var y=top;y<=bottom;++y){var select=rect.left<=x&&x<=rect.right&&rect.top<=y&&y<=rect.bottom;this._IndicateSelection(part,y,x,select)}}};Qva.Mgr.grid.prototype._IndicateSelection=function(part,y,x,select){if(!part.Painted[y]||!part.Painted[y][x]){return}if(this.PageBinder.Type==="MB"){return}if(part.Painted[y][x].selectsource){for(var cix=0;cix<part.Painted[y].length;cix++){var yindex=y;var cell=null;while(yindex>=0&&cell==null){var thisY=yindex--;if(part.Painted[thisY]&&part.Painted[thisY][cix]){cell=part.Painted[thisY][cix]}}if(!cell){continue}if(!cell.selectsource&&(cell.singleselect||cell.multiselect)){this._SetCellSelected(cell,select?this.SelectedClassName:"",!select)}}for(var rix=0;rix<part.Painted.length;rix++){var cell=part.Painted[rix]&&part.Painted[rix][x];if(!cell){continue}if(!cell.selectsource&&(cell.singleselect||cell.multiselect)){this._SetCellSelected(cell,select?this.SelectedClassName:"",!select)}}if(part!=this.Headers){for(var rix=0;rix<this.Headers.Painted.length;rix++){var cell=this.Headers.Painted[rix][x];if(!cell){continue}if(!cell.selectsource&&(cell.singleselect||cell.multiselect)){this._SetCellSelected(cell,select?this.SelectedClassName:"",!select)}}}}else{this._SetCellSelected(part.Painted[y][x],select?this.SelectedClassName:"",!select)}};Qva.Mgr.grid.prototype._ClearCellsToSelect=function(){if(!this.Selection.Old){return}var left=this.Selection.Old.left;var top=this.Selection.Old.top;var right=this.Selection.Old.right;var bottom=this.Selection.Old.bottom;this.Selection.Old=null;var part=this.Body;if(getSection(this.Selection.Start.position)==="Head"){part=this.Headers}if(getSection(this.Selection.Start.position)==="Foot"){part=this.Footers}for(var x=left;x<=right;++x){for(var y=top;y<=bottom;++y){this._IndicateSelection(part,y,x,false)}}};Qva.Mgr.grid.prototype._SetCellSelected=function(cell,newclassName,deselect){if(!cell){return}if(deselect){if(cell.origcolor!=""){cell.style.color=cell.origcolor;cell.origcolor=""}if(cell.origbackgroundColor!=""){cell.style.backgroundColor=cell.origbackgroundColor;cell.origbackgroundColor=""}}else{if(cell.style.color!=""){cell.origcolor=cell.style.color;cell.style.color=""}if(cell.style.backgroundColor!=""){cell.origbackgroundColor=cell.style.backgroundColor;cell.style.backgroundColor=""}}if(cell.className!=newclassName){cell.className=newclassName}};Qva.Mgr.grid.prototype.GetCell=function(col,row){var header_lines=this.Headers.Lines.length;var cell;if(row<header_lines){return this.Headers.Painted[row][col]}else{return this.Body.Painted[row-header_lines][col]}};Qva.Mgr.grid.prototype.GetCellRect=function(col,row){var header_lines=this.Headers.Lines.length;var cell=this.GetCell(col,row);if(!cell){var cell=this.GetCell(col-1,row);var pos=Qva.GetAbsolutePageCoords(cell);return{left:pos.x+cell.offsetWidth,width:this.Element.offsetWidth-cell.offsetWidth,top:pos.y,height:cell.offsetHeight}}else{var pos=Qva.GetAbsolutePageCoords(cell);return{left:pos.x,width:cell.offsetWidth,top:pos.y,height:cell.offsetHeight}}}})($QvJq);if(!Qva.Mgr){Qva.Mgr={}}Qva.PageBinding.prototype.CreateTransientListBox=function(name){var data={};data.name=name;data.id="DS";var frame=Qva.Mgr.CreateObject(this,data);frame.Element.className+=" DS";frame.Element.style.cssText="z-index: 666; display: none; left: 10pt; top: 10pt; width: 10pt; height: 10pt; position:absolute;";new Qva.Mgr.transientpos(frame,frame.Element,name);new Qva.Mgr.closetransient(frame,frame.Element,name,"",frame.CreateListBox());document.body.appendChild(frame.Element)};function AppendWidthHighlights(div,text,parts){if(parts&&parts.length>0){var currentpos=0;var currentpart=0;while(text!=""){var part=parts[currentpart++];if(part){var partpos=parseInt(part.getAttribute("pos"));var partcount=parseInt(part.getAttribute("count"));if(partpos>currentpos){var span=document.createElement("span");span.innerText=text.substr(0,partpos-currentpos);text=text.substr(partpos-currentpos);currentpos=partpos;div.appendChild(span)}var span=document.createElement("span");span.innerText=text.substr(0,partcount);text=text.substr(partcount);currentpos+=partcount;span.className="qvHighLighted";div.appendChild(span)}else{var span=document.createElement("span");span.innerText=text;div.appendChild(span);text=""}}}else{div.appendChild(document.createTextNode(text))}}Qva.Mgr.closetransient=function(owner,elem,name,prefix,listbox){if(!Qva.MgrSplit(this,name,prefix)){return}owner.AddManager(this);this.Listbox=listbox;Qva.Events.AddCancelBubble(elem,".transientpos");Qva.Events.AddScrollWheelEvent(elem,function(){},".transientpos")};Qva.Mgr.closetransient.prototype.Paint=function(mode,node){$(document).unbind(".transientpos");if(mode=="h"){return}var _this=this;$(document).one(Qva.Events.getStartEvents(".transientpos")+" "+Qva.Events.getScrollWheelEvents(".transientpos"),function(event){_this.Listbox.HideTransientListbox()});var ownerelement=document.getElementById(node.getAttribute("owner"));var OwnerMgr=ownerelement&&ownerelement.AvqMgr&&ownerelement.AvqMgr.GetSearchMgr();if(!OwnerMgr||!OwnerMgr.GetCellRect){this.Listbox.HideTransientListbox();return}};Qva.Mgr.transientpos=function(owner,elem,name,prefix){if(!Qva.MgrSplit(this,name,prefix)){return}owner.AddManager(this);this.Element=elem};Qva.Mgr.transientpos.prototype.Paint=function(mode,node,name){var element=this.Element;element.style.display=Qva.MgrGetDisplayFromMode(this,mode);if(element.style.display=="none"){return}var ownerelement=document.getElementById(node.getAttribute("owner"));$(element).attr("owner",ownerelement.id);var OwnerMgr=ownerelement&&ownerelement.AvqMgr&&ownerelement.AvqMgr.GetSearchMgr();Qva.params.transientMenuOpen=true;if(OwnerMgr&&OwnerMgr.GetCellRect){var row=parseInt(node.getAttribute("row"));var col=parseInt(node.getAttribute("col"));var position=node.getAttribute("position");var rect=OwnerMgr.GetCellRect(col,row);if(position=="offset"){rect.left-=15;if(rect.left<0){rect.left=0}}else{if(position=="cut"){rect.width-=15}else{if(position=="below"){rect.top+=rect.height}else{if(position=="right"){rect.left+=rect.width}else{Assert(position=="")}}}}rect.height=Qva.GetViewportHeight();rect.height-=(rect.top-Qva.GetScrollTop());if(rect.height>80){rect.height-=40}rect.width=Math.max(rect.width,50);rect.mode=mode;rect.allowmove=false;rect.allowresize=false;rect.maximized=false;this.PageBinder.BorderWidth=parseInt($(this.Element).css("border-left-width"));this.PageBinder.Size(rect)}};Qva.Mgr.listbox=function(owner,elem,name,prefix,documentbinder){this.SearchName=this.Name=Qva.MgrMakeName(name,prefix);this.binderid=owner.binderid;this.ObjectId=owner.Element.id;this.LeftButton=owner.LeftButton;this.Element=elem;elem.Mgr=this;owner.AddManager(this);this.DocumentBinder=documentbinder;this.SelectionManager=new Qva.ListBoxSelectionManager(this);this.Selections={Selected:[]};elem.style.position="relative";elem.style.overflow="hidden";elem.style.cursor="Default";this.Content=document.createElement("div");elem.appendChild(this.Content);Qva.AddScroll(this);this.SelectionManager.AddEvents(elem);Qva.Events.AddClickEvent(elem,function(event){var origevent=Qva.Events.getOriginalEvent(event),target=Qva.Events.getClickElem(this,event);switch(target[Qva.Events.Flags.Click]){case"action":window.onclick_Action.apply(target,[origevent]);break;case"clientaction":window.onclick_ContextClientAction.apply(target,[origevent]);break}})};Qva.Mgr.listbox.prototype.Remove=function(){if(Qva.Touch.Listbox.SelectMenu&&Qva.Touch.Listbox.SelectMenu.Visible&&Qva.Touch.Listbox.SelectMenu.ListboxObject.Mgr===this){Qva.Touch.Listbox.SelectMenu.Hide(true)}$(this.Content).html("").remove();$(this.Element).html("").remove()};Qva.Mgr.listbox.prototype.GetCellRect=function(col,row){Assert(col==-1&&row==-1);var frame=this.PageBinder.Element;var pos=Qva.GetAbsolutePageCoords(frame);var elementPath=$(frame).getPath();return{left:pos.x,width:Qva.ElementAttributesHandler(elementPath,frame,"offsetWidth"),top:pos.y,height:Qva.ElementAttributesHandler(elementPath,frame,"offsetHeight")}};Qva.Mgr.listbox.prototype.IsSupportingKeyUpAndDown=function(){return true};Qva.Mgr.listbox.prototype.AddSelectionStyle=function(node){var selectionstyle=parseInt(node.getAttribute("style"));var color=HtmlifyARGB(node.getAttribute("color"));if(color!=null){color=color.replace("#","")}this.HideAndModeSymbols=false;this.AutoCtrl=false;this.HasSelectedExcluded=false;switch(selectionstyle){case 1:this.TextIndent=17;if(this.OnlyoneSelected){this.AltClass="_RADIO_"+color;this.PageBinder.GetDocumentMgr().LoadRadioStyle(color)}else{this.AltClass="_CHECK_"+color;this.PageBinder.GetDocumentMgr().LoadCheckStyle(color);this.AutoCtrl=true;this.HasSelectedExcluded=true}break;case 2:var any_cell=this.Lines[this.Lines.length-1];var size=Math.min((any_cell?any_cell.rowspan:1)*this.TextHeight,40);this.TextIndent=(size/2)+4;this.AltClass="_CORNERTAG_"+size+"_"+color;this.PageBinder.GetDocumentMgr().LoadCornertagStyle(size,color);this.HideAndModeSymbols=true;break;case 3:this.TextIndent=16;this.AltClass="_Led_"+color;this.PageBinder.GetDocumentMgr().LoadLedStyle(color);break;case 7:this.TextIndent=16;this.AltClass="_LED_CHECK_"+color;this.PageBinder.GetDocumentMgr().LoadLedCheckStyle(color);if(!this.OnlyoneSelected){this.AutoCtrl=true}this.HasSelectedExcluded=true;break;case -1:case 0:default:this.TextIndent=1;this.AltClass="";break}this.AltClass_OnBorder=!!this.AltClass;var Semantic=node.getAttribute("semantic")=="true";if(Semantic){this.AltClass="_Semantic"}};Qva.Mgr.listbox.prototype.Paint=function(mode,node,name,partial){this.Touched=true;var element=this.Element;var owner=node.getAttribute("owner");if(owner){var row=parseInt(node.getAttribute("row"));var col=parseInt(node.getAttribute("col"));var position=node.getAttribute("position");if(this.Owner&&(this.Owner!=owner||this.Row!=row||this.Col!=col||this.Position!=position)){if(this.Content){this.Content.innerHTML=""}}this.Owner=owner;this.Row=row;this.Col=col;this.Position=position;var ownerelement=document.getElementById(this.Owner);if(ownerelement){var input=$(ownerelement).find("input");if(input.length>0){this.Input=input}}}Qva.UpdateScroll(this);function getNodeByName(name){for(var i=0;i<node.childNodes.length;++i){if(node.childNodes[i].tagName=="value"&&node.childNodes[i].getAttribute("name")==name){return node.childNodes[i]}}return null}var bodyNode=getNodeByName("Body");if(bodyNode){element.style.display=bodyNode.getAttribute("mode")=="enabled"?"":"none"}if(element.style.display=="none"){return}var stylenodes=node.getElementsByTagName("style");if(stylenodes.length>0){this.Style=[];stylenodes=stylenodes[0].getElementsByTagName("style");for(var istyle=0;istyle<stylenodes.length;istyle++){this.Style[istyle]=new this._StyleObject(stylenodes[istyle])}}stylenodes=node.getElementsByTagName("borderstyle");if(stylenodes.length>0){this.BorderStyle=[];stylenodes=stylenodes[0].getElementsByTagName("borderstyle");for(istyle=0;istyle<stylenodes.length;istyle++){var b=this.BorderStyle[istyle]=new this._BorderStyleObject(stylenodes[istyle])}}var styleNode=getNodeByName("Style");if(styleNode){var fontfamily=this.fontfamily=styleNode.getAttribute("fontfamily");var fontsize=this.fontsize=styleNode.getAttribute("fontsize")+"pt";var fontweight=this.fontsize=styleNode.getAttribute("fontweight");this.TextHeight=Qva.MeasureFontHeight(fontfamily,fontsize,fontweight);var longestString=node.getAttribute("longest");this.TextLength=Qva.MeasureText(longestString,fontfamily,fontsize,fontweight).width+4}this.readOnly=node.getAttribute("readonly")==="true";this.disabled=node.getAttribute("mode")==="disabled";this.orderByCol=node.getAttribute("order")==="col";this.fixedCols=parseInt(node.getAttribute("columns"));if(isNaN(this.fixedCols)){this.fixedCols=null}this.maxrows=parseInt(node.getAttribute("maxrows"));if(isNaN(this.maxrows)){this.maxrows=null}function getPos(name){var val=node.getAttribute(name);if(!val){return 0}var pos=val.split(":");return parseInt(pos[1])}function getScrollPos(name){var val=node.getAttribute(name);if(!val){return{x:0,y:0}}var pos=val.split(":");return{x:parseInt(pos[0]),y:parseInt(pos[1])}}if(node.getAttribute("totalsize")!=null){this.ChunkOffset=getPos("pageoffset");this.ChunkSize=getPos("pagesize");this.TotalSize=getPos("totalsize")}else{this.ChunkOffset=0;var y=getNodeByName("C0").getElementsByTagName("element").length;this.TotalSize=this.ChunkSize=y}partial=this.ChunkOffset!==0;if(!partial){this.Lines=[];this.YScroll.Scrolled=false;this.XScroll.Scrolled=false;this.LastSize=null}if(node.getAttribute("scrollposition")!=null){this.ScrollPosition=getScrollPos("scrollposition")}else{this.ScrollPosition={x:0,y:0}}this.andmode=node.getAttribute("andmode")=="true";this.CurrentPhase=0;this.suppresshorizontalscroll=node.getAttribute("suppresshorizontalscroll")==="true";this.sizetodata=node.getAttribute("sizetodata")==="true";this.PageBinder.Searchable=node.getAttribute("searchable")=="true";this.hideexcluded=node.getAttribute("hideexcluded")==="true";var colNode=getNodeByName("C0");if(colNode){var entries=colNode.getElementsByTagName("element");if(this.Name==="Document.DS"&&entries.length===1&&entries[0].childNodes.length===0){if($("#"+this.Owner).attr("objType")==="SearchObject"){entries[0].setAttribute("text",Qva.localization.getStringFromKey("noMatches"))}}for(var rix=0;rix<entries.length;++rix){var entry=entries[rix];var full_rix=rix+this.ChunkOffset;if(this.Lines[full_rix]==null){this.Lines[full_rix]=[]}this.Lines[full_rix]=new this._CellObject(entry)}var any_cell=this.Lines[this.Lines.length-1];this.rowHeight=any_cell?any_cell.rowspan*this.TextHeight:0;if(this.PageBinder.PageBinder.isSmallDevices&&this.ObjectId==="DS"){this.rowHeight+=32}this.singleselect=any_cell&&any_cell.selecttype=="single"}this.PageBinder.QueuePostPaintMessage(this);this.OnlyoneSelected=node.getAttribute("onlyoneselected")=="true";var selectionstyle=node.getElementsByTagName("selectionstyle");if(selectionstyle.length>0){this.AddSelectionStyle(selectionstyle[0])}};Qva.Mgr.listbox.prototype._appendCellIcon=function(icon,offset,stretchmode,adjust,width,height){var img=this.PageBinder.GetDocumentMgr().CreateCellIcon(icon,stretchmode,adjust,width,height);AppendAction(img,icon,this,offset);return img};Qva.Mgr.listbox.prototype._CheckSize=Qva.Mgr.grid.prototype._CheckSize;Qva.Mgr.listbox.prototype._UpdateSize=function(width,height){var scrollProperties=this.ScrollProperties,calcH=0;var new_height=Math.floor(height/this.rowHeight)*this.rowHeight;var OrderByColumn=this.orderByCol;var fixed_columns=this.fixedCols;var max_rows=this.maxrows;var bothScrollsVisible=true;var rows,columns,visible_cols;var single_col_scroll=false;if(OrderByColumn){function gerRows(height){var rows=this.rowHeight>=0?Math.floor(height/this.rowHeight):1;if(rows>this.TotalSize){rows=this.TotalSize}if(max_rows!=null&&max_rows<rows){rows=max_rows}if(rows<1){rows=1}return rows}rows=gerRows.call(this,height);columns=Math.ceil(this.TotalSize/rows);single_col_scroll=!this.suppresshorizontalscroll&&columns==1&&Math.floor(width/columns)<this.TextLength;if(fixed_columns!=null&&fixed_columns<columns||width<columns*this.TextLength||single_col_scroll){visible_cols=(fixed_columns!=null)?fixed_columns:Math.floor(width/this.TextLength);visible_cols=columns<visible_cols?columns:visible_cols;if(visible_cols<columns){height-=scrollProperties.width}rows=gerRows.call(this,height);columns=Math.ceil(this.TotalSize/rows)}else{visible_cols=columns}}else{function getColumns(width){var columns;if(fixed_columns!=null){columns=fixed_columns}else{columns=Math.floor(width/this.TextLength)}if(columns>this.TotalSize){columns=this.TotalSize}if(columns<1){columns=1}return columns}columns=getColumns.call(this,width);rows=Math.ceil(this.TotalSize/columns);single_col_scroll=!this.suppresshorizontalscroll&&columns==1&&Math.floor(width/columns)<this.TextLength;if(single_col_scroll){height-=scrollProperties.width}if(Math.max(height,this.rowHeight)<rows*this.rowHeight||this.maxrows!=null&&this.maxrows<rows){width-=scrollProperties.width;width=Math.max(0,width);columns=getColumns.call(this,width);rows=Math.ceil(this.TotalSize/columns)}if(!single_col_scroll&&!this.suppresshorizontalscroll&&columns==1&&Math.floor(width/columns)<this.TextLength){single_col_scroll=true;height-=scrollProperties.width;height=Math.max(0,height)}visible_cols=columns}if(visible_cols<1){visible_cols=1}var colwidth=this.colwidth=Math.floor(width/visible_cols);var dx=width-visible_cols*colwidth;if(visible_cols==columns&&!single_col_scroll){Assert(dx<visible_cols);this.col_extra=dx;dx=0}else{this.col_extra=0;width=visible_cols*colwidth}var element=this.Element,$ele=$(this.Element);var path=$(element).parent().parent().getPath();if(Qva.CheckElementCache(path)){var cachedElements=Qva.ElementCacheHandler();var cacheLength=cachedElements.length;var toproc=cacheLength-1;if(cachedElements[toproc][4]=="complete"){toproc++}var cache=cachedElements[toproc];var root=cache[3];var borderwidth=isNaN(root.BorderWidth)?0:root.BorderWidth}var visible_rows=Math.floor((height)/this.rowHeight);if(max_rows!=null&&max_rows<visible_rows){visible_rows=max_rows}var dy=0;if(this.Lines.length===0){dy=height;height=0}else{if(height<this.rowHeight){dy=height-this.rowHeight;height=this.rowHeight;visible_rows=1}else{if(this.sizetodata){var new_height=visible_rows*this.rowHeight;if(new_height>rows*this.rowHeight){new_height=rows*this.rowHeight}dy=height-new_height;height=new_height}}}var captionborder=parseFloat($(this.Element).parent().parent().children(".QvCaption").css("borderBottomWidth"))+parseFloat($(this.Element).parent().parent().children(".QvCaption").css("borderTopWidth"));if(!captionborder){captionborder=0}var frameborder=parseFloat($(this.Element).parent().parent().css("borderBottomWidth"))+parseFloat($(this.Element).parent().parent().css("borderTopWidth"));if(!frameborder){frameborder=0}var captionheight=parseFloat($(this.Element).parent().parent().children(".QvCaption").css("height"));if(!captionheight){captionheight=0}var scrollX=false;if(visible_cols<columns){this.XScroll.Set(0,height,width,columns*colwidth,width,0,height);scrollX=true}else{if(single_col_scroll){this.colwidth=this.TextLength;this.XScroll.Set(0,height,width,this.TextLength,width,0,height);this.x_max_scroll=this.colwidth-width;scrollX=true}else{this.XScroll.Hide();bothScrollsVisible=false}}if(visible_rows<rows){this.YScroll.Set(width,0,height,rows*this.rowHeight,height,width,0)}else{this.YScroll.Hide();bothScrollsVisible=false}if(bothScrollsVisible){this.YScroll.EnablePaddingElement()}else{this.YScroll.DisablePaddingElement()}var has_any_scrollbar=visible_cols<columns||visible_rows<rows;var scrollbarheight=0;if(scrollX){scrollbarheight=this.XScroll.props.width}if(Qva.IS_WORKBENCH||Qva.IS_WEBPARTS){if(scrollX){if(Qva.userAgentDetector.get("msie")){if(!Qva.userAgentDetector.get("msie8lte")){scrollbarheight+=1}}else{scrollbarheight-=1}}}var iefactor=0;if(Qva.userAgentDetector.get("msie8lte")){iefactor=-1}if(Qva.userAgentDetector.get("msie6o7")){iefactor=frameborder-1}calcH=height+captionheight+captionborder+frameborder+scrollbarheight-iefactor;$ele.parent().parent().css("height",calcH);$ele.parent().css("height",height+scrollbarheight);$ele.parent().css("width",width);$ele.css("height",height);if($ele.parent()&&$ele.parent().parent()&&$ele.parent().parent().children()[0]&&$ele.parent().parent().children()[0].className=="ResizeFrame"){Qva.Mgr.CreateAndUpdateResizeHandles($ele.parent().parent()[0],frameborder/2,false,true)}this.PageBinder.GetDocumentMgr()._Send("set",this.Name,true,{scrollbar:(has_any_scrollbar?"true":"false")});this.OrderByColumn=OrderByColumn;this.single_col_scroll=single_col_scroll;this.visible_cols=visible_cols;this.columns=columns;this.visible_rows=visible_rows;this.rows=rows;var that=this;this._makeScrollObj({setPosition:function(x,y){translate(that.Content,x,y)},setTransitionTime:function(time){setDuration(that.Content,time)},getPosition:function(){var webkitTransform=window.getComputedStyle(that.Content).webkitTransform;if(webkitTransform==="none"||!webkitTransform){return{x:that.Content.offsetLeft,y:that.Content.offsetTop}}if(webkitTransform&&webkitTransform!=="none"){var matrix=new WebKitCSSMatrix(webkitTransform);return{x:matrix.e,y:matrix.f}}}});this._addMouseScroll(width,height);var $pEle=$ele.parent(),bgImgUrl=$pEle.css("backgroundImage");if(bgImgUrl.indexOf("height=")>-1){$pEle.css("backgroundImage",bgImgUrl.substr(0,bgImgUrl.indexOf("height="))+"height="+($ele.closest(".QvFrame").find(".QvCaption").css("display")==="none"?height+parseInt(!isNaN($ele.closest(".QvFrame").css("bottomBorderWidth"))?$ele.closest(".QvFrame").css("bottomBorderWidth"):parseFloat($ele.closest(".QvFrame")[0].style.borderWidth)):height)+'px")');if($ele.closest(".QvFrame").find(".QvCaption").css("display")==="none"){$pEle.css("height",height+parseInt(!isNaN($ele.closest(".QvFrame").css("bottomBorderWidth"))?$ele.closest(".QvFrame").css("bottomBorderWidth"):parseFloat($ele.closest(".QvFrame")[0].style.borderWidth))+"px")}}Qva.Events.SetTouchAction($ele.parent(),this.XScroll&&this.XScroll.IsVisible(),this.YScroll&&this.YScroll.IsVisible());return{dx:dx,dy:dy,width:width,height:height}};Qva.Mgr.listbox.prototype._makeScrollObj=Qva.Mgr.grid.prototype._makeScrollObj;Qva.Mgr.listbox.prototype._addMouseScroll=function(width,height){var that=this;function queuePostPaint(){that.PageBinder.QueuePostPaintMessage(that)}function setPosition(x,y){that.scroll_obj.setPosition(x,y)}function setTransitionTime(time){that.scroll_obj.setTransitionTime(time)}var scroll_x=0;var scroll_y=0;var x_max=Math.max(0,this.columns*this.colwidth-width);function limit_x(x){if(-x<0){return 0}if(-x>x_max){return -x_max}return x}function snap_x(x){x=!that.single_col_scroll?Math.round(x/that.colwidth)*that.colwidth:x;return limit_x(x)}var y_max=Math.max(0,this.rows*this.rowHeight-height);function limit_y(y){if(-y<0){return 0}if(-y>y_max){return -y_max}return y}function snap_y(y){y=Math.round(y/that.rowHeight)*that.rowHeight;return limit_y(y)}var x_actions={step:function(dx,noTransition){scroll_x=limit_x(scroll_x+dx*that.colwidth);setTransitionTime((noTransition?0:500)+"ms");setPosition(scroll_x,scroll_y);queuePostPaint()},scroll:function(dx){var x=snap_x(dx+scroll_x);setPosition(x,scroll_y);setTransitionTime("0ms");queuePostPaint()},scroll_end:function(dx){scroll_x=snap_x(dx+scroll_x);setTransitionTime("500ms");setPosition(scroll_x,scroll_y);queuePostPaint()},page:function(dx){scroll_x=limit_x(dx*that.colwidth*(that.visible_cols-1)+scroll_x);setTransitionTime("500ms");setPosition(scroll_x,scroll_y);queuePostPaint()}};var y_actions={step:function(dy,noTransition){scroll_y=snap_y(scroll_y+dy*that.rowHeight);setTransitionTime((noTransition?0:500)+"ms");setPosition(scroll_x,scroll_y);queuePostPaint()},scroll:function(dy){var y=snap_y(dy+scroll_y);setPosition(scroll_x,y);setTransitionTime("0ms");queuePostPaint()},scroll_end:function(dy){scroll_y=snap_y(dy+scroll_y);setTransitionTime("500ms");setPosition(scroll_x,scroll_y);queuePostPaint()},page:function(dy){scroll_y=limit_y(dy*that.rowHeight*(that.visible_rows-1)+scroll_y);setTransitionTime("500ms");setPosition(scroll_x,scroll_y);queuePostPaint()}};this.XScroll.bindEvents(x_actions);this.YScroll.bindEvents(y_actions);this.actions=y_max>0?y_actions:x_actions};Qva.Mgr.listbox.prototype.HideTransientListbox=function(){if(this.Content){this.Content.innerHTML=""}this.PageBinder.Element.style.display="none";this.Selections={Selected:[]};if(Qva.userAgentDetector.get("touchEnabled")&&Qva.Touch.Listbox.SelectMenu){Qva.Touch.Listbox.SelectMenu.Hide(true)}if(this.scroll_obj){this.scroll_obj.setPosition(0,0)}this.DocumentBinder.Set(this.Name,"closetransient","ok",false);setTimeout(function(){Qva.params.transientMenuOpen=false},100)};Qva.Mgr.listbox.prototype.PostPaint=function(){var element=this.Element;if(element.style.display=="none"){return}var size=this._CheckSize(false,true);var width=size.width;var height=size.height;var changed=size.changed;if(this.Lines.length==0){return}var touch_scroll={x:0,y:0};if(this.scroll_obj){touch_scroll=this.scroll_obj.getCurrentScroll()}this.scroll_obj.setPosition(-touch_scroll.x,-touch_scroll.y);var real_colwidth=this.single_col_scroll?this.TextLength:this.colwidth;var xScroll=Math.max(0,Math.floor(touch_scroll.x/real_colwidth));var yScroll=Math.max(0,Math.floor(touch_scroll.y/this.rowHeight));var visible_cols=Math.min(this.visible_cols+1,this.columns-xScroll);var visible_rows=Math.min(this.visible_rows+1,this.rows-yScroll);if(visible_cols===0||visible_rows===0){return}var colMap=[];var lineMap=[];var i;var path=$(element).parent().parent().getPath();if(Qva.CheckElementCache(path)){var cachedElements=Qva.ElementCacheHandler();var cacheLength=cachedElements.length;var toproc=cacheLength-1;if(cachedElements[toproc][4]=="complete"){toproc++}var cache=cachedElements[toproc];var procElement=cache[1];var root=cache[3];var borderwidth=isNaN(root.BorderWidth)?0:root.BorderWidth}for(i=0;i<visible_cols;++i){var cix=i+xScroll;colMap.push({offset:((this.OrderByColumn?this.rows:1)*cix),xPos:(this.colwidth*cix),width:(real_colwidth+(i<this.col_extra?1:0))})}for(i=0;i<visible_rows;++i){var rix=i+yScroll;lineMap.push({offset:((this.OrderByColumn?1:this.columns)*rix),yPos:(this.rowHeight*rix),height:this.rowHeight})}var colMap0,colMap1,colMap2,lineMap1,lineMap0;if(colMap&&colMap[0]){colMap0=colMap[0].offset}else{colMap0=0}if(lineMap&&lineMap[0]){lineMap0=lineMap[0].offset}else{lineMap0=0}colMap1=colMap0+lineMap0;if(colMap&&colMap[1]){colMap2=colMap2=colMap[colMap.length-1].offset}else{colMap2=0}if(lineMap&&lineMap[1]){lineMap1=lineMap[lineMap.length-1].offset}else{lineMap1=0}this.Visible={Start:colMap1,End:Math.min(colMap2+lineMap1,this.TotalSize-1)};function safeHeight(i){if(Qva.userAgentDetector.get("msedge")||Qva.userAgentDetector.get("msie")||Qva.userAgentDetector.get("gecko")||Qva.userAgentDetector.get("chrome")){return Math.min(i,Qva.userAgentDetector.get("maxHeight"))}return i}if(changed){this.Painted=[];var content=document.createElement("div");content.style.position="relative";content.style.overflow="hidden";content.style.width=(this.columns*real_colwidth+this.col_extra)+"px";content.style.height=safeHeight(this.rows*this.rowHeight)+"px";this._PaintCells(content,lineMap,colMap,width);element.replaceChild(content,this.Content);$(this.Content).find("div").each(function(){$(this).unbind()});this.Content=content;if(this.ScrollPosition.x!==0||this.ScrollPosition.y!==0){if(this.ScrollPosition.x!==0&&this.XScroll.actions){this.XScroll.actions.step(this.OrderByColumn?-this.ScrollPosition.x/this.rows:-this.ScrollPosition.x,true)}if(this.ScrollPosition.y!==0&&this.YScroll.actions){this.YScroll.actions.step(-this.ScrollPosition.y,true)}this.PageBinder.QueuePostPaintMessage(this)}else{this.PageBinder.SetScrollPos(this.ScrollPosition)}}else{this._PaintCells(this.Content,lineMap,colMap,width);var x=xScroll*this.rows;var y=yScroll*this.columns;if(this.ScrollPosition&&(this.ScrollPosition.y!=y||this.ScrollPosition.x!=x)){if(this.SendPosition){this.SendPosition=clearTimeout(this.SendPosition)}var ObjectBinder=this.PageBinder;this.SendPosition=setTimeout(function(){if(!ObjectBinder.GetEnabled()){return}ObjectBinder.SetScrollPos({x:x,y:y})},500)}}$(this.Content).parent().css("visibility","visible");Qva.SetEllipsisOnMultiLineElement(this.Content);if(this.Selections.mouseDown||this.Selections.Selected.length>0){this._IndicateCellsToSelect()}return};Qva.Mgr.listbox.prototype._PaintCells=function(content,lineMap,colMap,boxWidth){var x,y;for(y=0;y<lineMap.length;++y){for(x=0;x<colMap.length;++x){var offset=lineMap[y].offset+colMap[x].offset;if(offset>=this.TotalSize){continue}if(!this.Lines[offset]){this.PageBinder.PartialLoad("Document."+this.ObjectId,{x:0,y:Math.floor(offset/this.ChunkSize)*this.ChunkSize});return false}var cell=this.Lines[offset];var xOffset=colMap[x].xOffset||0;var yOffset=lineMap[y].yOffset||0;var left=colMap[x].xPos+xOffset;var top=lineMap[y].yPos+yOffset;var width=cell.rowspan===1||colMap.length>1?colMap[x].width-xOffset:boxWidth-xOffset;var height=lineMap[y].height-yOffset;if(this.Painted[offset]){continue}var div=this.Painted[offset]=document.createElement("div");var inner_width=colMap[x].width;var inner_height=lineMap[y].height;var border_div=document.createElement("div");border_div.style.position="absolute";border_div.style.zIndex=1;if(y+1===lineMap.length){border_div.last=true}else{border_div.last=false}inner_width-=this._MakeBorder(border_div,"Left","Right",function(w){return Math.ceil(w/2)-1});inner_width-=this._MakeBorder(border_div,"Right","Left",function(w){return Math.floor(w/2)+1});inner_height-=this._MakeBorder(border_div,"Top","Bottom",function(w){return Math.ceil(w/2)-1});inner_height-=this._MakeBorder(border_div,"Bottom","Top",function(w){return Math.floor(w/2)+1});if(this.Style[0].CellBorders==="1"&&this.BorderStyle[0].Top.width>0){xOffset+=1;inner_width+=2;if(border_div.last===true){inner_height+=1;border_div.style.borderBottom="none"}}border_div.style.left=(-xOffset)+"px";border_div.style.top=(-yOffset)+"px";border_div.style.width=inner_width+"px";border_div.style.height=inner_height+"px";border_div.setAttribute("unselectable","on");div.appendChild(border_div);div.style.cssText=this._SetCellStyle(cell,false,false);div.style.cursor="pointer";div.style.position="absolute";div.style.overflow="hidden";div.style.overflow="hidden";div.style.left=left+"px";div.style.top=top+"px";div.style.width=width+"px";div.style.height=height+"px";div.setAttribute("unselectable","on");div.title=cell.title;div.offset=offset;div.value=cell.intval;div.onclick=Qva.CancelAction;if(cell.selecttype!=null){div.selectsource=cell.selectsource;Qva.Events.setClickElem(div,"select")}var inner_div=document.createElement("div");inner_div.style.padding="0";inner_div.style.width=width+"px";inner_div.style.height=height+"px";inner_div.setAttribute("unselectable","on");inner_div.title=cell.title;inner_div.style.whiteSpace=cell.rowspan===1?"pre":(Qva.userAgentDetector.get("msie")?"":"pre-wrap");if(Qva.userAgentDetector.get("msie")){$(inner_div).attr("unselectable","on")}div.appendChild(inner_div);var style=this.Style[0];var stretchmode=style.StretchMode;var textalign=cell.isnum?style.NumAdjust:style.TextAdjust;var altClass=(this.hideexcluded&&cell.state=="Excluded")?"":this.AltClass;div.className="Qv"+cell.state+altClass;if(this.AltClass_OnBorder){border_div.className="Qv"+cell.state+altClass}var _width=width;var totpercentwidth=0;for(var isub=0;isub<cell.subcontent.length;isub++){var subcontent=cell.subcontent[isub];var w=parseInt(subcontent.getAttribute("width"));if(!isNaN(w)){_width-=w}var percentwidth=parseInt(subcontent.getAttribute("percentwidth"));if(!isNaN(percentwidth)){totpercentwidth+=percentwidth}}function sub_div(width,textcell){var d=document.createElement("div");d.position=div.position;d.binderid=this.PageBinder.ID;d.ObjectId=this.ObjectId;d.style.width=width+"px";d.style.cssFloat="left";d.style.styleFloat="left";d.setAttribute("unselectable","on");if(cell.rowspan===1||!textcell){d.style.height=height+"px";d.style.overflow="hidden";d.style.wordWrap="normal"}else{$(d).addClass("Qv_multiline")}d.style.whiteSpace=cell.rowspan===1?"pre":(Qva.userAgentDetector.get("msie")?"":"pre-wrap");inner_div.appendChild(d);if(Qva.userAgentDetector.get("msie")){$(d).attr("unselectable","on")}return d}if(cell.val){_width-=this.TextIndent;_width-=2;sub_div.call(this,this.TextIndent)}var icon_size=14;if(cell.level){var indent=cell.level*icon_size;_width-=indent;if(cell.expandcollapse_icon){indent-=icon_size}sub_div.call(this,indent);if(cell.expandcollapse_icon){var d=sub_div.call(this,icon_size);var icon=this._appendCellIcon(cell.expandcollapse_icon,cell.intval,stretchmode,textalign,icon_size,height);icon.style.top=((height-icon_size)/2)+"px";icon.style.zIndex=1;d.appendChild(icon);var input=this.Input;if(input&&!Qva.userAgentDetector.get("touchEnabled")){$(icon).bind("mouseup",function(){input.focus()})}}_width-=2;sub_div.call(this,2)}if(this.andmode&&!this.HideAndModeSymbols){var andmode_width=12;_width-=andmode_width;var d=sub_div.call(this,andmode_width);var text=Qva.Mgr.listbox.AndModeSymbol(cell.state);d.appendChild(document.createTextNode(text));div.AndModeSymbol=d}if(cell.input_icon){_width-=icon_size}var w=parseInt(_width*Math.max(0,100-totpercentwidth)/100);if(w>0){if(cell.led_icon){w-=icon_size}var d=sub_div.call(this,w,cell.val);if(cell.val){AppendWidthHighlights(d,cell.val,cell.parts)}else{if(cell.main_icon){var icon=this._appendCellIcon(cell.main_icon,cell.intval,stretchmode,textalign,w,height);icon.style.top="0";d.appendChild(icon)}}if(cell.led_icon){var d=sub_div.call(this,icon_size);var icon=this._appendCellIcon(cell.led_icon,cell.intval,stretchmode,textalign);icon.style.top=((height-icon_size)/2)+"px";d.appendChild(icon)}}for(var isub=0;isub<cell.subcontent.length;isub++){var subcontent=cell.subcontent[isub];var w=parseInt(subcontent.getAttribute("width"));if(isNaN(w)){w=parseInt(_width*parseInt(subcontent.getAttribute("percentwidth"))/100)}if(w<=0){continue}if(subcontent.getAttribute("name")){var d=sub_div.call(this,w);var icon=this.PageBinder.GetDocumentMgr().CreateCellIcon(subcontent,stretchmode,textalign,w,height);AppendAction(icon,subcontent,this,cell.intval);d.appendChild(icon)}else{var d=sub_div.call(this,w,true);d.appendChild(document.createTextNode(subcontent.getAttribute("text")||"  "));if(subcontent.getAttribute("align")){d.style.textAlign=subcontent.getAttribute("align")}}}if(cell.input_icon){var d=sub_div.call(this,icon_size);var icon=this._appendCellIcon(cell.input_icon,cell.intval,stretchmode,textalign);icon.style.top=((height-icon_size)/2)+"px";icon.style.zIndex=1;d.appendChild(icon)}content.appendChild(div);div=null;inner_div=null;border_div=null}}inner_div=null;border_div=null;div=null};Qva.Mgr.listbox.AndModeSymbol=function(state){if(state=="Selected"){return"&"}else{if(state=="Deselected"){return"!"}else{return" "}}};Qva.Mgr.listbox.prototype.StartPhaseShift=function(delay){var _this=this;if(this.phase_timout){return}this.phase_timout=setTimeout(function(){_this.NextPhase()},delay)};Qva.Mgr.listbox.prototype.NextPhase=function(){this.CurrentPhase=(this.CurrentPhase+1)%3;this._IndicateCellsToSelect();this.phase_timout=null;this.StartPhaseShift(1100)};Qva.Mgr.listbox.prototype.EndPhaseShift=function(){if(this.phase_timout){clearTimeout(this.phase_timout);this.phase_timout=null}};Qva.ListBoxSelection={CurrentMgr:null,ParentCoords:{},Start:function(mgr,elem,ctrl){mgr.Selections.Start=mgr.Selections.End=elem.offset;mgr.Selections.SelectSource=elem.selectsource;mgr.Selections.mouseDown=true;mgr.Selections.ctrl=!mgr.OnlyoneSelected&&ctrl;var $parent=$(mgr.Element);var elemoffset=$parent.offset();this.ParentCoords={top:elemoffset.top,left:elemoffset.left,right:(elemoffset.left+$parent.width()),bottom:(elemoffset.top+$parent.height())};this.CurrentMgr=mgr},End:function(toggle){this.CurrentMgr._EndSelect(toggle);this.CurrentMgr=null;this.ParentCoords={}}};Qva.ListBoxSelectionManager=function(mgr){var $document=$(document);if(window.parent&&window.parent!=window){try{var $parentdocument=$(window.parent.document)}catch(e){}}var that=this;this.AddEvents=function(elem){Qva.Events.AddDragSelectEvent(elem,function(event){if(!mgr.PageBinder.GetEnabled()){return false}if(Qva.ListBoxSelection.CurrentMgr!=null&&Qva.ListBoxSelection.CurrentMgr!=mgr){return false}var target=Qva.Events.getClickElem(elem,event);if(!target||target[Qva.Events.Flags.Click]!="select"){return false}var ctrl=ctrlKeyPressed(event);Qva.ListBoxSelection.Start(mgr,target,ctrl);mgr._IndicateCellsToSelect();mgr.Selections.StartY=Qva.Events.getClientY(event);mgr.Selections.StartX=Qva.Events.getClientX(event);mgr.Selections.ScrollStart=mgr.scroll_obj.getCurrentScroll();mgr.Selections.ScrollY=0;mgr.Selections.ScrollX=0;var frame=$(elem).closest(".QvFrame");mgr.QvFramePos=frame.position();mgr.QvFramePos.dx=mgr.QvFramePos.left-mgr.Selections.StartX;mgr.QvFramePos.dxL=mgr.colwidth+(mgr.QvFramePos.dx%mgr.colwidth);mgr.QvFramePos.dxR=mgr.QvFramePos.dx%mgr.colwidth;Qva.BlurActiveElement()},function(event){if(Qva.ListBoxSelection.CurrentMgr!=mgr){return}if(!mgr.PageBinder.GetEnabled()){return}if(!mgr.Selections.mouseDown){return}var clientX=Qva.Events.getClientX(event),clientY=Qva.Events.getClientY(event),currentScroll=mgr.scroll_obj.getCurrentScroll();mgr.Selections.ScrollX=currentScroll.x-mgr.Selections.ScrollStart.x;mgr.Selections.ScrollY=currentScroll.y-mgr.Selections.ScrollStart.y;var dx=parseInt((clientX-mgr.Selections.StartX+mgr.Selections.ScrollX-((clientX-mgr.Selections.StartX+mgr.Selections.ScrollX<=0)?mgr.QvFramePos.dxL:mgr.QvFramePos.dxR))/mgr.colwidth);var dy=parseInt((clientY-mgr.Selections.StartY+mgr.Selections.ScrollY)/mgr.rowHeight);mgr.Selections.End=mgr.OrderByColumn?mgr.Selections.Start+(dx*mgr.rows)+dy:mgr.Selections.Start+(dy*mgr.columns)+dx;if(mgr.singleselect){mgr.Selections.Start=mgr.Selections.End}mgr.Selections.ctrl=!mgr.OnlyoneSelected&&ctrlKeyPressed(event);mgr._IndicateCellsToSelect()},function(event){if(Qva.ListBoxSelection.CurrentMgr!=mgr){return}mgr.Selections.ctrl=!mgr.OnlyoneSelected&&ctrlKeyPressed(event);mgr.Selections.mouseDown=false;mgr._SaveCurrentSelection();if(mgr.Selections.ctrl){if(!mgr.Selections.ctrlKeyUpEventDefined){mgr.Selections.ctrlKeyUpEventDefined=true;$(document).on("keyup.listboxselection",function(event){var ctrl=ctrlKeyPressed(event);if(!ctrl){Qva.ListBoxSelection.End(true);$(document).off("keyup.listboxselection")}})}}else{Qva.ListBoxSelection.End(false)}},{useEventTarget:true,fnInterval:function(){if(Qva.ListBoxSelection.CurrentMgr!=mgr){return}if(!mgr.PageBinder.GetEnabled()){return}if(!mgr.Selections.mouseDown){return}var event=mgr.Selections.latestMoveEvent;if(!event){return}var clientX=Qva.Events.getX(event),clientY=Qva.Events.getY(event);var fnIndicateSelection=function(){if(!mgr.Selections.ScrollStart){return}var currentScroll=mgr.scroll_obj.getCurrentScroll();mgr.Selections.ScrollX=currentScroll.x-mgr.Selections.ScrollStart.x;mgr.Selections.ScrollY=currentScroll.y-mgr.Selections.ScrollStart.y;var xpos=clientX,ypos=clientY;if(clientX<Qva.ListBoxSelection.ParentCoords.left){xpos=Qva.ListBoxSelection.ParentCoords.left}else{if(clientX>Qva.ListBoxSelection.ParentCoords.right){xpos=Qva.ListBoxSelection.ParentCoords.right}}if(clientY<Qva.ListBoxSelection.ParentCoords.top){ypos=Qva.ListBoxSelection.ParentCoords.top}else{if(clientY>Qva.ListBoxSelection.ParentCoords.bottom){ypos=Qva.ListBoxSelection.ParentCoords.bottom}}var dx=parseInt((xpos-mgr.Selections.StartX+mgr.Selections.ScrollX-((xpos-mgr.Selections.StartX+mgr.Selections.ScrollX<=0)?mgr.QvFramePos.dxL:mgr.QvFramePos.dxR))/mgr.colwidth);var dy=parseInt((ypos-mgr.Selections.StartY+mgr.Selections.ScrollY)/mgr.rowHeight);mgr.Selections.End=mgr.OrderByColumn?mgr.Selections.Start+(dx*mgr.rows)+dy:mgr.Selections.Start+(dy*mgr.columns)+dx;if(mgr.singleselect){mgr.Selections.Start=mgr.Selections.End}mgr.Selections.ctrl=!mgr.OnlyoneSelected&&ctrlKeyPressed(event);mgr._IndicateCellsToSelect()};var x_scroll=mgr.XScroll.IsVisible();var y_scroll=mgr.YScroll.IsVisible();var xstep=0,ystep=0;if(x_scroll&&clientX<Qva.ListBoxSelection.ParentCoords.left){xstep=1}else{if(x_scroll&&clientX>Qva.ListBoxSelection.ParentCoords.right){xstep=-1}}if(y_scroll&&clientY<Qva.ListBoxSelection.ParentCoords.top){ystep=1}else{if(y_scroll&&clientY>Qva.ListBoxSelection.ParentCoords.bottom){ystep=-1}}if(xstep!=0||ystep!=0){if(xstep!=0){mgr.XScroll.actions.step(xstep,true)}if(ystep!=0){mgr.YScroll.actions.step(ystep,true)}mgr.PageBinder.GetDocumentMgr().CallOnceOnUpdateComplete(function(){fnIndicateSelection.apply()})}},fnMoveOutside:function(event){mgr.Selections.latestMoveEvent=event}});Qva.Events.AddClickEvent(elem,function(event){var target=Qva.Events.getClickElem(elem,event);var ctrl=ctrlKeyPressed(event);if(!target||target[Qva.Events.Flags.Click]!="select"){return}if(target.disabled){return}if(!mgr.PageBinder.GetEnabled()){return}if(Qva.ListBoxSelection.CurrentMgr!=null&&Qva.ListBoxSelection.CurrentMgr!=mgr){if(ctrl){return}Qva.ListBoxSelection.End()}if(Qva.Events.isTouchEvent(event)){var content=$(this).closest(".QvContent")[0];var objLBTouch=content.Touch;if(Qva.Touch.Listbox.SelectMenu&&Qva.Touch.Listbox.SelectMenu.Visible&&Qva.Touch.Listbox.SelectMenu.ListboxObject!==objLBTouch){Qva.Touch.Listbox.SelectMenu.Hide(true)}if(Qva.Touch.SelectionPopup){Qva.Touch.SelectionPopup.Hide()}objLBTouch.CellSelectable=(target.offset!=undefined&&mgr.Lines[target.offset]&&mgr.Lines[target.offset].selecttype);if(!mgr.readOnly&&!mgr.disabled&&objLBTouch.CellSelectable){if(objLBTouch.MultiSelectMode&&!objLBTouch.MultiSelectModeInitializing){Qva.Touch.Listbox.PreSelectMulti({row:target,lb:objLBTouch,contentElem:content})}else{if(!objLBTouch.MultiSelectMode){Qva.Touch.Listbox.PreSelectSingle({row:target,lb:objLBTouch})}}}return}Qva.ListBoxSelection.Start(mgr,target,ctrl);mgr._IndicateCellsToSelect();mgr.Selections.ctrl=!mgr.OnlyoneSelected&&ctrl;mgr.Selections.mouseDown=false;mgr._SaveCurrentSelection();if(mgr.Selections.ctrl&&target.offset!=undefined&&mgr.Lines[target.offset]&&(mgr.Lines[target.offset].selecttype)=="multi"){if(!mgr.Selections.ctrlKeyUpEventDefined){mgr.Selections.ctrlKeyUpEventDefined=true;$(document).on("keyup.listboxselection",function(event){var ctrl=ctrlKeyPressed(event);if(!ctrl){mgr.Selections.ctrl=false;Qva.ListBoxSelection.End(true);$(document).off("keyup.listboxselection")}})}}else{Qva.ListBoxSelection.End(false)}},{longpressOk:true,startEffect:function(event){if(mgr.andmode){mgr.StartPhaseShift(2500)}}});Qva.Events.AddLongPressEvent(elem,function(event){var target=Qva.Events.getClickElem(elem,event);if(!target||target[Qva.Events.Flags.Click]!="select"){return}if(target.parentNode.disabled){return false}if(!mgr.PageBinder.GetEnabled()){return false}if(Qva.ListBoxSelection.CurrentMgr!=null&&Qva.ListBoxSelection.CurrentMgr!=mgr){return false}var content=$(this).closest(".QvContent")[0];var objLBTouch=content.Touch;if(Qva.Touch.Listbox.SelectMenu&&Qva.Touch.Listbox.SelectMenu.Visible&&Qva.Touch.Listbox.SelectMenu.ListboxObject!==objLBTouch){Qva.Touch.Listbox.SelectMenu.Hide(true)}if(Qva.Touch.SelectionPopup){Qva.Touch.SelectionPopup.Hide()}objLBTouch.CellSelectable=(target.offset!=undefined&&mgr.Lines[target.offset]&&mgr.Lines[target.offset].selecttype);if(!mgr.readOnly&&!mgr.disabled&&objLBTouch.CellSelectable){if(!objLBTouch.MultiSelectMode&&!objLBTouch.MultiSelectModeInitializing){objLBTouch.MultiSelectModeInitializing=true;Qva.Touch.Listbox.PreSelectMulti({row:target,lb:objLBTouch,contentElem:content});objLBTouch.MultiSelectMode=true;objLBTouch.MultiSelectModeInitializing=false}}},{fnValidation:function(e){var target=Qva.Events.getClickElem(elem,e);if(!target||target[Qva.Events.Flags.Click]!="select"){return}return(target.offset!=undefined&&mgr.Lines[target.offset]&&mgr.Lines[target.offset].selecttype)}})}};Qva.Mgr.listbox.prototype._Select=function(offset){var start=Math.min(this.Selections.Start,this.Selections.End);var end=Math.max(this.Selections.Start,this.Selections.End);var in_currentselect=(this.Selections.mouseDown&&start<=offset&&offset<=end)||false;var selected=this.Selections.Selected[offset]||false;return in_currentselect!==selected};Qva.Mgr.listbox.prototype._SaveCurrentSelection=function(){var start=Math.min(this.Selections.Start,this.Selections.End);var end=Math.max(this.Selections.Start,this.Selections.End);for(var offset=start;offset<=end;++offset){if(this.Selections.Selected[offset]){delete this.Selections.Selected[offset]}else{this.Selections.Selected[offset]=true}}};Qva.Mgr.listbox.prototype._EndSelect=function(toggle){var values="";for(var offset in this.Selections.Selected){if(isNaN(offset)){continue}if(this.Lines[offset]&&this.Lines[offset].intval){var intval=this.Lines[offset].intval}if(isNaN(intval)){continue}if(values!=""){values+=","}if(intval){values+=intval}}this.Selections={Selected:[]};if(values!=""){var params={};params.select=values;params.toggle=toggle?"true":"false";if(this.andmode){params.phase=this.CurrentPhase}this.PageBinder.Set(this.ObjectId,params)}else{if(!toggle){this.PageBinder.Set(this.ObjectId+".CD","action","",true)}}if(this.andmode){this.EndPhaseShift()}this.CurrentPhase=0};Qva.Mgr.listbox.prototype._IndicateCellsToSelect=function(){var ctrl=this.Selections.ctrl||this.AutoCtrl;if(this.ObjectId!=Qva.SearchableObject){SetSearchableAndActives(this.ObjectId,[this.ObjectId])}for(var offset=this.Visible.Start;offset<=this.Visible.End;++offset){if(!this.Lines[offset]){continue}if(!this.Painted[offset]){continue}var select=this._Select(offset);var selected=this.Lines[offset].state=="Selected";var deselected=this.Lines[offset].state=="Deselected";var excluded=this.Lines[offset].state=="Excluded";var optional=this.Lines[offset].state=="Optional";var selected_excluded=this.Lines[offset].state=="SelectedExcluded";var className;if(this.Lines[offset].expandcollapse_icon){className=this.DisabledClassName}else{if(select){if(this.andmode){switch(this.CurrentPhase){case 0:if(ctrl&&(selected||deselected)){className=this.EnabledClassName}else{if(ctrl&&excluded){className=this.DeselectedClassName}else{className=this.SelectedClassName}}break;case 1:if(ctrl&&(deselected||excluded)){className=this.SelectedClassName}else{if(deselected){className=this.EnabledClassName}else{className=this.DeselectedClassName}}break;case 2:className="Qv"+this.Lines[offset].state;break;default:Assert(false);break}}else{if(ctrl&&(selected||deselected)){className=this.EnabledClassName}else{if(this.HasSelectedExcluded&&ctrl&&selected_excluded){className=this.DisabledClassName}else{className=this.SelectedClassName}}}}else{if(!ctrl&&(selected||deselected)){className=this.SelectedClassName}else{className="Qv"+this.Lines[offset].state}}}if(this.Painted[offset].AndModeSymbol){var symbol=Qva.Mgr.listbox.AndModeSymbol(className.substr(2));this.Painted[offset].AndModeSymbol.innerText=symbol}var altClass=(this.hideexcluded&&excluded)?"":this.AltClass;this.Painted[offset].className=className+altClass;if(this.AltClass_OnBorder){this.Painted[offset].firstChild.className=className+altClass}}};Qva.Mgr.listbox.prototype._CombineColors=function(c1,c2){if(c1.A===0&&c2.A===0){return"Transparent"}if(c1.A===0){return c2.css}if(c2.A===0){return c1.css}if(c1.R+c1.G+c1.B>c2.R+c2.G+c2.B){return c2.css}return c1.css};Qva.Mgr.listbox.prototype._CombineBorders=function(b1,b2){var width=Math.max(b1.width,b2.width);var color=this._CombineColors(b1.color,b2.color);var style=b1.style==="double"||b2.style==="double"?"double":b1.style==="solid"||b2.style==="solid"?"solid":"none";return{width:width,color:color,style:style}};Qva.Mgr.listbox.prototype._MakeBorder=function(div,near,far,f){var b1=this.BorderStyle[this.Style[0].BorderStyle][near];var b2=this.BorderStyle[this.Style[0].BorderStyle][far];var border=this._CombineBorders(b1,b2);if(this.Style[0].CellBorders==="1"){var cellBorderColor="";if(this.Style[0].CellBorderColor.length>7){cellBorderColor="#"+this.Style[0].CellBorderColor.substr(-6)}else{cellBorderColor=this.Style[0].CellBorderColor}div.style["border"+near]="solid 1px "+cellBorderColor;if(near==="Top"&&div.last===false){return 0}return 1}if(border.style==="solid"){var border_width=f(border.width);div.style["border"+near]="solid "+border_width+"px "+border.color;return border_width}else{if(border.style==="double"){div.style["border"+near]="solid 3px "+border.color;return f(9)}else{Assert(border.style==="none");return 0}}};Qva.Mgr.listbox.prototype._StyleObject=function(node){var bgColor=node.getAttribute("bgcolor");this.BgColorRGB=HtmlifyARGB(bgColor);this.BgColorCSSExpr=Qva.Hex2CSSExpression(bgColor);this.Color=HtmlifyARGB(node.getAttribute("color"));this.NumAdjust=node.getAttribute("numadjust");this.TextAdjust=node.getAttribute("textadjust");this.BorderStyle=node.getAttribute("borderstyle");var fontstyle=node.getAttribute("fontstyle");this.FontStyle=fontstyle;this.FontWeight=node.getAttribute("fontweight");this.TextDecoration=node.getAttribute("textdecoration");this.SizeMod=node.getAttribute("sizemod");this.CellBorders=node.getAttribute("cellborders");this.CellBorderColor=node.getAttribute("cellbordercolor");var stretchmode=node.getAttribute("stretchmode");if(stretchmode){this.StretchMode=stretchmode}};Qva.Mgr.listbox.prototype._BorderStyleObject=function(node){function getBorder(name){var b=node.getAttribute(name).split(" ");if(b[0]==="none"){return{width:0,style:"none",color:Qva.generalHelper.ObjectifyARGB(null)}}var width=parseInt(b[1]);return{width:width,style:b[0],color:Qva.generalHelper.ObjectifyARGB(b[2])}}this.Top=getBorder("top");this.Right=getBorder("right");this.Bottom=getBorder("bottom");this.Left=getBorder("left")};Qva.Mgr.listbox.prototype._CellObject=function(value){this.val=value.getAttribute("text");this.title=value.getAttribute("title")||this.val;this.intval=value.getAttribute("value");this.selected=value.getAttribute("selected")=="yes";this.level=parseInt(value.getAttribute("level"));if(!isNaN(this.level)){++this.level}this.parts=value.getElementsByTagName("range");if(value.getAttribute("state")){this.state=value.getAttribute("state")}this.isnum=value.getAttribute("isnum")=="true";var icons=this.icons=value.getElementsByTagName("icon");for(var i=0;i<icons.length;++i){var icon=icons[i];var name=icon.getAttribute("name");if(icon.getAttribute("sendsize")==="true"){this.main_icon=icon}else{if(name=="EXC"||name=="COC"){this.expandcollapse_icon=icon}else{if(name=="LED"){this.led_icon=icon}else{if(name=="IC"){this.input_icon=icon}}}}}this.icons=[];this.subcontent=$(value).find("subcontent");this.selecttype=value.getAttribute("selecttype");var rowspan=value.getAttribute("rowspan");if(rowspan){this.rowspan=parseInt(rowspan)}else{this.rowspan=1}};Qva.Mgr.listbox.prototype._SetCellStyle=function(data,ignorecolor,hidetext){var style=this.Style[0];if(!style){return""}var csstext="";if(hidetext){if(style.BgColorCSSExpr){csstext+="; background-color:"+style.BgColorCSSExpr}else{if(style.BgColorRGB){csstext+="; background-color:"+style.BgColorRGB}}csstext+="; color:"+style.BgColorRGB}else{if(!ignorecolor){if(style.BgColorCSSExpr){csstext+="; background-color:"+style.BgColorCSSExpr}else{if(style.BgColorRGB){csstext+="; background-color:"+style.BgColorRGB}}csstext+="; color:"+style.Color}else{csstext+="; background-color:";csstext+="; color:"}}csstext+="; text-align:"+(data.label?style.LabelAdjust:(data.isnum?style.NumAdjust:style.TextAdjust));csstext+="; font-style:"+style.FontStyle;csstext+="; font-weight:"+style.FontWeight;csstext+="; text-decoration:"+style.TextDecoration;switch(style.SizeMod){case"2":csstext+="; font-size:large";break;case"1":csstext+="; font-size:larger";break;case"-1":csstext+="; font-size:smaller";break;case"-2":csstext+="; font-size:small";break}return csstext};Qva.LoadDefaultStyles=function(){var QvStyles=Qva.QvStyles={};for(var i=0;i<document.styleSheets.length;i++){var rules;try{rules=document.styleSheets[i].rules?document.styleSheets[i].rules:document.styleSheets[i].cssRules}catch(Error){continue}if(!rules){continue}var styles={};for(var is=0;is<rules.length;is++){var style=rules[is];switch(style.selectorText){case".QvSelected":styles.QvSelected=style;break;case".QvExcluded":styles.QvExcluded=style;break;case".QvOptional":styles.QvOptional=style;break;case".QvLocked":styles.QvLocked=style;break;case".QvDeselected":styles.QvDeselected=style;break;case".QvAlternative":styles.QvAlternative=style;break;case".QvSelectedExcluded":styles.QvSelectedExcluded=style;break;case".QvLockedExcluded":styles.QvLockedExcluded=style;break}}if(styles.QvSelected){QvStyles.stylesheet=document.styleSheets[i];QvStyles["default"]=styles;QvStyles.alt={QvSelected:{style:{color:"#363636",backgroundColor:"#00ff00"}},QvExcluded:{style:{color:"#a4a4a4",backgroundColor:"#a4a4a4"}},QvOptional:{style:{color:"#363636",backgroundColor:"#ffffff"}},QvLocked:{style:{color:"#363636",backgroundColor:"#000080"}},QvDeselected:{style:{color:"#363636",backgroundColor:"#ff0000"}},QvAlternative:{style:{color:"#363636",backgroundColor:"#ffffff"}},QvSelectedExcluded:{style:{color:"#a4a4a4",backgroundColor:"#a4a4a4"}},QvLockedExcluded:{style:{color:"#a4a4a4",backgroundColor:"#a4a4a4"}}}}}};function addRule(ss,name){if(ss.addRule){ss.addRule(name,"dummy: none;");return ss.rules[ss.rules.length-1]}else{var i=ss.insertRule(name+" { }",ss.cssRules.length);return ss.cssRules[i]}}Qva.PageBinding.prototype.LoadLedStyle=function(color){if(!Qva.QvStyles){Qva.LoadDefaultStyles()}if(Qva.QvStyles["Led_"+color]){return}Qva.QvStyles["Led_"+color]=true;var states=["Locked","Selected","Optional","Deselected","Alternative","Excluded","SelectedExcluded","LockedExcluded"];var dimcolor={SelectedExcluded:true,Excluded:true,LockedExcluded:true};for(var i=0;i<states.length;++i){var state=states[i];var defaultStyle=Qva.QvStyles.alt["Qv"+state];var style=addRule(Qva.QvStyles.stylesheet,".Qv"+state+"_Led_"+color);if(!Qva.userAgentDetector.get("msie")&&dimcolor[state]){style.style.color=Qva.Hex2RGBA("#96"+color)}else{style.style.color="#"+color}var url=this.BuildBinaryUrl(null,null,"LED",defaultStyle.style.backgroundColor);style.style.backgroundImage="url('"+url+"')";style.style.backgroundRepeat="no-repeat";style.style.backgroundPosition="3px center"}};Qva.PageBinding.prototype.LoadLedCheckStyle=function(color){if(!Qva.QvStyles){Qva.LoadDefaultStyles()}if(Qva.QvStyles["LED_CHECK_"+color]){return}Qva.QvStyles["LED_CHECK_"+color]=true;var check={Selected:true,SelectedExcluded:true,Locked:true,LockedExcluded:true};var states=["Locked","Selected","Optional","Deselected","Alternative","Excluded","SelectedExcluded","LockedExcluded"];var dimcolor={SelectedExcluded:true,Excluded:true,LockedExcluded:true};for(var i=0;i<states.length;++i){var state=states[i];var defaultStyle=Qva.QvStyles.alt["Qv"+state];var style=addRule(Qva.QvStyles.stylesheet,".Qv"+state+"_LED_CHECK_"+color);if(!Qva.userAgentDetector.get("msie")&&dimcolor[state]){style.style.color=Qva.Hex2RGBA("#96"+color)}else{style.style.color="#"+color}var url=this.BuildBinaryUrl(null,null,"LED",defaultStyle.style.backgroundColor);if(check[state]){url+="&check=true"}style.style.backgroundImage="url('"+url+"')";style.style.backgroundRepeat="no-repeat";style.style.backgroundPosition="3px center"}};Qva.PageBinding.prototype.LoadCornertagStyle=function(size,color){if(!Qva.QvStyles){Qva.LoadDefaultStyles()}if(Qva.QvStyles["CORNERTAG_"+size+"_"+color]){return}Qva.QvStyles["CORNERTAG_"+size+"_"+color]=true;var states=["Locked","Selected","Optional","Deselected","Alternative","Excluded","SelectedExcluded","LockedExcluded"];var dimcolor={SelectedExcluded:true,Excluded:true,LockedExcluded:true};for(var i=0;i<states.length;++i){var state=states[i];var defaultStyle=Qva.QvStyles.alt["Qv"+state];var style=addRule(Qva.QvStyles.stylesheet,".Qv"+state+"_CORNERTAG_"+size+"_"+color);if(!Qva.userAgentDetector.get("msie")&&dimcolor[state]){style.style.color=Qva.Hex2RGBA("#96"+color)}else{style.style.color="#"+color}var url=this.BuildBinaryUrl(null,null,"CORNERTAG",defaultStyle.style.backgroundColor)+"&width="+size+"&height="+size;style.style.backgroundImage="url('"+url+"')";style.style.backgroundRepeat="no-repeat"}};Qva.PageBinding.prototype.LoadCheckStyle=function(color){if(!Qva.QvStyles){Qva.LoadDefaultStyles()}if(Qva.QvStyles["CHECK_"+color]){return}Qva.QvStyles["CHECK_"+color]=true;var states=["Locked","Selected","Optional","Deselected","Alternative","Excluded","SelectedExcluded","LockedExcluded"];var dimcolor={SelectedExcluded:true,Excluded:true,LockedExcluded:true};for(var i=0;i<states.length;++i){var state=states[i];var defaultStyle=Qva.QvStyles.alt["Qv"+state];var style=addRule(Qva.QvStyles.stylesheet,".Qv"+state+"_CHECK_"+color);if(!Qva.userAgentDetector.get("msie")&&dimcolor[state]){style.style.color=Qva.Hex2RGBA("#96"+color)}else{style.style.color="#"+color}var url=this.BuildBinaryUrl(null,null,"CHECK",null)+"&width=16&height=16&state="+i;style.style.backgroundImage="url('"+url+"')";style.style.backgroundRepeat="no-repeat";style.style.backgroundPosition="1px center"}};Qva.PageBinding.prototype.LoadRadioStyle=function(color){if(!Qva.QvStyles){Qva.LoadDefaultStyles()}if(Qva.QvStyles["RADIO_"+color]){return}Qva.QvStyles["RADIO_"+color]=true;var states=["Locked","Selected","Optional","Deselected","Alternative","Excluded","SelectedExcluded","LockedExcluded"];var dimcolor={SelectedExcluded:true,Excluded:true,LockedExcluded:true};for(var i=0;i<states.length;++i){var state=states[i];var defaultStyle=Qva.QvStyles.alt["Qv"+state];var style=addRule(Qva.QvStyles.stylesheet,".Qv"+state+"_RADIO_"+color);if(!Qva.userAgentDetector.get("msie")&&dimcolor[state]){style.style.color=Qva.Hex2RGBA("#96"+color)}else{style.style.color="#"+color}var url=this.BuildBinaryUrl(null,null,"CHECK",null)+"&width=16&height=16&radio=true&state="+i;style.style.backgroundImage="url('"+url+"')";style.style.backgroundRepeat="no-repeat";style.style.backgroundPosition="1px center"}};(function($,undefined){Qva.Mgr.tabrow2=function(owner,elem,name,prefix){if(!Qva.MgrSplit(this,name,prefix)){return}owner.AddManager(this);this.Element=elem;elem.Name=this.Name;this.binderid=owner.binderid;Qva.DragDrop.DropFrames[Qva.DragDrop.DropFrames.length]=this;if(elem.className.indexOf("use-new-tabrow")>=0){this.PageBinder.PaintTabrow=Qva.tabrow3}};Qva.Mgr.tabrow2.prototype.Inside=function(pos,type){var elem=this.Element;var cellPos=Qva.GetPageCoords(elem);var cellWidth=parseInt(elem.offsetWidth);var cellHeight=parseInt(elem.offsetHeight);if(pos.x>cellPos.x&&pos.x<cellPos.x+cellWidth&&pos.y>cellPos.y&&pos.y<cellPos.y+cellHeight){if(type=="Object"){var tab=elem.firstChild.firstChild;if(tab.tagName!="LI"){tab=$(elem).find(".qvtr-tabs").children()[0]}for(;tab;tab=tab.nextSibling){if(tab.tagName!="LI"){continue}cellPos=Qva.GetAbsolutePageCoords(tab);cellPos.x-=Qva.GetScrollLeft();cellPos.y-=Qva.GetScrollTop();cellWidth=parseInt(tab.offsetWidth);cellHeight=parseInt(tab.offsetHeight);if(pos.x>cellPos.x&&pos.x<cellPos.x+cellWidth&&pos.y>cellPos.y&&pos.y<cellPos.y+cellHeight){tab.Name=this.Name+"."+tab.id;return{Element:tab,Dialog:"Drop.qvpp"}}}}return{Element:null}}return null};Qva.Mgr.tabrow2.prototype.Paint=function(mode,node,name){this.Touched=true;this.Layout={from:"tabrow"};Qva.ObjectifyXML(this.Layout,node);this.PageBinder.QueuePostPaintMessage(this)};Qva.Mgr.tabrow2.prototype.PostPaint=function(){if(this.Layout.visible){this.Element.style.display="";if(this.PageBinder.PaintTabrow){this.PostPaintCustom=this.PageBinder.PaintTabrow;this.PostPaintCustom()}else{this.PostPaintDefault()}}else{this.Element.style.display="none"}var selectedTabName,items=this.Layout.value;for(i=0;i<items.length;i++){if(items[i].selected==="true"){selectedTabName=items[i].name;break}}if(selectedTabName&&selectedTabName!=this.SelectedTabName){this.SelectedTabName=selectedTabName;$(Qva.EventServer).one("OnUpdateComplete",function(){window.scrollTo(0,0)})}};Qva.Mgr.tabrow2.prototype.PostPaintDefault=function(){var element=this.Element;var tabrowElem=element.getElementsByTagName("ul")[0];if(!tabrowElem){tabrowElem=document.createElement("ul");element.appendChild(tabrowElem)}var xmlTabs=this.Layout.value;var tabNodes=tabrowElem.getElementsByTagName("li");for(var itab=0;itab<Math.max(xmlTabs.length,tabNodes.length);itab++){var xmlTabNode=xmlTabs[itab];var tabelem=tabNodes[itab];if(!xmlTabNode&&!tabelem){continue}var aelem;var spanelem;if(!tabelem){tabelem=document.createElement("li");tabrowElem.appendChild(tabelem)}tabelem.innerHTML="";if(!xmlTabNode||!xmlTabNode.visible){tabelem.style.display="none";continue}tabelem.style.display="";aelem=document.createElement("a");spanelem=document.createElement("span");SetElementStyle(spanelem,"fontWeight",this.Layout.fontweight);SetElementStyle(spanelem,"fontFamily",this.Layout.fontfamily);SetElementStyle(spanelem,"fontSize",this.Layout.fontsize,"pt");SetElementStyle(spanelem,"fontStyle",this.Layout.fontstyle);SetElementStyle(spanelem,"textDecoration",this.Layout.textdecoration);if(Qva.userAgentDetector.get("touchEnabled")){spanelem.style.fontSize="22px"}Qva.ApplyColorDataToElement(xmlTabNode,aelem,false,true);aelem.appendChild(spanelem);tabelem.appendChild(aelem);var id=xmlTabNode.name;tabelem.id=id;var selected=xmlTabNode.selected==="true";tabelem.className=selected?"selectedtab":"";var text=xmlTabNode.text;if(xmlTabNode.icon&&xmlTabNode.icon.length>=1){text+=" "}var textnode=document.createTextNode(text);spanelem.appendChild(textnode);if(xmlTabNode.icon&&xmlTabNode.icon.length>0){var stamp=xmlTabNode.icon[0].stamp;var name=xmlTabNode.icon[0].name;var color=HtmlifyARGB(xmlTabNode.icon[0].color);var url=Qva.GetBinder(this.binderid).BuildBinaryUrl(xmlTabNode.icon[0].path,stamp,name,color);var img=document.createElement("img");img.alt="";img.src=url;spanelem.appendChild(img)}if(xmlTabNode.action){Qva.Events.AddClickEvent(tabelem,onclick_action);tabelem.Action=this.Name+"."+id}}};Qva.tabrow3=function(){var leftTriangle='<a href="javascript:;" class="qvtr-scroll-left"><span>&#9668;</span></a>';if(Qva.Registry.get("System","Browsers","UserAgentDetector","android")===true){leftTriangle='<a href="javascript:;" class="qvtr-scroll-left" style="width: 7px; height: 12px;"><span style="-webkit-transform: rotate(180deg); position: absolute; top: 4px; left: 4px width: 8px;">&#9658;</span></a>'}var contentTemplate='<div class="qvtr-tabs-wrap">   <ul class="qvtr-tabs"></ul></div><ul class="qvtr-more">   <li class="qvtr-expand">       <a href="javascript:;"><span>&#9660;</span></a>      <ul></ul>   </li>   <li class="qvtr-scrolls">'+leftTriangle+'      <a href="javascript:;" class="qvtr-scroll-right"><span>&#9658;</span></a>   </li>   <li><a href="javascript:;" class="qvtr-add-sheet"><span>&#x002B;</span></a></li></ul>',theme="original",allTabsVisible=false,container=$(this.Element),qvScroll=container.data("qvscroll"),isReRender=true;if(this.Layout.mode==="enabled"){container.show()}else{container.hide()}if(!container.is(".shadetabs3")){container.removeClass("use-new-tabrow shadetabs shadetabs2").addClass("shadetabs3 theme-"+theme).html(contentTemplate);isReRender=false;qvScroll=new QvScroll({attachElement:container.find(".qvtr-tabs")[0],vertical:"disabled",startAttached:false,cornerBounce:false,scrollWheelEvent:false});container.data("qvscroll",qvScroll)}if(this.PageBinder.OfflineRecorder){this.PageBinder.OfflineRecorder.SetSheets(this.Layout.value,this.Name)}var tabs=container.find(".qvtr-tabs"),expandButton=$(".qvtr-expand > a"),expandList=expandButton.next(),items=this.Layout.value,selected,i,item,tab,addedTabs={},hasDeleted=false,newTab=false,imgCount=0,fn={tabClick:function(e){var me=$(this).closest("li");me.addClass("selectedtab").siblings().removeClass("selectedtab");if(!allTabsVisible){qvScroll.setPositionByElement(me[0],null,false,!hasDeleted);hasDeleted=false}},scrollClick:function(e){var elem=Qva.Events.getTarget(e);if(elem.nodeName!="A"){elem=elem.parentNode}var isLeft=elem.className.indexOf("-left")>=0;qvScroll.setPositionByStep(isLeft?-1:1);return false},expandBtnClick:function(e){if(expandList.is(":visible")){expandList.hide()}else{expandList.css("zIndex",2000);expandList.html("");var maxWidth=0;$("li:visible",tabs).each(function(){var newItem=$("<li>").attr("title",$(this).text()).text($(this).text()).css("cursor","pointer").css("padding","2px").append($(this).find("img").css("margin-left","5px"));if($(this).hasClass("selectedtab")){newItem.css("background-color","#E0E0E0")}expandList.append(newItem);var elemWidth=parseInt($(this).css("width"));if(parseInt($(this).css("width"))>maxWidth){maxWidth=elemWidth}});expandList.width(maxWidth);expandList.show()}return false},expandListClick:function(e){var tab=tabs.find("li").eq($(this).index());fn.tabClick.call(tab[0],e);onclick_action.call(tab[0],e);fn.expandBtnClick(e)},updateView:function(){tabs.width(99999);var overlayWidth=tabs.parent().next().outerWidth(),totalWidth=(function(){var tab=tabs.find("li:visible:last");if(tab.position()!=null){return tab.position().left+tab.outerWidth()+40}}()),selected=$("li[rel].selectedtab");tabs.width(totalWidth);qvScroll.setOptions({contentWidth:totalWidth+overlayWidth}).attach().calculateScrollValues();qvScroll.visibleWidth-=overlayWidth;if(qvScroll.visibleWidth>totalWidth){allTabsVisible=true;container.find(".qvtr-scrolls,.qvtr-expand").hide();if(selected.length){qvScroll.reset()}qvScroll.detach()}else{container.find(".qvtr-scrolls,.qvtr-expand").show();if(selected.length){qvScroll.setPositionByElement(selected[0],null,false,!hasDeleted)}}},resizeBody:function(){imgCount--;if(imgCount===0){Qva.ResizeBody()}}};if(items){for(i=0;i<items.length;i+=1){item=items[i];var name=item.name.replace(/\\/g,"").replace(/ /g,"");tab=$("li[rel='"+name+"']").removeClass("has-filter");newTab=(!tab.length||(tab.attr&&parseInt(tab.attr("order"))!==i));if(newTab){if(tab.length){tab.remove()}var span=$("<span></span>").text(item.text);tab=$('<li><a href="javascript:;"></a></li>').attr({id:item.name,rel:name,order:i});var binder=this.PageBinder;Qva.Events.AddClickEvent(tab[0],function(event){fn.tabClick.apply(this,[event]);onclick_action.apply(this,[event]);binder.ToolWindowZLevel.RemoveTopDialog()},{preventDefault:true});tab.find("a").append(span);tab[0].Action=this.Name+"."+item.name}else{tab.children("a").children("span").text(item.text)}var spanelem=tab.children("a").children("span")[0];SetElementStyle(spanelem,"fontWeight",this.Layout.fontweight);SetElementStyle(spanelem,"fontFamily",this.Layout.fontfamily);SetElementStyle(spanelem,"fontSize",this.Layout.fontsize,"pt");SetElementStyle(spanelem,"fontStyle",this.Layout.fontstyle);SetElementStyle(spanelem,"textDecoration",this.Layout.textdecoration);var backgroundcolor=Qva.Hex2CSSExpression(item.bkgcolor);if(!backgroundcolor){backgroundcolor=HtmlifyARGB(item.bkgcolor)}tab.children("a").css({color:HtmlifyARGB(item.color),background:backgroundcolor});if(item.selected==="true"){if(this.PageBinder.OfflineRecorder){this.PageBinder.OfflineRecorder.SetInitialSheet(i)}selected=tab[0]}if(item.icon&&item.icon.length){imgCount++;$("<img>").attr({alt:"",src:Qva.GetBinder(this.binderid).BuildBinaryUrl(item.icon[0].path,item.icon[0].stamp,item.icon[0].name,HtmlifyARGB(item.icon[0].color))}).addClass("icon").css({height:"10px",width:"10px"}).load(fn.resizeBody).appendTo(tab.children("a").children("span"))}tab[item.visible?"show":"hide"]();addedTabs[tab[0].getAttribute("rel")]=true;if(newTab){if(i===0&&$("li",tabs).length===0){tabs.append(tab)}else{if(i===0&&$("li",tabs).length>0){tab.insertBefore($("li",tabs)[0])}else{tab.insertAfter($("li",tabs)[i-1])}}}}}tabs.children().each(function(){if(!addedTabs[this.getAttribute("rel")]){$(this).remove();hasDeleted=true}});fn.updateView();selected&&fn.tabClick.call(selected,null);if(!isReRender){$(window).on("tabrowchange",function(){hasDeleted=true;fn.updateView()});Qva.Events.AddClickEvent(this.Element,function(e){var $target=$(Qva.Events.getTarget(e));var $element=$target.closest(".qvtr-scroll-left, .qvtr-scroll-right");if($element.length>0){fn.scrollClick.apply($element[0],[e]);return}$element=$target.closest(".qvtr-expand > a");if($element.length>0){fn.expandBtnClick.apply($element[0],[e]);return}$element=$target.closest(".qvtr-expand > ul li");if($element.length>0){fn.expandListClick.apply($element[0],[e]);return}},{nostop:false});if(this.Layout.addsheet==="enabled"){var newButton=container.find(".qvtr-add-sheet")[0];newButton.Action="Document.StandardActions.ADDSHEET";newButton.title=Qva.localization.getStringFromKey("ADDSHEET");newButton.sheettitle=Qva.localization.getStringFromKey("SHEETPROPS");Qva.Events.AddClickEvent(".qvtr-add-sheet",function(){onclick_action.call(newButton)})}else{container.find(".qvtr-add-sheet").hide()}var $win=$(window),$tabs=$("#Tabrow"),vpW=Qva.GetViewportWidth();$tabs.css({width:vpW+"px"})}}})($QvJq);(function($,undefined){if(!Qva.Mgr){Qva.Mgr={}}Qva.Mgr.toolwindowtable=function(owner,elem,name,prefix){if(!Qva.MgrSplit(this,name,prefix)){return}owner.AddManager(this);this.Element=elem;this.binderid=owner.binderid;this.BaseName=owner.Name};Qva.Mgr.toolwindowtable.prototype.Inside=function(pos,type){for(var ix=0;ix<this.DropTargets.length;++ix){var cell=this.DropTargets[ix];if(!cell.dropObj){continue}if(cell.dropObj.Type!=type){continue}var cellPos=Qva.GetPageCoords(cell);var cellWidth=parseInt(cell.offsetWidth);var cellHeight=parseInt(cell.offsetHeight);if(pos.x>cellPos.x&&pos.x<cellPos.x+cellWidth&&pos.y>cellPos.y&&pos.y<cellPos.y+cellHeight){if(pos.y<cellPos.y+0.37*cellHeight){var vertPosition="insertbefore"}else{if(pos.y>cellPos.y+0.7*cellHeight){var vertPosition="insertafter"}else{var vertPosition="dragto"}}if((cell.dropObj.DropOn&&vertPosition=="dragto")||(cell.dropObj.InsertAfter&&vertPosition=="insertafter")||(cell.dropObj.InsertBefore&&vertPosition=="insertbefore")){return{Element:cell,VerticalPosition:vertPosition}}}}return null};Qva.Tooltip=null;Qva.TooltipTimeout;Qva.ShowTooltip=function(event,cell){if(!cell.Tooltip){return}clearTimeout(Qva.TooltipTimeout);if(!Qva.Tooltip){Qva.Tooltip=document.createElement("div");Qva.Tooltip.className="QvHover";Qva.Tooltip.style.display="none";Qva.Tooltip.style.position="absolute";Qva.Tooltip.style.backgroundColor="#FFFFCC";Qva.Tooltip.style.border="solid 1px black";Qva.Tooltip.style.padding="1px 3px 2px 3px";document.body.appendChild(Qva.Tooltip)}Qva.Tooltip.innerHTML="";var lines=cell.Tooltip;for(var i=0;i<lines.length;i++){var p=document.createElement("span");p.innerText=lines[i];Qva.Tooltip.appendChild(p);var br=document.createElement("br");Qva.Tooltip.appendChild(br)}Qva.Tooltip.style.left=(Qva.Events.getX(event)+5)+"px";Qva.Tooltip.style.top=(Qva.Events.getY(event)+25)+"px";Qva.Tooltip.style.zIndex=Qva.GetzIndex(cell);Qva.Tooltip.style.display="";Qva.TooltipTimeout=setTimeout(Qva.HideTooltip,5000)};Qva.HideTooltip=function(){if(Qva.Tooltip){Qva.Tooltip.style.display="none"}};Qva.Mgr.toolwindowtable.prototype.Paint=function(mode,node){this.Touched=true;this.DropTargets=[];var table=this.Element;var rix=0;var colgroup=table.firstChild;while(colgroup.firstChild){colgroup.removeChild(colgroup.firstChild)}for(var line=node.firstChild;line!=null;line=line.nextSibling){if(line.nodeName!="column"){continue}var col=document.createElement("col");col.width=parseInt(line.getAttribute("width"));colgroup.appendChild(col)}for(var line=node.firstChild;line!=null;line=line.nextSibling){if(line.nodeName!="row"){continue}var row=(rix<table.rows.length)?table.rows[rix]:table.insertRow(-1);++rix;switch(line.getAttribute("class")){case"header":row.className="ToolProperty-Header";break;case"navigation":row.className="ToolProperty-Navigation";break;case"warning":row.className="ToolProperty-Warning";break;default:row.className="";break}var cix=0;for(var child=line.firstChild;child!=null;child=child.nextSibling){var cmd=child.getAttribute("name");if(cmd){cmd=this.BaseName+"."+cmd}var exprtype=child.getAttribute("expression");var cell=(cix<row.cells.length)?row.cells[cix]:row.insertCell(-1);++cix;var indent=child.getAttribute("indent");if(indent){indent=12*parseInt(indent);cell.style.paddingLeft=indent+"pt"}else{cell.style.paddingLeft=""}var label=child.getAttribute("label");switch(child.getAttribute("class")){case"highlight":cell.className="ToolProperty-Highlight";break}var colspan=child.getAttribute("colspan");if(colspan){cell.colSpan=parseInt(colspan)}else{cell.colSpan=1}var tips=child.getElementsByTagName("tooltip");var tiplen=tips.length;if(tiplen>0){var tiplist=[];for(var ix=0;ix<tiplen;++ix){tiplist.push(Qva.localization.getTooltipText(tips[ix]))}cell.Tooltip=tiplist;cell.onmouseover=function(event){Qva.ShowTooltip(event,this)};cell.onmouseout=function(){Qva.HideTooltip()}}else{cell.Tooltip=null}switch(child.nodeName){case"title":cell.innerText=child.getAttribute("text");break;case"link":cell.innerText=child.getAttribute("text");cell.binderid=this.binderid;cell.Name=cmd;cell.className="ToolProperty-Link";Qva.Events.AddClickEvent(cell,function(){var binder=Qva.GetBinder(this.binderid);if(!binder.Enabled){return}binder.Set(this.Name,"action","",true)});break;case"literal":cell.innerHTML="<span></span>";cell.className="ToolProperty-Literal";cell.firstChild.innerText=child.getAttribute("text");break;case"text":case"numeric":var actor=null;if(indent){cell.style.paddingLeft=indent+"pt"}if(label){cell.innerHTML="<span></span> <input />";cell.firstChild.innerText=label;cell.firstChild.className="ToolProperty-Label"}else{var range=child.getAttribute("range");if(range=="percent"){cell.innerHTML="<table cellspacing='0' cellpadding='0' width1='100%' ><tr><td width='30pt' >0%</td><td width='134px'><span style='position:absolute;'><hr style='margin:0pt;position:absolute;width:128px;' /><button style='top:-4px;position:absolute;width:4px;height:9px;background-color:lightgrey;border:solid 1px darkgray'></button></span></td><td width='36pt' align='right'>100%</td></tr></table>";actor=cell.lastChild.rows[0].cells[1].firstChild.lastChild}else{var hsize=parseInt(child.getAttribute("size"));if(exprtype){cell.innerHTML="<input style='width:80%'/><button>...</button>";actor=cell.firstChild;var xactor=cell.lastChild;xactor.binderid=this.binderid;xactor.Name=cmd;xactor.disabled=child.getAttribute("mode")!="enabled";xactor.Value=child.getAttribute("value");xactor.ExpressionType=exprtype;Qva.Events.AddClickEvent(xactor,function(){Qva.ExpressionDialog(this,this.Value)})}else{if(!isNaN(hsize)){cell.innerHTML="<textarea rows='"+hsize+"'></textarea>"}else{cell.innerHTML="<input/>"}}}cell.className="ToolProperty-TextInput"}if(actor==null){actor=cell.lastChild}if(child.nodeName=="numeric"&&actor.tagName=="INPUT"){actor.style.width="24pt";actor.style.textAlign="right"}actor.Name=cmd;if(actor.tagName!="BUTTON"){actor.binderid=this.binderid;actor.readOnly=child.getAttribute("mode")!="enabled";if(actor.readOnly){actor.style.color="silver"}actor.value=child.getAttribute("value");Qva.Events.AddCancelAction(actor);actor.onchange=function(){var binder=Qva.GetBinder(this.binderid);if(!binder.Enabled){return}binder.Set(this.Name,"value",this.value,true)}}else{var pos=parseInt(child.getAttribute("value"));pos=isNaN(pos)?0:pos/2;actor.style.left=pos+"px";actor.binderid=this.binderid;actor.moveObj="*";actor.xOnly=true;actor.xMin=parseInt(child.getAttribute("min"))/2;actor.xMax=parseInt(child.getAttribute("max"))/2;actor.disabled=child.getAttribute("mode")!="enabled";actor.style.cursor=actor.disabled?"":"pointer";Qva.Events.AddDragEvent(actor,Qva.Move.mouseDown,Qva.Move.mouseMove,Qva.Move.mouseUp)}break;case"check":if(indent){cell.style.paddingLeft=indent+"pt"}cell.innerHTML="<input type='checkbox'/> <span></span>";cell.lastChild.innerText=label;cell.lastChild.className="ToolProperty-Label";var actor=cell.firstChild;actor.checked=child.getAttribute("value")=="1";actor.disabled=child.getAttribute("mode")!="enabled";actor.Name=cmd;actor.binderid=this.binderid;Qva.Events.AddClickEvent(actor,function(){var binder=Qva.GetBinder(this.binderid);if(!binder.Enabled){return}binder.Set(this.Name,"value",this.checked?"1":"0",true)});break;case"icon":cell.innerHTML="<img />";cell.className="ToolProperty-IconCell";var img=cell.firstChild;img.className="ToolProperty-Icon";img.disabled=child.getAttribute("mode")!="enabled";if(child.getAttribute("menu")=="true"){img.position=cmd}var imgstamp=null;var imgname=child.getAttribute("image");if(child.getAttribute("type")=="radio"){imgstamp=child.getAttribute("stamp");imgname+="."+child.getAttribute("value")}img.src=Qva.GetBinder(this.binderid).BuildBinaryUrl(child.getAttribute("path"),imgstamp,imgname+(img.disabled?".DISABLED":""));img.title=label;cell.binderid=this.binderid;cell.Name=cmd;img.dragAccept=child.getAttribute("accept");if(img.dragAccept){this.DropTargets[this.DropTargets.length]=img}var clickable=true;var highlight=true;switch(child.getAttribute("type")){case"drag":img.dragObj={Name:cmd,Type:child.getAttribute("content"),Value:child.getAttribute("value")};if(child.getAttribute("dropat")!=null){img.dragObj.DropAt=true}img.binderid=this.binderid;img.Name=cmd;Qva.Events.AddDragEvent(img,Qva.DragDrop.mouseDown,Qva.DragDrop.mouseMove,Qva.DragDrop.mouseUp);break;case"drop":img.binderid=this.binderid;img.Name=cmd;break;case"action":cell.Value=child.getAttribute("value");break;case"radio":highlight=false;cell.Value=child.getAttribute("value");if(child.getAttribute("selected")=="true"){cell.className="ToolProperty-IconSelected"}else{cell.className="ToolProperty-IconUnselected"}break;case null:clickable=false;break;default:clickable=false;break}if(clickable){if(!img.disabled){if(highlight){img.onmouseover=function(){this.className="prop-dyn-sortable-item-highlighted"};img.onmouseout=function(){this.className=""}}Qva.Events.AddClickEvent(cell,function(){var binder=Qva.GetBinder(this.binderid);if(!binder.Enabled){return}if(this.Value!=null){binder.Set(this.Name,"value",this.Value,true)}else{binder.Set(this.Name,"action","",true)}})}}break;case"select":case"combo":var actor;var xactor=null;if(label){if(exprtype){cell.innerHTML="<span></span> <select ></select><button>...</button>";xactor=cell.lastChild;actor=xactor.previousSibling}else{cell.innerHTML="<span></span> <select ></select>";actor=cell.lastChild}cell.firstChild.innerText=label;cell.firstChild.className="ToolProperty-Label"}else{if(exprtype){cell.innerHTML="<select style='width:80%'></select><button>...</button>";xactor=cell.lastChild}else{cell.innerHTML="<select style='width:100%'></select>"}actor=cell.firstChild}if(xactor){xactor.binderid=this.binderid;xactor.Name=cmd;xactor.disabled=child.getAttribute("mode")!="enabled";xactor.Value=child.getAttribute("value");xactor.ExpressionType=exprtype;Qva.Events.AddClickEvent(xactor,function(){Qva.ExpressionDialog(this,this.Value)})}actor.disabled=child.getAttribute("mode")!="enabled";actor.Name=cmd;actor.binderid=this.binderid;Qva.Events.AddCancelAction(actor);actor.onchange=function(){if(this.selectedIndex<0){return}var binder=Qva.GetBinder(this.binderid);if(!binder.Enabled){return}var opt=this.options[this.selectedIndex];binder.Set(this.Name,"value",opt.value,true)};var choices=child.getElementsByTagName("option");var cholen=choices.length;actor.options.length=cholen;var currentValue=child.getAttribute("value");var found=false;for(var ix=0;ix<cholen;++ix){var cho=choices[ix];var opt=actor.options[ix];opt.text=cho.getAttribute("text");opt.value=cho.getAttribute("value");if(opt.value==currentValue){opt.selected=true;found=true}}if(!found){actor.options.length=cholen+1;var cho=choices[cholen];var opt=actor.options[cholen];opt.text=child.getAttribute("text");opt.value=currentValue;opt.selected=true}if(child.nodeName=="combo"){var selectactor=actor;setTimeout(function(){Qva.Mgr.toolwindowtable.CreateCombobox(selectactor)},0)}break;case"img-select":case"txt-select":var html="";if(label){html+="<span></span> "}if(child.nodeName=="img-select"){html+='<img class="ToolProperty-ImgSelect" >'}else{html+='<input class="ToolProperty-TxtSelect" />'}html+="<button></button>";cell.innerHTML=html;if(label){cell.firstChild.innerText=label;cell.firstChild.className="ToolProperty-Label"}var actor=cell.lastChild;actor.disabled=child.getAttribute("mode")!="enabled";actor.Name=cmd;actor.binderid=this.binderid;actor.style.backgroundImage="url(/qvajaxzfc/qvsviewclient.aspx?datamode=binary&public=only&name=menu"+((child.getAttribute("mode")!="enabled")?".DISABLED":"")+")";actor.className="ToolProperty-TxtSelectMenu";var target=actor.previousSibling;if(child.nodeName=="img-select"){target.src="/qvajaxzfc/qvsviewclient.aspx?datamode=binary&public=only&name=bundled:"+child.getAttribute("image")}else{target.value=child.getAttribute("text");target.style.width="78%";target.Name=cmd;target.binderid=this.binderid;target.readOnly=child.getAttribute("mode")!="enabled";if(target.readOnly){target.style.color="silver"}if(!target.readOnly){target.onchange=function(){var binder=Qva.GetBinder(this.binderid);if(!binder.Enabled){return}binder.Set(this.Name,"value",this.value,true)}}}break;case"color":cell.disabled=child.getAttribute("mode")!="enabled";cell.Name=cmd;cell.binderid=this.binderid;Qva.Events.AddClickEvent(cell,function(){var binder=Qva.GetBinder(this.binderid);if(!binder.Enabled){return}binder.Set(this.Name,"value",this.Color,true)});if(label){cell.title=label}var selected=child.getAttribute("selected")=="1";cell.innerHTML="<div>&nbsp</div>";cell.Color=child.getAttribute("value");cell.firstChild.className="ToolProperty-Color";cell.firstChild.style.backgroundColor=child.getAttribute("value");cell.style.backgroundColor=selected?"Highlight":"Transparent";break}var warning=child.getAttribute("warning");if(warning){var img=document.createElement("IMG");img.src=Qva.GetBinder(this.binderid).BuildBinaryUrl(child.getAttribute("path"),null,"warning");img.title=warning;img.style.paddingLeft="2pt";cell.appendChild(img);cell.title=warning}}while(cix<row.cells.length){row.deleteCell(cix)}var acceptDrop=line.getAttribute("accept");var canDrag=(line.getAttribute("type")=="drag")&&line.getAttribute("content");if(canDrag||acceptDrop){var rowName=line.getAttribute("name");if(rowName){rowName=this.BaseName+"."+rowName}row.binderid=this.binderid;row.Name=rowName;if(acceptDrop){var dropTypes=line.getAttribute("at").split(";");var dropOn=false;var dropBefore=false;var dropAfter=false;for(var aix=0;aix<dropTypes.length;aix++){if(dropTypes[aix]=="on"){dropOn=true}if(dropTypes[aix]=="before"){dropBefore=true}if(dropTypes[aix]=="after"){dropAfter=true}}row.dropObj={Name:rowName,Type:acceptDrop,DropOn:dropOn,InsertAfter:dropAfter,InsertBefore:dropBefore};this.DropTargets[this.DropTargets.length]=row;var objFrame=Qva.getFrameObjForElement(this.Element);var frameFound=false;var acceptedDroptypes=acceptDrop.split(";");for(var frameIndex in Qva.DragDrop.DropFrames){if(Qva.DragDrop.DropFrames[frameIndex].Name===objFrame.Name){frameFound=true;var droptypes=Qva.DragDrop.DropFrames[frameIndex].DropTypes;for(var a in acceptedDroptypes){var foundDroptype=false;for(var b in droptypes){if(droptypes[b]===acceptedDroptypes[a]){foundDroptype=true;break}}if(!foundDroptype){droptypes[droptypes.length]=acceptedDroptypes[a]}}break}}if(!frameFound){objFrame.DropTypes=acceptDrop.split(";");Qva.DragDrop.DropFrames.push(objFrame)}}if(canDrag){var dragContent=line.getAttribute("content");if(line.getAttribute("label")){row.title=line.getAttribute("label")}row.dragObj={Name:rowName,Type:dragContent};row.onmouseover=function(){if(this.className.indexOf("DragTarget")==-1){this.className+=" DragTarget"}};row.onmouseout=function(){this.className=this.className.replace("DragTarget","");this.className=this.className.replace(/^\s+|\s+$/g,"")};Qva.Events.AddDragEvent(row,Qva.DragDrop.mouseDown,Qva.DragDrop.mouseMove,Qva.DragDrop.mouseUp)}}}while(rix<table.rows.length){table.deleteRow(rix)}};Qva.Mgr.toolwindowbody=function(owner,elem,name,uiparent){if(!Qva.MgrSplit(this,name,null)){return}owner.AddManager(this);this.binderid=owner.binderid;this.Element=elem;var _this=this;Qva.Events.AddClickEvent(this.Element,function(){Qva.HideContextMenu(true)},{preventDefault:false});this.Managers={};this.UIParent=uiparent;this.DocumentBinder=owner;while(this.DocumentBinder&&!this.DocumentBinder.LoadHtml){this.DocumentBinder=this.DocumentBinder.PageBinder}Qva.DragDrop.DropTargets[Qva.DragDrop.DropTargets.length]=this};Qva.Mgr.toolwindowbody.prototype.Abort=function(){this.SingleName=null};Qva.Mgr.toolwindowbody.prototype.Close=function(ask){if(!this.SingleName){return}var text=this.Managers[this.SingleName][0].Element.value;if(text==this.SingleInitalText){return}var binder=Qva.GetBinder(this.binderid);if(!binder.Enabled){return}this.SingleInitalText=text;binder.Set(this.SingleName,"value",text,true)};Qva.Mgr.toolwindowbody.prototype.SetSingleMode=function(name,text){this.SingleName=name;this.SingleInitalText=text;var mgr=this.Managers[this.SingleName][0];mgr.Element.value=text;if(mgr.Element.onchange){mgr.Element.onchange=function(){}}else{$(mgr.Element).off("change")}};Qva.Mgr.toolwindowbody.prototype.ScanAndPaint=function(name,elem){this.IsPage=true;this.SubName=name;var elm=elem||this.Element;var scanner=new Qva.Scanner(this);scanner.Scan(elm,name||this.Name,this);this.PaintOnlyNew=true;this.Paint();this.PaintOnlyNew=false};Qva.Mgr.toolwindowbody.prototype.Scan=function(name,elem){this.IsPage=true;this.SubName=name;var elm=elem||this.Element;var scanner=new Qva.Scanner(this);scanner.Scan(elm,name||this.Name,this)};Qva.Mgr.toolwindowbody.prototype.Inside=function(pos,type){for(var key in this.Managers){var list=this.Managers[key];for(var ix=0;ix<list.length;++ix){var mgr=list[ix];if(!mgr.Inside){continue}var fnd=mgr.Inside(pos,type);if(fnd!=null){return fnd}}}return null};Qva.Mgr.toolwindowbody.prototype.PaintTree=function(node,prefix){for(var child=node.firstChild;child!=null;child=child.nextSibling){var name=child.getAttribute("name");var mode=child.getAttribute("mode");switch(mode){case"hidden":mode="h";break;case"enabled":mode="e";break;default:mode="d";break}var list=this.Managers[prefix+"."+name];if(list){for(var ix=0;ix<list.length;++ix){var mgr=list[ix];if(mgr.ToBeDeleted){list.splice(ix,1);mgr=list[ix]}if(!this.PaintOnlyNew||!mgr.Old){mgr.Paint(mode,child,name)}mgr.Old=true}}this.PaintTree(child,prefix+"."+name)}};Qva.Mgr.toolwindowbody.prototype.Paint=function(mode,node,prefix){this.Touched=true;if(!this.Element){this.node=node;this.prefix=prefix;this.mode=mode;return}else{if(!node){if(!this.node){return}node=this.node;prefix=this.prefix;mode=this.mode}else{this.node=node;this.prefix=prefix;this.mode=mode}}this.Element.binderid=this.binderid;if(node.getAttribute("isDropDialog")){Qva.dropDialog.showAt(node.getAttribute("x"),node.getAttribute("y"))}if(node.getAttribute("activetab")){if(typeof $(this.Element).data("ui-accordion")!="undefined"){$(this.Element).accordion("option","activate",parseInt(node.getAttribute("activetab")))}}if(this.IsPage){if(mode=="h"){Qva.dropDialog.element.style.display="none";Qva.dropDialog.hidden=true;$(Qva.dropDialog.maskelement).hide();return}var list=this.Managers["$"];if(list){for(var ix=0;ix<list.length;++ix){var mgr=list[ix];if(!this.PaintOnlyNew||!mgr.Old){mgr.Paint("e",node,"$")}mgr.Old=true}}this.PaintTree(node,prefix);if(this.OnComplete){this.OnComplete(node)}if(Qva.userAgentDetector.get("msie")){$(this.Element).find("*").not("input,select,textarea").attr("unselectable","on");$(this.Element).find("select").on("mousedown",function(event){event.stopPropagation()})}if(this.Tabs){this.Tabs.drawFoldoutScrollShadow(0)}return}var selected=node.getAttribute("value");if(selected!=this.Selected){this.Managers={};this.Element.innerHTML="<table width='95%'></table>";var table=this.Element.firstChild;table.cellpadding=0;table.cellspacing=0;for(var child=node.firstChild;child!=null;child=child.nextSibling){if(child.nodeName!="property"){continue}var row=table.insertRow(-1);var cell=row.insertCell(-1);var name=child.getAttribute("name");var indent=child.getAttribute("indent");if(indent){indent=12*parseInt(indent)}cell.innerHTML="<table width='98%'><colgroup></colgroup></table>";cell.colSpan=2;var mgr=new Qva.Mgr.toolwindowtable(this,cell.firstChild,"."+name,this.Name)}this.Body=table.tBodies[0];this.Selected=selected}for(var child=node.firstChild;child!=null;child=child.nextSibling){if(child.nodeName!="property"){continue}var name=this.Name+"."+child.getAttribute("name");var list=this.Managers[name];if(list!=null){var mode="d";switch(child.getAttribute("mode")){case"hidden":mode="h";break;case"enabled":mode="e";break}var xlen=list.length;for(var ixx=0;ixx<xlen;++ixx){var mgr=list[ixx];var mgrmode=mode;if(mode!="n"&&mgr.HideIf&&mgr.HideIf(child.getAttribute("value"),child.getAttribute("text"))){mgrmode="n"}if(!this.PaintOnlyNew||!mgr.Old){mgr.Paint(mgrmode,child,name)}mgr.Old=true}}}};Qva.Mgr.toolwindowbody.prototype.Append=function(){};Qva.Mgr.toolwindowbody.prototype.AddManager=function(mgr){mgr.PageBinder=this;mgr.Touched=false;var list=this.Managers[mgr.Name];if(list==null){list=[];this.Managers[mgr.Name]=list}list.push(mgr)};Qva.Mgr.toolwindowbody.prototype.RemoveFromManagers=function(mgr){var list=this.Managers[mgr.Name];for(var ix=0;ix<list.length;++ix){if(list[ix]==mgr){mgr.ToBeDeleted=true;break}}};Qva.Mgr.toolwindownavigation=function(owner,elem,name,prefix){if(!Qva.MgrSplit(this,name,prefix)){return}owner.AddManager(this);this.Element=elem;this.binderid=owner.binderid;this.Managers={}};Qva.Mgr.toolwindownavigation.prototype.Paint=function(mode,node){this.Touched=true;var div=this.Element;if(mode=="h"){div.style.display="none";return}div.style.display="";while(div.firstChild){div.removeChild(div.firstChild)}div.innerHTML="";var choices=node.getElementsByTagName("option");var cholen=choices.length;for(var ix=0;ix<cholen;++ix){if(ix>0){var sep=document.createElement("span");sep.innerText=" > ";div.appendChild(sep)}var cho=choices[ix];var opt=document.createElement("span");if(ix<cholen-1){opt.className="Navigation-Link";opt.binderid=this.binderid;opt.Name=this.Name;opt.Link=cho.getAttribute("value");Qva.Events.AddClickEvent(opt,function(){var binder=Qva.GetBinder(this.binderid);if(!binder.Enabled){return}binder.Set(this.Name,"value",this.Link,true)})}opt.innerText=cho.getAttribute("text");div.appendChild(opt)}};Qva.Mgr.toolwindowtable.CreateCombobox=function(selectactor){var actor2=document.createElement("input");actor2.style.border="none";actor2.style.marginTop="2px";actor2.style.marginLeft="4px";actor2.style.position="absolute";actor2.style.height=Math.max(parseInt(selectactor.offsetHeight)-6,0)+"px";actor2.style.left=parseInt(selectactor.parentNode.offsetLeft)+"px";actor2.style.width=Math.max(parseInt(selectactor.offsetWidth)-21,0)+"px";if(selectactor.selectedIndex>=0){actor2.value=selectactor.options[selectactor.selectedIndex].text}selectactor.parentNode.appendChild(actor2);actor2.Name=selectactor.Name;actor2.binderid=selectactor.binderid;if(selectactor.disabled){actor2.disabled=true}else{actor2.onchange=function(){var binder=Qva.GetBinder(this.binderid);if(!binder.Enabled){return}binder.Set(this.Name,"text",this.value,true)}}};Qva.ToggleToolPane=function(row){var pane=row.parentNode.rows[row.rowIndex+1];var icon=row.cells[0].firstChild;if(icon.tagName!="IMG"){icon=icon.nextSibling}if(pane.style.display=="none"){icon.src="collapse.png";pane.style.display=""}else{icon.src="expand.png";pane.style.display="none"}};Qva.SelectToolPane=function(cell,pinning){var row=cell.parentNode;var div=row.parentNode.parentNode;var atix=row.rowIndex;if(pinning&&row.cells[1]){var icon=row.cells[1].firstChild;if(icon.tagName!="IMG"){icon=icon.nextSibling}icon.src=icon.src.replace((icon.src.indexOf("unpinned")!=-1)?"unpinned":"pinned",(icon.src.indexOf("unpinned")!=-1)?"pinned":"unpinned")}for(var rix=0;rix<div.rows.length;rix++){icon=div.rows[rix].cells[1];if(icon){icon=icon.firstChild}if(icon&&icon.tagName!="IMG"){icon=icon.nextSibling}if(!icon){continue}var dopanes=true;var prix=rix+1;while(dopanes){var pane=div.rows[prix++];if(!pane){dopanes=false;continue}var icon2=pane.cells[1];if(icon2){icon2=icon2.firstChild}if(icon2&&icon2.tagName!="IMG"){icon2=icon2.nextSibling}if(icon2){dopanes=false;continue}if(rix==atix||(icon&&icon.src.indexOf("unpinned")==-1)){pane.style.display=""}else{pane.style.display="none"}}}};Qva.SelectToolTab=function(tab){var div=tab.parentNode;var ix=1;var tix=-1;for(var t=div.firstChild;t;t=t.nextSibling){if(t.tagName!="A"){continue}++ix;if(t!=tab){t.className=""}if(t==tab){tix=ix}}tab.className="selectedtab";var table=div.parentNode.parentNode.parentNode.parentNode;for(var rix=2;rix<table.rows.length;++rix){var row=table.rows[rix];if(rix==tix){row.style.display=""}else{row.style.display="none"}}};Qva.Mgr.img=function(owner,elem,name,prefix){this.Name=name?Qva.MgrMakeName(name,prefix):"$";owner.AddManager(this);this.Element=elem;elem.binderid=owner.binderid;elem.Name=this.Name};Qva.Mgr.img.prototype.Paint=function(mode,node){this.Touched=true;var element=this.Element;element.style.display=Qva.MgrGetDisplayFromMode(this,mode);var enabled=(mode=="e");var icon=element.getAttribute("icon");if(icon){var binder=Qva.GetBinder(element.binderid);if(!enabled){icon+=".DISABLED"}var url=binder.BuildBinaryUrl(node.getAttribute("path"),null,icon);element.src=url}};Qva.Mgr.radio=function(owner,elem,name,prefix,condition){this.Name=Qva.MgrMakeName(name,prefix);owner.AddManager(this);this.Element=elem;elem.binderid=owner.binderid;elem.Name=this.Name;Qva.Events.AddClickEvent(elem,Qva.Mgr.radio.OnClick);elem.setAttribute("unselected-class",elem.className)};Qva.Mgr.radio.OnClick=function(){var binder=Qva.GetBinder(this.binderid);binder.Set(this.Name,"value",this.getAttribute("value"),true)};Qva.Mgr.radio.prototype.Paint=function(mode,node){this.Touched=true;var element=this.Element;element.style.display=Qva.MgrGetDisplayFromMode(this,mode);var enabled=(mode=="e");var value=element.getAttribute("value");if(enabled){var options=node.getElementsByTagName("option");if(options.length>0){enabled=false;for(var ix=0;ix<options.length;++ix){var option=options[ix];if(option.getAttribute("value")!=value){continue}if(option.getAttribute("mode")=="enabled"){enabled=true}break}}}element.disabled=!enabled;var icon=element.getAttribute("icon");if(icon){var binder=Qva.GetBinder(element.binderid);if(!enabled){icon+=".DISABLED"}var url=binder.BuildBinaryUrl(node.getAttribute("path"),null,icon);element.src=url}element.className=(value==node.getAttribute("value"))?element.getAttribute("selected-class"):element.getAttribute("unselected-class")};Qva.Mgr.color=function(owner,elem,name,prefix,condition){this.Name=Qva.MgrMakeName(name,prefix);owner.AddManager(this);this.Element=elem;elem.binderid=owner.binderid;elem.Name=this.Name;elem.setAttribute("value",condition);var div=document.createElement("div");elem.appendChild(div);div.innerText=" ";div.className="ToolProperty-Color";try{div.style.backgroundColor=condition}catch(e){alert("Invalid color:"+condition)}};Qva.Mgr.color.OnClick=function(){var binder=Qva.GetBinder(this.binderid);binder.Set(this.Name,"value",this.getAttribute("value"),true)};Qva.Mgr.color.prototype.Paint=function(mode,node){this.Touched=true;var element=this.Element;element.style.display=Qva.MgrGetDisplayFromMode(this,mode);var enabled=(mode=="e");var value=element.getAttribute("value");element.disabled=!enabled;element.style.backgroundColor=(value==node.getAttribute("text"))?"highlight":"";if(enabled){Qva.Events.AddClickEvent(element,Qva.Mgr.color.OnClick)}else{Qva.Events.AddClickEvent(element,function(){})}};Qva.Mgr.resize=function(owner,elem,name,prefix){this.Name="$";owner.AddManager(this);this.Element=elem};Qva.Mgr.resize.prototype.Paint=function(mode,node){this.Touched=true;var element=this.Element};Qva.Mgr.ulList=function(owner,elem,name,prefix,condition){};function SetFocusSubItems(inputs,fxbuttons,isfocus){for(var i=0;i<inputs.length;i++){var $input=$(inputs[i]);if($input.hasClass("prop-dyn-dynamic-dropdown")){return}if(isfocus){$input.removeClass("prop-dyn-clear-border-background");if(inputs.length==1&&!Qva.userAgentDetector.get("touchEnabled")){$input.focus()}}else{$input.addClass("prop-dyn-clear-border-background")}}for(var i=0;i<fxbuttons.length;i++){var $fxbutton=$(fxbuttons[i]);if(isfocus){$fxbutton.removeClass("prop-dyn-hidden")}else{$fxbutton.addClass("prop-dyn-hidden")}}}function SetActivateSubItems($child,isactive,isdisabled){var $listItemHandle=$($child.children(".prop-dyn-sortable-item-handle").children(":eq(0)")[0]);if(isactive){$child.removeClass("ui-state-default").addClass("prop-dyn-sortable-item-highlighted");if(!isdisabled){$listItemHandle.removeClass("prop-sortable-list-arrow").addClass("prop-sortable-list-arrow-highlighted");$child.find("[name='sortable-list-item-close-button']").removeClass("prop-dyn-hidden")}else{$listItemHandle.removeClass("prop-sortable-list-arrow-highlighted").addClass("prop-sortable-list-arrow");$child.find("[name='sortable-list-item-close-button']").addClass("prop-dyn-hidden")}}else{$child.removeClass("prop-dyn-sortable-item-highlighted").addClass("ui-state-default");$listItemHandle.removeClass("prop-sortable-list-arrow-highlighted").addClass("prop-sortable-list-arrow");$child.find("[name='sortable-list-item-close-button']").addClass("prop-dyn-hidden");$child.find("input.prop-dyn-dynamic-dropdown").dynamicdropdown("close").trigger("blur")}SetFocusSubItems($child.find("input"),$child.find("[propicontype='expression']"),isactive&&!isdisabled)}Qva.Mgr.list=function(owner,elem,name,prefix,condition){this.Name=Qva.MgrMakeName(name,prefix);owner.AddManager(this);this.Element=elem;elem.binderid=owner.binderid;elem.Name=this.Name;var list=this;var dragging=false;var draggedItem;var draggingOutsideOfSortable=false;var popoutRightPos;if(elem.tagName.toUpperCase()=="UL"){Qva.DragDrop.DropTargets[Qva.DragDrop.DropTargets.length]=this;var $elem=$(elem);var _this=this;$elem.on(Qva.Events.getStartEvents(),function(event){var activeli=$(event.srcElement).closest("li")[0];if(!activeli){return}$elem.children("li").each(function(){var $li=$(this);SetFocusSubItems($li.find("input"),$li.find("[propicontype='expression']"),false)});_this.SetActiveItem(activeli)});$(document).on(Qva.Events.getStartEvents(),function(event){var activeli=$(event.srcElement).closest("li")[0];$elem.children("li").each(function(){if(this==activeli){return}var $li=$(this);SetFocusSubItems($li.find("input"),$li.find("[propicontype='expression']"),false)})});if(elem.Name.match(/(.Expression)$/i)){var $div=$(elem.children[0]).find("div[avq^='prop_editexpression']");this.ExtraIndex=($div&&$div.length>0)?parseInt($div.attr("avq").split(".")[1]):null}var istoolwindow=elem.getAttribute("istoolwindow");this.ActiveItem=null;if(owner.ListController){this.ListController=owner.ListController}this.StyleActiveItem=function(Index){for(var iChild=0;iChild<$elem.children().length;iChild++){var child=$elem.children()[iChild];var $child=$(child);if(istoolwindow){$child.addClass("ui-state-default");$child.mouseover(function(){$(this).addClass("prop-dyn-sortable-item-highlighted")});$child.mouseout(function(){if(!$elem.sortable("option","disabled")){$(this).removeClass("prop-dyn-sortable-item-highlighted")}})}else{SetActivateSubItems($child,child.Index==Index,$elem.sortable("option","disabled"))}}};this.InitActiveItem=function(object){var ActiveItemRemoved=false;if(this.ActiveItem){if(this.ActiveItem.Index<this.RowCount){return}ActiveItemRemoved=true}this.ActiveItem={Name:object.Name,AvqDialog:object.AvqDialog,binderid:object.binderid,Index:object.Index};if(this.ListController){if(this.ListController.SetActiveListItemAndFoldout&&object.AvqDialog){if(ActiveItemRemoved){this.ListController.SetActiveListItemAndFoldout(this)}}else{if(this.ListController.SetActiveListItem){this.ListController.SetActiveListItem(this)}}}else{this.SetActiveItem(this.ActiveItem)}};this.SetActiveItem=function(object,initial){var ActiveItem={Name:object.Name,AvqDialog:object.AvqDialog,binderid:object.binderid,Index:object.Index};if(initial&&this.ListController&&this.ListController.GetActiveFoldOut&&object.AvqDialog){var CurrentActiveFoldout=this.ListController.GetActiveFoldOut();if(CurrentActiveFoldout.Name){if(CurrentActiveFoldout.AvqDialog==this.ActiveItem.AvqDialog){this.StyleActiveItem(this.ActiveItem.Index)}else{this.StyleActiveItem(-1)}return}}this.ActiveItem=ActiveItem;this.StyleActiveItem(this.ActiveItem.Index);if(this.ListController){if(this.ListController.SetActiveListItemAndFoldout&&object.AvqDialog){this.ListController.SetActiveListItemAndFoldout(this)}else{if(this.ListController.SetActiveListItem){this.ListController.SetActiveListItem(this)}}}};this.ClearActiveItem=function(onlystyling){if($elem.children().length>0){this.StyleActiveItem(-1)}else{if(!onlystyling){if(this.ActiveItem){if(this.ListController){if(this.ListController.SetActiveListItemAndFoldout&&this.ActiveItem.AvqDialog){this.ActiveItem=null;this.ListController.SetActiveListItemAndFoldout(this)}else{if(this.ListController.SetActiveListItem){this.ActiveItem=null;this.ListController.SetActiveListItem(this)}}}else{this.ActiveItem=null}}else{if(this.ListController){if(this.ListController.SetActiveListItemAndFoldout){this.ListController.SetActiveListItemAndFoldout(this)}else{if(this.ListController.SetActiveListItem){this.ListController.SetActiveListItem(this)}}}}}}};elem.Object=this;var currentSortableList=elem;$elem.sortable({disable:true,handle:".prop-dyn-sortable-item-handle",helper:"clone",start:function(event,ui){if($(document.activeElement).hasClass("ui-autocomplete-input")){$(document.activeElement).blur()}},update:function(event,ui){var ul=ui.item.parent();if(this.Name!=ul[0].Name){_this.Paint();return}var sortedUl=[];var binder=Qva.GetBinder(ui.item[0].binderid);if(!binder.Enabled){return}ul.children("li").each(function(){sortedUl.push(this.Name)});var idOfNewlySortedItem=ui.item[0].Name;var indexOfNewlySortedItem=$QvJq.inArray(idOfNewlySortedItem,sortedUl);var NameEnd;if(this.Object.ExtraIndex!=null&&this.Object.ExtraIndex>=0){NameEnd="."+this.Object.ExtraIndex+".Remove"}else{NameEnd=".Remove"}if(sortedUl.length==1){binder.Set(sortedUl[indexOfNewlySortedItem]+NameEnd,"insertafter",ul[0].Name.concat(".Add"),true)}else{if(sortedUl[indexOfNewlySortedItem-1]==null&&sortedUl[indexOfNewlySortedItem+1]!=null){binder.Set(sortedUl[indexOfNewlySortedItem]+NameEnd,"insertbefore",sortedUl[indexOfNewlySortedItem+1]+NameEnd,true)}else{if(sortedUl[indexOfNewlySortedItem-1]!=null&&sortedUl[indexOfNewlySortedItem+1]!=null){binder.Set(sortedUl[indexOfNewlySortedItem]+NameEnd,"insertbefore",sortedUl[indexOfNewlySortedItem+1]+NameEnd,true)}else{if(sortedUl[indexOfNewlySortedItem+1]==null){binder.Set(sortedUl[indexOfNewlySortedItem]+NameEnd,"insertafter",sortedUl[indexOfNewlySortedItem-1]+NameEnd,true)}else{}}}}list.ActiveItem={AvqDialog:ui.item[0].AvqDialog,Index:indexOfNewlySortedItem,Name:ul[0].Name.concat(".").concat(indexOfNewlySortedItem),binderid:ui.item[0].binderid};if(ul[0].Name.match(/(.Chart.Dimension)$/i)){list.keepDropDownClosed=true}},sort:function(event,ui){var $currentSortableList=$(currentSortableList),sortableListOffset=$currentSortableList.offset();var sortableList={top:Math.round(sortableListOffset.top),right:Math.round($currentSortableList.width()+sortableListOffset.left),bottom:Math.round(sortableListOffset.top+$currentSortableList.height()),left:Math.round(sortableListOffset.left)};var uihelperOffset=ui.helper.offset();var draggable={top:Math.round(uihelperOffset.top),right:Math.round(uihelperOffset.left+ui.helper.width()),bottom:Math.round(uihelperOffset.top+ui.helper.height()),left:Math.round(uihelperOffset.left)}},scroll:true,appendTo:"parent",axis:"y",zIndex:99999});var li=elem.getElementsByTagName("li")[0];this.Li=li.innerHTML.replace(/avqcol/gi,"avq");this.LiAttr=[];for(var iAttr=0;iAttr<li.attributes.length;iAttr++){this.LiAttr[this.LiAttr.length]={name:li.attributes[iAttr].name,value:li.attributes[iAttr].value}}if(Qva.userAgentDetector.get("msie")&&Qva.userAgentDetector.get("msieDocMode")<8){this.LiAttr[this.LiAttr.length]={name:"class",value:li.className}}elem.innerHTML="";this.Managers={};this.Paint=Qva.Mgr.ulList.prototype.Paint}else{var cells=elem.getElementsByTagName("tr")[0].getElementsByTagName("td");this.Cells=[];for(var ix=0;ix<cells.length;++ix){this.Cells[ix]=cells[ix].innerHTML.replace("avqcol=","avq=")}elem.deleteRow(0);this.Managers={}}};Qva.Mgr.list.prototype.Inside=function(pos,type){if(type!=this.Accept){return null}var $elem=$(this.Element);var cellPos=Qva.GetPageCoords(this.Element);if(pos.x>cellPos.x&&pos.x<cellPos.x+$elem.width()&&pos.y>cellPos.y&&pos.y<cellPos.y+$elem.height()){return{Element:{Name:this.Name+".Add"},VerticalPosition:"insertafter",listobject:this}}return null};Qva.Mgr.ulList.prototype.Paint=function(mode,node,prefix){if(!node){mode=this.mode;node=this.node;prefix=this.prefix}else{this.mode=mode;this.node=node;this.prefix=prefix}this.Touched=true;var element=this.Element;var liElements=element.getElementsByTagName("li");$(this.Element).children("li").each(function(){var li=$(this);li.find(".prop-dyn-dynamic-dropdown").dynamicdropdown("destroy")});element.style.display=Qva.MgrGetDisplayFromMode(this,mode);this.Accept=node.getAttribute("accept");var RowCount=parseInt(node.getAttribute("value"));if(isNaN(RowCount)){return}var ItemAdded=false;if(!isNaN(this.RowCount)&&RowCount>this.RowCount){ItemAdded=true}this.RowCount=RowCount;var binder=Qva.GetBinder(element.binderid);while(0<liElements.length){var rix=liElements.length-1;element.removeChild(liElements[rix]);this.RemoveManagers(this.Name+"."+rix)}var disabledList=(node.getAttribute("mode")=="disabled")?true:false;var $element=$(element);$element.sortable();$element.sortable("option","disabled",disabledList);if(this.Accept&&this.Accept.length>0){if(!$element.sortable("option","connectWith")){$element.attr("data-list-type",this.Accept);$element.sortable("option","connectWith","[data-list-type='"+this.Accept+"']")}}else{if(!$element.sortable("option","axis")){$element.sortable("option","axis","y")}}if(this.RowCount==0){this.ClearActiveItem()}else{while(this.RowCount>liElements.length){var rix=liElements.length;var scanner=new Qva.Scanner(this);var li=document.createElement("li");var attrCount=this.LiAttr.length;if(Qva.userAgentDetector.get("msie")&&Qva.userAgentDetector.get("msieDocMode")<8){attrCount--;li.className=this.LiAttr[this.LiAttr.length-1].value}for(var iAttr=0;iAttr<attrCount;iAttr++){switch(this.LiAttr[iAttr].name){case"class":li.setAttribute(this.LiAttr[iAttr].name,this.LiAttr[iAttr].value);break;case"name":li.setAttribute(this.LiAttr[iAttr].name,this.LiAttr[iAttr].value);break;case"avq":li.setAttribute(this.LiAttr[iAttr].name,this.LiAttr[iAttr].value);break}}li.innerHTML=this.Li;li.Name=this.Name;li.Index=rix;li.binderid=element.binderid;element.appendChild(li);if($(element).height()<($(li).height()*this.RowCount)){var liWidth=310;$(li).width(liWidth)}scanner.Scan(li,li.Name+"."+rix,this);var liIndex=li.Name.substr(li.Name.lastIndexOf(".")+1);if(isNaN(liIndex)){li.Name+="."+rix}if(ItemAdded&&rix==this.RowCount-1&&!this.keepDropDownClosed){this.SetActiveItem(li);$(li).find("span[propicontype='tool']").attr("newrow","true");$(li).find(".prop-dyn-dynamic-dropdown").attr("newrow","true")}else{if(rix==0){this.InitActiveItem(li)}}}this.SetActiveItem(this.ActiveItem,true);delete this.keepDropDownClosed}if(disabledList){$(element).children("li").each(function(){$(this).find("*").each(function(){if(this.closeDynamicDropdown){this.closeDynamicDropdown()}var el=$(this);if(el.hasClass("prop-dyn-dynamic-dropdown")){el.dynamicdropdown("option","disabled",true);el.attr("readonly",true)}if(this.tagName=="INPUT"){$(this).addClass("prop-dyn-dimmed");if(Qva.userAgentDetector.get("msie")&&Qva.userAgentDetector.get("msieVersion")<9){this.onselectstart=function(){this.blur();return false}}else{this.onmousedown=function(){this.blur();return false}}}el.unbind()})});$(element).prev().children(".prop-icon-24x24:eq(0)").addClass("prop-dyn-transparency")}this.PaintChildren(node,".")};Qva.Mgr.list.prototype.Paint=function(mode,node,prefix){this.Touched=true;var element=this.Element;element.style.display=Qva.MgrGetDisplayFromMode(this,mode);var count=parseInt(node.getAttribute("value"));if(isNaN(count)){return}var binder=Qva.GetBinder(element.binderid);if(this.Element.tagName.toUpperCase()=="UL"){return}while(count<element.rows.length){var rix=element.rows.length-1;element.deleteRow(rix);this.RemoveManagers(this.Name+"."+rix)}while(count>element.rows.length){var rix=element.rows.length;var row=element.insertRow(-1);for(var ix=0;ix<this.Cells.length;++ix){var cell=row.insertCell(-1);cell.innerHTML=this.Cells[ix]}var scanner=new Qva.Scanner(this);scanner.Scan(row,this.Name+"."+rix,this)}this.PaintChildren(node,".")};Qva.Mgr.list.prototype.PaintChildren=function(node,infix){for(var child=node.firstChild;child!=null;child=child.nextSibling){var name=child.getAttribute("name");if(name==null){continue}var mode=child.getAttribute("mode");switch(mode){case"hidden":mode="h";break;case"enabled":mode="e";break;default:mode="d";break}var list=this.Managers[this.Name+infix+name];if(list){for(var ix=0;ix<list.length;++ix){var mgr=list[ix];mgr.Paint(mode,child,name)}}this.PaintChildren(child,infix+name+".")}};Qva.Mgr.list.prototype.Append=function(){};Qva.Mgr.list.prototype.AddManager=function(mgr){mgr.PageBinder=this;mgr.Touched=false;var list=this.Managers[mgr.Name];if(list==null){list=[];this.Managers[mgr.Name]=list}list.push(mgr)};Qva.Mgr.list.prototype.RemoveManagers=function(prefix){for(var name in this.Managers){if(name.indexOf(prefix)!=0){continue}this.Managers[name]=null}Qva.HideTooltip()};Qva.Mgr.ulList.prototype.RemoveManagers=Qva.Mgr.list.prototype.RemoveManagers;Qva.Mgr.ulList.prototype.AddManager=Qva.Mgr.list.prototype.AddManager;Qva.Mgr.row=function(owner,elem,name,prefix,condition){if(!Qva.MgrSplit(this,name,prefix)){return}this.Attr="mode";owner.AddManager(this);this.Element=elem;owner.Append(this,this.Name,"value");this.row=elem;while(this.row.tagName!="TR"){this.row=this.row.parentNode}var drag=false;if(condition){if(condition=="drag"){drag=true}else{if(condition.substr(0,4)=="drag"){drag=true}}}if(drag){this.dragObj={Name:this.Name,Drag:elem}}var $row=$(this.row);this.$cloakables=$($row.children().find("[proptype='cloakable']"));var _this=this;var row=this.row;Qva.Events.AddClickEvent(row,function(event){var prevRow=_this.PageBinder.ActiveRow;if(prevRow){if(!prevRow.row.disabled){$(prevRow.row).removeClass("prop-dyn-sortable-item-highlighted")}Qva.HideTooltip();prevRow.$cloakables.addClass("prop-hidden")}if(!_this.row.disabled){$row.addClass("prop-dyn-sortable-item-highlighted")}Qva.ShowTooltip(event,_this.row);_this.$cloakables.removeClass("prop-hidden");_this.PageBinder.ActiveRow=_this},{nostop:true});this.binder=Qva.GetBinder(owner.ID);row.binderid=owner.ID;row.Name=this.Name};Qva.Mgr.row.prototype.Paint=function(mode,node){this.Touched=true;var element=this.Element;var $element=$(element);var row=this.row;row.disabled=(mode!="e");if(!row.disabled){this.row.dragObj=this.dragObj}row.style.display=Qva.MgrGetDisplayFromMode(this,mode);var binder=this.binder;var icon=node.getAttribute("icon");if(!icon){icon=element.getAttribute("icon")}if(icon){var switchFlag=(icon.split(":")[0]).toLowerCase();switch(switchFlag){case"web":var iconImage=(icon.split(":")[1]).toLowerCase();$element.attr("class",function(i,c){return c.replace(/\bprop-nso-\S+/g,"")});$element.addClass("prop-nso-"+iconImage).addClass("prop-left");break;case"addbm":var url=binder.BuildBinaryUrl(node.getAttribute("path"),null,icon);$element.attr("src",url);break;case"extension":if(!$element.children().is("img")){$element.append($('<img src="'+binder.BuildBinaryUrl(node.getAttribute("path"),null,icon)+'">'))}break}}var tips=node.getElementsByTagName("tooltip");var tiplen=tips.length;if(tiplen>0){var tiplist=[];for(var ix=0;ix<tiplen;++ix){tiplist.push(Qva.localization.getTooltipText(tips[ix]))}row.Tooltip=tiplist}else{row.Tooltip=null}if(this.PageBinder.ActiveRow!=this){this.$cloakables.addClass("prop-hidden")}var dragElemExists=false;if(row.dragObj){dragElemExists=$(row).find(".prop-draggable_icon").length>0}for(var cix=0;cix<row.cells.length;++cix){cell=row.cells[cix];if(cix<=row.cells.length){if(row.dragObj){if(dragElemExists){if($(cell).find(".prop-draggable_icon").length>0){Qva.Events.AddDragEvent(cell,Qva.DragDrop.mouseDown,Qva.DragDrop.mouseMove,Qva.DragDrop.mouseUp)}}else{Qva.Events.AddDragEvent(cell,Qva.DragDrop.mouseDown,Qva.DragDrop.mouseMove,Qva.DragDrop.mouseUp)}}else{Qva.Events.AddClickEvent(cell,function(){if(row.disabled){return}if(!binder.Enabled){return}binder.Set(row.Name,"value",row.Value,true)},{nostop:true})}}}if(row.dragObj){row.dragObj.Type=node.getAttribute("content");row.dragObj.Value=node.getAttribute("value")}else{row.Value=node.getAttribute("value")}};Qva.Mgr.listRow=function(owner,elem,name,prefix,condition){if(!Qva.MgrSplit(this,name,prefix)){return}this.Attr="mode";owner.AddManager(this);this.Element=elem;owner.Append(this,this.Name,"value");var row=elem;row.onclick=function(){if(row.disabled){return}var binder=Qva.GetBinder(row.binderid);if(!binder.Enabled){return}binder.Set(row.Name,"value",row.Value,true)};row.binderid=owner.binderid||owner.PageBinder.binderid;row.Name=this.Name};Qva.Mgr.listRow.prototype.Paint=function(mode,node){this.Touched=true;var element=this.Element;var row=element;row.disabled=(mode!="e");row.style.display=Qva.MgrGetDisplayFromMode(this,mode);var icon=node.getAttribute("icon");if(!icon){icon=element.getAttribute("icon")}if(icon){var binder=Qva.GetBinder(element.binderid);if(row.disabled){icon+=".DISABLED"}var url=binder.BuildBinaryUrl(node.getAttribute("path"),null,icon);element.src=url}var tips=node.getElementsByTagName("tooltip");var tiplen=tips.length;if(tiplen>0){var tiplist=[];for(var ix=0;ix<tiplen;++ix){tiplist.push(Qva.localization.getTooltipText(tips[ix]))}row.Tooltip=tiplist}else{row.Tooltip=null}if(row.dragObj){row.dragObj.Type=node.getAttribute("content");row.dragObj.Value=node.getAttribute("value")}else{row.Value=node.getAttribute("value")}};Qva.dropDialog={hidden:false,x:0,y:0,element:null,create:function(startHidden){if((!(Qva.IS_WORKBENCH||Qva.IS_WEBPARTS))&&(document.body===null||(document.body!==null&&typeof(document.body.binderid)==="undefined"))){return}if(Qva.dropDialog.maskelement==null){Qva.dropDialog.maskelement=document.createElement("div");Qva.dropDialog.maskelement.style.zIndex=9998;Qva.dropDialog.maskelement.className="popupMask";Qva.Events.AddCancelBubble(Qva.dropDialog.maskelement);document.body.appendChild(Qva.dropDialog.maskelement)}if(Qva.dropDialog.element===null){Qva.dropDialog.element=document.createElement("div");Qva.dropDialog.element.style.position="absolute";Qva.dropDialog.element.style.zIndex=9999;Qva.dropDialog.element.className="contextdialog";Qva.Events.AddCancelBubble(Qva.dropDialog.element);document.body.appendChild(Qva.dropDialog.element)}var body=document.createElement("div");Qva.dropDialog.element.appendChild(body);$(body.parentNode).removeClass("contextdialog").addClass("contextdialog-tool-window").addClass("popup-tool-window_container").addClass("popup-shadow");var header=document.createElement("div");$(header).addClass("ngdia-popup-toolwindow-subdialog-header").addClass("popup-tool-window_span-14");var caption=document.createElement("div");var caption_close=document.createElement("span");caption.setAttribute("avq","text:Document.ContextDialog.Title");$(caption).addClass("popup-tool-window_clear").addClass("popup-tool-window_span-8");$(caption_close).addClass("prop-icon-24x24").addClass("prop-contextdialog-icon-close").addClass("popup-grid_right").addClass("popup-grid_last");Qva.Events.AddClickEvent(caption_close,Qva.dropDialog.hide,{stopPropagation:true});header.appendChild(caption_close);var caption=document.createElement("span");caption.setAttribute("avq","text:Document.ContextDialog.Title");header.appendChild(caption);body.appendChild(header);var br=document.createElement("br");$(br).css("clear","both");body.appendChild(br);var content=document.createElement("div");var ul=document.createElement("ul");$(ul).attr("avq","list:Document.ContextDialog.Option").attr("istoolwindow","true").addClass("popup-tool-window-ul");$(content).append(ul);body.appendChild(content);for(var id in Qva.binders){ul.innerHTML='<li class="popup-tool-window-ul-li" avq="listRow:.Name"><span avq="text:.Name"></span></li>';var binder=Qva.binders[id];binder.dropDialogMgr=new Qva.Mgr.toolwindowbody(binder,Qva.dropDialog.element,"Document.ContextDialog");binder.dropDialogMgr.Scan(document.body.Name);binder.dropDialogMgr.Element.style.display=startHidden?"none":""}try{Qva.dropDialog.element.focus()}catch(err){}},show:function(){$(Qva.dropDialog.maskelement).show();Qva.dropDialog.element.style.display=""},showAt:function(x,y){Qva.dropDialog.x=x;Qva.dropDialog.y=y;Qva.dropDialog.element.style.left=x+"px";Qva.dropDialog.element.style.top=y+"px";Qva.dropDialog.show()},hide:function(){Qva.dropDialog.element.style.display="none";$(Qva.dropDialog.maskelement).hide();Qva.dropDialog.hidden=true;var binder=Qva.GetObjectBinder(Qva.dropDialog.element);binder.Set(binder.dropDialogMgr.Name,"action","close",true)}};QvaExpressionEditor={Insert:function(text,srcelem){if(!srcelem){return}var elem=srcelem.parentNode.parentNode.firstChild;while(elem&&elem.tagName!="TEXTAREA"){if(!elem.tagName){elem=elem.nextSibling}else{elem=elem.firstChild}}if(!elem){Assert(false);return}if(elem.setSelectionRange){var selectionStart=elem.ieselstart?elem.ieselstart:elem.selectionStart;var selectionEnd=elem.ieselend?elem.ieselend:elem.selectionEnd;var at=selectionStart+text.length;if(text[text.length-1]==")"){--at}elem.value=elem.value.substring(0,selectionStart)+text+elem.value.substring(selectionStart,selectionEnd)+elem.value.substring(selectionEnd,elem.value.length);elem.setSelectionRange(at,at);elem.focus()}else{if(document.selection&&document.selection.createRange){elem.focus();var range=elem.ierange?elem.ierange:document.selection.createRange();range.text=text+range.text;if(text.charAt(text.length-1)==")"){range.moveStart("character",-1);range.moveEnd("character",-1);range.select()}}}Qva.ActiveObjectsCloak=true},Update:function(event){var elem=event.target||event.srcElement;var text=elem.options[elem.selectedIndex].value;if(!text){text=elem.options[elem.selectedIndex].text}this.Insert(text,elem);if(event.preventDefault){event.preventDefault()}else{event.returnValue=false}elem.selectedIndex=0;return false}};Qva.Mgr.toolwindowfilter=function(owner,elem,name,prefix){if(!Qva.MgrSplit(this,name,prefix)){return}owner.AddManager(this);this.binderid=owner.binderid;this.Managers={};var select=document.createElement("select");$(select).addClass("prop-select");elem.appendChild(select);this.Element=select;var binderid=this.PageBinder.ID;$(select).change(function(){var binder=Qva.GetBinder(binderid);binder.Set(name,"value",$(this).val(),true)});if(name==="Document.TOOLS\\REPOSITORY.Filter"){this.options=["repositoryFilter0","repositoryFilter1","repositoryFilter2","repositoryFilter3"]}else{this.options=["repositoryOrderBy0","repositoryOrderBy1","repositoryOrderBy2","repositoryOrderBy3"]}var self=this;this.options.forEach(function(item,i){self.options[i]=Qva.localization.getStringFromKey(item)})};Qva.Mgr.toolwindowfilter.prototype.Paint=function(mode,node){this.Touched=true;var element=this.Element;if(mode=="h"){element.style.display="none";return}element.style.display="";while(element.firstChild){element.removeChild(element.firstChild)}element.innerHTML="";var self=this;$(node).find("element").each(function(){var attr={value:$(this).attr("value"),unselectable:"on"};var text=self.options[$(this).attr("value")];$("<option>").appendTo(element).attr(attr).text(text)});$(element).val($(node).attr("value"))}})($QvJq);(function($,undefined){Qva.Touch={GetCoordinatesForElem:function(elem,viewport){return Qva.GetAbsolutePageCoords(elem)},EventListenerExists:typeof(document.addEventListener)!=="undefined",SelectionPopup:null,Textbox:{AddTouchScroll:function(obj,mgr){var that=this;var box=obj.ContentElement.children[0],limitX,limitY,touchX=null,touchY=null,boxX,boxY,startX,startY,distX=0,distY=0,deltaX=0,deltaY=0;var touchStart=function(e){limitX=parseFloat($(obj.ContentElement).css("width"))-parseFloat($(box).css("width"));limitY=parseFloat($(obj.ContentElement).css("height"))-parseFloat($(box).css("height"));touchX=Qva.Events.getX(e);touchY=Qva.Events.getY(e);boxY=parseInt($(box).css("margin-top"));boxX=parseInt($(box).css("margin-left"));startX=parseInt(Qva.Events.getClientX(e));startY=parseInt(Qva.Events.getClientY(e));setDuration(box,"0ms")};var touchMove=function(e){touchX=Qva.Events.getX(e);touchY=Qva.Events.getY(e);var distX=parseInt(Qva.Events.getClientX(e))-startX;var distY=parseInt(Qva.Events.getClientY(e))-startY;deltaX=boxX+distX;deltaY=boxY+distY;if(mgr.scrollMgrY){(deltaY>=0)?$(box).css("margin-top",(deltaY/3)):(deltaY<=limitY)?$(box).css("margin-top",((deltaY-limitY)/3+limitY)):mgr.SetScrollPosition(true,mgr.scrollMgrY,0,deltaY)}if(mgr.scrollMgrX){(deltaX>=0)?$(box).css("margin-left",(deltaX/3)):(deltaX<=limitX)?$(box).css("margin-left",((deltaX-limitX)/3+limitX)):mgr.SetScrollPosition(false,mgr.scrollMgrX,0,deltaX)}};var touchEnd=function(e){if(deltaY>=0||deltaY<=limitY||deltaX>=0||deltaX<=limitX){setDuration(box,"800ms")}if(mgr.scrollMgrY){mgr.SetScrollPosition(true,mgr.scrollMgrY,0,((deltaY>=0)?0:(deltaY<=limitY)?limitY:deltaY))}if(mgr.scrollMgrX){mgr.SetScrollPosition(false,mgr.scrollMgrX,0,((deltaX>=0)?0:(deltaX<=limitX)?limitX:deltaX))}};Qva.Events.AddTouchScrollEvent(obj.ContentElement,touchStart,touchMove,touchEnd)}},Listbox:{AddTouchScroll:function(contentElement){var that=this;var touchStart=function(e){var touched=this;var objLBTouch=this.Touch,totalXScroll=isNaN(objLBTouch.TotalScrollX)?0:objLBTouch.TotalScrollX,totalYScroll=isNaN(objLBTouch.TotalScrollY)?0:objLBTouch.TotalScrollY,mgr=this.children[0].Mgr,target=Qva.Events.getTarget(e);var m=mgr.scroll_obj.getPosition();if(m.x!==totalXScroll||m.y!==totalYScroll){objLBTouch.TotalScrollX=m.x;objLBTouch.TotalScrollY=m.y;mgr.scroll_obj.setTransitionTime("0ms");mgr.scroll_obj.setPosition(objLBTouch.TotalScrollX,objLBTouch.TotalScrollY)}objLBTouch.TouchStartX=Qva.Events.getClientX(e);objLBTouch.TouchStartY=Qva.Events.getClientY(e);objLBTouch.TouchIdentifier=Qva.Events.getIdentifier(e);objLBTouch.TouchPointList=[];objLBTouch.FingerMoved=false;objLBTouch.TouchStartTime=e.timeStamp};var touchMove=function(e){var objLBTouch=this.Touch,totalXScroll=isNaN(objLBTouch.TotalScrollX)?0:objLBTouch.TotalScrollX,totalYScroll=isNaN(objLBTouch.TotalScrollY)?0:objLBTouch.TotalScrollY,translateExpr="",mgr=this.children[0].Mgr,deltaX=0,deltaY=0,last=null,deltaRows=0,deltaCols=0,absoluteDY=0,absoluteDX=0;if(!Qva.touchHelper.Listbox.update(e,objLBTouch)){return true}last=objLBTouch.TouchPointList[objLBTouch.TouchPointList.length-1];absoluteDX=Math.abs(last.dx);absoluteDY=Math.abs(last.dy);if(absoluteDY<3){totalYScroll+=last.dy}if(absoluteDX<3){totalXScroll+=last.dx}if(absoluteDY<3&&absoluteDX<3){return true}deltaX=last.dx+totalXScroll;deltaY=last.dy+totalYScroll;objLBTouch.FingerMoved=true;if(mgr.single_col_scroll){var maxX=mgr.x_max_scroll}else{if(mgr.columns<=mgr.visible_cols){deltaX=0}var maxX=Math.max(0,(mgr.columns-mgr.visible_cols)*mgr.colwidth)}if(-deltaX<0){deltaX=deltaX/3}if(-deltaX>maxX){deltaX=(deltaX+maxX)/3-maxX}if(mgr.rows<=mgr.visible_rows){deltaY=0}var maxY=Math.max(0,(mgr.rows-mgr.visible_rows)*mgr.rowHeight);if(-deltaY<0){deltaY=deltaY/3}if(-deltaY>maxY){deltaY=(deltaY+maxY)/3-maxY}objLBTouch.TmpScrollX=deltaX;objLBTouch.TmpScrollY=deltaY;mgr.scroll_obj.setTransitionTime("0ms");if(Qva.Events.loggingActive){console.log(" moving deltaY="+deltaY)}mgr.scroll_obj.setPosition(deltaX,deltaY);mgr.PageBinder.QueuePostPaintMessage(mgr)};var touchEnd=function(e){var objLBTouch=this.Touch,totalXScroll=isNaN(objLBTouch.TotalScrollX)?0:objLBTouch.TotalScrollX,totalYScroll=isNaN(objLBTouch.TotalScrollY)?0:objLBTouch.TotalScrollY,mgr=this.children[0].Mgr,last=null,deltaX=0,deltaY=0,deltaRows=0,deltaCols=0,i=0,objMomentum={},target=Qva.Events.getTarget(e);if(!Qva.touchHelper.Listbox.update(e,objLBTouch)){return true}last=objLBTouch.TouchPointList[objLBTouch.TouchPointList.length-1];for(i=objLBTouch.TouchPointList.length-1;i>0&&last.dt-objLBTouch.TouchPointList[i-1].dt<200;--i){}deltaX=(last.dx-objLBTouch.TouchPointList[i].dx)+last.dx+totalXScroll;deltaY=(last.dy-objLBTouch.TouchPointList[i].dy)+last.dy+totalYScroll;deltaRows=Qva.touchHelper.Listbox.calculateDeltaRows(mgr,deltaY);deltaY=mgr.rowHeight*-deltaRows;if(Qva.Events.loggingActive){console.log(" ended deltaY="+deltaY)}if(mgr.single_col_scroll){var maxX=mgr.x_max_scroll;if(-deltaX<0){deltaX=0}if(-deltaX>maxX){deltaX=-maxX}}else{deltaCols=Math.max(0,Math.min(mgr.columns-mgr.visible_cols,Math.round(-deltaX/mgr.colwidth)));deltaX=mgr.colwidth*-deltaCols}mgr.scroll_obj.setTransitionTime("800ms");mgr.scroll_obj.setPosition(deltaX,deltaY);mgr.PageBinder.QueuePostPaintMessage(mgr);objLBTouch.TotalScrollX=deltaX;objLBTouch.TotalScrollY=deltaY};contentElement.Touch={ElementToScroll:contentElement.children[0].children[0],Scrollbar:new Qva.Touch.Scrollbar(contentElement),Mgr:contentElement.children[0].Mgr,MultiSelectMode:false,TouchStartX:0,TouchStartY:0,TouchStartTime:0,TmpScrollX:0,TmpScrollY:0,TotalScrollY:0,TotalScrollX:0,FingerMoved:false,ToggleSelect:false,ResetScroll:function(){this.TotalScrollX=0;this.TotalScrollY=0;this.Mgr.scroll_obj.setTransitionTime("0ms");this.Mgr.scroll_obj.setPosition(0,0)}};contentElement.Touch.ElementToScroll.style.webkitTransform="translate3d(0px, 0px, 0)";contentElement.Touch.ElementToScroll.style.webkitTransitionTimingFunction="cubic-bezier(0,0,0.25,1)";contentElement.Touch.ElementToScroll.style.webkitTransitionProperty="-webkit-transform";Qva.Events.AddTouchScrollEvent(contentElement,touchStart,touchMove,touchEnd)}},Chart:{DelayBeforePopup:500,Pinch:false,AddTouchSupport:function(chart){var that=this;Qva.Events.AddLongPressEvent(chart.Element,function(event){Qva.Touch.SelectionPopup.Show(chart,Qva.Events.getX(event),Qva.Events.getY(event))});chart.Element.className+=" Suppress-Callout";if(Qva.Touch.SelectionPopup===null){Qva.Debug.UseConsolelog&&Qva.ConsoleLog.Log("Hover object has been created...",Qva.ConsoleLog.SeverityTypes.Normal);Qva.Touch.SelectionPopup=new Qva.Touch.HoverObject(Qva.GetBinder(chart.PageBinder.binderid).isSmallDevices,this)}}}};Qva.Touch.HoverObject=function(isSmallDevices,that){Resizer=function(width,height,beforeResizeCfg,onResizeCfg){var visibleGrabHandle=document.createElement("div");visibleGrabHandle.className="Touch-ResizeHandle-Inner";this.Element=document.createElement("div");this.Element.className="Touch-ResizeHandle-Outer";this.Element.appendChild(visibleGrabHandle);this.Element.ObjRef=this;if(onResizeCfg){this.OnResize=onResizeCfg}if(beforeResizeCfg){this.BeforeResize=beforeResizeCfg}this.SetPosition(width,height);var that=this;Qva.Events.AddDragEvent(that.Element,function(event){var objRef=that.Element.ObjRef;that.Element.ObjRef.TouchCoord.x=Qva.Events.getX(event);that.Element.ObjRef.TouchCoord.y=Qva.Events.getY(event);if(objRef.BeforeResize.fn){objRef.BeforeResize.fn.apply(objRef.BeforeResize.scope||that.Element,[event])}},function(event){var objRef=that.Element.ObjRef;var xPos=Qva.Events.getX(event),yPos=Qva.Events.getY(event),deltaW=that.Element.ObjRef.TouchCoord.x-xPos,deltaH=that.Element.ObjRef.TouchCoord.y-yPos;objRef.TouchCoord.x-=deltaW;objRef.TouchCoord.y-=deltaH;if(objRef.OnResize.fn){objRef.OnResize.fn.apply(objRef.OnResize.scope,[event,{width:deltaW,height:deltaH}])}},function(){})};Resizer.prototype={Element:null,OnResize:null,BeforeResize:null,TouchCoord:{x:0,y:0},SetPosition:function(x,y){this.Element.style.left=x-7+"px";this.Element.style.top=y-7+"px"}};SelectionRect=function(width,height,beforeMoveCfg,onMoveCfg,afterMoveCfg){this.Element=document.createElement("div");var $element=$(this.Element);this.Element.className="TouchSelectionRect img_move_arrows";this.Element.style.border="2px solid green";Qva.Events.AddNoContextMenu(this.Element);this.Size.defaultWidth=width;this.Size.defaultHeight=height;this.Element.ObjRef=this;this.Element.OnMove=onMoveCfg;this.Element.BeforeMove=beforeMoveCfg;this.Element.AfterMove=afterMoveCfg;this.SetSize(width,height);var that=this;Qva.Events.AddDragEvent(this.Element,function(event){that.Element.ObjRef.StartTouch.x=Qva.Events.getX(event);that.Element.ObjRef.StartTouch.y=Qva.Events.getY(event);if(that.Element.BeforeMove.fn){that.Element.BeforeMove.fn.apply(that.Element.BeforeMove.scope||that.Element,[event,that.Element.ObjRef.StartTouch])}},function(event){var startRef=that.StartTouch,left=Qva.Events.getX(event),top=Qva.Events.getY(event),deltaX=startRef.x-left,deltaY=startRef.y-top;if(that.Element.OnMove.fn){that.Element.OnMove.fn.apply(that.Element.OnMove.scope,[event,{x:deltaX,y:deltaY}])}},function(event){if(that.Element.AfterMove.fn){that.Element.AfterMove.fn.apply(that.Element.AfterMove.scope,[event])}});return this};SelectionRect.prototype={Element:{BeforeMove:{fn:null,scope:null},OnMove:{fn:null,scope:null},AfterMove:{fn:null,scope:null},ObjRef:null},StartTouch:{x:0,y:0},Size:{defaultWidth:0,defaultHeight:0,currentWidth:0,currentHeight:0},SetSize:function(width,height){this.Size.currentWidth=width;this.Size.currentHeight=height;this.Element.style.width=width+"px";this.Element.style.height=height+"px"},ResetSize:function(){this.SetSize(this.Size.defaultWidth,this.Size.defaultHeight)}};this.IsSmallDevices=isSmallDevices;this.Element=document.createElement("div");this.Element.HoverRef=this;this.Element.className="Suppress-Callout";this.Element.style.position="absolute";this.Element.style.display="none";this.Element.style.zIndex=9999;this.Element.IsSelectionPopup=true;var config={SmallDevices:isSmallDevices,AddPointerElem:true,that:that,Buttons:[{Fn:this.Hide,Scope:this,CssClass:"img_cancel_cross",Text:"Cancel",Style:{"float":"left"}},{Fn:this.MakeSelection,Scope:this,CssClass:"img_accept_tick",Text:"Select",Style:{"float":"right"}}],Style:{"margin-left":isSmallDevices?"0px":"-15px",display:isSmallDevices?"none":""}};if(!isSmallDevices){config.Buttons.unshift({Fn:this.More,Text:"More",Scope:this,CssClass:"img_more_dots",Style:{display:"inline-block"}})}this.MenuObj=new Qva.Touch.SelectionMenu(config);if(!isSmallDevices){this.Element.appendChild(this.MenuObj.Element)}this.SelectionObj=new SelectionRect(this.Size.width,this.Size.height,{fn:this.BeforeMove,scope:this},{fn:this.OnMove,scope:this},{fn:this.AfterMove,scope:this});this.Element.appendChild(this.SelectionObj.Element);this.ResizerObj=new Resizer(this.Size.width,this.Size.height,{fn:this.BeforeResize,scope:this},{fn:this.OnResize,scope:this});this.Element.appendChild(this.ResizerObj.Element);document.body.appendChild(this.Element)};Qva.Touch.HoverObject.prototype={Element:null,IsSmallDevices:false,ChartElement:null,MenuObj:null,SelectionObj:null,ResizerObj:null,MinWidth:15,MinHeight:15,Size:{width:100,height:80},CurrentPos:{left:0,top:0},Limits:{maxWidth:0,maxHeight:0,xMin:0,xMax:0,yMin:0,yMax:0,dragLeft:0,dragRight:0,dragTop:0,dragBottom:0},DefineLimits:function(){var chartCoords=this.IsSmallDevices?{x:0,y:Qva.Touch.GetCoordinatesForElem(this.ChartElement).y}:Qva.Touch.GetCoordinatesForElem(this.ChartElement),selAreaPos=Qva.Touch.GetCoordinatesForElem(this.SelectionObj.Element),menuHeight=this.IsSmallDevices?0:getClientHeight(this.MenuObj.Element),chartWidth=getClientWidth(this.ChartElement),chartHeight=getClientHeight(this.ChartElement),selAreaWidth=getClientWidth(this.SelectionObj.Element),selAreaHeight=getClientHeight(this.SelectionObj.Element);this.Limits.xMin=chartCoords.x;this.Limits.xMax=chartCoords.x+chartWidth-selAreaWidth;this.Limits.yMin=chartCoords.y-menuHeight;this.Limits.yMax=this.IsSmallDevices?chartCoords.y+chartHeight:chartCoords.y+chartHeight-selAreaHeight-menuHeight;this.Limits.maxWidth=chartCoords.x+chartWidth-selAreaPos.x;this.Limits.maxHeight=chartCoords.y+chartHeight-selAreaPos.y;this.Limits.dragLeft=selAreaPos.x-chartCoords.x;this.Limits.dragRight=selAreaPos.x-(chartCoords.x+chartWidth-selAreaWidth);this.Limits.dragTop=selAreaPos.y-chartCoords.y;this.Limits.dragBottom=selAreaPos.y-(chartCoords.y+chartHeight-selAreaHeight)},Show:function(chart,posx,posy){if(this.Element.style.display!=="none"){return}Qva.Debug.UseConsolelog&&Qva.ConsoleLog.Log("Show popup",Qva.ConsoleLog.SeverityTypes.Normal);this.Chart=chart;this.ChartElement=chart.Element;if(!chart.Element){Qva.Debug.UseConsolelog&&Qva.ConsoleLog.Log("No chart element",Qva.ConsoleLog.SeverityTypes.Normal)}this.Element.style.display="";this.Element.style.webkitTransform="translate3d(0px, 0px, 0)";this.Element.style.transform="translate3d(0px, 0px, 0)";this.DefineLimits();var x=posx-(this.Size.width/2),y=posy-getClientHeight(this.MenuObj.Element)-(this.Size.height/2);x=Math.max(x,this.Limits.xMin);x=Math.min(x,this.Limits.xMax);y=Math.max(y,this.Limits.yMin);y=Math.min(y,this.Limits.yMax);this.Element.style.left=x+"px";this.Element.style.top=y+"px";this.CurrentPos.left=x;this.CurrentPos.top=y;this.SelectionObj.ResetSize(this.Size.width,this.Size.height);this.ResizerObj.SetPosition(this.Size.width,this.Size.height);if(this.IsSmallDevices){this.MenuObj.Element.style.display=""}},Hide:function(){Qva.Debug.UseConsolelog&&Qva.ConsoleLog.Log("HoverObject.Hide",Qva.ConsoleLog.SeverityTypes.Normal);this.Element.style.display="none";if(this.IsSmallDevices){this.MenuObj.Element.style.display="none"}},MakeSelection:function(){var objectbinder=Qva.GetObjectBinder(this.ChartElement),graphCoords=this.IsSmallDevices?{x:0,y:Qva.Touch.GetCoordinatesForElem(this.ChartElement).y}:Qva.Touch.GetCoordinatesForElem(this.ChartElement),selRectCoords=Qva.Touch.GetCoordinatesForElem(this.SelectionObj.Element),left=selRectCoords.x-graphCoords.x,top=selRectCoords.y-graphCoords.y,width=getClientWidth(this.SelectionObj.Element),height=getClientHeight(this.SelectionObj.Element),rectstring=left+":"+top+":"+width+":"+height+":"+getClientWidth(this.ChartElement)+":"+getClientHeight(this.ChartElement);Qva.Debug.UseConsolelog&&Qva.ConsoleLog.Log("Make selection. rect: "+rectstring,Qva.ConsoleLog.SeverityTypes.Normal);var array=[];array[0]={left:left,top:top,width:width,height:height};this.Chart.HandleSelection(array);this.Hide()},More:function(event){this.Hide();this.Chart.PageBinder.GetDocumentMgr().OnContextMenu(event,this.Chart.PageBinder.Name)},BeforeMove:function(e,fingerCoords){Qva.Debug.UseConsolelog&&Qva.ConsoleLog.Log("BeforeMove fired",Qva.ConsoleLog.SeverityTypes.Normal);this.DefineLimits()},OnMove:function(e,deltaObj){deltaObj.x=Math.min(deltaObj.x,this.Limits.dragLeft);deltaObj.x=Math.max(deltaObj.x,this.Limits.dragRight);deltaObj.y=Math.min(deltaObj.y,this.Limits.dragTop);deltaObj.y=Math.max(deltaObj.y,this.Limits.dragBottom);this.Element.style.webkitTransform="translate3d("+-deltaObj.x+"px, "+-deltaObj.y+"px, 0)";this.Element.style.transform="translate3d("+-deltaObj.x+"px, "+-deltaObj.y+"px, 0)"},AfterMove:function(e){var transformStr,xMove,yMove;transformStr=this.Element.style.webkitTransform;if(Qva.userAgentDetector.options.msie===true){transformStr=this.Element.style.transform}xMove=parseInt(transformStr.substring(transformStr.indexOf("(")+1,transformStr.indexOf("px")),10);yMove=parseInt(transformStr.substring(transformStr.indexOf(",")+1,transformStr.lastIndexOf("px")),10);Qva.Debug.UseConsolelog&&Qva.ConsoleLog.Log("AfterMove fired",Qva.ConsoleLog.SeverityTypes.Normal);this.CurrentPos.left+=xMove;this.CurrentPos.top+=yMove;this.Element.style.webkitTransform="translate3d(0px, 0px, 0)";this.Element.style.transform="translate3d(0px, 0px, 0)";this.Element.style.left=this.CurrentPos.left+"px";this.Element.style.top=this.CurrentPos.top+"px"},BeforeResize:function(e){Qva.Debug.UseConsolelog&&Qva.ConsoleLog.Log("BeforeResize fired",Qva.ConsoleLog.SeverityTypes.Normal);this.DefineLimits()},OnResize:function(e,deltaObj){var tmpWidth=Math.max(this.SelectionObj.Size.currentWidth-deltaObj.width,this.MinWidth),width=Math.min(this.Limits.maxWidth,tmpWidth),tmpHeight=Math.max(this.SelectionObj.Size.currentHeight-deltaObj.height,this.MinHeight),height=Math.min(this.Limits.maxHeight,tmpHeight);this.SelectionObj.SetSize(width,height);this.ResizerObj.SetPosition(width,height)}};Qva.Touch.Scrollbar=function(id,parentElem){this.Element=document.createElement("div");this.Element.className="TouchScrollbar";this.Id=id;this.Visible=false;return this};Qva.Touch.Scrollbar.prototype={Element:null,Id:"",ScrollStep:0,Visible:false,Show:function(visibleAreaHeight,scrollHeight){var scrollbarHeight=Math.max(Math.round(visibleAreaHeight*visibleAreaHeight/scrollHeight,10)),scrollMax=visibleAreaHeight-scrollbarHeight;this.ScrollStep=scrollMax/(visibleAreaHeight-scrollHeight);this.Element.style.height=scrollbarHeight+"px";this.Element.style["-webkit-transition-duration"]="100ms";this.Element.style.opacity=1;this.Visible=true;Qva.Debug.UseConsolelog&&Qva.ConsoleLog.Log("Scrollbar["+this.Id+"].Show. VisibleAreaH: "+visibleAreaHeight+" :: scrollH: "+scrollHeight+" :: ScrollbarHeight: "+scrollbarHeight+" :: ScrollStep: "+this.ScrollStep,Qva.ConsoleLog.SeverityTypes.Verbose)},Reposition:function(yVal){var newVal=yVal*this.ScrollStep;this.Element.style.webkitTransform="translate(0px, "+newVal+"px)";Qva.Debug.UseConsolelog&&Qva.ConsoleLog.Log("Scrollbar["+this.Id+"].Reposition: yVal: "+yVal+" :: scrollstep: "+this.ScrollStep+" :: newVal: "+newVal,Qva.ConsoleLog.SeverityTypes.Verbose)},Hide:function(){this.Element.style["-webkit-transition-duration"]="600ms";this.Element.style.opacity=0;this.Visible=false;Qva.Debug.UseConsolelog&&Qva.ConsoleLog.Log("Scrollbar["+this.Id+"].Hide",Qva.ConsoleLog.SeverityTypes.Verbose)}};Qva.Touch.Listbox.PreSelectSingle=function(objSelection){objSelection.lb.Mgr.Selections.ctrl=false;objSelection.lb.Mgr.Selections.Start=objSelection.lb.Mgr.Selections.End=objSelection.row.offset;objSelection.lb.Mgr._SaveCurrentSelection();objSelection.lb.Mgr._IndicateCellsToSelect();objSelection.lb.Mgr._EndSelect(false)};Qva.Touch.Listbox.PreSelectMulti=function(objSelection,that){var mgr=objSelection.lb.Mgr,offset=objSelection.row.offset;if(!objSelection.lb.MultiSelectMode){if(!Qva.Touch.Listbox.SelectMenu){Qva.Touch.Listbox.SelectMenu=new Qva.Touch.Listbox.SelectionMenu(Qva.GetBinder(mgr.binderid).isSmallDevices,that)}if(Qva.Touch.Listbox.SelectMenu.Visible){Qva.Touch.Listbox.SelectMenu.Hide(true)}Qva.Touch.Listbox.SelectMenu.Show(objSelection.lb);objSelection.lb.ToggleSelect=true;Qva.Debug.UseConsolelog&&Qva.ConsoleLog.Log("PreSelectMulti - show menu",Qva.ConsoleLog.SeverityTypes.Verbose)}else{if(mgr.ObjectId.indexOf("Fields.")===0){objSelection.lb.ToggleSelect=true}}if(objSelection.lb.MultiSelectModeInitializing&&objSelection.row.className.indexOf("QvSelected")!==-1){return}mgr.Selections.ctrl=objSelection.lb.ToggleSelect;mgr.Selections.Start=mgr.Selections.End=offset;mgr._SaveCurrentSelection();mgr._IndicateCellsToSelect();Qva.Debug.UseConsolelog&&Qva.ConsoleLog.Log("PreSelectMulti - selected row with offset: "+offset+" :: toggle: "+objSelection.lb.ToggleSelect,Qva.ConsoleLog.SeverityTypes.Verbose)};Qva.Touch.SelectionMenu=function(config){var that={};if(this.that||config.that){that=this.that||config.that}if(config.SmallDevices){var header=document.getElementById("single-object-view").getElementsByTagName("header")[0],menu=document.createElement("div"),buttons=config.Buttons.length,btnIndex=0,divBtn=null;menu.className="object-selection-menu";for(;btnIndex<buttons;btnIndex++){divBtn=document.createElement("div");divBtn.className="button";if(btnIndex===0){divBtn.className+=" button-primary"}divBtn.touchEnd={fn:config.Buttons[btnIndex].Fn,scope:config.Buttons[btnIndex].Scope},divBtn.onclick=function(e){var touchEnd=this.touchEnd;touchEnd.fn.apply(touchEnd.scope,[e]);return false},divBtn.appendChild(document.createTextNode(config.Buttons[btnIndex].Text));for(var attr in config.Buttons[btnIndex].Style){divBtn.style[attr]=config.Buttons[btnIndex].Style[attr]}menu.appendChild(divBtn)}header.appendChild(menu);this.Element=menu;this.IsSmallDevices=true}else{var divPanel=null,divBtn=null,divGloss=null,divIcon=null,divPointer=null,self=this,buttons=config.Buttons.length,btnIndex=0;this.Element=document.createElement("div");this.Element.className="TouchSelectionMenu";divPanel=document.createElement("div");divPanel.className="TouchSelectionMenu-Panel";this.Element.appendChild(divPanel);for(;btnIndex<buttons;btnIndex++){divBtn=document.createElement("div");divBtn.className="TouchSelectionMenu-Button-Background TouchSelectionMenu-Button-Background-Default";divBtn.style.marginLeft=(btnIndex==0?0:4)+"px";Qva.Events.AddClickEvent(divBtn,config.Buttons[btnIndex].Fn,{scope:config.Buttons[btnIndex].Scope,startEffect:function(){self.ToggleButtonState(this,true)},endEffect:function(){self.ToggleButtonState(this,false)},stopPropagation:true,preventDefault:true});divPanel.appendChild(divBtn);divGloss=document.createElement("div");divGloss.className="TouchSelectionMenu-Gloss";divBtn.appendChild(divGloss);divIcon=document.createElement("div");divIcon.className="TouchSelectionMenu-Button "+config.Buttons[btnIndex].CssClass;divBtn.appendChild(divIcon)}this.Buttons=buttons;if(config.AddPointerElem){divPointer=document.createElement("div");divPointer.className="TouchSelectionMenu-Pointer-Down";divPointer.style.marginLeft="30px";divPointer.style.marginTop="-1px";this.Element.appendChild(divPointer)}}for(var attr in config.Style){this.Element.style[attr]=config.Style[attr]}return this};Qva.Touch.SelectionMenu.prototype={Element:null,IsSmallDevices:false,Show:function(x,y){if(!this.IsSmallDevices){this.Element.style.left=x+"px";this.Element.style.top=y+"px"}this.Element.style.visibility="visible";if(this.Buttons==3){var panel=$(this.Element).children(".TouchSelectionMenu-Panel");panel.css("minWidth",panel.css("maxWidth"))}},Hide:function(){this.Element.style.visibility="hidden"},IsTapInsideBtn:function(xTap,yTap,btnElement,viewport){var btnCoords=Qva.Touch.GetCoordinatesForElem(btnElement,viewport),radius=getClientWidth(btnElement)/2,btnCenterX=btnCoords.x+radius,btnCenterY=btnCoords.y+radius;return(Math.pow((xTap-btnCenterX),2)+Math.pow((yTap-btnCenterY),2)<Math.pow(radius,2))},ToggleButtonState:function(elem,btnIsDown){if(btnIsDown){elem.className=elem.className.replace(" TouchSelectionMenu-Button-Background-Default"," TouchSelectionMenu-Button-Background-Pressed");elem.firstChild.style.display="none"}else{elem.className=elem.className.replace(" TouchSelectionMenu-Button-Background-Pressed"," TouchSelectionMenu-Button-Background-Default");elem.firstChild.style.display=""}}};Qva.Touch.Extend=function(child,superClass){for(var property in superClass.prototype){if(!(property in child.prototype)){child.prototype[property]=superClass.prototype[property]}}return child};Qva.Touch.Listbox.SelectionMenu=function(isSmallDevices,that){var config={SmallDevices:isSmallDevices,AddPointerElem:false,Buttons:[{Fn:this.Hide,Text:"Cancel",Scope:this,CssClass:"img_cancel_cross",Style:{"float":"right"}},{Fn:this.Select,Text:"Select",Scope:this,CssClass:"img_accept_tick",Style:{"float":"left"}}],Style:{position:"absolute",display:"none"}};if(isSmallDevices){config.Buttons.unshift({Fn:this.Clear,Text:"Clear",Scope:this,CssClass:"img_clear_eraser",Style:{display:"inline-block"}})}else{config.Buttons.unshift({Fn:this.More,Text:"More",Scope:this,CssClass:"img_more_dots",Style:{display:"inline-block"}})}if(Qva.userAgentDetector.get("pointerSupport")){this.that=that}else{this.that=false}Qva.Touch.SelectionMenu.call(this,config);if(!isSmallDevices){document.documentElement.appendChild(Qva.Touch.SelectionMenu.call(this,config).Element)}};Qva.Touch.Listbox.SelectionMenu.prototype={Visible:false,ListboxObject:null,Show:function(objLB){this.ListboxObject=objLB;this.Visible=true;this.Element.style.display="";if(!this.IsSmallDevices){var lbElem=objLB.Mgr.PageBinder.Element,lbCoords=Qva.Touch.GetCoordinatesForElem(lbElem),pageContainer=document.getElementById("PageContainer"),menuLeft=0,divPointer=document.getElementById("TouchSelectionMenu-PointerElem");if(!pageContainer){pageContainer=document.getElementsByTagName("body")[0]}if(!divPointer){divPointer=document.createElement("div");divPointer.id="TouchSelectionMenu-PointerElem";this.Element.appendChild(divPointer)}if(this.Buttons==3){var panel=$(this.Element).children(".TouchSelectionMenu-Panel");panel.css("minWidth",panel.css("maxWidth"))}if(parseInt(lbCoords.x+lbElem.clientWidth+this.Element.clientWidth,10)<pageContainer.clientWidth){left=lbCoords.x+lbElem.clientWidth+"px";divPointer.className="TouchSelectionMenu-Pointer-Left";divPointer.style.marginLeft=-divPointer.offsetWidth+1+"px";this.Element.style.marginLeft=divPointer.offsetWidth+"px"}else{left=Math.max(lbCoords.x-this.Element.clientWidth,0)+"px";divPointer.className="TouchSelectionMenu-Pointer-Right";divPointer.style.marginLeft=this.Element.clientWidth-1+"px";this.Element.style.marginLeft=-divPointer.offsetWidth+"px"}divPointer.style.marginTop=(-this.Element.clientHeight/2)-(divPointer.offsetHeight/2)+"px";this.Element.style.top=lbCoords.y+10+"px";this.Element.style.left=left}},Hide:function(rePaint){this.Element.style.display="none";this.ListboxObject.MultiSelectMode=false;this.ListboxObject.Mgr.Selections={Selected:[]};this.ListboxObject.Mgr._IndicateCellsToSelect();if(rePaint){this.ListboxObject.Mgr.PageBinder.QueuePostPaintMessage(this.ListboxObject.Mgr)}this.ListboxObject.ResetScroll();this.Visible=false},Select:function(){this.ListboxObject.Mgr._EndSelect(this.ListboxObject.ToggleSelect);this.ListboxObject.ResetScroll();this.Hide(false)},Clear:function(){this.ListboxObject.Mgr.Selections.ctrl=this.ListboxObject.ToggleSelect=false;this.ListboxObject.Mgr.Selections={Selected:[]};this.ListboxObject.Mgr._IndicateCellsToSelect()},More:function(event){this.Hide(false);this.ListboxObject.Mgr.PageBinder.GetDocumentMgr().OnContextMenu(event,this.ListboxObject.Mgr.PageBinder.Name)}};Qva.Touch.Extend(Qva.Touch.Listbox.SelectionMenu,Qva.Touch.SelectionMenu)})($QvJq);(function($,undefined){var nativeSupport="placeholder" in document.createElement("input");$.fn.placeholder=function(){return nativeSupport?this:this.each(function(){var me=$(this).siblings(".html5-placeholder").remove().end(),id=me[0].id||"placeholder"+ +new Date,value=me.val(),offset=me.position(),label=$("<label/>").addClass("html5-placeholder");function _callback(e){(e.type=="focus"||document.activeElement===this)&&label.hide();e.type=="blur"&&me.val()===""&&label.show()}me.prop("id",id).bind("focus blur keyup",_callback);label.css({display:value==""?"block":"none",color:"#999",position:"absolute",top:"50%",left:offset.left,marginTop:me.css("margin-top"),overflow:"hidden",cursor:"text",fontFamily:me.css("font-family"),fontSize:Math.ceil(parseFloat(me.css("font-size"))),fontWeight:me.css("font-weight")}).attr("for",id).text(me.attr("placeholder")).insertAfter(me);_callback.call(me[0],{})})};Qva.Mgr.inputsearch=function(owner,elem,name,prefix,condition){var self=this,rightclicked=false;if(!Qva.MgrSplit(this,name,prefix)){return}var $elem=$(elem),delay=300,timeout=null;$.extend(self,{Element:elem,Condition:condition,SearchName:self.Name});$.extend(elem,{Name:self.Name,binderid:owner.binderid,Attr:self.Attr,SearchMgr:self});$elem.on("mousedown",function(e){if(e.button===2){rightclicked=true}else{rightclicked=false}});$elem.bind("keydown",function(event){var searchMgr=this.SearchMgr,searchName=searchMgr.SearchName,binder=searchMgr.PageBinder||Qva.GetBinder(this.binderid),key=event.which,doSearch=key===13,cmd=doSearch?"accept":"abort";if(key===27||doSearch){if(binder.GetEnabled()){if(doSearch){event.preventDefault();binder.Set(searchName,"search",elem.value,false)}binder.Set(searchName,"closesearch",cmd,true)}else{Qva.PendingSearchKey=cmd;Qva.PendingSearchKeyName=mgr.SearchName}binder.GlobalSearchObject=""}}).bind("focus",function(event){if(rightclicked){return}Qva.params.transientMenuOpen=true;var searchMgr=this.SearchMgr,binder=searchMgr.PageBinder,name=searchMgr.Name.replace(".Input","");if(searchMgr.InputTimeout){searchMgr.InputTimeout=clearTimeout(searchMgr.InputTimeout)}if(this.value==""&&!this.SearchMgr.IsSearching){searchMgr.Element.last_search=undefined;binder.Set(name,"click","",true)}binder.GlobalSearchObject=name;searchMgr.InputTimeout=setTimeout(function(){searchMgr.InputChecker()},300)}).bind("blur",function(e){if(this.SearchMgr.InputTimeout){this.SearchMgr.InputTimeout=clearTimeout(this.SearchMgr.InputTimeout)}if(this.SearchMgr.IsSearching){if(!Qva.userAgentDetector.get("ipad")&&!Qva.userAgentDetector.get("iphone")){$elem.focus()}}else{this.value=""}});Qva.Events.AddClickEvent(elem,function(){if(Qva.userAgentDetector.get("gecko")){$elem.focus()}});Qva.Events.AddCancelBubble(elem,".transientpos");Qva.Events.AddScrollWheelEvent(elem,function(){},".transientpos");var button=this.Button=$('<button class="prop-icon-24x24 prop-dyn-dynamic-dropdown-search-open"></button>').appendTo($elem.parent()).on("mousedown",function(e){if(e.button===2&&Qva.params.transientMenuOpen){e.preventDefault();e.stopPropagation()}});Qva.Events.AddClickEvent(button,function(e){if(elem.SearchMgr.IsSearching){var binder=elem.SearchMgr.PageBinder||Qva.GetBinder(elem.binderid);binder.Set(elem.SearchMgr.SearchName,"closesearch","abort",true);$elem.blur()}else{if(Qva.Events.isTouchEvent(e)){Qva.Search(elem.SearchMgr,elem)}else{$elem.focus()}}},{preventDefault:true});owner.AddManager(this)};Qva.Mgr.inputsearch.prototype.InputChecker=function(){var elem=this.Element,searchMgr=elem.SearchMgr,isEmpty=elem.value==""||elem.value===elem.getAttribute("placeholder");if(isEmpty){if(searchMgr.SearchMode===0){elem.value="**"}else{if(searchMgr.SearchMode===1){elem.value="~"}else{elem.value=""}}Qva.SetCursor(elem)}var timeout=this.timeout;if(elem.value!=elem.last_search){elem.last_search=elem.value;if(timeout){timeout=clearTimeout(timeout)}timeout=setTimeout(function(){Qva.Search(elem.SearchMgr,elem)},300)}var that=this;that.InputTimeout=setTimeout(function(){that.InputChecker()},300)};Qva.Mgr.inputsearch.prototype.Paint=function(mode,node){var elem=$(this.Element),button=$(this.Button),defaultTextId=node.getAttribute("defaulttextid");this.Touched=true;if(defaultTextId&&defaultTextId==="searchobject.defaultstring"){this.DefaultText=Qva.localization.getStringFromKey("searchLabel")}else{var defaulttext=node.getAttribute("defaulttext");this.DefaultText=defaulttext!=null?defaulttext:this.DefaultText!=null?this.DefaultText:"Search"}this.SearchMode=+node.getAttribute("searchmode");this.IsSearching=(node.getAttribute("searching")=="true");if(elem.css("display")=="hidden"){return}elem.prop({readOnly:mode!="e",disabled:false}).css({display:Qva.MgrGetDisplayFromMode(this,mode),marginTop:-(elem.height()/2)});if(this.IsSearching){button.removeClass("prop-dyn-dynamic-dropdown-search-open").addClass("prop-dyn-dynamic-dropdown-search-close")}else{button.removeClass("prop-dyn-dynamic-dropdown-search-close").addClass("prop-dyn-dynamic-dropdown-search-open");elem.blur()}if(!Qva.userAgentDetector.get("msie10mode7")){elem.attr("placeholder",this.DefaultText).placeholder()}if(!node.getAttribute("searching")!="true"){this.PageBinder.GlobalSearchObject=this.Name.replace(".Input","")}};Qva.Mgr.inputsearch.prototype.PostPaint=function(){var elem=$(this.Element);var button=$(this.Button);button.css({left:elem.parent().width()-button.outerWidth(true)});elem.css({width:elem.parent().width()-elem.prev().outerWidth(true)-button.outerWidth(true)})};Qva.Mgr.inputsearch.prototype.GetCellRect=function(col,row){var elem=$(this.Element),offset=elem.offset();return $.extend(offset,{width:elem.width(),height:elem.height()})}})($QvJq);(function($,undefined){var expando=0,activeInstances={};$(window).resize(function(){var o,instance;for(o in activeInstances){instance=activeInstances[o];if(instance.isAttached){instance.calculateScrollValues()}}});var QvScroll=window.QvScroll=function(opts){return new QvScroll.Core(opts)};QvScroll.eventTypes=(function(){var ret={};if(Qva.userAgentDetector.get("touchEnabled")){ret={EVT_START:"touchstart",EVT_MOVE:"touchmove",EVT_END:"touchend"};if(Qva.userAgentDetector.get("msie")){ret={EVT_START:"MSPointerDown",EVT_MOVE:"MSPointerMove",EVT_END:"MSPointerUp"};if(Qva.userAgentDetector.get("msie11gte")){ret={EVT_START:"pointerdown",EVT_MOVE:"pointermove",EVT_END:"pointerup"}}}}else{ret={EVT_START:"mousedown",EVT_MOVE:"mousemove",EVT_END:"mouseup",EVT_SCROLL:"mousewheel DOMMouseScroll"}}return ret}());(function(){var ret="",div=document.createElement("div"),prefixes=["webkit","ie","Moz","ms","o"],i=prefixes.length;while(i--){if(typeof div.style[prefixes[i]+"Transform"]!=="undefined"){ret=prefixes[i];break}}div.style[ret+"Transform"]="translate3d(0,0,0)";QvScroll.vendorPrefix=ret;QvScroll.hasTranslate3d=div.style[ret+"Transform"].indexOf("translate3d")>=0}());QvScroll.parseWheelScroll=function(originalEvt){ret={step:0,stepX:0,stepY:0,axis:"vertical"};ret.step=(typeof originalEvt.wheelDelta==="undefined"?-originalEvt.detail:originalEvt.wheelDelta)>0?1:-1;if(originalEvt.axis===1||originalEvt.wheelDeltaY===0){ret.axis="horizontal";ret.stepX=ret.step}else{ret.stepY=ret.step}return ret};QvScroll.animate=function(me,x,y,ms,callback){var $me=$(me),vendorPrefix=QvScroll.vendorPrefix,transitionEvt=(vendorPrefix==="Moz"?"":vendorPrefix)+"TransitionEnd",animStr=QvScroll.hasTranslate3d?"translate3d("+x+"px, "+y+"px, 0)":"translate("+x+"px,"+y+"px)";ms=typeof ms==="undefined"?100:ms;if(vendorPrefix!==""&&!Qva.userAgentDetector.get("webview")){$me.unbind(transitionEvt).bind(transitionEvt,callback).css(vendorPrefix+"TransitionDuration",ms+"ms")[0].style[vendorPrefix+"Transform"]=animStr}else{$me.stop(true).animate({top:y,left:x},ms,"linear",callback)}return this};QvScroll.Core=function(opts){this.isTouch=Qva.userAgentDetector.get("touchEnabled");this.isAttached=false;this.visibleWidth=0;this.visibleHeight=0;this.overflowWidth=0;this.overflowHeight=0;this.totalWidth=0;this.totalHeight=0;this.positions={};this.expandoId=expando++;this.setOptions(opts)};QvScroll.Core.prototype={attach:function(){var opts=this.options,pos=this.applyOffset({x:opts.startPositionX,y:opts.startPositionY});opts.parentElement=opts.parentElement||opts.attachElement.parentNode;opts.scrollElement=opts.scrollElement||opts.parentElement;if(opts.attachElement.style[QvScroll.vendorPrefix+"Transform"]===""){var props={TransitionProperty:"-"+QvScroll.vendorPrefix+"-transform",TransformOrigin:"0 0",Transform:"translate3d(0, 0, 0)",TransitionTimingFunction:"cubic-bezier(0.33, 0.66, 0.66, 1)",TransitionDuration:"0ms"};for(var prop in props){opts.attachElement.style[QvScroll.vendorPrefix+prop]=props[prop]}}if(!this.isAttached){this.isAttached=true;opts.attachElement.style.position="relative";if(opts.bindEvents){this.attachEvents()}this.calculateScrollValues().calculateSteps();if(opts.indicators.enabled){opts.indicators.coreInstance=this;opts.indicatorInstance=new QvScroll.Indicators(opts.indicators)}activeInstances[this.expandoId]=this}if(opts.indicatorInstance&&!opts.indicatorInstance.isAttached){opts.indicatorInstance.attach()}return this},attachEvents:function(){var that=this,elem=$(this.options.parentElement),doc=$(document),eventTypes=QvScroll.eventTypes,pos=this.positions,hasEnded=false,checkpoint={x:0,y:0,timeStamp:null};function startEvt(e){doc.addClass("unselectable");var offset=that.applyOffset({x:0,y:0});pos.startX=-offset.x+Qva.Events.getX(e);pos.startY=-offset.y+Qva.Events.getY(e);hasEnded=false;return true}function moveEvt(e,touchEnded){var pageX=Qva.Events.getX(e),pageY=Qva.Events.getY(e),deltaX=-(pos.startX-(pageX)),deltaY=-(pos.startY-(pageY)),totalTime=0,momentumX=0,momentumY=0;if(+new Date()-checkpoint.timeStamp>250){checkpoint.x=pageX;checkpoint.y=pageY;checkpoint.timeStamp=+new Date()}if(touchEnded){totalTime=+new Date()-checkpoint.timeStamp;momentumX=that.calculateMomentum(pageX-checkpoint.x,totalTime);momentumY=that.calculateMomentum(pageY-checkpoint.y,totalTime);deltaX+=momentumX.distance;deltaY+=momentumY.distance}that.setPosition(deltaX,deltaY,touchEnded?200:0,!!touchEnded,function(scope){var cornerModifier=that.options.cornerModifier;if(that.options.cornerBounce&&!touchEnded){scope.deltas.x+=scope.deltas.relX/cornerModifier;scope.deltas.y+=scope.deltas.relY/cornerModifier}return !hasEnded});if(that.options.cancelEvents&&(that.options.horizontal!="disabled"||that.options.vertical!="disabled")){return false}}function stopEvt(e){doc.removeClass("unselectable");moveEvt.call(this,e,true);hasEnded=true;return true}function scrollEvt(e){var scrollEvtData=QvScroll.parseWheelScroll(e);that.setPositionByStep(-scrollEvtData.stepX,-scrollEvtData.stepY);if(that.options.cancelEvents){return false}}if(this.options.scrollWheelEvent){Qva.Events.AddScrollWheelEvent(elem,scrollEvt,".qvscroll")}Qva.Events.AddTouchScrollEvent(elem,startEvt,moveEvt,stopEvt,{xns:".qvscroll"});this.startEvt=startEvt;return this},detach:function(){var opts=this.options;this.isAttached=false;$(opts.parentElement).off(".qvscroll");if(opts.indicatorInstance){opts.indicatorInstance.detach()}delete activeInstances[this.expandoId];return this},applyOffset:function(deltas){var elem=$(this.options.attachElement),elemPos=elem.position(),offsetX=elemPos.left,offsetY=elemPos.top,mozCss=elem[0].style.MozTransform;if(mozCss&&mozCss.indexOf("translate(")>=0){mozCss=mozCss.split("(")[1].split(", ");offsetX=parseFloat(mozCss[0]);offsetY=parseFloat(mozCss[1])}deltas.x=deltas.x+offsetX;deltas.y=deltas.y+offsetY;return deltas},setPosition:function(x,y,animationSpeed,isStop,callback){var that=this,maxPosX=-this.overflowWidth,maxPosY=-this.overflowHeight,opts=this.options,pos=this.positions,attElem=$(opts.attachElement),offset=attElem.position(),scope={deltas:{},animationSpeed:animationSpeed==undefined?opts.animationSpeed:animationSpeed},percentX,percentY;if(x>0){scope.deltas.x=0}else{if(x<maxPosX){scope.deltas.x=maxPosX}else{scope.deltas.x=x}}if(y>0){scope.deltas.y=0}else{if(y<maxPosY){scope.deltas.y=maxPosY}else{scope.deltas.y=y}}scope.deltas.relX=x-offset.left;scope.deltas.relY=y-offset.top;if(typeof callback==="function"&&callback.call(this,scope)===false){return this}if(opts.vertical==="disabled"||opts.horizontal==="locked"){scope.deltas.y=0}if(opts.horizontal==="disabled"){scope.deltas.x=0}pos.offsetX=scope.deltas.x;pos.offsetY=scope.deltas.y;percentX=-scope.deltas.x/this.overflowWidth||0;percentY=-scope.deltas.y/this.overflowHeight||0;attElem.trigger("qvscrollstart",[scope.animationSpeed,percentX*100,percentY*100]);QvScroll.animate(opts.attachElement,scope.deltas.x,scope.deltas.y,scope.animationSpeed,function(e){attElem.trigger(!isStop?"qvscrollupdate":"qvscrollstop",[scope.animationSpeed,percentX*100,percentY*100])});return this},setPositionByStep:function(stepX,stepY,animationSpeed,isAbsolute){var stepPxX=stepX*-this.options.stepPerScrollX,stepPxY=stepY*-this.options.stepPerScrollY,deltas={x:stepPxX,y:stepPxY};if(!isAbsolute){this.applyOffset(deltas)}this.setPosition(deltas.x,deltas.y,animationSpeed,true);return this},setPositionByPercent:function(percentX,percentY,animationSpeed){var percentPxX=percentX/-100*this.overflowWidth,percentPxY=percentY/-100*this.overflowHeight;this.setPosition(percentPxX,percentPxY,animationSpeed,true);return this},setPositionByElement:function(element,animationSpeed,centerElement,onlyIfInvisible){var elem=$(element),width=elem.outerWidth(),height=elem.outerHeight(),elemPos=elem.position(),elemOff=elem.offset(),visibleInX=elemOff.left>=0&&elemOff.left+elem.outerWidth()<this.visibleWidth,visibleInY=elemOff.top>=0&&elemOff.top+elem.outerHeight()<this.visibleHeight,doSetPosition=!(onlyIfInvisible&&visibleInX);if(doSetPosition){if(centerElement){elemPos.left-=this.visibleWidth/2-width/2;elemPos.top-=this.visibleHeight/2-height/2}this.setPosition(-elemPos.left,-elemPos.top,animationSpeed,true)}return this},setOptions:function(opts){var opts=this.options=$.extend(true,{},this.defaults,this.options||{},opts);if(opts.startAttached){this.attach()}return this},reset:function(){$(this.options.attachElement).stop(true).removeAttr("style");return this},calculateScrollValues:function(){var opts=this.options;if(!this.isAttached||!opts.parentElement.parentNode){this.detach();return this}var parent=opts.parentElement,scrollWidth=opts.contentWidth==="auto"?parent.scrollWidth:opts.contentWidth,scrollHeight=opts.contentHeight==="auto"?parent.scrollHeight:opts.contentHeight;this.visibleWidth=parent.clientWidth||parent.parentNode.clientWidth;this.visibleHeight=parent.clientHeight||parent.parentNode.clientHeight;this.overflowWidth=scrollWidth-this.visibleWidth;this.overflowHeight=scrollHeight-this.visibleHeight;this.totalWidth=scrollWidth;this.totalHeight=scrollHeight;if(this.indicatorInstance){this.indicatorInstance.calculate()}Qva.Events.SetTouchAction(this.options.parentElement,this.overflowWidth>3,this.overflowHeight>3);return this},calculateSteps:function(){var opts=this.options;if(opts.stepPerScrollX===0){opts.stepPerScrollX=Math.round(this.visibleWidth/4)}if(opts.stepPerScrollY===0){opts.stepPerScrollY=parseFloat(opts.attachElement.style.lineHeight)||Math.round(this.visibleHeight/3)}return this},calculateMomentum:function(distance,duration){var decel=0.0022,speed=Math.abs(distance)/duration||0,addDistance=(speed*speed)/(decel*2),animDuration=speed/decel;addDistance=distance<0?-addDistance:addDistance;return{distance:Math.round(addDistance),duration:Math.round(animDuration)}},defaults:{startAttached:true,stepPerScrollX:0,stepPerScrollY:0,animationSpeed:400,cornerBounce:true,cornerModifier:3.5,bindEvents:true,cancelEvents:false,indicators:{enabled:false},horizontal:"auto",vertical:"auto",lockAxis:"",contentWidth:"auto",contentHeight:"auto",attachElement:null,parentElement:null,scrollWheelEvent:true}};QvScroll.Indicators=function(opts){var self=this,attElem,evtElem;opts=self.options=$.extend({},self.defaults,opts);if(!opts.coreInstance){throw new Error("No core instance given when trying to instantiate QvScroll indicators")}attElem=$(opts.coreInstance.options.parentElement).append('<div class="qvsi qvsi-vertical"><div class="qvsi-indicator"/></div><div class="qvsi qvsi-horizontal"><div class="qvsi-indicator"/></div>');evtElem=$(opts.coreInstance.options.attachElement);$.extend(self,{expandoId:QvScroll.Indicators.expando++,coreOptions:opts.coreInstance.options,attElem:attElem,evtElem:evtElem,vWrap:attElem.find(".qvsi-vertical"),vIndicator:attElem.find(".qvsi-indicator:eq(0)"),hWrap:attElem.find(".qvsi-horizontal"),hIndicator:attElem.find(".qvsi-indicator:eq(1)")});this.calculate().attach()};QvScroll.Indicators.expando=0;QvScroll.Indicators.prototype={calculate:function(){var self=this,coreInstance=self.options.coreInstance,coreOpts=self.coreOptions;self.vWrap[coreOpts.vertical==="disabled"||coreInstance.overflowHeight<=0?"hide":"show"]();self.hWrap[coreOpts.horizontal==="disabled"||coreInstance.overflowWidth===0?"hide":"show"]();self.vIndicator.height(coreInstance.visibleHeight-coreInstance.overflowHeight);self.hIndicator.width(coreInstance.visibleWidth-coreInstance.overflowWidth);return self},addEvents:function(){var self=this;self.evtElem.on("qvscrollstart qvscrollupdate qvscrollstop",$.proxy(self._update,self));Qva.Events.AddDragEvent(self.vWrap[0],self._dragStartStop,self._dragMove,self._dragStartStop,{xns:".qvscroll"+self.expandoId,_this:self})},_update:function(evt,animSpeed,percentX,percentY){function _parse(wrap,indicator,prop){var margins=parseFloat(indicator.css("margin-"+(prop==="width"?"left":"top")))*2;return wrap[prop]()-indicator[prop]()-margins}var self=this,exactY=_parse(self.vWrap,self.vIndicator,"height")*percentY/100,exactX=_parse(self.hWrap,self.hIndicator,"width")*percentX/100;QvScroll.animate(self.vIndicator,0,exactY,animSpeed,function(){});QvScroll.animate(self.hIndicator,exactX,0,animSpeed,function(){})},_dragStartStop:function(evt){var self=this;if(!Qva.Events.isTouchEvent(evt)&&$(Qva.Events.getTarget(evt)).is(".qvsi-indicator")){self.indicatorDragging={position:self.options.coreInstance.applyOffset({x:0,y:0}),pageX:Qva.Events.getX(evt),pageY:Qva.Events.getY(evt)}}else{self.indicatorDragging=null}},_dragMove:function(evt){var self=this,iDrag=self.indicatorDragging,newX,newY;if(iDrag){newX=-(-iDrag.position.x+Qva.Events.getX(evt)-iDrag.pageX);newY=-(-iDrag.position.y+Qva.Events.getY(evt)-iDrag.pageY);self.options.coreInstance.setPosition(newX,newY,0,true,function(){})}},attach:function(){var self=this;self.addEvents();self.calculate();self.isAttached=true;return self},detach:function(){var self=this;$(self.vWrap).off(".qvscroll"+self.expandoId);self.evtElem.off("qvscrollstart qvscrollupdate qvscrollstop");self.vWrap.hide();self.hWrap.hide();this.isAttached=false;return self},defaults:{enabled:true,coreInstance:null}}})($QvJq);if(!Qva.Mgr){Qva.Mgr={}}Qva.Mgr.actionicon=function(owner,elem,name,prefix){if(!Qva.MgrSplit(this,name,prefix)){return}this.SearchName=this.Name;this.Owner=owner;this.Element=elem;this.Touched=false;owner.AddManager(this)};Qva.Mgr.actionicon.prototype.GetCellRect=function(col,row){Assert(col==-1&&row==-1);var pos=Qva.GetAbsolutePageCoords(this.Element);return{left:pos.x,width:this.Element.offsetWidth,top:pos.y,height:this.Element.offsetHeight}};Qva.Mgr.actionicon.prototype.Paint=function(mode,node){this.Touched=true;var icons=node.getElementsByTagName("icon");if(icons.length>=1){var icon=icons[0];var img=document.createElement("img");var name=icon.getAttribute("name");var align=icon.getAttribute("align");img.className="Qv_CellIcon";if(align){img.className+="_"+align}var url=this.PageBinder.BuildBinaryUrl(icon.getAttribute("path"),null,name);img.src=url;this.Img=img;var binder=this.PageBinder;img.ObjectId=binder.Name;img.action=name;img.binderid=binder.PageBinder.ID;img.style.cursor="pointer";this.Element.appendChild(img);img.onclick=function(event){if(!event){event=window.event}event.cancelBubble=true;var binder=Qva.GetObjectBinder(this);var params={};params.action="";binder.Set(binder.Name+"."+this.action,params)}}};Qva.Mgr.actionicon.prototype.Remove=function(){$(this.Element).html("").remove()};Qva.Mgr.date=function(owner,elem,name,prefix){if(!Qva.MgrSplit(this,name,prefix)){return}this.ObjectID=$(elem).closest(".QvFrame")[0].id;elem.id="inp_"+this.ObjectID;this.Owner=owner;this.Element=elem;this.Touched=false;owner.AddManager(this);this.First=true};Qva.Mgr.date.prototype.Lock=Qva.LockDisabled;Qva.Mgr.date.prototype.Unlock=Qva.UnlockDisabled;Qva.Mgr.date.prototype.getDateObject=function(datestring){var ar=datestring.split("-");if(ar.length=3){return new Date(parseInt(ar[0]),parseInt(ar[1])-1,parseInt(ar[2]))}return new Date(datestring)};Qva.Mgr.date.prototype.Paint=function(mode,node){this.Touched=true;this.Element.style.display=Qva.MgrGetDisplayFromMode(this,mode);var elem=this.Element;var _this=this;this.SelectedDates=[];this.DisabledDates=[];this.LockedCalendar=(node.getAttribute("Locked")==="1");this.OneAndOnlyOne=(node.getAttribute("OneAndOnlyOne")==="1");if(this.First){var monthNameArray=new Array();var monthShortNameArray=new Array();var monthIds=["January","February","March","April","May","June","July","August","September","October","November","December"];monthIds.forEach(function(id){var name=Qva.localization.getStringFromKey(id);monthNameArray.push(name);monthShortNameArray.push(name.substring(0,3))});var dayNameArray=new Array();var dayShortNameArray=new Array();var dayIds=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];dayIds.forEach(function(id){var name=Qva.localization.getStringFromKey(id);dayNameArray.push(name);dayShortNameArray.push(name.substring(0,2))});var next=Qva.localization.getStringFromKey("Next.Month"),prev=Qva.localization.getStringFromKey("Prev.Month"),wk=Qva.localization.getStringFromKey("WK");$(elem).multiDatesPicker({separator:";",numberOfMonths:1,changeMonth:true,changeYear:true,showOtherMonths:true,selectOtherMonths:true,dateFormat:"yy-mm-dd",weekHeader:wk,nextText:next,prevText:prev,showWeek:(Qva.params.showCalendarWeek==="true"||Qva.params.showCalendarWeek==="1"||Qva.params.showCalendarWeek===1),firstDay:1,monthNames:monthNameArray,monthNamesShort:monthShortNameArray,dayNames:dayNameArray,dayNamesMin:dayShortNameArray,caller:_this.ObjectID,beforeShow:function(inputelem,dp){_this.updateCalendar();setTimeout(function(){$(dp.dpDiv).removeClass("ui-helper-hidden-accessible").css("z-index",9999)},0)},onChangeMonthYear:function(year,month,inst){if(_this.updatingCalendar){return}var newdate=new Date(year,month-1,1);_this.Owner.GetDocumentMgr()._Send("poll",_this.ObjectID,true,{clearcache:"true",options:"current="+$.datepicker.formatDate("yy-mm-dd",newdate)})},beforeShowDay:function(date){if(_this.LockedCalendar&&_this.SelectedDates.map(Number).indexOf(+date)>-1){return[true,"ui-state-highlight-locked"]}else{return[true,""]}}});$(elem).click(function(e){e.preventDefault();$(elem).datepicker("show").unbind("focus");$(document).one(Qva.Events.getStartEvents(".mdp"),$.datepicker._checkExternalClick)});$("#ui-datepicker-div").on(Qva.Events.getStartEvents(".mdp"),function(e){e.stopPropagation()});$("#ui-datepicker-div").bind("contextmenu click",function(e){return false})}var values=node.getElementsByTagName("value");if(values.length>=1){var value=values[0];this.Min=_this.getDateObject(value.getAttribute("min"));this.Max=_this.getDateObject(value.getAttribute("max"));this.Current=value.getAttribute("current");this.YearRange=this.Min.getFullYear()+":"+this.Max.getFullYear();var multiMode=value.getAttribute("selectionrange")==="multi";if(this.First||multiMode!=this.MultiMode){this.MultiMode=multiMode}var days=value.getElementsByTagName("day");$(days).each(function(){var date=_this.getDateObject(this.getAttribute("date"));var state=this.getAttribute("State");if(state==1){_this.SelectedDates.push(date)}else{if(state==5){_this.DisabledDates.push(date)}}});if(this.First||($.datepicker._curInst&&$.datepicker._curInst&&$.datepicker._curInst.id==="inp_"+this.ObjectID)){this.updateCalendar()}}this.Unlock();this.First=false};Qva.Mgr.date.prototype.updateCalendar=function(){var closeDatePicker=function(){$.datepicker._hideDatepicker();$(document).off(Qva.Events.getStartEvents(".mdp"))};this.updatingCalendar=true;var elem=this.Element,disabledDates=this.DisabledDates,selectedDates=this.SelectedDates,current=this.Current,currentYearRange=$(elem).datepicker("option","yearRange"),currentMin=$(elem).datepicker("option","minDate"),currentMax=$(elem).datepicker("option","maxDate");if(this.YearRange!=currentYearRange){$(elem).datepicker("option","yearRange",this.YearRange)}if(currentMin===null||this.Min.getTime()!=currentMin.getTime()){$(elem).datepicker("option","minDate",this.Min)}if(currentMax===null||this.Max.getTime()!=currentMax.getTime()){$(elem).datepicker("option","maxDate",this.Max)}$(elem).multiDatesPicker("resetDates","disabled");if(disabledDates.length>0){$(elem).multiDatesPicker("addDates",disabledDates,"disabled")}$(elem).multiDatesPicker("resetDates");if(selectedDates.length>0&&!this.LockedCalendar){$(elem).multiDatesPicker("addDates",selectedDates)}if(current){$(elem).datepicker("setDate",this.getDateObject(current))}$(elem).datepicker("refresh");var _this=this;setTimeout(function(){var $table=$("#ui-datepicker-div").find("table");$table.find("td").off("click").not(".ui-datepicker-unselectable").on("click",function(){if(_this.LockedCalendar){return}var day=+$(this).find("a").html(),month=+this.getAttribute("data-month"),year=+this.getAttribute("data-year"),selecteddate=new Date(year,month,day);_this.Owner.Set(_this.Name,{value:$.datepicker.formatDate("yy-mm-dd",selecteddate),toggle:_this.MultiMode&&!_this.OneAndOnlyOne?"true":"false"});if(!_this.MultiMode||_this.OneAndOnlyOne){closeDatePicker()}});$("<div>").addClass("cell-icon cell-CLOSE-icon").css({"margin-top":"-14px","margin-right":"-14px","float":"right",height:"20px",width:"20px","z-index":"100",opacity:"1"}).on("click",function(e){closeDatePicker()}).prependTo("#ui-datepicker-div")},0);this.updatingCalendar=false};Qva.Mgr.date.prototype.Remove=function(){$(this.Element).find("input").remove();$(this.Element).unbind();$(this.Element).html("").remove()};(function($,undefined){var illegalCharacterPattern=new RegExp("[^a-zA-Z0-9]","g");illegalCharacterPattern.compile(illegalCharacterPattern);Qva.Mgr.anchor=function(owner,elem,name,prefix){this.Name=Qva.MgrMakeName(name,prefix);this.Element=elem;owner.AddManager(this);this.Element.Name=this.Name;this.Element.binderid=owner.PageBinder.ID;Qva.Events.AddClickEvent(this.Element,function(){if($(this).attr("href")!=null&&$(this).attr("href")=="javascript:;"){return false}else{return true}})};Qva.Mgr.anchor.prototype.Paint=function(mode,node){this.Touched=true;var element=this.Element;element.disabled=(mode!="e");element.style.display=Qva.MgrGetDisplayFromMode(this,mode)};Qva.Mgr.accordion=function(owner,elem,name,prefix){this.Name=Qva.MgrMakeName(name,prefix);this.Element=elem;owner.AddManager(this);var name=this.Element.Name=this.Name;var binderid=this.Element.binderid=owner.PageBinder.ID;$(this.Element).accordion({autoHeight:false,beforeActivate:function(event,ui){var newtab=$(this).find("h3").index(ui.newHeader[0]);var binder=Qva.GetBinder(binderid);if(!binder.Enabled){return}if(name.indexOf("Document.TOOLS\\REPOSITORY")<0){return}binder.Set(name+".ActiveTab","value",newtab,true)}})};Qva.Mgr.accordion.prototype.Paint=function(mode,node){this.Touched=true;var element=this.Element;element.disabled=(mode!="e");element.style.display=Qva.MgrGetDisplayFromMode(this,mode)};Qva.Mgr.foldOutMenu=function(owner,elem,name,prefix){this.Name=Qva.MgrMakeName(name,prefix);this.Element=elem;owner.AddManager(this);owner.FoldOutController=this;this.Element.binderid=owner.PageBinder.ID;this.FoldOutVisible=false;this.FoldOutAvailable=false;this.Buttons=[];this.DocumentBinder=owner;while(this.DocumentBinder&&!this.DocumentBinder.LoadHtml){this.DocumentBinder=this.DocumentBinder.PageBinder}};Qva.Mgr.foldOutMenu.prototype.Paint=function(mode,node){this.Touched=true;var element=this.Element;element.disabled=(mode!="e");element.style.display=Qva.MgrGetDisplayFromMode(this,mode)};Qva.Mgr.foldOutMenu.prototype.SetActiveFoldOut=function(child){var CurrentFoldOut={Name:child.Name,AvqDialog:child.AvqDialog,binderid:child.binderid,Index:child.Index};var enabled=true;if(!CurrentFoldOut.AvqDialog){var FoldOutVisible=this.FoldOutVisible;this.HideFoldOut();this.FoldOutVisible=FoldOutVisible;this.CurrentFoldOut=CurrentFoldOut;this.FoldOutAvailable=false}else{this.FoldOutAvailable=true}if(this.FoldOutVisible&&(!this.CurrentFoldOut||CurrentFoldOut.Name!=this.CurrentFoldOut.Name||CurrentFoldOut.AvqDialog!=this.CurrentFoldOut.AvqDialog)&&this.ContextDialog){this.CurrentFoldOut=CurrentFoldOut;this.HideFoldOut();this.ShowFoldOut()}else{this.CurrentFoldOut=CurrentFoldOut}for(var i=0;i<this.Buttons.length;i++){this.Buttons[i].SetStatus(this.FoldOutVisible,this.FoldOutAvailable)}};Qva.Mgr.foldOutMenu.prototype.SetFoldOutButton=function(obj){this.Buttons[this.Buttons.length]=obj};Qva.Mgr.foldOutMenu.prototype.ShowFoldOut=function(){var _this=this;if(this.FoldOutVisible){this.HideFoldOut()}this.DocumentBinder.LoadHtml(_this.CurrentFoldOut.AvqDialog,function(body){_this.ShowFoldOutDialog(body)});this.FoldOutVisible=true;for(var i=0;i<this.Buttons.length;i++){this.Buttons[i].SetStatus(this.FoldOutVisible,this.FoldOutAvailable)}};var HardCodedFoldOutWidth=340;Qva.Mgr.foldOutMenu.prototype.ShowFoldOutDialog=function(foldOutMenuBody){if(this.ContextDialog==null){this.ContextDialog=document.createElement("div");this.ContextDialog.style.position="absolute";this.ContextDialog.style.width=HardCodedFoldOutWidth+"px";this.ContextDialog.style.left="330px";this.ContextDialog.style.top="-2px";this.ContextDialog.innerHTML=foldOutMenuBody;this.Element.insertBefore(this.ContextDialog,this.Element.firstChild)}else{this.ContextDialog.style.zIndex=666;this.ContextDialog.style.position="absolute";this.ContextDialog.style.width=HardCodedFoldOutWidth+"px";this.ContextDialog.style.left="330px";this.ContextDialog.style.top="-2px";this.ContextDialog.innerHTML=foldOutMenuBody;$(this.ContextDialog).toggle("fold",250)}var parts=this.CurrentFoldOut.Name.split(".");var name=parts[0]+"."+parts[1]+"."+parts[2];this.ContextDialogMgr=new Qva.Mgr.toolwindowbody(this.PageBinder.PageBinder,this.ContextDialog,name);this.ContextDialogMgr.TopElement=this.PageBinder.TopElement;this.ContextDialogMgr.Scan(this.CurrentFoldOut.Name);try{this.ContextDialog.focus()}catch(err){}if(this.PageBinder.node){this.ContextDialogMgr.Paint(this.PageBinder.mode,this.PageBinder.node,this.PageBinder.prefix)}else{this.PageBinder.PageBinder.Refresh()}};Qva.Mgr.foldOutMenu.prototype.HideFoldOut=function(){this.FoldOutVisible=false;for(var i=0;i<this.Buttons.length;i++){this.Buttons[i].SetStatus(this.FoldOutVisible,this.FoldOutAvailable)}if(this.ContextDialogMgr!=null){this.ContextDialogMgr.Close(true);this.PageBinder.PageBinder.RemoveFromManagers(this.ContextDialogMgr);this.ContextDialogMgr=null}if(this.ContextDialog!=null){this.ContextDialog.style.display="none"}};Qva.Mgr.ListPanelController=function(owner,elem,name,prefix){owner.ListController=this};Qva.Mgr.ListPanelController.prototype.SetActiveListItem=function(object){var CurrentItemName=null;if(object.ActiveItem){CurrentItemName=object.ActiveItem.Name}if(CurrentItemName!=this.CurrentItemName){if(this.ListPanel){this.ListPanel.ShowPanel(CurrentItemName)}}this.CurrentItemName=CurrentItemName};Qva.Mgr.listpanel=function(owner,elem,name,prefix,dlgname){if(!Qva.MgrSplit(this,name,prefix)){return}owner.AddManager(this);owner.ListController.ListPanel=this;this.Element=elem;this.DlgName=dlgname;this.DocumentBinder=owner.PageBinder;while(this.DocumentBinder&&!this.DocumentBinder.LoadHtml){this.DocumentBinder=this.DocumentBinder.PageBinder}};Qva.Mgr.listpanel.prototype.ShowPanel=function(name){if(!name){if(this.Element.firstChild){this.Element.removeChild(this.Element.firstChild)}}else{var _this=this;this.DocumentBinder.LoadHtml(this.DlgName,function(body){_this.Element.innerHTML=body;_this.PageBinder.Scan(name,_this.Element.firstChild);_this.PageBinder.Paint()})}};Qva.Mgr.listpanel.prototype.Paint=function(mode,node){this.Touched=true};Qva.Mgr.activeAccordionHeader=function(owner,elem,name,prefix,dlgname){this.Name=Qva.MgrMakeName(name,prefix)||prefix;this.Element=elem;owner.AddManager(this);if(!owner.ListController){owner.ListController=this}this.FoldOutController=owner.FoldOutController;this.Lists=[];this.CurrentFoldOut={};if(dlgname){this.SetActiveListItemAndFoldout=function(){};this.CurrentFoldOut={Name:this.Name,AvqDialog:dlgname,binderid:owner.PageBinder.ID};if($(elem).hasClass("ui-state-active")){this.FoldOutController.SetActiveFoldOut(this.CurrentFoldOut)}}var _this=this;Qva.Events.AddClickEvent(elem,function(){_this.FoldOutController.SetActiveFoldOut(_this.CurrentFoldOut)},{preventDefault:false})};Qva.Mgr.activeAccordionHeader.prototype.SetActiveListItemAndFoldout=function(object){var newlist=true;if(!object.ActiveItem){for(var i=0;i<this.Lists.length;i++){if(this.Lists[i]==object){newlist=false}if(this.Lists[i]!=object&&this.Lists[i].ActiveItem){if(this.CurrentFoldOut.AvqDialog!==this.Lists[i].ActiveItem.AvqDialog&&this.CurrentFoldOut.Name!==this.Lists[i].ActiveItem.Name){this.Lists[i].SetActiveItem(this.Lists[i].ActiveItem)}return}}this.CurrentFoldOut={}}else{for(var i=0;i<this.Lists.length;i++){if(this.Lists[i]!=object){this.Lists[i].ClearActiveItem(true)}if(this.Lists[i]==object){newlist=false}}this.CurrentFoldOut={Name:object.ActiveItem.Name,AvqDialog:object.ActiveItem.AvqDialog,binderid:object.ActiveItem.binderid,Index:object.ActiveItem.Index}}if(newlist){this.Lists[this.Lists.length]=object}if($(this.Element).hasClass("ui-state-active")){this.FoldOutController.SetActiveFoldOut(this.CurrentFoldOut)}};Qva.Mgr.activeAccordionHeader.prototype.GetActiveFoldOut=function(){return this.CurrentFoldOut};Qva.Mgr.activeAccordionHeader.prototype.Paint=function(mode,node){};Qva.Mgr.sortableDimensions=function(owner,elem,name,prefix){this.Name=Qva.MgrMakeName(name,prefix);this.Element=elem;owner.AddManager(this);this.Element.Name=this.Name;this.Element.binderid=owner.PageBinder.ID;$(this.Element).sortable({handle:"span"});$(this.Element).disableSelection()};Qva.Mgr.sortableDimensions.prototype.Paint=function(mode,node){this.Touched=true;var element=this.Element;element.disabled=(mode!="e");element.style.display=Qva.MgrGetDisplayFromMode(this,mode)};Qva.Mgr.chartDimensionsButton=function(owner,elem,name,prefix){this.Name=Qva.MgrMakeName(name,prefix);this.Element=elem;owner.AddManager(this);this.Element.Name=this.Name;this.Element.binderid=owner.PageBinder.ID;Qva.Events.AddClickEvent(this.Element,function(){var binder=Qva.GetBinder(this.binderid);if(!binder.Enabled){return}binder.Set(this.Name,"action","",true)})};Qva.Mgr.chartDimensionsButton.prototype.Paint=function(mode,node){this.Touched=true;var element=this.Element;element.disabled=(mode!="e");element.style.display=Qva.MgrGetDisplayFromMode(this,mode)};Qva.Mgr.propertySlider=function(owner,elem,name,prefix,input){this.Name=Qva.MgrMakeName(name,prefix);this.Element=elem;this.Input=input;owner.AddManager(this);var _this=this;var binder=Qva.GetBinder(this.binderid);if(this.Input){this.DisplayToServer=function(value){if(!this.DisplayPercent){return value}return Math.round(value*this.serverMax/100)};this.ServerToDisplay=function(value){if(!this.DisplayPercent){return value}return Math.round((value*100)/this.serverMax)};$(this.Input).on("change keyup",function(event){if(event.type==="keyup"&&event.keyCode!==13){return}var value=parseInt(_this.DisplayToServer(this.value));if(!isNaN(value)&&value>=_this.serverMin&&value<=_this.serverMax){binder.Set(_this.Name,"value",value,true)}else{this.value=_this.ServerToDisplay(_this.serverValue)}})}$(this.Element).slider({slide:function(event,ui){if(_this.Input){_this.Input.value=_this.ServerToDisplay(ui.value)}},stop:function(event,ui){binder.Set(_this.Name,"value",ui.value,true)}})};Qva.Mgr.propertySlider.prototype.Paint=function(mode,node){this.serverMin=isNaN(parseInt(node.getAttribute("min")))?0:parseInt(node.getAttribute("min"));$(this.Element).slider();$(this.Element).slider("option","min",this.serverMin);this.serverMax=isNaN(parseInt(node.getAttribute("max")))?0:parseInt(node.getAttribute("max"));$(this.Element).slider("option","max",this.serverMax);var serverValue=isNaN(parseInt(node.getAttribute("value")))?0:parseInt(node.getAttribute("value"));this.serverValue=Math.max(this.serverMin,Math.min(serverValue,this.serverMax));this.DisplayPercent=node.getAttribute("range")=="percent";if(this.Input){this.Input.value=this.ServerToDisplay(serverValue)}$(this.Element).slider("value",this.serverValue);this.Touched=true;var element=this.Element;if(mode!="e"){$(this.Element).slider("disable")}else{$(this.Element).slider("enable")}if(this.Input){this.Input.readOnly=mode!="e"}element.style.display=Qva.MgrGetDisplayFromMode(this,mode)};Qva.Mgr.foldOutMenuButton=function(owner,elem){this.Element=elem;var object=owner.FoldOutController;if(object){object.SetFoldOutButton(this);elem.FoldOutVisible=false;this.IsLessButton=elem.getAttribute("isless")=="true";if(this.IsLessButton){elem.style.display="none"}$(this.Element).button();Qva.Events.AddClickEvent(this.Element,function(){if(this.disabled){return}if(this.FoldOutVisible){object.HideFoldOut()}else{object.ShowFoldOut()}},{preventDefault:true})}else{elem.style.display="none"}};Qva.Mgr.foldOutMenuButton.prototype.SetStatus=function(visible,enabled){this.Element.FoldOutVisible=visible;$(this.Element).button(enabled?"enable":"disable");if(visible==this.IsLessButton){this.Element.style.display=""}else{this.Element.style.display="none"}};Qva.Mgr.TabSource=function(owner,elem,name,prefix,dlgname){if(!Qva.MgrSplit(this,name,prefix)){return}owner.AddManager(this);this.Element=elem;elem.binderid=owner.binderid;elem.Name=this.Name;elem.AvqDialog=dlgname;var _this=this;elem.onmousedown=function(event){_this.PageBinder.SetActiveItem(this)}};Qva.Mgr.TabSource.prototype.Paint=function(mode,node){this.Touched=true;var element=this.Element;element.disabled=(mode!="e");element.style.display=Qva.MgrGetDisplayFromMode(this,mode)};Qva.Mgr.tabs=function(owner,elem,name,prefix,dlgname){if(!Qva.MgrSplit(this,name,prefix)){return}owner.AddManager(this);owner.Tabs=this;this.Element=elem;this.MgrType="tabs";var chartName=this.Name.replace(illegalCharacterPattern,""),$elem=$(elem),self=this;$elem.find("[name='tab']").each(function(){var tab=$(this),prop=tab.attr("href")?"href":"id",propVal=tab.attr(prop);if(prop&&propVal){tab.attr(prop,propVal+"-"+chartName)}Qva.Events.AddClickEvent(tab,function(){self.drawFoldoutScrollShadow(tab.parent().index())})});$elem.tabs({activate:function(event,ui){self.drawFoldoutScrollShadow($(event.currentTarget).parent().index())}})};Qva.Mgr.tabs.prototype.drawFoldoutScrollShadow=function(index){var elem=$(this.Element),tab=elem.find("[name='tab']"),tabContent=elem.find(".tab-container .ui-tabs-panel > .prop-grid_container").eq(index),whenToShowVScroll=3,tFoldout=tab.children(":visible"),qvScroll,showScroll;tabContent=tabContent.length?tabContent:elem.find(".tab-container > *").eq(0);tabContent.siblings().each(function(){var qvScroll=$(this).data("qvScroll");if(qvScroll&&qvScroll.isAttached){qvScroll.detach()}});qvScroll=tabContent.data("qvScroll")||this.createScroll(tabContent);if(tabContent.is(":visible")){qvScroll.attach().calculateScrollValues();showScroll=qvScroll.overflowHeight>whenToShowVScroll;if(showScroll){tabContent.parent().addClass("prop-grid_foldout-shadow")}else{tabContent.parent().removeClass("prop-grid_foldout-shadow");qvScroll.detach()}}tabContent.data("qvScroll",qvScroll)};Qva.Mgr.tabs.prototype.createScroll=function(attElem){return new QvScroll({attachElement:attElem[0],horizontal:"disabled",cancelEvents:true,startAttached:false,indicators:{enabled:true}})};Qva.Mgr.tabs.prototype.Paint=function(mode,node){this.Element.style.display=Qva.MgrGetDisplayFromMode(this,mode)};Qva.Mgr.align=function(owner,elem,name,prefix,dlgname){if(!Qva.MgrSplit(this,name,prefix)){return}owner.AddManager(this);this.Element=elem;this.Element.Name=this.Name;this.Element.binderid=owner.PageBinder.ID};Qva.Mgr.align.prototype.Paint=function(mode,node){var Current=parseInt(node.getAttribute("value"));var elemnodes=node.getElementsByTagName("element");this.Element.innerHTML="";var disabled=(mode!="e");var values=[];var vertical=false;for(var i=0;i<elemnodes.length;i++){values[values.length]=parseInt(elemnodes[i].getAttribute("value"));if(values[values.length-1]==4){vertical=true}}for(var i=0;i<values.length;i++){var button=window.document.createElement("button");button.setAttribute("value1",values[i]);this.AddImage(button,values[i],Current,vertical,disabled);button.Name=this.Element.Name;button.binderid=this.Element.ID;if(!disabled){Qva.Events.AddClickEvent(button,function(){var binder=Qva.GetBinder(this.binderid);if(!binder.Enabled){return}binder.Set(this.Name,"value",this.getAttribute("value1"),true)})}this.Element.appendChild(button)}};Qva.Mgr.align.prototype.AddImage=function(button,value,current,vertical,disabled){var jqbutton=$(button);jqbutton.button({text:false});jqbutton.removeClass("ui-corner-all");if(jqbutton.attr("value1")==0){jqbutton.addClass("ui-corner-left").addClass("prop-button-align")}if(jqbutton.attr("value1")==1){jqbutton.addClass("prop-button-align")}if(jqbutton.attr("value1")==2){jqbutton.addClass("ui-corner-right").addClass("prop-button-align-last")}if(jqbutton.attr("value1")==4){jqbutton.addClass("prop-button-align")}if(jqbutton.attr("value1")==8){jqbutton.addClass("ui-corner-right").addClass("prop-button-align-last")}jqbutton.addClass("prop-weld-align-icons");var span=window.document.createElement("div");$(span).addClass("prop-grid_left prop-grid_button prop-icon-24x24");switch(value){case 0:if(vertical){$(span).addClass("prop-vertical-icon-top")}else{$(span).addClass("prop-horizontal-icon-left")}break;case 1:$(span).addClass("prop-horizontal-icon-center");break;case 2:$(span).addClass("prop-horizontal-icon-right");break;case 4:$(span).addClass("prop-vertical-icon-middle");break;case 8:$(span).addClass("prop-vertical-icon-bottom");break}if(value==current){jqbutton.addClass("ui-state-active")}else{jqbutton.removeClass("ui-state-active")}if(disabled){$(span).addClass("prop-icon-disabled")}jqbutton.bind("mouseout",function(){if(value==current){jqbutton.addClass("ui-state-active")}});if(disabled){jqbutton.unbind()}jqbutton.prepend(span);jqbutton.addClass("ui-state-default")};Qva.PageBinding.prototype.GetDynamicDropdownContent=function(property){if(!this.dynamicDropdownContent){this.dynamicDropdownContent={}}if(this.dynamicDropdownContent[property]){return this.dynamicDropdownContent[property]}else{this.dynamicDropdownContent[property]=[];var content={list:[],containsIcons:false};var items=this["Get"+property]();for(var fix=0;fix<items.length;++fix){var icon=null;if(items[fix].type){icon=items[fix].type;content.containsIcons=true}if(items[fix].SubItems!=null&&items[fix].SubItems.length>0){for(var six=0;six<items[fix].SubItems.length;++six){var subItemIcon=null;if(items[fix].SubItems[six].type){subItemIcon=items[fix].SubItems[six].type;content.containsIcons=true}if(items[fix].SubItems[six].text!=null){content.list.push({label:items[fix].SubItems[six].text,value:items[fix].SubItems[six].text,iconType:subItemIcon,param:items[fix].SubItems[six].param,tooltip:items[fix].SubItems[six].tooltip,category:items[fix].text})}}}else{content.list.push({label:items[fix].text,value:items[fix].text,iconType:icon,param:items[fix].param,tooltip:items[fix].tooltip,category:null})}}this.dynamicDropdownContent[property]=content;return this.dynamicDropdownContent[property]}};Qva.Mgr.dynamicDropdown=function(owner,elem,name,prefix,property,placeholder){property=property||"Fields";placeholder=placeholder||"";if(!Qva.MgrSplit(this,name,prefix)){return}owner.AddManager(this);var self=this,pagebinder=this.PageBinder,$span=$('<span class="prop-icon-24x24 prop-dyn-dynamic-dropdown-search-icon prop-dyn-hidden"></span>'),$input=$('<input class="prop-dyn-dynamic-dropdown" type="text" />'),$button=$('<button class="prop-icon-24x24 prop-dyn-dynamic-dropdown-button-open"></button>'),$elem=$(elem),forExpression=$elem.closest(".expression-ac").length,ac;while(pagebinder&&!pagebinder.GetFields){pagebinder=pagebinder.PageBinder}$.extend(self,{Property:property,Element:$.extend(elem,{Name:self.Name,binderid:owner.PageBinder.ID,Property:property,dynamicDropdownContent:pagebinder.GetDynamicDropdownContent(property)})});$elem.append($span).append($input).append($button);function _applyClasses(t){var primary="addClass",secondary="removeClass";if(t){primary=secondary;secondary="addClass"}$span[primary]("prop-dyn-hidden");$button[primary]("prop-dyn-dynamic-dropdown-button-open")[secondary]("prop-dyn-dynamic-dropdown-button-close");if($input.closest("ul").length){$input[primary]("prop-dyn-clear-border-background").parent()[primary]("prop-dyn-clear-border-background");$button[primary]("prop-dyn-clear-border-background")}}function _select(event,ui){var binder=Qva.GetBinder(elem.binderid);if(!binder.Enabled){return}binder.Set(elem.Name,{position:ui.item.value,action:""});$input.dynamicdropdown("close").trigger("blur")}function _change(event,ui){$input.prop("value",forExpression?placeholder:$input.data("originalValue"))}function _focus(){_applyClasses(true);$input.prop("value","").dynamicdropdown("search","")}function _keydown(e){var selected=$input.val().toLowerCase();var choosen=$QvJq.grep(elem.dynamicDropdownContent.list,function(a){return a.value.toLowerCase()===selected}).length>0;if(choosen===false&&e.which==13){e.preventDefault();return false}if(choosen===true&&e.which==13){var item=$QvJq.grep(elem.dynamicDropdownContent.list,function(a){return a.value.toLowerCase()===selected})[0];var itemToSelect={item:item};_select(null,itemToSelect)}return true}function _blur(){_applyClasses(false)}$input.css("width",$elem.width()-$span.width()-$button.width()-parseFloat($input.css("padding-left"))).dynamicdropdown({source:elem.dynamicDropdownContent.list,appendTo:forExpression?$input.parent():"body",minLength:0,change:_change,position:{collision:"flip"},open:function(event,ui){$(".ui-autocomplete").css({"z-index":Number($input.closest("div.ToolWindow").css("zIndex"))+100,top:"+=2px",left:"-=21px;","min-width":$input.closest(".prop-grid_vertical_align").width()-2})},select:forExpression?function(event,ui){var item=ui.item;$input.val(placeholder);QvaExpressionEditor.Insert(item.param||item.value,QvaExpressionEditor.Element)}:_select}).keydown(_keydown).focus(_focus).blur(_blur);Qva.Events.AddClickEvent($button,function(){var m=$span.is(".prop-dyn-hidden")?"focus":"blur";$input.trigger(m)},{preventDefault:true});if(forExpression){var self=this;$input.val(placeholder);QvaExpressionEditor.Element=$input.closest(".popup-toolwindow-subdialog-content").find("textarea")[0];if(Qva.userAgentDetector.get("msie")){QvaExpressionEditor.Element.onbeforedeactivate=function(event){if(this.setSelectionRange){this.ieselstart=this.selectionStart;this.ieselend=this.selectionEnd}else{if(document.selection&&document.selection.createRange){this.ierange=document.selection.createRange()}}}}}};Qva.Mgr.dynamicDropdown.prototype.Paint=function(mode,node){this.Element.style.display=Qva.MgrGetDisplayFromMode(this,mode);var $input=$(this.Element).find("input");$input.prop("value",node.getAttribute("text"));$input.data("originalValue",node.getAttribute("text"));if(node.getAttribute("mode")=="disabled"){if(Qva.userAgentDetector.get("msie")&&Qva.userAgentDetector.get("msieVersion")<9){this.Element.childNodes[1].onselectstart=function(){this.blur();return false}}else{this.Element.childNodes[1].onmousedown=function(){this.blur();return false}}$(this.Element.childNodes[1]).dynamicdropdown();$(this.Element.childNodes[1]).dynamicdropdown("option","disabled",true).attr("readonly",true).unbind().addClass("prop-dyn-dimmed");$(this.Element.childNodes[2]).addClass("prop-dyn-transparency")}else{if($input.attr("newrow")=="true"){Qva.ActiveElement=$input[0]}else{$input.trigger("blur")}}};Qva.Mgr.backgroundcolor=function(owner,elem,name,prefix){this.Name=Qva.MgrMakeName(name,prefix);owner.AddManager(this);this.Element=elem};Qva.Mgr.backgroundcolor.prototype.Paint=function(mode,node){this.Touched=true;var element=this.Element;element.style.display=Qva.MgrGetDisplayFromMode(this,mode);element.style.backgroundColor=node.getAttribute("value")};window.log=function(message){try{console.log(message)}catch(e){}};Qva.Mgr.closeself=function(owner,elem,name,prefix){if(name!=null){if(!Qva.MgrSplit(this,name,prefix)){return}this.Element=elem;owner.AddManager(this);this.Mode="h"}this.Parent=owner;Qva.Events.AddClickEvent(elem,function(){setTimeout(function(){owner.CloseSelf.apply(owner)},300)})};Qva.Mgr.closeself.prototype.Paint=function(mode,node){if(this.Mode=="h"&&mode!="e"){return}this.Mode=mode;if(this.Mode=="h"){this.Parent.CloseSelf()}};Qva.Mgr.abortself=function(owner,elem){this.Parent=owner;Qva.Events.AddClickEvent(elem,function(){owner.AbortSelf()})};Qva.Mgr.imagepicker=function(owner,elem,name,prefix){if(!Qva.MgrSplit(this,name,prefix)){return}this.Element=elem;owner.AddManager(this)};Qva.Mgr.imagepicker.prototype.Paint=function(mode,node){this.Element.innerHTML="";var images=node.getElementsByTagName("image");var cellCounter=0;for(var i=0;i<images.length;i++){var divImg=document.createElement("div");divImg.className="prop-grid_image-picker-image";var divTerminator=document.createElement("div");divTerminator.style.clear="both";var image=images[i];var img=document.createElement("img");var imgstamp=image.getAttribute("stamp");var imgname=image.getAttribute("image");imgname+="."+image.getAttribute("value");img.setAttribute("src",Qva.GetBinder(this.PageBinder.binderid).BuildBinaryUrl(image.getAttribute("path"),imgstamp,imgname)+"&width=90&height=90");img.binderid=this.PageBinder.binderid;img.Name=this.Name;img.value=image.getAttribute("value");if(mode=="e"){Qva.Events.AddClickEvent(img,function(){var binder=Qva.GetBinder(this.binderid);if(!binder.Enabled){return}binder.Set(this.Name,"value",this.value,true)})}if(image.getAttribute("selected")=="true"){img.className="prop-selected-image"}divImg.appendChild(img);this.Element.appendChild(divImg);if(++cellCounter>2){this.Element.appendChild(divTerminator);cellCounter=0}}this.Touched=true};Qva.Mgr.colorpicker=function(owner,elem,name,prefix){this.Name=Qva.MgrMakeName(name,prefix);this.primaryColor;this.secondaryColor;this.counter=0;this.isFirstRunTwoColor=true;this.disableColorPalette=false;owner.AddManager(this);this.Element=elem;this.PickerAreas=[]};Qva.Mgr.colorpicker.prototype.Paint=function(mode,node){this.PickerAreas[0].DisablePalette(this.disableColorPalette)};Qva.Mgr.colorpicker.prototype.Setcolor=function(color,issecondary){if(!issecondary){this.primaryColor=color;this.PrimaryInput.SelectColor(color,false)}else{this.secondaryColor=color;this.SecondaryInput.SelectColor(color,true)}};Qva.Mgr.colorpicker.prototype.highlightSecondaryInPalette=function(){if(this.PickerAreas){for(var area in this.PickerAreas){if(this.PickerAreas[area]&&this.secondaryColor==this.PickerAreas[area].Color){this.PickerAreas[area].highlightSecondaryArea(this.oneColorPalette);break}}}};Qva.Mgr.colorpicker.prototype.highlightPrimaryInPalette=function(){if(this.PickerAreas){for(var area in this.PickerAreas){if(this.PickerAreas[area]&&this.primaryColor==this.PickerAreas[area].Color){this.PickerAreas[area].highlightPrimaryArea(this.oneColorPalette);break}}}};Qva.Mgr.colorpicker.prototype.DisablePalette=function(color){};Qva.Mgr.colorpicker.prototype.Markcolor=function(color){this.noColorPalette=(this.firstColorMode!="e"&&this.secondColorMode!="e");var firstColorPalette=(this.firstColorMode=="e"&&this.secondColorMode!="e");var secondColorPalette=(this.firstColorMode!="e"&&this.secondColorMode=="e");var twoColorPalette=(this.firstColorMode=="e"&&this.secondColorMode=="e");this.oneColorPalette=(this.secondColorMode=="h");var issecondary=false;if(this.noColorPalette){this.counter=0;this.isFirstRunTwoColor=true}else{if(firstColorPalette){this.counter=1;this.isFirstRunTwoColor=true;this.Setcolor(color,false)}else{if(secondColorPalette){this.counter=0;issecondary=(this.counter==0);this.Setcolor(color,issecondary)}else{if(twoColorPalette){if(this.isFirstRunTwoColor){this.isFirstRunTwoColor=false;this.counter=1}else{this.counter=(this.counter+1)%2}issecondary=(this.counter==0);this.Setcolor(color,issecondary)}else{}}}}this.ResetColorPalette()};Qva.Mgr.colorpicker.prototype.SetColorPalette=function(color,issecondary){if(!issecondary){this.primaryColor=color;this.highlightPrimaryInPalette()}else{this.secondaryColor=color;this.highlightSecondaryInPalette()}};Qva.Mgr.colorpicker.prototype.ResetColorPalette=function(){if(this.PickerAreas){for(var area in this.PickerAreas){if(this.PickerAreas[area]){if(this.PickerAreas[area].nolightArea){this.PickerAreas[area].nolightArea()}}}}};Qva.Mgr.colorpicker.prototype.DisplayColor=function(source){var issecondary=/\.SecondaryColorHex$/.test(source.Element.Name);if(!issecondary){this.firstColorMode=source.mode;this.ResetColorPalette()}else{this.secondColorMode=source.mode;this.oneColorPalette=(this.secondColorMode=="h")}this.disableColorPalette=(this.firstColorMode!="e"&&this.secondColorMode!="e");this.PickerAreas[0].DisablePalette(this.disableColorPalette);if(this.disableColorPalette){return}if(this.firstColorMode!="e"&&this.secondColorMode=="e"&&!issecondary){return}if(this.firstColorMode=="e"&&this.secondColorMode!="e"&&issecondary){if(this.oneColorPalette){this.SetColorPalette(this.primaryColor,false)}return}this.SetColorPalette(source.Element.value,issecondary)};Qva.Mgr.colorpickerarea=function(owner,elem,name,prefix,color){this.Name=Qva.MgrMakeName(name,prefix);owner.AddManager(this);this.Element=elem;this.Color=color;elem.binderid=owner.binderid;elem.Name=this.Name;elem.setAttribute("value",color);var div=document.createElement("div");elem.appendChild(div);div.className="ToolProperty-Color-Picker";try{div.style.backgroundColor=color}catch(e){alert("Invalid color:"+color)}var mgrs=owner.Managers[this.Name];for(var i=0;i<mgrs.length;i++){if(mgrs[i].PickerAreas){mgrs[i].PickerAreas[mgrs[i].PickerAreas.length]=this;this.colorpicker=mgrs[i];elem.colorpicker=this.colorpicker;break}}Qva.Events.AddClickEvent(elem,function(){this.colorpicker.Markcolor(this.getAttribute("value"))})};Qva.Mgr.colorpickerarea.prototype.Paint=function(mode,node){};Qva.Mgr.colorpickerarea.prototype.highlightArea=function(issecondary,oneColorPalette){var elem=$(this.Element);elem.find(".prop-icon-24x24").remove();var firstchild=elem.children().first();if(!oneColorPalette){var div=$(window.document.createElement("div"));div.addClass("prop-icon-24x24").addClass(issecondary?"prop-colorpicker-icon-second":"prop-colorpicker-icon-first").addClass("prop-colorpicker-icon");div.appendTo(firstchild)}firstchild.addClass("popup-grid_colorpicker_highlight_border");elem.addClass("popup-grid_colorpicker_highlight")};Qva.Mgr.colorpickerarea.prototype.DisablePalette=function(disable){if(disable){$(this.Element).parents("[palette='palette']").addClass("colorpickerpalette-disabled")}else{$(this.Element).parents("[palette='palette']").removeClass("colorpickerpalette-disabled")}};Qva.Mgr.colorpickerarea.prototype.highlightSecondaryArea=function(oneColorPalette){this.highlightArea(true,oneColorPalette)};Qva.Mgr.colorpickerarea.prototype.highlightPrimaryArea=function(oneColorPalette){this.highlightArea(false,oneColorPalette)};Qva.Mgr.colorpickerarea.prototype.nolightArea=function(){var elem=$(this.Element);elem.find(".prop-icon-24x24").remove();elem.children().first().removeClass("popup-grid_colorpicker_highlight_border");elem.removeClass("popup-grid_colorpicker_highlight")};Qva.Mgr.inputcolor=function(owner,elem,name,prefix,issecondary){if(!Qva.MgrSplit(this,name,prefix)){return}this.Element=elem;elem.mgr=this;elem.Name=this.Name;elem.binderid=owner.binderid;elem.Attr=this.Attr;this.IsSecondary=issecondary=="true";owner.AddManager(this);Qva.Events.AddClickEvent(elem,function(){Qva.ActiveObjectsCloak=true},{stopPropagation:true});elem.onchange=function(){var binder=owner.PageBinder;if(this.value==""){binder.Set(this.Name,"text","",true)}else{binder.Set(this.Name,this.Attr,this.value,true)}};var mgrs=owner.Managers[prefix];for(var i=0;i<mgrs.length;i++){if(mgrs[i].PickerAreas){this.colorpicker=mgrs[i];if(this.IsSecondary){mgrs[i].SecondaryInput=this}else{mgrs[i].PrimaryInput=this}break}}};Qva.Mgr.inputcolor.prototype.Lock=Qva.LockReadOnly;Qva.Mgr.inputcolor.prototype.Unlock=Qva.UnlockReadOnly;Qva.Mgr.inputcolor.prototype.Paint=function(mode,node){this.Touched=true;this.mode=mode;var element=this.Element;element.readOnly=(mode!="e");element.style.color=element.readOnly?"graytext":"";element.disabled=false;var attrValue="";if(mode!="n"){attrValue=node.getAttribute(this.Attr);if(this.Attr=="value"&&node.getAttribute("text")==""){attrValue=""}}if(attrValue==""&&this.TextIfNull){attrValue=this.TextIfNull}if(this.Dec!=null){element.value=Qva.Trunc(attrValue,this.Dec)}else{element.value=attrValue}this.Locked=element.disabled;element.style.display=Qva.MgrGetDisplayFromMode(this,mode);this.colorpicker.DisplayColor(this)};Qva.Mgr.inputcolor.prototype.SelectColor=function(color){var binder=this.PageBinder.PageBinder;binder.Set(this.Name,this.Attr,color,true)};var HardCodedDialogWidth=355;Qva.Mgr.toolwindowbody.prototype.ShowContextDialog=function(body,text){if(this.ContextDialog==null){this.ContextDialog=document.createElement("div");this.ContextDialog.style.position="absolute";this.ContextDialog.style.zIndex=10666;this.ContextDialog.className="contextdialog";Qva.Events.AddCancelBubble(this.ContextDialog);this.Element.insertBefore(this.ContextDialog,this.Element.firstChild)}this.ContextDialog.innerHTML=body;var parts=this.CurrentDialog.ButtonMgr.Name.split(".");var name=parts[0]+"."+parts[1]+"."+parts[2];this.ContextDialogMgr=new Qva.Mgr.toolwindowbody(this.PageBinder,this.ContextDialog,name,this);this.ContextDialogMgr.TopElement=this.ContextDialog;this.ContextDialog.style.display="none";this.ContextDialogMgr.Scan(this.CurrentDialog.ButtonMgr.Name);this.CurrentDialog.ButtonMgr.ToggleUIState();if(parseInt($(this.Element).css("width"))==HardCodedDialogWidth){this.ContextDialog.style.left="-1px"}else{var left=HardCodedDialogWidth-parseInt($(this.Element).css("width"));if(left==HardCodedDialogWidth){left=HardCodedDialogWidth-334}left=Math.round(left/2);this.ContextDialog.style.left=-left+"px"}try{this.ContextDialog.focus()}catch(err){}if(typeof(text)=="string"){this.ContextDialogMgr.SetSingleMode(this.CurrentDialog.ButtonMgr.Name,text)}else{if(this.node){this.ContextDialogMgr.Paint(this.mode,this.node,this.prefix)}else{this.DocumentBinder.Refresh()}}this.ContextDialog.style.display="";var parentdelta=$(this.Element).offset().top-$(this.TopElement).offset().top;var parentheight=$(this.TopElement).height();var height=$(this.ContextDialog).height();var buttondelta=Math.round(this.CurrentDialog.buttonheight/2);if(parentheight<$(this.ContextDialog).height()){this.ContextDialog.style.top="-1px"}else{if(((this.CurrentDialog.buttonoffset+parentdelta)>(parentheight/2))&&((this.CurrentDialog.buttonoffset+parentdelta)>height)){this.ContextDialog.style.top=this.CurrentDialog.buttonoffset-buttondelta-height-4+"px"}else{if(parentheight<300){this.ContextDialog.style.top=this.CurrentDialog.buttonoffset-buttondelta-height-4+"px"}else{this.ContextDialog.style.top=this.CurrentDialog.buttonoffset+buttondelta+4+"px"}}}var list=[this.TopElement,document];if(this.TopElement!=this.Element){list.push(this.Element)}var _this=this;Qva.Events.AddClickEvent(list,function(){_this.HideContextDialog(true,true)},{xns:".ToolWindowBody",stopPropagation:true})};Qva.Mgr.toolwindowbody.prototype.CloseSelf=function(){this.HideContextDialog();this.UIParent.HideContextDialog(true)};Qva.Mgr.toolwindowbody.prototype.AbortSelf=function(){this.HideContextDialog();this.UIParent.HideContextDialog(true,true)};Qva.Mgr.toolwindowbody.prototype.HideContextDialog=function(external,abort){var list=[this.TopElement,document];if(this.TopElement!=this.Element){list.push(this.Element)}Qva.Events.RemoveClickEvent(list,".ToolWindowBody");Qva.HideContextMenu();if(this.CurrentDialog){if(this.ContextDialogMgr!=null){if(abort){this.ContextDialogMgr.Abort(true)}else{this.ContextDialogMgr.Close(true)}this.DocumentBinder.RemoveFromManagers(this.ContextDialogMgr);this.ContextDialogMgr=null}if(this.ContextDialog!=null){this.ContextDialog.style.display="none"}this.CurrentDialog.ButtonMgr.ToggleUIState();if(external){this.CurrentDialog=null}}};Qva.Mgr.toolwindowbody.prototype.ExpressionDialog=function(elem){if(!this.DocumentBinder.Enabled){return}if(this.DocumentBinder.IsHosted){var text=external.AvqExpressionDialog(this.CurrentDialog.ButtonMgr.Value,this.CurrentDialog.ButtonMgr.ExpressionType=="always");if(text!=this.CurrentDialog.ButtonMgr.Value){this.DocumentBinder.Set(this.CurrentDialog.ButtonMgr.Name,"value",text,true)}}else{var _this=this;this.DocumentBinder.LoadHtml("Expression.Qvpp",function(body){_this.ShowContextDialog(body,_this.CurrentDialog.ButtonMgr.Value)})}};Qva.Mgr.toolwindowbody.prototype.HideMe=function(buttonmgr,dlgname){if(this.CurrentDialog){if(this.CurrentDialog.ButtonMgr.Name==buttonmgr.Name&&this.CurrentDialog.dlg==dlgname){this.HideContextDialog();this.CurrentDialog=null;return}}};Qva.Mgr.toolwindowbody.prototype.SetContextDialog=function(buttonmgr,dlgname){if(this.CurrentDialog&&!Qva.userAgentDetector.get("webview")){this.HideContextDialog();if(this.CurrentDialog.ButtonMgr.Name==buttonmgr.Name&&this.CurrentDialog.dlg==dlgname){this.CurrentDialog=null;return}}var buttonElement=$(buttonmgr.ButtonElement?buttonmgr.ButtonElement:buttonmgr.Element);this.CurrentDialog={ButtonMgr:buttonmgr,dlg:dlgname,buttonoffset:(buttonElement.offset().top-$(this.Element).offset().top+Math.round(buttonElement.height()/2)),buttonheight:buttonElement.height()};var _this=this;if(buttonmgr.IsExpression){if(buttonmgr.Element.disabled){return}this.ExpressionDialog()}else{var _this=this;this.DocumentBinder.LoadHtml(_this.CurrentDialog.dlg,function(body){_this.ShowContextDialog(body,_this.CurrentDialog.ButtonMgr.Value)})}};Qva.Mgr.dlgpropjqui=function(owner,elem,name,prefix,dlgname){this.Init(owner,elem,name,prefix,dlgname)};Qva.Mgr.dlgpropjqui.prototype.Init=function(owner,elem,name,prefix,dlgname){if(!Qva.MgrSplit(this,name,prefix)){return}owner.AddManager(this);this.Element=elem;this.DlgName=dlgname;if(this.DlgName!==null&&this.DlgName.toUpperCase()=="EXPRESSION.QVPP"){this.IsExpression=true}var _this=this;this.DialogOwner=owner;while(!this.DialogOwner.SetContextDialog){this.DialogOwner=this.DialogOwner.PageBinder}this.iconType=elem.getAttribute("propicontype");this.ButtonElement=this.CreateButton(name,prefix,this.iconType,this.iconType=="expression"||this.iconType=="expression-text");$(this.Element).prepend(this.ButtonElement);Qva.Events.AddClickEvent(this.ButtonElement,function(){if(!_this.disabled){_this.DialogOwner.SetContextDialog(_this,_this.DlgName)}},{stopPropagation:true})};Qva.Mgr.dlgpropjqui.prototype.CreateButton=function(name,prefix,iconType,hasborder,buttonType){var button=window.document.createElement("button");if(buttonType){button.setAttribute("type",buttonType)}$button=$(button).button({text:false});var div=window.document.createElement("div");var $div=$(div);$button.prepend($div);$div.addClass("prop-icon-24x24");$button.addClass("prop-jqui-icon-border-fix");if(hasborder){$button.attr("border",true);$div.addClass("prop-icon-expression-standalone")}else{$button.addClass("prop-jqui-icon-state-no-border").removeClass("ui-state-default")}switch(iconType){case"togglefont_bold":$div.addClass("prop-font-bold-icon");break;case"togglefont_italic":$div.addClass("prop-font-italic-icon");break;case"togglefont_underline":$div.addClass("prop-font-uline-icon");break;case"delete-row":$div.addClass("prop-sortable-list-close-button");$(this.Element).attr("name","sortable-list-item-close-button");break;case"add-row":$div.addClass("prop-dimension-icon-close");break;case"expression-text":$button.addClass("prop-right");break;case"expression":$div.addClass("prop-left");break;case"image":$div.addClass("prop-grid_button").addClass("prop-image-icon-enabled");break;case"fontcolor":$div.addClass("prop-left").addClass("prop-font-color-icon");var divFontColor=window.document.createElement("div");$(divFontColor).addClass("prop-font-color-icon-box");$(divFontColor).insertAfter(div);new Qva.Mgr.backgroundcolor(this.PageBinder,divFontColor,name+".ColorHex",prefix);break;case"tool":$div.addClass("prop-grid_button").addClass("prop-jqui-icon");break;case"font":$div.addClass("prop-left").addClass("prop-font-icon");break}return $button};Qva.Mgr.dlgpropjqui.Enable=function($elem,enabled){var button=$($elem.find("button")[0]);var imagediv=button.children("div")[0];var imagediv2=button.children("div")[1];var isstandalone=$(imagediv).hasClass("prop-icon-expression-standalone");button.button();if(!enabled){button.button("disable");if(!isstandalone){button.addClass("prop-jqui-icon-state-no-border-disabled").removeClass("prop-jqui-icon-state-no-border")}}else{button.button("enable");if(!isstandalone){button.addClass("prop-jqui-icon-state-no-border").removeClass("prop-jqui-icon-state-no-border-disabled")}}if(imagediv2){button.prepend(imagediv2)}button.prepend(imagediv)};Qva.Mgr.propjquibutton=function(owner,elem,name,prefix,buttonType){this.Element=elem;this.iconType=elem.getAttribute("propicontype");this.ButtonElement=this.CreateButton(name,prefix,this.iconType,this.iconType=="expression"||this.iconType=="expression-text",buttonType);$(this.Element).prepend(this.ButtonElement);new Qva.Mgr.action(owner,elem,name,prefix)};Qva.Mgr.propjquibutton.prototype.CreateButton=Qva.Mgr.dlgpropjqui.prototype.CreateButton;Qva.Mgr.dlgpropjqui.prototype.ToggleUIState=function(){var button=this.ButtonElement;if(Qva.userAgentDetector.get("msie")){button.toggleClass("ui-state-active")}if(button.attr("border")=="false"){if(button.hasClass("ui-state-active")){button.removeClass("prop-jqui-icon-state-no-border")}else{button.addClass("prop-jqui-icon-state-no-border")}}button.bind("mouseup mouseout",function(){button.toggleClass("ui-state-active");if(button.attr("border")=="false"){if(button.hasClass("ui-state-active")){button.removeClass("prop-jqui-icon-state-no-border")}else{button.addClass("prop-jqui-icon-state-no-border")}}})};Qva.Mgr.dlgpropjqui.prototype.CommonPaint=Qva.Mgr.dlg.prototype.Paint;Qva.Mgr.dlgpropjqui.prototype.Paint=function(mode,node){if(mode=="h"){this.DialogOwner.HideMe(this,this.DlgName)}this.CommonPaint(mode,node);if(this.Element.getAttribute("newrow")=="true"){this.DialogOwner.SetContextDialog(this,this.DlgName)}if(this.iconType=="expression"||this.iconType=="expression-text"){var $element=$(this.Element);var button=$($element.find("button")[0]);if($(button.children("div")[0]).hasClass("prop-icon-expression-standalone")){Qva.Mgr.dlgpropjqui.Enable($element,mode=="e")}else{var button=$($element.find("button")[0]);if(mode=="d"){this.disabled=true;button.addClass("prop-icon-expression-disabled").removeClass("prop-icon-expression")}else{this.disabled=false;button.addClass("prop-icon-expression").removeClass("prop-icon-expression-disabled")}}}};Qva.Mgr.dlgprop=function(owner,elem,name,prefix,dlgname){this.Init(owner,elem,name,prefix,dlgname)};Qva.Mgr.dlgprop.prototype.Init=Qva.Mgr.dlgpropjqui.prototype.Init;Qva.Mgr.dlgprop.prototype.CreateButton=function(name,prefix,iconType){if(iconType=="colorpicker"||iconType=="singlecolor"){var span=window.document.createElement("span");var $span=$(span);$span.addClass("prop-left").addClass("prop-icon-24x24").addClass("prop-color-icon");new Qva.Mgr.backgroundcolor(this.PageBinder,span,iconType=="colorpicker"?name+".ColorHex":name,prefix);return $span}else{if(iconType=="expression"){var btn=window.document.createElement("button");var $btn=$(btn);$btn.addClass("prop-icon-24x24").addClass("prop-icon-expression").addClass("prop-grid_button").addClass("prop-expression-button");return $btn}else{Assert(false)}}};Qva.Mgr.dlgprop.prototype.ToggleUIState=function(){if(this.ButtonElement.hasClass("prop-color-icon")||this.ButtonElement.hasClass("prop-color-icon-active")){this.ButtonElement.toggleClass("prop-color-icon-active");this.ButtonElement.toggleClass("prop-color-icon")}if(this.ButtonElement.hasClass("prop-icon-expression")||this.ButtonElement.hasClass("prop-icon-expression-active")){this.ButtonElement.toggleClass("prop-icon-expression-active");this.ButtonElement.toggleClass("prop-icon-expression")}};Qva.Mgr.dlgprop.prototype.CommonPaint=Qva.Mgr.dlg.prototype.Paint;Qva.Mgr.dlgprop.prototype.Paint=Qva.Mgr.dlgpropjqui.prototype.Paint;Qva.Mgr.jqueryToggle=function(owner,elem,name,prefix){if(!Qva.MgrSplit(this,name,prefix)){return}this.Element=elem;elem.binderid=owner.binderid;elem.Name=this.Name;this.Active=0;this.iconType=elem.getAttribute("propicontype");if(this.iconType=="togglefont"){var button=window.document.createElement("button");$(button).button({text:false});var jqbutton=$(button);jqbutton.css("height","24px");var div=window.document.createElement("div");var jqdiv=$(div);jqdiv.addClass("prop-icon-24x24");var icon=elem.getAttribute("propicon");if(name==".Bold"||icon=="bold"){jqdiv.addClass("prop-font-bold-icon")}if(name==".Italic"||icon=="italic"){jqdiv.addClass("prop-font-italic-icon")}if(name==".Underline"||icon=="underline"){jqdiv.addClass("prop-font-uline-icon")}jqdiv.insertBefore(jqbutton.children()[0]);elem.appendChild(button)}else{this.ButtonElement=this.CreateButton(name,prefix,this.iconType,true);$(this.Element).prepend(this.ButtonElement)}Qva.Events.AddClickEvent(elem,function(){var binder=Qva.GetBinder(this.binderid);if(!binder.Enabled){return}binder.Set(this.Name,"value",this.getAttribute("value1"),true)});$(elem).mouseleave(function(e){var t=$(this).children()[0];if(this.getAttribute("value1")==0){$(t).addClass("ui-state-active")}});owner.AddManager(this)};Qva.Mgr.jqueryToggle.prototype.CreateButton=Qva.Mgr.dlgpropjqui.prototype.CreateButton;Qva.Mgr.jqueryToggle.prototype.Paint=function(mode,node){this.Active=parseInt(node.getAttribute("value"));var disabled=mode=="d"||isNaN(this.Active);var $t=$($(this.Element).children()[0]);if(!isNaN(this.Active)){this.Element.setAttribute("value1",(this.Active==0?1:0));if(this.Active==0){$t.removeClass("ui-state-active")}else{$t.addClass("ui-state-active")}if(disabled){$t.addClass("ui-state-disabled")}else{$t.removeClass("ui-state-disabled")}}else{$t.addClass("ui-state-disabled")}};Qva.Mgr.arrowstyle=function(owner,elem,name,prefix,dlgname){if(!Qva.MgrSplit(this,name,prefix)){return}owner.AddManager(this);this.Element=elem;this.Element.Name=this.Name;this.Element.binderid=owner.PageBinder.ID;this.ClassPrefix="prop-linearrow-"};Qva.Mgr.arrowstyle.prototype.SetRange=function(values){this.First=this.Current<7?0:7;this.Last=this.Current<7?6:13};Qva.Mgr.arrowstyle.prototype.Paint=function(mode,node){var elemnodes=node.getElementsByTagName("element");this.Element.innerHTML="";var disabled=(mode!="e");var values=[];for(var i=0;i<elemnodes.length;i++){values[values.length]=parseInt(elemnodes[i].getAttribute("value"))}this.Current=parseInt(node.getAttribute("value"));this.SetRange(values);for(var i=this.First;i<=this.Last;i++){var button=window.document.createElement("button");button.setAttribute("value1",i);this.AddImage(button,i,disabled);button.Name=this.Element.Name;button.binderid=this.Element.ID;if(!disabled){Qva.Events.AddClickEvent(button,function(){var binder=Qva.GetBinder(this.binderid);if(!binder.Enabled){return}binder.Set(this.Name,"value",this.getAttribute("value1"),true)})}this.Element.appendChild(button)}};Qva.Mgr.arrowstyle.prototype.AddImage=function(button,value,disabled){$(button).button({text:false});$(button).removeClass("ui-corner-all");switch(value){case this.First:$(button).addClass("ui-corner-left");$(button).addClass("prop-button-align");break;case this.Last:$(button).addClass("ui-corner-right");$(button).addClass("prop-button-align-last");break;default:$(button).addClass("prop-button-align");break}$(button).addClass("prop-weld-align-icons");var span=window.document.createElement("div");$(span).addClass("prop-grid_button prop-icon-24x24");$(span).css("position","relative");$(span).addClass(this.ClassPrefix+value);if(value==this.Current){$(button).addClass("ui-state-active")}else{$(button).removeClass("ui-state-active")}if(disabled){$(span).addClass("prop-icon-disabled")}var current=this.Current;$(button).bind("mouseout",function(){if(value==current){$(button).addClass("ui-state-active")}});if(disabled){$(button).unbind()}$(span).insertBefore($(button).children()[0])};Qva.Mgr.linestyle=function(owner,elem,name,prefix,dlgname){if(!Qva.MgrSplit(this,name,prefix)){return}owner.AddManager(this);this.Element=elem;this.Element.Name=this.Name;this.Element.binderid=owner.PageBinder.ID;this.ClassPrefix="prop-linestyle-"};Qva.Mgr.linestyle.prototype.SetRange=function(values){this.First=0;this.Last=values.length-1};Qva.Mgr.linestyle.prototype.Paint=Qva.Mgr.arrowstyle.prototype.Paint;Qva.Mgr.linestyle.prototype.AddImage=Qva.Mgr.arrowstyle.prototype.AddImage;function SetWidth100percent(elem,parentwidth){elem=$(elem);var delta=0;var margin=parseFloat(elem.css("margin-right"))+parseFloat(elem.css("margin-left"));if(!isNaN(margin)){delta+=margin}var padding=parseFloat(elem.css("padding-right"))+parseFloat(elem.css("padding-left"));if(!isNaN(padding)){delta+=padding}var border=parseFloat(elem.css("border-right-width"))+parseFloat(elem.css("border-left-width"));if(!isNaN(border)){delta+=border}if(!parentwidth){parentwidth=elem.parent().width()}elem.css("width",parentwidth-delta)}Qva.Mgr.prop_editexpression=function(owner,elem,name,prefix){var div1=window.document.createElement("div");div1.className="prop-grid_vertical_align";elem.appendChild(div1);SetWidth100percent(div1,$(elem).width());var width=$(div1).width();var input=window.document.createElement("input");$(input).addClass("prop-expression-input").attr("type","text");new Qva.Mgr.inputtext(owner,input,name,prefix);div1.appendChild(input);SetWidth100percent(input,width);var span=window.document.createElement("span");$(span).attr("propicontype","expression");new Qva.Mgr.dlgprop(owner,span,name,prefix,"Expression.qvpp");div1.appendChild(span)};Qva.Mgr.prop_dynamicDropdown=function(owner,elem,name,prefix,property){var alignDiv=document.createElement("div"),div=document.createElement("div"),placeholder=elem.innerHTML;div.className="prop-dyn-dynamic-dropdown-wrapper";alignDiv.className="prop-grid_vertical_align";alignDiv.appendChild(div);elem.innerHTML="";elem.appendChild(alignDiv);if($(elem).hasClass("expression-ac")){$(alignDiv).css("width","150");$(div).css("width","150")}else{SetWidth100percent(alignDiv,$(elem).width());SetWidth100percent(div)}new Qva.Mgr.dynamicDropdown(owner,div,name,prefix,property,placeholder)};Qva.Mgr.dropdown=function(owner,elem,name,prefix,property){var self=$(elem),parent=self.parent();if(self.is("button")){self=$("<div/>");parent.find("*").remove().end().append(self)}Qva.Mgr.prop_dynamicDropdown.call(this,owner,self[0],name,prefix,property)};Qva.Mgr.prop_select=function(owner,elem,name,prefix){new Qva.Mgr.label(owner,elem,name,prefix);var div1=window.document.createElement("div");div1.className="prop-grid_vertical_align";var select=window.document.createElement("select");$(select).addClass("prop-select");div1.appendChild(select);elem.appendChild(div1);SetWidth100percent(div1);new Qva.Mgr.select(owner,select,name,prefix)};Qva.Mgr.prop_label=function(owner,elem,name,prefix){$(elem).wrapInner('<div class="prop-grid_vertical_align">');if(name){var child=$(elem).children()[0];new Qva.Mgr.text(owner,child,name,prefix)}};Qva.Mgr.prop_centeredlabel=function(owner,elem,name,prefix){Qva.Mgr.prop_label(owner,elem);var child=$($(elem).children()[0]);child.css("text-align","center");SetWidth100percent(child)};Qva.Mgr.prop_checkbox=function(owner,elem,name,prefix,condition){var div1=window.document.createElement("div");div1.className="prop-grid_vertical_align";elem.appendChild(div1);var checkbox=window.document.createElement("input");$(checkbox).attr("type","checkbox").addClass("prop-grid_checkbox");new Qva.Mgr.inputcheckbox(owner,checkbox,name,prefix,condition);div1.appendChild(checkbox)};Qva.Mgr.prop_radiobutton=function(owner,elem,name,prefix,groupname){if(!groupname){return}var parts=groupname.split(":");if(parts.length<2){return}var div1=window.document.createElement("div");div1.className="prop-grid_vertical_align";elem.appendChild(div1);var radiobutton=window.document.createElement("input");$(radiobutton).attr("type","radio").attr("name",!!parts[0]?name:parts[0]).attr("value",parts[1]).addClass("prop-grid_checkbox");new Qva.Mgr.inputradio(owner,radiobutton,name,prefix);div1.appendChild(radiobutton)};Qva.Mgr.prop_editinput=function(owner,elem,name,prefix,classname){this.Create(owner,elem,name,prefix,classname)};function FixVerticalAlignWithPadding(elem,parent){var newheight=elem.height();var border=parseFloat(elem.css("border-top-width"))+parseFloat(elem.css("border-bottom-width"));if(!isNaN(border)){newheight+=border}var margin=parseFloat(elem.css("margin-top"))+parseFloat(elem.css("margin-bottom"));if(!isNaN(margin)){newheight+=margin}var padding=parseFloat(elem.css("padding-top"))+parseFloat(elem.css("padding-bottom"));if(!isNaN(padding)){newheight+=padding}var parent=parent?parent:elem.parent();var newpadding=(parent.height()-newheight)/2;parent.css("height",newheight).css("padding-top",newpadding).css("padding-bottom",newpadding)}function GetTotalWidth(elem,includemargin){var delta=0;if(includemargin){var margin=parseFloat(elem.css("margin-right"))+parseFloat(elem.css("margin-left"));if(!isNaN(margin)){delta+=margin}}var padding=parseFloat(elem.css("padding-right"))+parseFloat(elem.css("padding-left"));if(!isNaN(padding)){delta+=padding}var border=parseFloat(elem.css("border-right-width"))+parseFloat(elem.css("border-left-width"));if(!isNaN(border)){delta+=border}return elem.width()+delta}Qva.Mgr.prop_editinput.prototype.Create=function(owner,elem,name,prefix,classname){var input=window.document.createElement("input");var jqelem=$(elem);var jqinput=$(input);jqinput.addClass("prop-expression-input").attr("type","text");this.AddManager(owner,input,name,prefix);elem.appendChild(input);if(classname){jqinput.addClass(classname);if(parseInt(jqinput.css("width"))>0){jqinput.css("margin-left",jqelem.width()-GetTotalWidth(jqinput,false)).css("margin-right",0)}else{SetWidth100percent(input)}}else{SetWidth100percent(input)}FixVerticalAlignWithPadding(jqinput)};Qva.Mgr.prop_editinput.prototype.AddManager=function(owner,elem,name,prefix){new Qva.Mgr.inputtext(owner,elem,name,prefix)};Qva.Mgr.prop_text=function(owner,elem,name,prefix,tooltip){$(elem).wrapInner('<div class="prop-grid_vertical_align">');var child=$(elem).children()[0];SetWidth100percent(child);new Qva.Mgr.text(owner,child,name,prefix,tooltip)};Qva.Mgr.prop_inputcolor=function(owner,elem,name,prefix,issecondary){var input=window.document.createElement("input");var jqinput=$(input);jqinput.addClass("prop-expression-input").attr("type","text");new Qva.Mgr.inputcolor(owner,input,name,prefix,issecondary);elem.appendChild(input);SetWidth100percent(input);FixVerticalAlignWithPadding(jqinput)};Qva.Mgr.prop_dlgbutton=function(owner,elem,name,prefix,dlg){new Qva.Mgr.dlgprop(owner,elem,name,prefix,dlg);new Qva.Mgr.label(owner,elem,name,prefix);var $span=$(elem).children("span:eq(0)");FixVerticalAlignWithPadding($span)};Qva.Mgr.prop_dlgbuttonjqui=function(owner,elem,name,prefix,dlg){new Qva.Mgr.dlgpropjqui(owner,elem,name,prefix,dlg);var button=$($(elem).children("button")[0]);FixVerticalAlignWithPadding(button,$(elem));new Qva.Mgr.label(owner,elem,name,prefix)};Qva.Mgr.prop_buttonjqui=function(owner,elem,name,prefix){new Qva.Mgr.propjquibutton(owner,elem,name,prefix);var button=$($(elem).children("button")[0]);if(owner.Name.indexOf("Document.TOOLS\\REPOSITORY.Body.Repository")<0){FixVerticalAlignWithPadding(button,$(elem))}};Qva.Mgr.prop_inputbuttonjqui=function(owner,elem,name,prefix){new Qva.Mgr.propjquibutton(owner,elem,name,prefix,"button");var button=$($(elem).children("button")[0]);FixVerticalAlignWithPadding(button,$(elem))};Qva.Mgr.prop_toollabel=function(owner,elem,name,prefix,dlg){$(elem).wrapInner('<div class="prop-grid_vertical_align">').wrapInner('<div  style="float:left">');var div1=window.document.createElement("div");$(div1).css("float","left").css("padding-left","3px");elem.appendChild(div1);var div2=window.document.createElement("div");div2.className="prop-grid_vertical_align";div1.appendChild(div2);var div3=window.document.createElement("div");$(div3).attr("propicontype",$(elem).attr("propicontype"));div2.appendChild(div3);new Qva.Mgr.prop_dlgbuttonjqui(owner,div3,name,prefix,dlg)};Qva.Mgr.prop_arrowstyle=function(owner,elem,name,prefix){var div1=window.document.createElement("div");var jqdiv=$(div1);jqdiv.css("height","26px").css("float","right");elem.appendChild(div1);new Qva.Mgr.arrowstyle(owner,div1,name,prefix);FixVerticalAlignWithPadding(jqdiv)};Qva.Mgr.prop_linestyle=function(owner,elem,name,prefix){var div1=window.document.createElement("div");var jqdiv=$(div1);$(div1).css("height","26px");elem.appendChild(div1);new Qva.Mgr.linestyle(owner,div1,name,prefix);FixVerticalAlignWithPadding(jqdiv)};Qva.Mgr.prop_selectoneicon=function(owner,elem,name,prefix){elem=$(elem);var totwidth=elem.width();var children=$(elem).children("div");var iconwith=26;for(var i=0;i<children.length;i++){var child=$(children[i]);var grandchild=$(child).children("div")[0];if(grandchild){child=$(grandchild)}var propicontype=child.attr("propicontype");if(propicontype){if(propicontype=="colorpicker"){child.css("width",iconwith-4).css("padding-left",2).css("padding-right",2)}else{child.css("width",iconwith)}}else{child.css("width",totwidth-iconwith-6)}}};Qva.Mgr.prop_selecttwoicons=function(owner,elem,name,prefix){elem=$(elem);var totwidth=elem.width();var children=$(elem).children("div");var iconwith=26;for(var i=0;i<children.length;i++){var child=$(children[i]);if(child.width()==0){child=$(child).children("div")[0];if(!child){continue}child=$(child)}var propicontype=child.attr("propicontype");if(propicontype){if(propicontype=="colorpicker"){child.css("width",iconwith-4).css("padding-left",2).css("padding-right",2)}else{child.css("width",iconwith)}}else{child.css("width",totwidth-2*iconwith-6)}}};Qva.Mgr.prop_percentslider=function(owner,elem,name,prefix){var slider=$($(elem).children("div")[0]);slider.css("width",slider.width()+7)};Qva.Mgr.prop_align=function(owner,elem,name,prefix){var div1=window.document.createElement("div");var jqdiv=$(div1);jqdiv.css("height","26px");elem.appendChild(div1);new Qva.Mgr.align(owner,div1,name,prefix);FixVerticalAlignWithPadding(jqdiv)};Qva.Mgr.prop_disablebuttonif=function(owner,elem,name,prefix,value){if(!Qva.MgrSplit(this,name,prefix)){return}owner.AddManager(this);this.Element=elem;this.Value=value};Qva.Mgr.prop_disablebuttonif.prototype.Paint=function(mode,node){var enabled=mode=="e";if(this.Value!=null){enabled=enabled&&node.getAttribute("value")!=this.Value}Qva.Mgr.dlgpropjqui.Enable($(this.Element),enabled)};Qva.Mgr.prop_disablebuttonifhidden=function(owner,elem,name,prefix,value){if(!Qva.MgrSplit(this,name,prefix)){return}owner.AddManager(this);this.Element=elem};Qva.Mgr.prop_disablebuttonifhidden.prototype.Paint=function(mode,node){Qva.Mgr.dlgpropjqui.Enable($(this.Element),mode=="e")};Qva.Mgr.list_movehandle=function(owner,elem,name,prefix){var $span=$(window.document.createElement("div"));var $elem=$(elem);$elem.addClass("prop-clear-none").addClass("prop-dyn-sortable-item-handle");$span.addClass("prop-icon-24x24");$elem.append($span)};Qva.Mgr.prop_listheader=function(owner,elem,name,prefix){var $elem=$(elem);var text=$elem.text();$('<div class="prop-grid_span-9" style="margin-left:7px;"><div class="prop-grid_vertical_align"/></div>').appendTo($elem.empty()).find(".prop-grid_vertical_align").append('<span style="float:left">'+text+"</span>").append('<span style="float:left; margin-left:6px;">(<span></span>)</span>');$elem.append('<div class="prop-sortable-right-width-28px prop-margin-right-3px"><div class="prop-sortable-width-28px" propicontype="add-row"></div></div>');new Qva.Mgr.text(owner,$elem.find(".prop-grid_vertical_align > span:last > span")[0],name+"@value",prefix);new Qva.Mgr.prop_buttonjqui(owner,$elem.find(".prop-sortable-width-28px")[0],name+".Add",prefix);new Qva.Mgr.prop_disablebuttonifhidden(owner,$elem.find(".prop-sortable-width-28px")[0],name,prefix)};Qva.Mgr.prop_slider=function(owner,elem,name,prefix,classname){this.Name=Qva.MgrMakeName(name,prefix);owner.AddManager(this);this.Element=elem;this.$Element=$(elem);this.$SliderParent=$('<div style="float:left;">');this.$Slider=$('<div class="prop-grid_slider2" type="radio">').appendTo(this.$SliderParent);this.$InputParent=$('<div style="float:left;">');this.$Input=$('<input class="prop-expression-input '+classname+'"></input>').appendTo(this.$InputParent);this.$SliderParent.appendTo(this.$Element);this.$InputParent.appendTo(this.$Element);new Qva.Mgr.propertySlider(owner,this.$Slider[0],name,prefix,this.$Input[0])};Qva.Mgr.prop_slider.prototype.Paint=function(mode,node){this.PageBinder.RemoveFromManagers(this);var inputwidth=this.$Input.outerWidth(true);this.$InputParent.css("width",inputwidth);this.$InputParent.css("height",this.$Element.height());FixVerticalAlignWithPadding(this.$Input);this.$SliderParent.css("width",this.$Element.width()-inputwidth);this.$SliderParent.css("height",this.$Element.height());FixVerticalAlignWithPadding(this.$Slider)}})($QvJq);
/*! A fix for the iOS orientationchange zoom bug.
Script by @scottjehl, rebound by @wilto.
MIT / GPLv2 License.
*/
(function(w){var ua=navigator.userAgent;if(!(/iPhone|iPad|iPod/.test(navigator.platform)&&/OS [1-5]_[0-9_]* like Mac OS X/i.test(ua)&&ua.indexOf("AppleWebKit")>-1)){return}var doc=w.document;if(!doc.querySelector){return}if(!doc.querySelector("meta[name=viewport]")){var metaTag=doc.createElement("meta");metaTag.name="viewport";metaTag.content="width=device-height";doc.getElementsByTagName("head")[0].appendChild(metaTag)}var meta=doc.querySelector("meta[name=viewport]"),initialContent=meta&&meta.getAttribute("content"),disabledZoom=initialContent+",maximum-scale=1",enabledZoom=initialContent+",maximum-scale=10",enabled=true,x,y,z,aig;if(!meta){return}function restoreZoom(){enabled=true;meta.setAttribute("content",enabledZoom)}function disableZoom(){meta.setAttribute("content",disabledZoom);enabled=false}function checkTilt(e){aig=e.accelerationIncludingGravity;x=Math.abs(aig.x);y=Math.abs(aig.y);z=Math.abs(aig.z);if((!w.orientation||w.orientation===180)&&(x>7||((z>6&&y<8||z<8&&y>6)&&x>5))){if(enabled){disableZoom()}}else{if(!enabled){restoreZoom()}}}w.addEventListener("orientationchange",restoreZoom,false);w.addEventListener("devicemotion",checkTilt,false)})(this);(function($){Qva.addons={serverRootPath:Qva.QvAjaxZfcPath+"htc/addons/"};$.getJSON(Qva.QvAjaxZfcPath+"htc/addons/config.json").done(function(data){$.each(data.addons,function(index,addon){if(addon.active===true){Qva.LoadScript(Qva.QvAjaxZfcPath+"htc/addons/"+addon.name+"/"+addon.script,function(){Qva.addons[addon.name].init(addon.config)})}})})})(jQuery);(function($,undefined){if(!Qva.EventServer){Qva.EventServer={}}if(!Qva.EventServer.Queue){Qva.EventServer.Queue=[]}if(!Qva.EventServer.ArchiveQueue){Qva.EventServer.ArchiveQueue=[]}Qva.EventServer.init=function(){$(document).on("DOMNodeInserted",function(e){if(Qva.EventServer.Queue.length>0){Qva.EventServer.processQueue(e.target)}});$(Qva.EventServer).on("featureAdded configReady OnUpdateComplete",function(e,feature){if(Qva.EventServer.Queue.length>0){Qva.EventServer.processQueue(feature)}});$(Qva.EventServer).on("configReady",function(){if(!Qva.EventServer.ConfigReady){Qva.EventServer.ConfigReady=true}})};Qva.EventServer.registerEvent=function(eventName,uniqueName,fn){if(!Qva.Registry.verify("Events","EventServer",eventName,uniqueName)){$(Qva.EventServer).on(uniqueName,function(event,param){fn(event,param)});Qva.Registry.add("Events","EventServer",eventName,uniqueName,true)}};Qva.EventServer.queueEvent=function(oEvent){if(Qva.generalHelper.dupCheckQueueEntry(Qva.EventServer.Queue,oEvent)&&Qva.generalHelper.dupCheckQueueEntry(Qva.EventServer.ArchiveQueue,oEvent)){Qva.EventServer.Queue.push(oEvent);Qva.EventServer.processQueueObjects()}};Qva.EventServer.processQueueObjects=function(){var q=Qva.EventServer.Queue,cond=[],i=0,j=0,tree="",deps=[],failed=false,cq=[],id="",verified=true,args={},toexec={};q=Qva.EventServer.Queue;cq=q.slice();var qlen=0;for(var key in q){qlen+=1}for(var key in q){if(q[key].id){id="#"+q[key].id.replace(".","\\.");if($(id).length>0){cond=q[key].condition;tree=$(id).find("."+cond[cond.length-1]).parentsUntil("#"+q[key].id);tree.push($(id).find("."+cond[cond.length-1])[0]);for(i=cond.length-1;i>-1;i-=1){for(j=tree.length-1;j>-1;j-=1){if(tree[j].className===cond[i]||tree[j].tagName.toLowerCase()===cond[i].toLowerCase()){tree.splice(j,1);break}else{if(j===0){failed=true}}}}if(failed!==false){continue}if(q[key].dependencies.length===0){$(Qva.EventServer).trigger(q[key].event,{id:id,obj:q[key].object});cq.splice(key,1)}else{q[key].condition=[];for(i=0;i<q[key].dependencies.length;i+=1){deps=q[key].dependencies[i].split(",");if(!Qva.Registry.verify(deps[0],deps[1],deps[2],(deps[3])?deps[3]:null)){verified=false;continue}}if(verified){args={id:id};$.each(q[key],function(k,v){if(k!=="event"&&k!=="dependencies"&&k!=="condition"){args[k]=v}});cq.splice(key,1);toexec[q[key].event]=args}}}Qva.EventServer.Queue=cq.slice()}}$.each(toexec,function(k,v){$(Qva.EventServer).trigger(k,v)});return};Qva.EventServer.processQueue=function(param){if(Qva.EventServer.ConfigReady!==true){return}var q=Qva.EventServer.Queue,i=0,loc=-1,mode=false,deps=[],failed=false,id="";switch(typeof param){case"object":$ele=$(param);mode="ele";break;case"string":mode="feature";break;case"undefined":mode:"debug";break}if(!mode){return}switch(mode){case"ele":Qva.EventServer.processQueueObjects();break;case"feature":for(var key in q){deps=q[key].dependencies;if(deps.length>0){for(i=0;i<deps.length;i+=1){loc=$.inArray(param,deps);if(loc>-1){deps.splice(loc,1)}else{failed=true}}if(failed){return}}}break}};Qva.EventServer.flushArchiveQueue=function(){Qva.EventServer.ArchiveQueue=[]};$(Qva.EventServer).on("OnUpdateComplete",function(){Qva.EventServer.flushArchiveQueue()});Qva.EventServer.init()})($QvJq);(function($,undefined){Qva.Registry={storage:{},validate:function(category,segment,feature,key){if(this.verify(category,segment,feature)&&this.storage[category][segment][feature].active===true){return true}return false},verify:function(category,segment,feature,key){if(!key){if(this.storage[category]&&this.storage[category][segment]&&this.storage[category][segment][feature]){return true}}else{if(this.storage[category]&&this.storage[category][segment]&&this.storage[category][segment][feature]&&this.storage[category][segment][feature][key]){return true}}return false},get:function(category,segment,feature,key){if(key&&this.verify(category,segment,feature)&&typeof this.storage[category][segment][feature][key]!=="undefined"){return this.storage[category][segment][feature][key]}else{if(this.verify(category,segment,feature)){return this.storage[category][segment][feature]}}return{}},getEntryLength:function(category,segment,feature){if(this.verify(category,segment,feature)){return Object.keys(this.storage[category][segment][feature]).length}return 0},set:function(category,segment,feature,featureEntry){var categories,segments,features;for(categories in this.storage){for(segments in this.storage[categories]){for(features in this.storage[categories][segments]){if(this.storage[categories][segments][features]===feature){Qva.ConsoleLog.Log("QvRegistry: Skipping entry of "+segments+" - "+features+" as a duplicate");return false}}}}if(!this.storage[category]){this.storage[category]={}}if(!this.storage[category][segment]){this.storage[category][segment]={}}this.storage[category][segment][feature]=featureEntry;return true},add:function(category,segment,feature,key,value){if(!this.verify(category,segment,feature)){this.set(category,segment,feature,{})}if(key){if(!value){value={}}this.storage[category][segment][feature][key]=value}return}}})($QvJq);(function($,undefined){Qva.FeatureConfig={Core:{},Events:{TranslationEvents:{active:true,areas:["All"],browsers:["All"],excludes:[],categories:["Events","Mutation Events"],requires:[],ignoreFile:false}},Gui:{},Security:{EnhancedXRF:{active:false,areas:["All"],browsers:["All"],excludes:[],categories:["Security","Client"],requires:[],ignoreFile:true}}}})($QvJq);(function($,undefined){Qva.ajaxHelper={checkLoadFileJSON:function(file,callbackFn){$.getJSON(file).fail(function(){if(Qva.Debug.IsDebugMode===true){Qva.ConsoleLog.Log("QvAjaxHelper - JSON request failed for file: "+file);callbackFn({})}}).done(function(data){callbackFn(data)})},escapeString:function(string){return $("<div/>").text(string).html()},getRandomValues:function(){function getCryptoObj(){if(typeof window.crypto=="object"&&typeof window.crypto.getRandomValues=="function"){crypto=window.crypto}else{if(typeof window.msCrypto=="object"&&typeof window.msCrypto.getRandomValues=="function"){crypto=window.msCrypto}}return crypto}function cryptoGetRandom(){var rndArr=new Uint8Array(1);crypto.getRandomValues(rndArr);if(rndArr[0]>=62){return cryptoGetRandom()}return rndArr[0]}var crypto=getCryptoObj();if(crypto){return cryptoGetRandom()}else{return Math.floor(Math.random()*62)}}}})($QvJq);(function($,undefined){Qva.urlHelper={getUrlParameter:function(paramName,url){var parts,partIx;if(typeof url==="undefined"){url=window.location.href}parts=url.split("?");if(parts.length>1){parts=parts[1].split("&")}for(partIx in parts){if(parts[partIx].indexOf(paramName+"=")>-1){return parts[partIx].substr(parts[partIx].indexOf("=")+1)}}return false},scanUrlPath:function(searchString){var urlPath=this.getUrlPath();return urlPath.indexOf(searchString)},getUrlPath:function(url){var url,host,parts,urlHostPath,urlPath;url=window.location.href;host=window.location.host;parts=url.split("?");if(parts.length>0){urlHostPath=parts[0]}urlPath=urlHostPath.substr(urlHostPath.indexOf(host)+host.length+1);return urlPath}}})($QvJq);(function($,undefined){Qva.generalHelper={readCookie:function(name){var nameEQ=name+"=";var ca=document.cookie.split(";");for(var i=0;i<ca.length;i++){var c=ca[i];while(c.charAt(0)===" "){c=c.substring(1,c.length)}if(c.indexOf(nameEQ)===0){return c.substring(nameEQ.length,c.length)}}return null},formatDateStrings:function(params){if(params.month){params.month=parseInt(params.month)+1;if(params.month.length<2){params.month="0"+params.month}}if(params.day){if(params.day.length<2){params.day="0"+params.day}}return params},getType:function(value){var type;if(value===undefined){return"undefined"}if(value===null){return"null"}type=typeof value;if(type==="object"){type=Qva.generalHelper.getObjectType(value).toLowerCase()}if(type==="number"){if(value.toString().indexOf(".")>0){return"float"}else{return"integer"}}return type},getObjectType:function(value){return Object.prototype.toString.call(value).match(/^\[object\s(.*)\]$/)[1]},compare:{array:function(a,b){if(a.length!==b.length&&typeof a!==typeof b){return false}for(var i=0;i<a.length;i+=1){if($.inArray(a[i],b)===-1){return false}}return true},object:function(a,b){if(a===b){return true}for(var i in a){if(b.hasOwnProperty(i)){if(!Qva.generalHelper.compareValues(a[i],b[i])){return false}}else{return false}}for(var i in b){if(!a.hasOwnProperty(i)){return false}}return true},date:function(a,b){return a.getTime()===b.getTime()},regexp:function(a,b){return a.toString()===b.toString()}},compareValues:function(a,b){if(a!==b){var typeA=Qva.generalHelper.getType(a),typeB=Qva.generalHelper.getType(b);if(typeA===typeB){return Qva.generalHelper.compare.hasOwnProperty(typeA)?Qva.generalHelper.compare[typeA](a,b):a==b}return false}return true},dupCheckQueueEntry:function(queue,entry){for(var key in queue){if(Qva.generalHelper.compareValues(queue[key],entry)){return false}}return true},ObjectifyARGB:function(color){var a=0,r=0,g=0,b=0;if(color&&color.length===9){a=parseInt(color.substr(1,2),16);r=parseInt(color.substr(3,2),16);g=parseInt(color.substr(5,2),16);b=parseInt(color.substr(7,2),16)}else{if(color&&color.length===7){a=parseInt("ff",16);r=parseInt(color.substr(1,2),16);g=parseInt(color.substr(3,2),16);b=parseInt(color.substr(5,2),16)}}return{A:a,R:r,G:g,B:b,css:HtmlifyARGB(color,Qva.userAgentDetector.get("msie8lte")||Qva.userAgentDetector.get("msie11emu")?false:[a,r,g,b])}},hexToRGB:function hexToRGB(h){var ah=h;if(ah.length===9){ah="#"+ah.substr(3)}if(typeof ah==="string"&&Qva.Registry.get("System","Browsers","UserAgentDetector","msie6o7")===true){ah=ah.split("")}ah[4]||(ah=h.replace(/./g,"$&$&").slice(1));return["0x"+ah[1]+ah[2]|0,"0x"+ah[3]+ah[4]|0,"0x"+ah[5]+ah[6]|0]},colorBrightness:function(color){var rgbarray=Qva.generalHelper.ObjectifyARGB(color);return Math.sqrt(0.299*Math.pow(rgbarray.R,2)+0.587*Math.pow(rgbarray.G,2)+0.114*Math.pow(rgbarray.B,2))},detectDarkColor:function(color,backgroundColor){var cB=Qva.generalHelper.colorBrightness(color);if(backgroundColor){return cB<Qva.generalHelper.colorBrightness(backgroundColor)}else{return cB<130}},getHighestZIndex:function(){var indexCurrent=0,indexHighest=0;$(".QvFrame").each(function(ix,ele){indexCurrent=parseInt(ele.style.zIndex);if(indexCurrent>indexHighest){indexHighest=indexCurrent}});return indexHighest}}})($QvJq);(function($,undefined){Qva.touchHelper={Listbox:{calculateDeltaRows:function(mgr,deltaY){return Math.max(0,Math.min(mgr.rows-mgr.visible_rows,Math.round(-deltaY/mgr.rowHeight)))},update:function(e,objLBTouch){var i=0,len=0;if(e.changedTouches){len=e.changedTouches.length}else{e.changedTouches=[e];len=1}for(;i<len;++i){if(Qva.Events.getIdentifier(e.changedTouches[i])==objLBTouch.TouchIdentifier){break}}if(i>=len){return false}var dx=e.changedTouches[i].clientX-objLBTouch.TouchStartX;var dy=e.changedTouches[i].clientY-objLBTouch.TouchStartY;var dt=e.timeStamp-objLBTouch.TouchStartTime;objLBTouch.TouchPointList.push({dx:dx,dy:dy,dt:dt});return true}}}})($QvJq);(function($,undefined){Qva.menuHelper={limitContextmenu:function(params){var $elem=params.elem,objects=params.objects,objMgr=params.mgr,objType="",owner="",settings={},$object={};if(objMgr&&objMgr.ObjectId){$object=$(document.getElementById(objMgr.ObjectId));if(objMgr.ObjectId==="DS"){owner=$object.attr("owner");objType=$(document.getElementById(owner)).attr("objsubtype")}else{objType=$object.attr("objsubtype")}if(typeof objType!=="undefined"){if(Qva.QvAjaxSettings&&Qva.QvAjaxSettings.ContextMenus&&Qva.QvAjaxSettings.ContextMenus[objMgr.ObjectId]&&Qva.QvAjaxSettings.ContextMenus[objMgr.ObjectId][objType]){settings=Qva.QvAjaxSettings.ContextMenus[objMgr.ObjectId][objType];objects=this.syncContextMenuOptions({objects:objects,settings:settings});objects=this.cleanContextMenuDividers({objects:objects})}}}return objects},syncContextMenuOptions:function(params){var settings=params.settings,objects=params.objects,that=this;$(objects).each(function(ix,obj){if((obj.name&&(!settings[obj.name]||settings[obj.name]!==true))||(!obj.name&&obj.text&&(!settings[obj.text]||settings[obj.text]!==true))){objects.splice(ix,1);that.syncContextMenuOptions({objects:objects,settings:settings});return false}});return objects},cleanContextMenuDividers:function(params){objects=params.objects,that=this;$(objects).each(function(ix,obj){while(obj.type&&obj.type==="divider"&&((objects[ix+1]&&objects[ix+1]["type"]&&objects[ix+1]["type"]==="divider")||ix+1===objects.length)){objects.splice(ix,1);that.cleanContextMenuDividers({objects:objects});return false}});return objects}}})($QvJq);(function($,undefined){Qva.guiHelper={options:{bodySize:{width:0,height:0},docSize:{width:0,height:0},$mainQvElements:{},$bodyQvElements:{},$tabrow:$("#Tabrow"),$toolbar:$("#QvAjaxToolbar")},measureBodySize:function(){var height=0,width=0,that=this;this.options.bodySize.height=0;this.options.bodySize.width=0;this.options.$mainQvElements=$("#MainContainer").children();this.options.$bodyQvElements=$("body").children(".QvFrame, .ctx-menu");$.each(this.options.$mainQvElements,function(ix,ele){that.measureMaxBodyByElement(ele)});$.each(this.options.$bodyQvElements,function(ix,ele){that.measureMaxBodyByElement(ele)});return this.options.bodySize},measureMaxBodyByElement:function(ele){$ele=$(ele);if($ele.find(".QvContent").html()!==""&&$ele.css("display")!=="none"&&$ele.css("visibility")!=="hidden"){var h=parseFloat($ele.css("top"))+$ele.height();var w=parseFloat($ele.css("left"))+$ele.width();if(h>this.options.bodySize.height){this.options.bodySize.height=h}if(w>this.options.bodySize.width){this.options.bodySize.width=w}}},measureDocSize:function(){var w=0,h=0,$doc=$(document);this.options.docSize.width=$doc.width();this.options.docSize.top=this.options.$tabrow.height()+this.options.$toolbar.height();this.options.docSize.height=$doc.height()-this.options.docSize.top;return this.options.docSize},isZoomed:function(){var screenCssPixelRatio=(window.outerWidth-8)/window.innerWidth;return isZoomed=(screenCssPixelRatio<0.98||screenCssPixelRatio>1.02)},getViewPortWidthWithoutScroll:function(){if(Qva.guiHelper.isZoomed()&&Qva.userAgentDetector.get("msie")){return window.innerWidth-10}if(Qva.userAgentDetector.get("safari")){return window.innerWidth-3}return Qva.GetViewportWidth()}}})($QvJq);(function($,undefined){Qva.Config={vars:{refreshParam:Qva.params.refreshParam,requires:[],active:"",named:"",excludes:"",excludeTest:"",path:"",browser:"",browserTest:"",area:"",areaTest:"",requireTest:true,configFeature:"",configSegment:"",featureEntry:{},addLoadFiles:[],ignoreFiles:[],overrides:{}},init:function(){this.getDevices();if(!this.vars.refreshParam){this.vars.refreshParam=""}if(Qva.Debug.IsDebugMode!==true){Qva.ajaxHelper.checkLoadFileJSON(Qva.QvAjaxZfcPath+"htc/customFiles/customConfig.js"+this.vars.refreshParam,function(data){Qva.Config.initConfig(data)})}else{this.initConfig()}},getDevices:function(){if(!Qva.userAgentDetector.getDevices||typeof Qva.userAgentDetector.getDevices!=="function"){$.extend(Qva.userAgentDetector,{getDevices:function(){if(Qva.userAgentDetector.get("smallDevicesChecked")===false){if(Qva.urlHelper.scanUrlPath("mobile")>-1){Qva.userAgentDetector.set("isSmallDevices",true)}}if(Qva.userAgentDetector.get("isSmallDevices")===false){Qva.userAgentDetector.set("isFullDevices",true)}Qva.userAgentDetector.set("smallDevicesChecked",true);Qva.userAgentDetector.set("fullDevicesChecked",true)}})}Qva.userAgentDetector.getDevices()},initConfig:function(data){this.createDynamicCSS();this.registerBrowserInfo();this.overrideSettings(data);this.readConfig()},overrideSettings:function(data){var key;if(data){for(key in data){if(data[key]===true){for(this.vars.configSegment in Qva.FeatureConfig){if(Qva.FeatureConfig[this.vars.configSegment][key]){if(Qva.Debug.IsDebugMode===true){this.vars.path=Qva.FeatureConfig[this.vars.configSegment][key].categories.join("/").toLowerCase().replace(/ /g,"");this.vars.addLoadFiles.push(Qva.QvAjaxZfcPath+"htc/"+this.vars.path+"/"+key+".js"+this.vars.refreshParam)}this.vars.overrides[key]="active"}}}else{if(Qva.Debug.IsDebugMode===true){this.vars.ignoreFiles.push(key)}this.vars.overrides[key]="inactive"}}}return true},readConfig:function(){for(this.vars.configSegment in Qva.FeatureConfig){for(this.vars.configFeature in Qva.FeatureConfig[this.vars.configSegment]){this.vars.active=false,this.vars.named=false,this.vars.browserTest=false,this.vars.areaTest=false,this.vars.excludeTest=false,this.vars.requireTest=true;var overrideStatus=this.vars.overrides[this.vars.configFeature];this.vars.featureEntry=this.getFeature(this.vars.configSegment,this.vars.configFeature,overrideStatus);for(this.vars.browser in this.vars.featureEntry.browsers){if(this.vars.featureEntry.browsers[this.vars.browser]==="All"||Qva.userAgentDetector.get(this.vars.featureEntry.browsers[this.vars.browser])===true){this.vars.browserTest=true}}for(this.vars.excludes in this.vars.featureEntry.excludes){if(Qva.Registry.get("System","Browsers","UserAgentDetector",this.vars.featureEntry.excludes[this.vars.excludes])===true){this.vars.excludeTest=true}}for(this.vars.area in this.vars.featureEntry.areas){if(this.vars.featureEntry.areas[this.vars.area]==="All"||Qva.userAgentDetector.get("is"+this.vars.featureEntry.areas[this.vars.area]+"Devices")===true){this.vars.areaTest=true}}for(this.vars.requires in this.vars.featureEntry.requires){var req=this.vars.featureEntry.requires[this.vars.requires].split(",");if(Qva.Registry.get(req[0],req[1],req[2],req[3])===false){this.vars.requireTest=false}}if(!this.vars.browserTest||!this.vars.areaTest||this.vars.excludeTest===true||!this.vars.requireTest){continue}this.vars.path=this.vars.featureEntry.categories.join("/").toLowerCase().replace(/ /g,"");this.register("Config",Qva.Config.vars.configSegment,Qva.Config.vars.configFeature,Qva.Config.vars.featureEntry);$(Qva.EventServer).trigger("featureAdded",{feature:Qva.Config.vars.featureEntry})}}Qva.Registry.set("Config","Init","LastFeature",this.vars.configFeature);var configReadyTimer=window.setInterval(function(){if(Qva.EventServer&&Qva.EventServer.registerEvent&&typeof Qva.EventServer.registerEvent!="undefined"){window.clearInterval(configReadyTimer);$(Qva.EventServer).trigger("configReady")}},10);return true},getFeature:function(segment,feature,overrideStatus){var configMode,details,ret,cont;cont=false;configMode="FeatureConfig";if(Qva[configMode]&&Qva[configMode][segment]&&Qva[configMode][segment][feature]&&((typeof Qva[configMode][segment][feature].active!=="undefined"&&(Qva[configMode][segment][feature].active===true||overrideStatus==="active")))){cont=true}if(cont===true){details=this.getDetails(segment,feature);ret=details;ret.active=true;return ret}return false},getDetails:function(segment,feature){var ret={areas:[],browsers:[],categories:[],requires:[],excludes:[],ignoreFile:false},key="";for(key in ret){ret[key]=this.getStringifiedFeatureDetailsArray(segment,feature,key)}return ret},getStringifiedFeatureDetailsArray:function(segment,feature,key){if(Qva.FeatureConfig[segment]&&Qva.FeatureConfig[segment][feature]&&Qva.FeatureConfig[segment][feature][key]&&Qva.FeatureConfig[segment][feature][key].length>0){var push=[];for(var ix in Qva.FeatureConfig[segment][feature][key]){push.push(Qva.FeatureConfig[segment][feature][key][ix].toString())}return push}else{if(Qva.FeatureConfig[segment]&&Qva.FeatureConfig[segment][feature]&&typeof Qva.FeatureConfig[segment][feature][key]!=="undefined"&&typeof Qva.FeatureConfig[segment][feature][key]==="boolean"){return Qva.FeatureConfig[segment][feature][key]}}return[]},registerBrowserInfo:function(){var that=this,toReg={};$.each(Qva.userAgentDetector.options,function(key,value){if(key!=="responsiveDevicesChecked"&&key!=="smallDevicesChecked"&&key!=="alert"&&key!=="fullDevicesChecked"){toReg[key]=value}});if(Object.keys(toReg).length>0){that.register("System","Browsers","UserAgentDetector",toReg)}},register:function(category,segment,feature,entry){Qva.Registry.set(category,segment,feature,entry)},createDynamicCSS:function(){return;var style=document.createElement("style");style.appendChild(document.createTextNode(""));document.head.appendChild(style);Qva.Registry.set("System","Resources","CSS",style.sheet)}};Qva.Config.init()})($QvJq);Qva.QvAjaxSettings={ContextMenus:{DS:{SO:{EAC:true,CAC:true},CS:{SEARCH:true,FSEARCH:true,SP:true,SE:true,SA:true,CD:true,CO:true,LOC:true},MB:{SEARCH:true,FSEARCH:true,SP:true,SE:true,SA:true,CD:true,CO:true,COPY:true,PR:true,XL:true,EC:true}},CurrentSelection:{CS:{SP:true,SE:true,SA:true,CA:true,CD:true,CO:true,LOC:true,LS:true,US:true,ULC:true}}}};(function($,undefined){var start=function(){var entry,link,linkHtml;var translationEvents={vars:{translationFeature:"",translationSegment:""},addEvents:function(){$(Qva.EventServer).on("translate",function(event,params){if(Qva.Registry.verify("Translations",params.segment,params.feature)){entry=Qva.Registry.get("Translations",params.segment,params.feature);switch(params.segment){case"ModalDialogs":link=$(params.target).find(".ModalDialog_Text a");if(link.length>0){if(!entry.link||entry.link.replace(/ /g,"")===""){entry.link=link.html()}linkHtml=' <a href="'+link.attr("href")+'" target="'+link.attr("target")+'">'+entry.link+"</a>"}else{linkHtml=""}$(params.target).find(".ModalDialog_Header span").html(entry.title);$(params.target).find(".ModalDialog_Text").html(entry.msg+linkHtml);Qva.Registry.set("Parameters",params.segment,"currentDialog",{});break}}})},init:function(data){var entry,escapedEntry,key;for(this.vars.translationSegment in data){for(this.vars.translationFeature in data[this.vars.translationSegment]){entry=data[this.vars.translationSegment][this.vars.translationFeature];escapedEntry={};for(key in entry){escapedEntry[key]=Qva.ajaxHelper.escapeString(entry[key])}this.register("Translations",this.vars.translationSegment,this.vars.translationFeature,escapedEntry)}}this.addEvents()},register:function(category,segment,feature,entry){Qva.Registry.set(category,segment,feature,entry)}};if(Qva.Registry.validate("Config","Events","TranslationEvents")===true){Qva.ajaxHelper.checkLoadFileJSON(Qva.QvAjaxZfcPath+"htc/customFiles/customTranslations.js",function(data){translationEvents.init(data)})}};if(Qva.EventServer.ConfigReady){start()}else{$(Qva.EventServer).on("configReady",start)}})($QvJq)})($QvJq);